/*
MICROSOFT SOFTWARE LICENSE TERMS
MICROSOFT AZURE MAPS WEB SDK
These license terms are an agreement between you and Microsoft Corporation (or one of its affiliates). They apply to the software named above and any Microsoft services or software updates (except to the extent such services or updates are accompanied by new or additional terms, in which case those different terms apply prospectively and do not alter your or Microsoft’s rights relating to pre-updated software or services). IF YOU COMPLY WITH THESE LICENSE TERMS, YOU HAVE THE RIGHTS BELOW.  BY USING THE SOFTWARE, YOU ACCEPT THESE TERMS.
1. INSTALLATION AND USE RIGHTS.
  a) General. You may install and use any number of copies of the software to develop and test your applications.
  b) User Region Parameters. The software will allow you to select from a View list to set the map view within your application for a given customer. By default the View parameter (also referred to as “user region parameter” is set to “Unified”.  Countries/Regions that are not on the View list will default to the “Unified” View. It is your responsibility to determine the location of your users, and then set the View parameter correctly for that location. The View parameter must be used in compliance with applicable laws, including those regarding mapping, of the country where maps, images and other data and third party content that You are authorized to access via the software is made available. 
  c) Third Party Software. The software may include third party applications that Microsoft, not the third party, licenses to you under this agreement. Any included notices for third party applications are for your information only.
  d) Microsoft Online Subscription Agreement. Some features of the software provide access to, or rely on, Microsoft Azure Services. The use of those services (but not the software) is governed by the separate terms and privacy policies associated with your Microsoft Azure subscription. The services may not be available in all regions. For more information see https://go.microsoft.com/fwLink/?LinkID=522330&amp;clcid=0x9.
2. DISTRIBUTABLE CODE. The software is comprised of “Distributable Code”. “Distributable Code” is code that you are permitted to distribute in applications you develop if you comply with the terms below and otherwise set forth in these license terms. 
  a) Distribution Rights. 
    i. You may copy and distribute the object code form of the software.
    i. Third Party Distribution. You may permit distributors of your applications to copy and distribute any of this distributable code you elect to distribute with your applications.
  b) Distribution Requirements. For any code you distribute, you must:
    i. add significant primary functionality to it in your applications;
    ii. require distributors and external end users to agree to terms that protect it and Microsoft at least as much as this agreement; and
    iii. indemnify, defend, and hold harmless Microsoft from any claims, including attorneys’ fees, related to the distribution or use of your applications, except to the extent that any claim is based solely on the unmodified distributable code.
  c) Distribution Restrictions. You may not:
    i. use Microsoft’s trademarks or trade dress in your application in any way that suggests your application comes from or is endorsed by Microsoft; or
    ii. modify or distribute the source code of any distributable code so that any part of it becomes subject to any license that requires that the distributable code, any other part of the software, or any of Microsoft’s other intellectual property be disclosed or distributed in source code form, or that others have the right to modify it.
3. DATA COLLECTION. The software may collect information about you and your use of the software and send that to Microsoft. Microsoft may use this information to provide services and improve Microsoft’s products and services. Your opt-out rights, if any, are described in the product documentation. Some features in the software may enable collection of data from users of your applications that access or use the software. If you use these features to enable data collection in your applications, you must comply with applicable law, including getting any required user consent, and maintain a prominent privacy policy that accurately informs users about how you use, collect, and share their data. You can learn more about Microsoft’s data collection and use in the product documentation and the Microsoft Privacy Statement at https://go.microsoft.com/fwlink/?LinkId=512132. You agree to comply with all applicable provisions of the Microsoft Privacy Statement.
4. SCOPE OF LICENSE. The software is licensed, not sold. Microsoft reserves all other rights. Unless applicable law gives you more rights despite this limitation, you will not (and have no right to):
  a) work around any technical limitations in the software that only allow you to use it in certain ways;
  b) reverse engineer, decompile, or disassemble the software, or attempt to do so, except and only to the extent permitted by licensing terms governing the use of open-source components that may be included with the software;
  c) remove, minimize, block, or modify any notices of Microsoft or its suppliers in the software;
  d) use the software in any way that is against the law or to create or propagate malware; or
  e) share, publish, distribute, or lend the software (except for any distributable code, subject to the terms above), provide the software as a stand-alone hosted solution for others to use, or transfer the software or this agreement to any third party.
5. EXPORT RESTRICTIONS. You must comply with all domestic and international export laws and regulations that apply to the software, which include restrictions on destinations, end users, and end use. For further information on export restrictions, visit http://aka.ms/exporting.
6. SUPPORT SERVICES. Microsoft is not obligated under this agreement to provide any support services for the software. Any support provided is “as is”, “with all faults”, and without warranty of any kind.
7. UPDATES. The software may periodically check for updates, and download and install them for you. You may obtain updates only from Microsoft or authorized sources. Microsoft may need to update your system to provide you with updates. You agree to receive these automatic updates without any additional notice. Updates may not include or support all existing software features, services, or peripheral devices.
8. ENTIRE AGREEMENT. This agreement, and any other terms Microsoft may provide for supplements, updates, or third-party applications, is the entire agreement for the software.
9. APPLICABLE LAW AND PLACE TO RESOLVE DISPUTES. If you acquired the software in the United States or Canada, the laws of the state or province where you live (or, if a business, where your principal place of business is located) govern the interpretation of this agreement, claims for its breach, and all other claims (including consumer protection, unfair competition, and tort claims), regardless of conflict of laws principles. If you acquired the software in any other country, its laws apply. If U.S. federal jurisdiction exists, you and Microsoft consent to exclusive jurisdiction and venue in the federal court in King County, Washington for all disputes heard in court. If not, you and Microsoft consent to exclusive jurisdiction and venue in the Superior Court of King County, Washington for all disputes heard in court.
10. CONSUMER RIGHTS; REGIONAL VARIATIONS. This agreement describes certain legal rights. You may have other rights, including consumer rights, under the laws of your state or country. Separate and apart from your relationship with Microsoft, you may also have rights with respect to the party from which you acquired the software. This agreement does not change those other rights if the laws of your state or country do not permit it to do so. For example, if you acquired the software in one of the below regions, or mandatory country law applies, then the following provisions apply to you:
  a) Australia. You have statutory guarantees under the Australian Consumer Law and nothing in this agreement is intended to affect those rights.
  b) Canada. If you acquired this software in Canada, you may stop receiving updates by turning off the automatic update feature, disconnecting your device from the Internet (if and when you re-connect to the Internet, however, the software will resume checking for and installing updates), or uninstalling the software. The product documentation, if any, may also specify how to turn off updates for your specific device or software.
  c) Germany and Austria.
    i. Warranty. The properly licensed software will perform substantially as described in any Microsoft materials that accompany the software. However, Microsoft gives no contractual guarantee in relation to the licensed software.
    ii. Limitation of Liability. In case of intentional conduct, gross negligence, claims based on the Product Liability Act, as well as, in case of death or personal or physical injury, Microsoft is liable according to the statutory law.
  Subject to the foregoing clause ii., Microsoft will only be liable for slight negligence if Microsoft is in breach of such material contractual obligations, the fulfillment of which facilitate the due performance of this agreement, the breach of which would endanger the purpose of this agreement and the compliance with which a party may constantly trust in (so-called "cardinal obligations"). In other cases of slight negligence, Microsoft will not be liable for slight negligence.
11. DISCLAIMER OF WARRANTY. THE SOFTWARE IS LICENSED “AS IS.” YOU BEAR THE RISK OF USING IT. MICROSOFT GIVES NO EXPRESS WARRANTIES, GUARANTEES, OR CONDITIONS. TO THE EXTENT PERMITTED UNDER APPLICABLE LAWS, MICROSOFT EXCLUDES ALL IMPLIED WARRANTIES, INCLUDING MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT.
12. LIMITATION ON AND EXCLUSION OF DAMAGES. IF YOU HAVE ANY BASIS FOR RECOVERING DAMAGES DESPITE THE PRECEDING DISCLAIMER OF WARRANTY, YOU CAN RECOVER FROM MICROSOFT AND ITS SUPPLIERS ONLY DIRECT DAMAGES UP TO U.S. $5.00. YOU CANNOT RECOVER ANY OTHER DAMAGES, INCLUDING CONSEQUENTIAL, LOST PROFITS, SPECIAL, INDIRECT, OR INCIDENTAL DAMAGES.
This limitation applies to (a) anything related to the software, services, content (including code) on third party Internet sites, or third party applications; and (b) claims for breach of contract, warranty, guarantee, or condition; strict liability, negligence, or other tort; or any other claim; in each case to the extent permitted by applicable law.
It also applies even if Microsoft knew or should have known about the possibility of the damages. The above limitation or exclusion may not apply to you because your state, province, or country may not allow the exclusion or limitation of incidental, consequential, or other damages.
Please note: As this software is distributed in Canada, some of the clauses in this agreement are provided below in French.
Remarque: Ce logiciel étant distribué au Canada, certaines des clauses dans ce contrat sont fournies ci-dessous en français.
EXONÉRATION DE GARANTIE. Le logiciel visé par une licence est offert « tel quel ». Toute utilisation de ce logiciel est à votre seule risque et péril. Microsoft n’accorde aucune autre garantie expresse. Vous pouvez bénéficier de droits additionnels en vertu du droit local sur la protection des consommateurs, que ce contrat ne peut modifier. La ou elles sont permises par le droit locale, les garanties implicites de qualité marchande, d’adéquation à un usage particulier et d’absence de contrefaçon sont exclues.
LIMITATION DES DOMMAGES-INTÉRÊTS ET EXCLUSION DE RESPONSABILITÉ POUR LES DOMMAGES. Vous pouvez obtenir de Microsoft et de ses fournisseurs une indemnisation en cas de dommages directs uniquement à hauteur de 5,00 $ US. Vous ne pouvez prétendre à aucune indemnisation pour les autres dommages, y compris les dommages spéciaux, indirects ou accessoires et pertes de bénéfices.
Cette limitation concerne:
• tout ce qui est relié au logiciel, aux services ou au contenu (y compris le code) figurant sur des sites Internet tiers ou dans des programmes tiers; et
• les réclamations au titre de violation de contrat ou de garantie, ou au titre de responsabilité stricte, de négligence ou d’une autre faute dans la limite autorisée par la loi en vigueur.
Elle s’applique également, même si Microsoft connaissait ou devrait connaître l’éventualité d’un tel dommage. Si votre pays n’autorise pas l’exclusion ou la limitation de responsabilité pour les dommages indirects, accessoires ou de quelque nature que ce soit, il se peut que la limitation ou l’exclusion ci-dessus ne s’appliquera pas à votre égard.
EFFET JURIDIQUE. Le présent contrat décrit certains droits juridiques. Vous pourriez avoir d’autres droits prévus par les lois de votre pays. Le présent contrat ne modifie pas les droits que vous confèrent les lois de votre pays si celles-ci ne le permettent pas.
---
title: THIRD PARTY NOTICES FOR Azure Maps SDK
preamble: |
	Do Not Translate or Localize

	This file is based on or incorporates material from the projects listed below (Third Party IP).
	The original copyright notice and the license under which Microsoft received such Third Party IP,
	are set forth below. Such licenses and notices are provided for informational purposes only.
	Microsoft licenses the Third Party IP to you under the licensing terms for the Microsoft product.
	Microsoft reserves all other rights not expressly granted under this agreement, whether by implication,
	estoppel or otherwise.


registrations:
	- component:
		name: @mapbox/mapbox-gl-rtl-text
		version: 0.1.2
		license: |
mapbox-gl-rtl-text copyright (c) 2017 Mapbox.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

 - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
 - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This source code is derived from the International Components for Unicode (ICU) library, available from [http://site.icu-project.org/](). ICU C++ code original license as follows:

COPYRIGHT AND PERMISSION NOTICE (ICU 58 and later)

Copyright © 1991-2016 Unicode, Inc. All rights reserved.
Distributed under the Terms of Use in http://www.unicode.org/copyright.html

Permission is hereby granted, free of charge, to any person obtaining
a copy of the Unicode data files and any associated documentation
(the "Data Files") or Unicode software and any associated documentation
(the "Software") to deal in the Data Files or Software
without restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, and/or sell copies of
the Data Files or Software, and to permit persons to whom the Data Files
or Software are furnished to do so, provided that either
(a) this copyright and permission notice appear with all copies
of the Data Files or Software, or
(b) this copyright and permission notice appear in associated
Documentation.

THE DATA FILES AND SOFTWARE ARE PROVIDED "AS IS", WITHOUT WARRANTY OF
ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT OF THIRD PARTY RIGHTS.
IN NO EVENT SHALL THE COPYRIGHT HOLDER OR HOLDERS INCLUDED IN THIS
NOTICE BE LIABLE FOR ANY CLAIM, OR ANY SPECIAL INDIRECT OR CONSEQUENTIAL
DAMAGES, OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE,
DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THE DATA FILES OR SOFTWARE.

Except as contained in this notice, the name of a copyright holder
shall not be used in advertising or otherwise to promote the sale,
use or other dealings in these Data Files or Software without prior
written authorization of the copyright holder.


	- component:
		name: @microsoft/applicationinsights-web
		version: 2.2.2
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @microsoft/applicationinsights-analytics-js
		version: 2.2.2
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @microsoft/applicationinsights-common
		version: 2.2.2
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @microsoft/applicationinsights-core-js
		version: 2.2.2
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: tslib
		version: 1.10.0
		license: |
Apache License

Version 2.0, January 2004

http://www.apache.org/licenses/ 

TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

1. Definitions.

"License" shall mean the terms and conditions for use, reproduction, and distribution as defined by Sections 1 through 9 of this document.

"Licensor" shall mean the copyright owner or entity authorized by the copyright owner that is granting the License.

"Legal Entity" shall mean the union of the acting entity and all other entities that control, are controlled by, or are under common control with that entity. For the purposes of this definition, "control" means (i) the power, direct or indirect, to cause the direction or management of such entity, whether by contract or otherwise, or (ii) ownership of fifty percent (50%) or more of the outstanding shares, or (iii) beneficial ownership of such entity.

"You" (or "Your") shall mean an individual or Legal Entity exercising permissions granted by this License.

"Source" form shall mean the preferred form for making modifications, including but not limited to software source code, documentation source, and configuration files.

"Object" form shall mean any form resulting from mechanical transformation or translation of a Source form, including but not limited to compiled object code, generated documentation, and conversions to other media types.

"Work" shall mean the work of authorship, whether in Source or Object form, made available under the License, as indicated by a copyright notice that is included in or attached to the work (an example is provided in the Appendix below).

"Derivative Works" shall mean any work, whether in Source or Object form, that is based on (or derived from) the Work and for which the editorial revisions, annotations, elaborations, or other modifications represent, as a whole, an original work of authorship. For the purposes of this License, Derivative Works shall not include works that remain separable from, or merely link (or bind by name) to the interfaces of, the Work and Derivative Works thereof.

"Contribution" shall mean any work of authorship, including the original version of the Work and any modifications or additions to that Work or Derivative Works thereof, that is intentionally submitted to Licensor for inclusion in the Work by the copyright owner or by an individual or Legal Entity authorized to submit on behalf of the copyright owner. For the purposes of this definition, "submitted" means any form of electronic, verbal, or written communication sent to the Licensor or its representatives, including but not limited to communication on electronic mailing lists, source code control systems, and issue tracking systems that are managed by, or on behalf of, the Licensor for the purpose of discussing and improving the Work, but excluding communication that is conspicuously marked or otherwise designated in writing by the copyright owner as "Not a Contribution."

"Contributor" shall mean Licensor and any individual or Legal Entity on behalf of whom a Contribution has been received by Licensor and subsequently incorporated within the Work.

2. Grant of Copyright License. Subject to the terms and conditions of this License, each Contributor hereby grants to You a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare Derivative Works of, publicly display, publicly perform, sublicense, and distribute the Work and such Derivative Works in Source or Object form.

3. Grant of Patent License. Subject to the terms and conditions of this License, each Contributor hereby grants to You a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable (except as stated in this section) patent license to make, have made, use, offer to sell, sell, import, and otherwise transfer the Work, where such license applies only to those patent claims licensable by such Contributor that are necessarily infringed by their Contribution(s) alone or by combination of their Contribution(s) with the Work to which such Contribution(s) was submitted. If You institute patent litigation against any entity (including a cross-claim or counterclaim in a lawsuit) alleging that the Work or a Contribution incorporated within the Work constitutes direct or contributory patent infringement, then any patent licenses granted to You under this License for that Work shall terminate as of the date such litigation is filed.

4. Redistribution. You may reproduce and distribute copies of the Work or Derivative Works thereof in any medium, with or without modifications, and in Source or Object form, provided that You meet the following conditions:

You must give any other recipients of the Work or Derivative Works a copy of this License; and

You must cause any modified files to carry prominent notices stating that You changed the files; and

You must retain, in the Source form of any Derivative Works that You distribute, all copyright, patent, trademark, and attribution notices from the Source form of the Work, excluding those notices that do not pertain to any part of the Derivative Works; and

If the Work includes a "NOTICE" text file as part of its distribution, then any Derivative Works that You distribute must include a readable copy of the attribution notices contained within such NOTICE file, excluding those notices that do not pertain to any part of the Derivative Works, in at least one of the following places: within a NOTICE text file distributed as part of the Derivative Works; within the Source form or documentation, if provided along with the Derivative Works; or, within a display generated by the Derivative Works, if and wherever such third-party notices normally appear. The contents of the NOTICE file are for informational purposes only and do not modify the License. You may add Your own attribution notices within Derivative Works that You distribute, alongside or as an addendum to the NOTICE text from the Work, provided that such additional attribution notices cannot be construed as modifying the License. You may add Your own copyright statement to Your modifications and may provide additional or different license terms and conditions for use, reproduction, or distribution of Your modifications, or for any such Derivative Works as a whole, provided Your use, reproduction, and distribution of the Work otherwise complies with the conditions stated in this License.

5. Submission of Contributions. Unless You explicitly state otherwise, any Contribution intentionally submitted for inclusion in the Work by You to the Licensor shall be under the terms and conditions of this License, without any additional terms or conditions. Notwithstanding the above, nothing herein shall supersede or modify the terms of any separate license agreement you may have executed with Licensor regarding such Contributions.

6. Trademarks. This License does not grant permission to use the trade names, trademarks, service marks, or product names of the Licensor, except as required for reasonable and customary use in describing the origin of the Work and reproducing the content of the NOTICE file.

7. Disclaimer of Warranty. Unless required by applicable law or agreed to in writing, Licensor provides the Work (and each Contributor provides its Contributions) on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. You are solely responsible for determining the appropriateness of using or redistributing the Work and assume any risks associated with Your exercise of permissions under this License.

8. Limitation of Liability. In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall any Contributor be liable to You for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising as a result of this License or out of the use or inability to use the Work (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if such Contributor has been advised of the possibility of such damages.

9. Accepting Warranty or Additional Liability. While redistributing the Work or Derivative Works thereof, You may choose to offer, and charge a fee for, acceptance of support, warranty, indemnity, or other liability obligations and/or rights consistent with this License. However, in accepting such obligations, You may act only on Your own behalf and on Your sole responsibility, not on behalf of any other Contributor, and only if You agree to indemnify, defend, and hold each Contributor harmless for any liability incurred by, or claims asserted against, such Contributor by reason of your accepting any such warranty or additional liability.

END OF TERMS AND CONDITIONS


	- component:
		name: @microsoft/applicationinsights-channel-js
		version: 2.2.2
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @microsoft/applicationinsights-dependencies-js
		version: 2.2.2
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @microsoft/applicationinsights-properties-js
		version: 2.2.2
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @types/adal-angular
		version: 1.0.1
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @types/color
		version: 3.0.0
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @types/color-convert
		version: 1.9.0
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @types/color-name
		version: 1.1.1
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @types/jwt-decode
		version: 2.2.1
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @types/lodash
		version: 4.14.136
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @types/mapbox-gl
		version: 0.54.5
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: @types/geojson
		version: 7946.0.7
		license: |
    MIT License

    Copyright (c) Microsoft Corporation. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE


	- component:
		name: adal-angular
		version: 1.0.17
		license: |
                                 Apache License
                           Version 2.0, January 2004
                        http://www.apache.org/licenses/

   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

   1. Definitions.

      "License" shall mean the terms and conditions for use, reproduction,
      and distribution as defined by Sections 1 through 9 of this document.

      "Licensor" shall mean the copyright owner or entity authorized by
      the copyright owner that is granting the License.

      "Legal Entity" shall mean the union of the acting entity and all
      other entities that control, are controlled by, or are under common
      control with that entity. For the purposes of this definition,
      "control" means (i) the power, direct or indirect, to cause the
      direction or management of such entity, whether by contract or
      otherwise, or (ii) ownership of fifty percent (50%) or more of the
      outstanding shares, or (iii) beneficial ownership of such entity.

      "You" (or "Your") shall mean an individual or Legal Entity
      exercising permissions granted by this License.

      "Source" form shall mean the preferred form for making modifications,
      including but not limited to software source code, documentation
      source, and configuration files.

      "Object" form shall mean any form resulting from mechanical
      transformation or translation of a Source form, including but
      not limited to compiled object code, generated documentation,
      and conversions to other media types.

      "Work" shall mean the work of authorship, whether in Source or
      Object form, made available under the License, as indicated by a
      copyright notice that is included in or attached to the work
      (an example is provided in the Appendix below).

      "Derivative Works" shall mean any work, whether in Source or Object
      form, that is based on (or derived from) the Work and for which the
      editorial revisions, annotations, elaborations, or other modifications
      represent, as a whole, an original work of authorship. For the purposes
      of this License, Derivative Works shall not include works that remain
      separable from, or merely link (or bind by name) to the interfaces of,
      the Work and Derivative Works thereof.

      "Contribution" shall mean any work of authorship, including
      the original version of the Work and any modifications or additions
      to that Work or Derivative Works thereof, that is intentionally
      submitted to Licensor for inclusion in the Work by the copyright owner
      or by an individual or Legal Entity authorized to submit on behalf of
      the copyright owner. For the purposes of this definition, "submitted"
      means any form of electronic, verbal, or written communication sent
      to the Licensor or its representatives, including but not limited to
      communication on electronic mailing lists, source code control systems,
      and issue tracking systems that are managed by, or on behalf of, the
      Licensor for the purpose of discussing and improving the Work, but
      excluding communication that is conspicuously marked or otherwise
      designated in writing by the copyright owner as "Not a Contribution."

      "Contributor" shall mean Licensor and any individual or Legal Entity
      on behalf of whom a Contribution has been received by Licensor and
      subsequently incorporated within the Work.

   2. Grant of Copyright License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      copyright license to reproduce, prepare Derivative Works of,
      publicly display, publicly perform, sublicense, and distribute the
      Work and such Derivative Works in Source or Object form.

   3. Grant of Patent License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      (except as stated in this section) patent license to make, have made,
      use, offer to sell, sell, import, and otherwise transfer the Work,
      where such license applies only to those patent claims licensable
      by such Contributor that are necessarily infringed by their
      Contribution(s) alone or by combination of their Contribution(s)
      with the Work to which such Contribution(s) was submitted. If You
      institute patent litigation against any entity (including a
      cross-claim or counterclaim in a lawsuit) alleging that the Work
      or a Contribution incorporated within the Work constitutes direct
      or contributory patent infringement, then any patent licenses
      granted to You under this License for that Work shall terminate
      as of the date such litigation is filed.

   4. Redistribution. You may reproduce and distribute copies of the
      Work or Derivative Works thereof in any medium, with or without
      modifications, and in Source or Object form, provided that You
      meet the following conditions:

      (a) You must give any other recipients of the Work or
          Derivative Works a copy of this License; and

      (b) You must cause any modified files to carry prominent notices
          stating that You changed the files; and

      (c) You must retain, in the Source form of any Derivative Works
          that You distribute, all copyright, patent, trademark, and
          attribution notices from the Source form of the Work,
          excluding those notices that do not pertain to any part of
          the Derivative Works; and

      (d) If the Work includes a "NOTICE" text file as part of its
          distribution, then any Derivative Works that You distribute must
          include a readable copy of the attribution notices contained
          within such NOTICE file, excluding those notices that do not
          pertain to any part of the Derivative Works, in at least one
          of the following places: within a NOTICE text file distributed
          as part of the Derivative Works; within the Source form or
          documentation, if provided along with the Derivative Works; or,
          within a display generated by the Derivative Works, if and
          wherever such third-party notices normally appear. The contents
          of the NOTICE file are for informational purposes only and
          do not modify the License. You may add Your own attribution
          notices within Derivative Works that You distribute, alongside
          or as an addendum to the NOTICE text from the Work, provided
          that such additional attribution notices cannot be construed
          as modifying the License.

      You may add Your own copyright statement to Your modifications and
      may provide additional or different license terms and conditions
      for use, reproduction, or distribution of Your modifications, or
      for any such Derivative Works as a whole, provided Your use,
      reproduction, and distribution of the Work otherwise complies with
      the conditions stated in this License.

   5. Submission of Contributions. Unless You explicitly state otherwise,
      any Contribution intentionally submitted for inclusion in the Work
      by You to the Licensor shall be under the terms and conditions of
      this License, without any additional terms or conditions.
      Notwithstanding the above, nothing herein shall supersede or modify
      the terms of any separate license agreement you may have executed
      with Licensor regarding such Contributions.

   6. Trademarks. This License does not grant permission to use the trade
      names, trademarks, service marks, or product names of the Licensor,
      except as required for reasonable and customary use in describing the
      origin of the Work and reproducing the content of the NOTICE file.

   7. Disclaimer of Warranty. Unless required by applicable law or
      agreed to in writing, Licensor provides the Work (and each
      Contributor provides its Contributions) on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
      implied, including, without limitation, any warranties or conditions
      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
      PARTICULAR PURPOSE. You are solely responsible for determining the
      appropriateness of using or redistributing the Work and assume any
      risks associated with Your exercise of permissions under this License.

   8. Limitation of Liability. In no event and under no legal theory,
      whether in tort (including negligence), contract, or otherwise,
      unless required by applicable law (such as deliberate and grossly
      negligent acts) or agreed to in writing, shall any Contributor be
      liable to You for damages, including any direct, indirect, special,
      incidental, or consequential damages of any character arising as a
      result of this License or out of the use or inability to use the
      Work (including but not limited to damages for loss of goodwill,
      work stoppage, computer failure or malfunction, or any and all
      other commercial damages or losses), even if such Contributor
      has been advised of the possibility of such damages.

   9. Accepting Warranty or Additional Liability. While redistributing
      the Work or Derivative Works thereof, You may choose to offer,
      and charge a fee for, acceptance of support, warranty, indemnity,
      or other liability obligations and/or rights consistent with this
      License. However, in accepting such obligations, You may act only
      on Your own behalf and on Your sole responsibility, not on behalf
      of any other Contributor, and only if You agree to indemnify,
      defend, and hold each Contributor harmless for any liability
      incurred by, or claims asserted against, such Contributor by reason
      of your accepting any such warranty or additional liability.

   END OF TERMS AND CONDITIONS

   APPENDIX: How to apply the Apache License to your work.

      To apply the Apache License to your work, attach the following
      boilerplate notice, with the fields enclosed by brackets "[]"
      replaced with your own identifying information. (Don't include
      the brackets!)  The text should be enclosed in the appropriate
      comment syntax for the file format. We also recommend that a
      file or class name and description of purpose be included on the
      same "printed page" as the copyright notice for easier
      identification within third-party archives.

   Copyright [yyyy] [name of copyright owner]

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.


	- component:
		name: color
		version: 3.1.2
		license: |
Copyright (c) 2012 Heather Arthur

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.



	- component:
		name: color-convert
		version: 1.9.3
		license: |
Copyright (c) 2011-2016 Heather Arthur <fayearthur@gmail.com>

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.



	- component:
		name: color-name
		version: 1.1.3
		license: |
The MIT License (MIT)
Copyright (c) 2015 Dmitry Ivanov

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

	- component:
		name: color-string
		version: 1.5.3
		license: |
Copyright (c) 2011 Heather Arthur <fayearthur@gmail.com>

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.



	- component:
		name: simple-swizzle
		version: 0.2.2
		license: |
The MIT License (MIT)

Copyright (c) 2015 Josh Junon

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.


	- component:
		name: is-arrayish
		version: 0.3.2
		license: |
The MIT License (MIT)

Copyright (c) 2015 JD Ballard

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.


	- component:
		name: jwt-decode
		version: 2.2.0
		license: |
The MIT License (MIT)
 
Copyright (c) 2015 Auth0, Inc. <support@auth0.com> (http://auth0.com)
 
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:
 
The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.
 
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.


	- component:
		name: lodash
		version: 4.17.15
		license: |
Copyright OpenJS Foundation and other contributors <https://openjsf.org/>

Based on Underscore.js, copyright Jeremy Ashkenas,
DocumentCloud and Investigative Reporters & Editors <http://underscorejs.org/>

This software consists of voluntary contributions made by many
individuals. For exact contribution history, see the revision history
available at https://github.com/lodash/lodash

The following license applies to all parts of this software except as
documented below:

====

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

====

Copyright and related rights for sample code are waived via CC0. Sample
code is defined as all source code displayed within the prose of the
documentation.

CC0: http://creativecommons.org/publicdomain/zero/1.0/

====

Files located in the node_modules and vendor directories are externally
maintained libraries used by this software which have their own
licenses; we recommend you read them, as their terms may differ from the
terms above.


	- component:
		name: mapbox-gl
		version: 1.4.1
		license: |
Copyright (c) 2016, Mapbox

All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright notice,
      this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright notice,
      this list of conditions and the following disclaimer in the documentation
      and/or other materials provided with the distribution.
    * Neither the name of Mapbox GL JS nor the names of its contributors
      may be used to endorse or promote products derived from this software
      without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

-------------------------------------------------------------------------------

Contains Hershey Simplex Font: http://paulbourke.net/dataformats/hershey/

-------------------------------------------------------------------------------

Contains code from glfx.js

Copyright (C) 2011 by Evan Wallace

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

--------------------------------------------------------------------------------

Contains a portion of d3-color https://github.com/d3/d3-color

Copyright 2010-2016 Mike Bostock
All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice, this
  list of conditions and the following disclaimer.

* Redistributions in binary form must reproduce the above copyright notice,
  this list of conditions and the following disclaimer in the documentation
  and/or other materials provided with the distribution.

* Neither the name of the author nor the names of contributors may be used to
  endorse or promote products derived from this software without specific prior
  written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


	- component:
		name: @mapbox/geojson-rewind
		version: 0.4.0
		license: |
Copyright (c) {{ year }}, {{ organization }}

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.


	- component:
		name: @mapbox/geojson-area
		version: 0.2.2
		license: |
Copyright 2005-2013 OpenLayers Contributors. All rights reserved. See
authors.txt for full list.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

 1. Redistributions of source code must retain the above copyright notice, this
list of conditions and the following disclaimer.

 2. Redistributions in binary form must reproduce the above copyright notice,
this list of conditions and the following disclaimer in the documentation and/or
other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY OPENLAYERS CONTRIBUTORS ``AS IS'' AND ANY EXPRESS
OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
SHALL COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

The views and conclusions contained in the software and documentation are those
of the authors and should not be interpreted as representing official policies,
either expressed or implied, of OpenLayers Contributors.


	- component:
		name: wgs84
		version: 0.0.0
		license: |
BSD 2-Clause License

Copyright (c) 2017, Mapbox
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice, this
  list of conditions and the following disclaimer.

* Redistributions in binary form must reproduce the above copyright notice,
  this list of conditions and the following disclaimer in the documentation
    and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

	- component:
		name: minimist
		version: 1.2.0
		license: |
This software is released under the MIT license:

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


	- component:
		name: minimist
		version: 0.0.5
		license: |
This software is released under the MIT license:

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


	- component:
		name: minimist
		version: 0.0.8
		license: |
This software is released under the MIT license:

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


	- component:
		name: concat-stream
		version: 1.6.2
		license: |
The MIT License

Copyright (c) 2013 Max Ogden

Permission is hereby granted, free of charge, 
to any person obtaining a copy of this software and 
associated documentation files (the "Software"), to 
deal in the Software without restriction, including 
without limitation the rights to use, copy, modify, 
merge, publish, distribute, sublicense, and/or sell 
copies of the Software, and to permit persons to whom 
the Software is furnished to do so, 
subject to the following conditions:

The above copyright notice and this permission notice 
shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, 
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES 
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. 
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR 
ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, 
TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE 
SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

	- component:
		name: buffer-from
		version: 1.1.1
		license: |
MIT License

Copyright (c) 2016, 2018 Linus Unnebäck

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

	- component:
		name: inherits
		version: 2.0.4
		license: |
The ISC License

Copyright (c) Isaac Z. Schlueter

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.



	- component:
		name: readable-stream
		version: 2.3.6
		license: |
Node.js is licensed for use as follows:

"""
Copyright Node.js contributors. All rights reserved.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
IN THE SOFTWARE.
"""

This license applies to parts of Node.js originating from the
https://github.com/joyent/node repository:

"""
Copyright Joyent, Inc. and other Node contributors. All rights reserved.
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
IN THE SOFTWARE.
"""


	- component:
		name: core-util-is
		version: 1.0.2
		license: |
Copyright Node.js contributors. All rights reserved.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
IN THE SOFTWARE.


	- component:
		name: isarray
		version: 1.0.0
		license: |
(MIT)

Copyright (c) 2013 Julian Gruber <julian@juliangruber.com>

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

	- component:
		name: process-nextick-args
		version: 2.0.1
		license: |
# Copyright (c) 2015 Calvin Metcalf

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

**THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.**


	- component:
		name: safe-buffer
		version: 5.1.2
		license: |
The MIT License (MIT)

Copyright (c) Feross Aboukhadijeh

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.


	- component:
		name: string_decoder
		version: 1.1.1
		license: |
Node.js is licensed for use as follows:

"""
Copyright Node.js contributors. All rights reserved.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
IN THE SOFTWARE.
"""

This license applies to parts of Node.js originating from the
https://github.com/joyent/node repository:

"""
Copyright Joyent, Inc. and other Node contributors. All rights reserved.
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
IN THE SOFTWARE.
"""



	- component:
		name: util-deprecate
		version: 1.0.2
		license: |
(The MIT License)

Copyright (c) 2014 Nathan Rajlich <nathan@tootallnate.net>

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.


	- component:
		name: typedarray
		version: 0.0.6
		license: |
 Copyright (c) 2010, Linden Research, Inc.
 Copyright (c) 2012, Joshua Bell

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 $/LicenseInfo$

// Original can be found at:
//   https://bitbucket.org/lindenlab/llsd
// Modifications by Joshua Bell inexorabletash@gmail.com
//   https://github.com/inexorabletash/polyfill

// ES3/ES5 implementation of the Krhonos Typed Array Specification
//   Ref: http://www.khronos.org/registry/typedarray/specs/latest/
//   Date: 2011-02-01
//
// Variations:
//  * Allows typed_array.get/set() as alias for subscripts (typed_array[])

	- component:
		name: sharkdown
		version: 0.1.1
		license: |
Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
Subject to the terms and conditions of this license, each copyright holder and contributor hereby grants to those receiving rights under this license a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable (except for failure to satisfy the conditions of this license) patent license to make, have made, use, offer to sell, sell, import, and otherwise transfer this software, where such license applies only to those patent claims, already acquired or hereafter acquired, licensable by such copyright holder or contributor that are necessarily infringed by:

(a) their Contribution(s) (the licensed copyrights of copyright holders and non-copyrightable additions of contributors, in source or binary form) alone; or
(b) combination of their Contribution(s) with the work of authorship to which such Contribution(s) was added by such copyright holder or contributor, if, at the time the Contribution is added, such addition causes such combination to be necessarily infringed. The patent license shall not apply to any other combinations which include the Contribution.
Except as expressly stated above, no rights or licenses from any copyright holder or contributor is granted under this license, whether expressly, by implication, estoppel or otherwise.

DISCLAIMER

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDERS OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

	- component:
		name: cardinal
		version: 0.4.4
		license: |
Copyright 2012 Thorsten Lorenz. 
All rights reserved.

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.


	- component:
		name: ansicolors
		version: 0.2.1
		license: |
Copyright 2013 Thorsten Lorenz. 
All rights reserved.

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.


	- component:
		name: redeyed
		version: 0.4.4
		license: |
Copyright 2012 Thorsten Lorenz. 
All rights reserved.

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.


	- component:
		name: esprima
		version: 1.0.4
		license: |
Copyright JS Foundation and other contributors, https://js.foundation/

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

  * Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the
    documentation and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY
DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

	- component:
		name: split
		version: 0.2.10
		license: |
Copyright (c) 2011 Dominic Tarr

Permission is hereby granted, free of charge, 
to any person obtaining a copy of this software and 
associated documentation files (the "Software"), to 
deal in the Software without restriction, including 
without limitation the rights to use, copy, modify, 
merge, publish, distribute, sublicense, and/or sell 
copies of the Software, and to permit persons to whom 
the Software is furnished to do so, 
subject to the following conditions:

The above copyright notice and this permission notice 
shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, 
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES 
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. 
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR 
ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, 
TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE 
SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

	- component:
		name: through
		version: 2.3.8
		license: |
Apache License, Version 2.0

Copyright (c) 2011 Dominic Tarr

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.


The MIT License

Copyright (c) 2011 Dominic Tarr

Permission is hereby granted, free of charge, 
to any person obtaining a copy of this software and 
associated documentation files (the "Software"), to 
deal in the Software without restriction, including 
without limitation the rights to use, copy, modify, 
merge, publish, distribute, sublicense, and/or sell 
copies of the Software, and to permit persons to whom 
the Software is furnished to do so, 
subject to the following conditions:

The above copyright notice and this permission notice 
shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, 
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES 
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. 
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR 
ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, 
TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE 
SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


	- component:
		name: @mapbox/geojson-types
		version: 1.0.2
		license: |
MIT License

Copyright (c) 2018 Mapbox

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.


	- component:
		name: @mapbox/jsonlint-lines-primitives
		version: 2.0.2
		license: |
No license information found

	- component:
		name: @mapbox/mapbox-gl-supported
		version: 1.4.1
		license: |

BSD 3-Clause License

Copyright (c) 2017, Mapbox
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice, this
  list of conditions and the following disclaimer.

* Redistributions in binary form must reproduce the above copyright notice,
  this list of conditions and the following disclaimer in the documentation
  and/or other materials provided with the distribution.

* Neither the name of the copyright holder nor the names of its
  contributors may be used to endorse or promote products derived from
  this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


	- component:
		name: @mapbox/point-geometry
		version: 0.1.0
		license: |
Copyright (c) 2015, Mapbox <>

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.


	- component:
		name: @mapbox/tiny-sdf
		version: 1.1.1
		license: |
Copyright © 2016-2017 Mapbox, Inc.
This code available under the terms of the BSD 2-Clause license.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
© 2018 GitHub, Inc.

	- component:
		name: @mapbox/unitbezier
		version: 0.0.0
		license: |
BSD-2-Clause

Copyright (C) 2008 Apple Inc. All Rights Reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:

1. Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in the
   documentation and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS'' AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

Ported from Webkit
http://svn.webkit.org/repository/webkit/trunk/Source/WebCore/platform/graphics/UnitBezier.h

	- component:
		name: @mapbox/vector-tile
		version: 1.3.1
		license: |
Copyright (c) 2014, Mapbox


All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright notice,
      this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright notice,
      this list of conditions and the following disclaimer in the documentation
      and/or other materials provided with the distribution.
    * Neither the name of Mapbox nor the names of its contributors
      may be used to endorse or promote products derived from this software
      without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


	- component:
		name: @mapbox/whoots-js
		version: 3.1.0
		license: |
ISC License

Copyright (c) 2017, Mapbox

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.


	- component:
		name: csscolorparser
		version: 1.0.3
		license: |
(c) Dean McNamee <dean@gmail.com>, 2012.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
IN THE SOFTWARE.

	- component:
		name: earcut
		version: 2.2.1
		license: |
ISC License

Copyright (c) 2016, Mapbox

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.


	- component:
		name: geojson-vt
		version: 3.2.1
		license: |
ISC License

Copyright (c) 2015, Mapbox

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.


	- component:
		name: gl-matrix
		version: 3.1.0
		license: |
Copyright (c) 2015-2019, Brandon Jones, Colin MacKenzie IV.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

	- component:
		name: grid-index
		version: 1.1.0
		license: |
Copyright (c) 2016, Mapbox

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.


	- component:
		name: murmurhash-js
		version: 1.0.0
		license: |
The MIT License (MIT)

Copyright (c) 2011 Gary Court

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

	- component:
		name: pbf
		version: 3.2.1
		license: |
Copyright (c) 2017, Mapbox
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice, this
  list of conditions and the following disclaimer.

* Redistributions in binary form must reproduce the above copyright notice,
  this list of conditions and the following disclaimer in the documentation
  and/or other materials provided with the distribution.

* Neither the name of pbf nor the names of its
  contributors may be used to endorse or promote products derived from
  this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


	- component:
		name: ieee754
		version: 1.1.13
		license: |
Copyright 2008 Fair Oaks Labs, Inc.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.

2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


	- component:
		name: resolve-protobuf-schema
		version: 2.1.0
		license: |
The MIT License (MIT)

Copyright (c) 2014 Mathias Buus

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.


	- component:
		name: protocol-buffers-schema
		version: 3.3.2
		license: |
The MIT License (MIT)

Copyright (c) 2014 Mathias Buus

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

	- component:
		name: potpack
		version: 1.0.1
		license: |
ISC License

Copyright (c) 2018, Mapbox

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.


	- component:
		name: quickselect
		version: 2.0.0
		license: |
ISC License

Copyright (c) 2018, Vladimir Agafonkin

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.


	- component:
		name: rw
		version: 1.3.3
		license: |
Copyright (c) 2014-2016, Michael Bostock
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice, this
  list of conditions and the following disclaimer.

* Redistributions in binary form must reproduce the above copyright notice,
  this list of conditions and the following disclaimer in the documentation
  and/or other materials provided with the distribution.

* The name Michael Bostock may not be used to endorse or promote products
  derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL MICHAEL BOSTOCK BE LIABLE FOR ANY DIRECT,
INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


	- component:
		name: supercluster
		version: 6.0.2
		license: |
ISC License

Copyright (c) 2016, Mapbox

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.


	- component:
		name: kdbush
		version: 3.0.0
		license: |
ISC License

Copyright (c) 2018, Vladimir Agafonkin

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.

	- component:
		name: tinyqueue
		version: 2.0.3
		license: |
ISC License

Copyright (c) 2017, Vladimir Agafonkin

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.


	- component:
		name: vt-pbf
		version: 3.1.1
		license: |
The MIT License (MIT)

Copyright (c) 2015 Anand Thakker

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

--------------------------------------------------------------------------------

Contains geojson_wrapper.js from https://github.com/mapbox/mapbox-gl-js

Copyright (c) 2014, Mapbox

All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright notice,
      this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright notice,
      this list of conditions and the following disclaimer in the documentation
      and/or other materials provided with the distribution.
    * Neither the name of Mapbox GL JS nor the names of its contributors
      may be used to endorse or promote products derived from this software
      without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.



	- component:
		name: typescript
		version: 3.7.2
		license: |
Apache License

Version 2.0, January 2004

http://www.apache.org/licenses/ 

TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

1. Definitions.

"License" shall mean the terms and conditions for use, reproduction, and distribution as defined by Sections 1 through 9 of this document.

"Licensor" shall mean the copyright owner or entity authorized by the copyright owner that is granting the License.

"Legal Entity" shall mean the union of the acting entity and all other entities that control, are controlled by, or are under common control with that entity. For the purposes of this definition, "control" means (i) the power, direct or indirect, to cause the direction or management of such entity, whether by contract or otherwise, or (ii) ownership of fifty percent (50%) or more of the outstanding shares, or (iii) beneficial ownership of such entity.

"You" (or "Your") shall mean an individual or Legal Entity exercising permissions granted by this License.

"Source" form shall mean the preferred form for making modifications, including but not limited to software source code, documentation source, and configuration files.

"Object" form shall mean any form resulting from mechanical transformation or translation of a Source form, including but not limited to compiled object code, generated documentation, and conversions to other media types.

"Work" shall mean the work of authorship, whether in Source or Object form, made available under the License, as indicated by a copyright notice that is included in or attached to the work (an example is provided in the Appendix below).

"Derivative Works" shall mean any work, whether in Source or Object form, that is based on (or derived from) the Work and for which the editorial revisions, annotations, elaborations, or other modifications represent, as a whole, an original work of authorship. For the purposes of this License, Derivative Works shall not include works that remain separable from, or merely link (or bind by name) to the interfaces of, the Work and Derivative Works thereof.

"Contribution" shall mean any work of authorship, including the original version of the Work and any modifications or additions to that Work or Derivative Works thereof, that is intentionally submitted to Licensor for inclusion in the Work by the copyright owner or by an individual or Legal Entity authorized to submit on behalf of the copyright owner. For the purposes of this definition, "submitted" means any form of electronic, verbal, or written communication sent to the Licensor or its representatives, including but not limited to communication on electronic mailing lists, source code control systems, and issue tracking systems that are managed by, or on behalf of, the Licensor for the purpose of discussing and improving the Work, but excluding communication that is conspicuously marked or otherwise designated in writing by the copyright owner as "Not a Contribution."

"Contributor" shall mean Licensor and any individual or Legal Entity on behalf of whom a Contribution has been received by Licensor and subsequently incorporated within the Work.

2. Grant of Copyright License. Subject to the terms and conditions of this License, each Contributor hereby grants to You a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare Derivative Works of, publicly display, publicly perform, sublicense, and distribute the Work and such Derivative Works in Source or Object form.

3. Grant of Patent License. Subject to the terms and conditions of this License, each Contributor hereby grants to You a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable (except as stated in this section) patent license to make, have made, use, offer to sell, sell, import, and otherwise transfer the Work, where such license applies only to those patent claims licensable by such Contributor that are necessarily infringed by their Contribution(s) alone or by combination of their Contribution(s) with the Work to which such Contribution(s) was submitted. If You institute patent litigation against any entity (including a cross-claim or counterclaim in a lawsuit) alleging that the Work or a Contribution incorporated within the Work constitutes direct or contributory patent infringement, then any patent licenses granted to You under this License for that Work shall terminate as of the date such litigation is filed.

4. Redistribution. You may reproduce and distribute copies of the Work or Derivative Works thereof in any medium, with or without modifications, and in Source or Object form, provided that You meet the following conditions:

You must give any other recipients of the Work or Derivative Works a copy of this License; and

You must cause any modified files to carry prominent notices stating that You changed the files; and

You must retain, in the Source form of any Derivative Works that You distribute, all copyright, patent, trademark, and attribution notices from the Source form of the Work, excluding those notices that do not pertain to any part of the Derivative Works; and

If the Work includes a "NOTICE" text file as part of its distribution, then any Derivative Works that You distribute must include a readable copy of the attribution notices contained within such NOTICE file, excluding those notices that do not pertain to any part of the Derivative Works, in at least one of the following places: within a NOTICE text file distributed as part of the Derivative Works; within the Source form or documentation, if provided along with the Derivative Works; or, within a display generated by the Derivative Works, if and wherever such third-party notices normally appear. The contents of the NOTICE file are for informational purposes only and do not modify the License. You may add Your own attribution notices within Derivative Works that You distribute, alongside or as an addendum to the NOTICE text from the Work, provided that such additional attribution notices cannot be construed as modifying the License. You may add Your own copyright statement to Your modifications and may provide additional or different license terms and conditions for use, reproduction, or distribution of Your modifications, or for any such Derivative Works as a whole, provided Your use, reproduction, and distribution of the Work otherwise complies with the conditions stated in this License.

5. Submission of Contributions. Unless You explicitly state otherwise, any Contribution intentionally submitted for inclusion in the Work by You to the Licensor shall be under the terms and conditions of this License, without any additional terms or conditions. Notwithstanding the above, nothing herein shall supersede or modify the terms of any separate license agreement you may have executed with Licensor regarding such Contributions.

6. Trademarks. This License does not grant permission to use the trade names, trademarks, service marks, or product names of the Licensor, except as required for reasonable and customary use in describing the origin of the Work and reproducing the content of the NOTICE file.

7. Disclaimer of Warranty. Unless required by applicable law or agreed to in writing, Licensor provides the Work (and each Contributor provides its Contributions) on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. You are solely responsible for determining the appropriateness of using or redistributing the Work and assume any risks associated with Your exercise of permissions under this License.

8. Limitation of Liability. In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall any Contributor be liable to You for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising as a result of this License or out of the use or inability to use the Work (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if such Contributor has been advised of the possibility of such damages.

9. Accepting Warranty or Additional Liability. While redistributing the Work or Derivative Works thereof, You may choose to offer, and charge a fee for, acceptance of support, warranty, indemnity, or other liability obligations and/or rights consistent with this License. However, in accepting such obligations, You may act only on Your own behalf and on Your sole responsibility, not on behalf of any other Contributor, and only if You agree to indemnify, defend, and hold each Contributor harmless for any liability incurred by, or claims asserted against, such Contributor by reason of your accepting any such warranty or additional liability.

END OF TERMS AND CONDITIONS


	- component:
		name: uuid-random
		version: 1.0.9
		license: |
Copyright (c) 2016-2019 Wes Roberts

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).atlas=t.atlas||{})}(this,function(p){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t,e){return t(e={exports:{}},e.exports),e.exports}var h=e(function(t,e){function r(t,e){if(n)if(o){var r="var sharedChunk = {}; ("+n+")(sharedChunk); ("+o+")(sharedChunk);",i={};n(i),(a=e(i)).workerUrl=window.URL.createObjectURL(new Blob([r],{type:"text/javascript"}))}else o=e;else n=e}var n,o,a;t.exports=(r(["exports"],function(t){function e(t,e){return t(e={exports:{}},e.exports),e.exports}var a=r;function r(t,e,r,i){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=r,this.p2y=i}r.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},r.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},r.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},r.prototype.solveCurveX=function(t,e){var r,i,n,o,a;for(void 0===e&&(e=1e-6),n=t,a=0;a<8;a++){if(o=this.sampleCurveX(n)-t,Math.abs(o)<e)return n;var s=this.sampleCurveDerivativeX(n);if(Math.abs(s)<1e-6)break;n-=o/s}if((n=t)<(r=0))return r;if(n>(i=1))return i;for(;r<i;){if(o=this.sampleCurveX(n),Math.abs(o-t)<e)return n;o<t?r=n:i=n,n=.5*(i-r)+r}return n},r.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var lt=i;function i(t,e){this.x=t,this.y=e}function h(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(!h(t[r],e[r]))return!1;return!0}if("object"!=typeof t||null===t||null===e)return t===e;if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var i in t)if(!h(t[i],e[i]))return!1;return!0}function n(t,e,r,i){var n=new a(t,e,r,i);return function(t){return n.solve(t)}}i.prototype={clone:function(){return new i(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),i=e*this.x-r*this.y,n=r*this.x+e*this.y;return this.x=i,this.y=n,this},_rotateAround:function(t,e){var r=Math.cos(t),i=Math.sin(t),n=e.x+r*(this.x-e.x)-i*(this.y-e.y),o=e.y+i*(this.x-e.x)+r*(this.y-e.y);return this.x=n,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(t){return t instanceof i?t:Array.isArray(t)?new i(t[0],t[1]):t};var o=n(.25,.1,.25,1);function l(t,e,r){return Math.min(r,Math.max(e,t))}function s(t,e,r){var i=r-e,n=((t-e)%i+i)%i+e;return n===e?r:n}function f(t){for(var e=[],r=arguments.length-1;0<r--;)e[r]=arguments[r+1];for(var i=0,n=e;i<n.length;i+=1){var o=n[i];for(var a in o)t[a]=o[a]}return t}var u=1;function c(){return u++}function p(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function d(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function m(t,e){t.forEach(function(t){e[t]&&(e[t]=e[t].bind(e))})}function g(t,e){return-1!==t.indexOf(e,t.length-e.length)}function y(t,e,r){var i={};for(var n in t)i[n]=e.call(r||this,t[n],n,t);return i}function v(t,e,r){var i={};for(var n in t)e.call(r||this,t[n],n,t)&&(i[n]=t[n]);return i}function _(t){return Array.isArray(t)?t.map(_):"object"==typeof t&&t?y(t,_):t}var x={};function ut(t){x[t]||("undefined"!=typeof console&&console.warn(t),x[t]=!0)}function b(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}function w(t){for(var e=0,r=0,i=t.length,n=i-1,o=void 0,a=void 0;r<i;n=r++)o=t[r],e+=((a=t[n]).x-o.x)*(o.y+a.y);return e}function S(t){var o={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(t,e,r,i){var n=r||i;return o[e]=!n||n.toLowerCase(),""}),o["max-age"]){var e=parseInt(o["max-age"],10);isNaN(e)?delete o["max-age"]:o["max-age"]=e}return o}function T(t){try{var e=self[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}}var E,I,C,k,A=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),P=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,M=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,L={now:A,frame:function(t){var e=P(t);return{cancel:function(){return M(e)}}},getImageData:function(t,e){void 0===e&&(e=0);var r=self.document.createElement("canvas"),i=r.getContext("2d");if(!i)throw new Error("failed to create canvas 2d context");return r.width=t.width,r.height=t.height,i.drawImage(t,0,0,t.width,t.height),i.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:function(t){return(E=E||self.document.createElement("a")).href=t,E.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(null==I&&(I=self.matchMedia("(prefers-reduced-motion: reduce)")),I.matches)}},O={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},D={supported:!1,testSupport:function(t){!R&&k&&(z?N(t):C=t)}},R=!1,z=!1;function N(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,k),t.isContextLost())return;D.supported=!0}catch(t){}t.deleteTexture(e),R=!0}function B(t,e){this._transformRequestFn=t,this._customAccessToken=e,this._createSkuToken()}self.document&&((k=self.document.createElement("img")).onload=function(){C&&N(C),z=!(C=null)},k.onerror=function(){R=!0,C=null},k.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var F="01";function U(t){return 0===t.indexOf("mapbox:")}B.prototype._createSkuToken=function(){var t=function(){for(var t="",e=0;e<10;e++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",F,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},B.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},B.prototype.transformRequest=function(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}},B.prototype.normalizeStyleURL=function(t,e){if(!U(t))return t;var r=G(t);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||e)},B.prototype.normalizeGlyphsURL=function(t,e){if(!U(t))return t;var r=G(t);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||e)},B.prototype.normalizeSourceURL=function(t,e){if(!U(t))return t;var r=G(t);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||e)},B.prototype.normalizeSpriteURL=function(t,e,r,i){var n=G(t);return U(t)?(n.path="/styles/v1"+n.path+"/sprite"+e+r,this._makeAPIURL(n,this._customAccessToken||i)):(n.path+=""+e+r,Z(n))},B.prototype.normalizeTileURL=function(t,e,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),!e||!U(e))return t;var i=G(t),n=2<=L.devicePixelRatio||512===r?"@2x":"",o=D.supported?".webp":"$1";return i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,n+o),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path,O.REQUIRE_ACCESS_TOKEN&&(O.ACCESS_TOKEN||this._customAccessToken)&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,this._customAccessToken)},B.prototype.canonicalizeTileURL=function(t){var e=G(t);if(!e.path.match(/(^\/v4\/)/)||!e.path.match(/\.[\w]+$/))return t;var r="mapbox://tiles/";r+=e.path.replace("/v4/","");var i=e.params.filter(function(t){return!t.match(/^access_token=/)});return i.length&&(r+="?"+i.join("&")),r},B.prototype.canonicalizeTileset=function(t,e){if(!U(e))return t.tiles||[];for(var r=[],i=0,n=t.tiles;i<n.length;i+=1){var o=n[i],a=this.canonicalizeTileURL(o);r.push(a)}return r},B.prototype._makeAPIURL=function(t,e){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",i=G(O.API_URL);if(t.protocol=i.protocol,t.authority=i.authority,"/"!==i.path&&(t.path=""+i.path+t.path),!O.REQUIRE_ACCESS_TOKEN)return Z(t);if(!(e=e||O.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return t.params=t.params.filter(function(t){return-1===t.indexOf("access_token")}),t.params.push("access_token="+e),Z(t)};var j=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function q(t){return j.test(t)}var V=/^(\w+):\/\/([^\/?]*)(\/[^?]+)?\??(.+)?/;function G(t){var e=t.match(V);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Z(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}function H(t){if(!t)return null;var e,r=t.split(".");if(!r||3!==r.length)return null;try{return JSON.parse((e=r[1],decodeURIComponent(self.atob(e).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""))))}catch(t){return null}}function W(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}W.prototype.getStorageKey=function(t){var e,r=H(O.ACCESS_TOKEN),i="";return i=r&&r.u?(e=r.u,self.btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(t,e){return String.fromCharCode(Number("0x"+e))}))):O.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+i:"mapbox.eventData:"+i},W.prototype.fetchEventData=function(){var t=T("localStorage"),e=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{var i=self.localStorage.getItem(e);i&&(this.eventData=JSON.parse(i));var n=self.localStorage.getItem(r);n&&(this.anonId=n)}catch(t){ut("Unable to read from LocalStorage")}},W.prototype.saveEventData=function(){var t=T("localStorage"),e=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{self.localStorage.setItem(r,this.anonId),1<=Object.keys(this.eventData).length&&self.localStorage.setItem(e,JSON.stringify(this.eventData))}catch(t){ut("Unable to write to LocalStorage")}},W.prototype.processRequests=function(t){},W.prototype.postEvent=function(t,e,r,i){var n=this;if(O.EVENTS_URL){var o=G(O.EVENTS_URL);o.params.push("access_token="+(i||O.ACCESS_TOKEN||""));var a={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.4.1",skuId:F,userId:this.anonId},s=e?f(a,e):a,l={url:Z(o),headers:{"Content-Type":"text/plain"},body:JSON.stringify([s])};this.pendingRequest=St(l,function(t){n.pendingRequest=null,r(t),n.saveEventData(),n.processRequests(i)})}},W.prototype.queueRequest=function(t,e){this.queue.push(t),this.processRequests(e)};var K,X,Y,J=(st.__proto__=Y=W,((st.prototype=Object.create(Y&&Y.prototype)).constructor=st).prototype.postMapLoadEvent=function(t,e,r,i){this.skuToken=r,(O.EVENTS_URL&&i||O.ACCESS_TOKEN&&Array.isArray(t)&&t.some(function(t){return U(t)||q(t)}))&&this.queueRequest({id:e,timestamp:Date.now()},i)},st.prototype.processRequests=function(t){var e=this;if(!this.pendingRequest&&0!==this.queue.length){var r=this.queue.shift(),i=r.id,n=r.timestamp;i&&this.success[i]||(this.anonId||this.fetchEventData(),d(this.anonId)||(this.anonId=p()),this.postEvent(n,{skuToken:this.skuToken},function(t){t||i&&(e.success[i]=!0)},t))}},st),Q=(at.__proto__=X=W,((at.prototype=Object.create(X&&X.prototype)).constructor=at).prototype.postTurnstileEvent=function(t,e){O.EVENTS_URL&&O.ACCESS_TOKEN&&Array.isArray(t)&&t.some(function(t){return U(t)||q(t)})&&this.queueRequest(Date.now(),e)},at.prototype.processRequests=function(t){var e=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var r=H(O.ACCESS_TOKEN),i=r?r.u:O.ACCESS_TOKEN,n=i!==this.eventData.tokenU;d(this.anonId)||(this.anonId=p(),n=!0);var o=this.queue.shift();if(this.eventData.lastSuccess){var a=new Date(this.eventData.lastSuccess),s=new Date(o),l=(o-this.eventData.lastSuccess)/864e5;n=n||1<=l||l<-1||a.getDate()!==s.getDate()}else n=!0;if(!n)return this.processRequests();this.postEvent(o,{"enabled.telemetry":!1},function(t){t||(e.eventData.lastSuccess=o,e.eventData.tokenU=i)},t)}},new at),$=Q.postTurnstileEvent.bind(Q),tt=new J,et=tt.postMapLoadEvent.bind(tt),rt="mapbox-tiles",it=500,nt=50,ot=42e4;function at(t){X.call(this,"appUserTurnstile"),this._customAccessToken=t}function st(){Y.call(this,"map.load"),this.success={},this.skuToken=""}function ct(t){var e=t.indexOf("?");return e<0?t:t.slice(0,e)}var pt=1/0,ht={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(ht);var dt,ft=((dt=Error)&&(mt.__proto__=dt),((mt.prototype=Object.create(dt&&dt.prototype)).constructor=mt).prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},mt);function mt(t,e,r){401===e&&q(r)&&(t+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),dt.call(this,t),this.status=e,this.url=r,this.name=this.constructor.name,this.message=t}function gt(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}var yt=gt()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===self.location.protocol?self.parent:self).location.href};function vt(n,o){var t,e=new self.AbortController,a=new self.Request(n.url,{method:n.method||"GET",body:n.body,credentials:n.credentials,headers:n.headers,referrer:yt(),signal:e.signal}),s=!1,l=!1,u=0<(t=a.url).indexOf("sku=")&&q(t);function r(t,e,r){if(!l){if(t&&"SecurityError"!==t.message&&ut(t),e&&r)return c(e);var i=Date.now();self.fetch(a).then(function(t){if(t.ok){var e=u?t.clone():null;return c(t,e,i)}return o(new ft(t.statusText,t.status,n.url))}).catch(function(t){20!==t.code&&o(new Error(t.message))})}}"json"===n.type&&a.headers.set("Accept","application/json");var c=function(e,r,i){("arrayBuffer"===n.type?e.arrayBuffer():"json"===n.type?e.json():e.text()).then(function(t){l||(r&&i&&function(r,t,e){if(self.caches){var i={status:t.status,statusText:t.statusText,headers:new self.Headers};t.headers.forEach(function(t,e){return i.headers.set(e,t)});var n=S(t.headers.get("Cache-Control")||"");n["no-store"]||(n["max-age"]&&i.headers.set("Expires",new Date(e+1e3*n["max-age"]).toUTCString()),new Date(i.headers.get("Expires")).getTime()-e<ot||function(t,e){if(void 0===K)try{new Response(new ReadableStream),K=!0}catch(t){K=!1}K?e(t.body):t.blob().then(e)}(t,function(t){var e=new self.Response(t,i);self.caches.open(rt).then(function(t){return t.put(ct(r.url),e)}).catch(function(t){return ut(t.message)})}))}}(a,r,i),s=!0,o(null,t,e.headers.get("Cache-Control"),e.headers.get("Expires")))}).catch(function(t){return o(new Error(t.message))})};return u?function(t,i){if(!self.caches)return i(null);var n=ct(t.url);self.caches.open(rt).then(function(r){r.match(n).catch(i).then(function(t){var e=function(t){if(!t)return!1;var e=new Date(t.headers.get("Expires")),r=S(t.headers.get("Cache-Control")||"");return e>Date.now()&&!r["no-cache"]}(t);r.delete(n),e&&r.put(n,t.clone()),i(null,t,e)})}).catch(i)}(a,r):r(null,null),{cancel:function(){l=!0,s||e.abort()}}}function _t(t,e){if(r=t.url,!(/^file:/.test(r)||/^file:/.test(yt())&&!/^\w+:/.test(r))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return vt(t,e);if(gt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e)}var r;return function(e,r){var i=new self.XMLHttpRequest;for(var t in i.open(e.method||"GET",e.url,!0),"arrayBuffer"===e.type&&(i.responseType="arraybuffer"),e.headers)i.setRequestHeader(t,e.headers[t]);return"json"===e.type&&(i.responseType="text",i.setRequestHeader("Accept","application/json")),i.withCredentials="include"===e.credentials,i.onerror=function(){r(new Error(i.statusText))},i.onload=function(){if((200<=i.status&&i.status<300||0===i.status)&&null!==i.response){var t=i.response;if("json"===e.type)try{t=JSON.parse(i.response)}catch(t){return r(t)}r(null,t,i.getResponseHeader("Cache-Control"),i.getResponseHeader("Expires"))}else r(new ft(i.statusText,i.status,e.url))},i.send(e.body),{cancel:function(){return i.abort()}}}(t,e)}function xt(t,e){return _t(f(t,{type:"arrayBuffer"}),e)}var bt,wt,St=function(t,e){return _t(f(t,{method:"POST"}),e)};bt=[],wt=0;var Tt=function(t,s){if(wt>=O.MAX_PARALLEL_IMAGE_REQUESTS){var e={requestParameters:t,callback:s,cancelled:!1,cancel:function(){this.cancelled=!0}};return bt.push(e),e}function l(){if(!i)for(i=!0,wt--;bt.length&&wt<O.MAX_PARALLEL_IMAGE_REQUESTS;){var t=bt.shift(),e=t.requestParameters,r=t.callback;t.cancelled||(t.cancel=Tt(e,r).cancel)}}wt++;var i=!1,r=xt(t,function(t,e,r,i){if(l(),t)s(t);else if(e){var n=new self.Image,o=self.URL||self.webkitURL;n.onload=function(){s(null,n),o.revokeObjectURL(n.src)},n.onerror=function(){return s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var a=new self.Blob([new Uint8Array(e)],{type:"image/png"});n.cacheControl=r,n.expires=i,n.src=e.byteLength?o.createObjectURL(a):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}});return{cancel:function(){r.cancel(),l()}}};function Et(t,e,r){r[t]&&-1!==r[t].indexOf(e)||(r[t]=r[t]||[],r[t].push(e))}function It(t,e,r){if(r&&r[t]){var i=r[t].indexOf(e);-1!==i&&r[t].splice(i,1)}}function Ct(t,e){void 0===e&&(e={}),f(this,e),this.type=t}function kt(){}var At,Pt=(Mt.__proto__=At=Ct,(Mt.prototype=Object.create(At&&At.prototype)).constructor=Mt);function Mt(t,e){void 0===e&&(e={}),At.call(this,"error",f({error:t},e))}kt.prototype.on=function(t,e){return this._listeners=this._listeners||{},Et(t,e,this._listeners),this},kt.prototype.off=function(t,e){return It(t,e,this._listeners),It(t,e,this._oneTimeListeners),this},kt.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},Et(t,e,this._oneTimeListeners),this},kt.prototype.fire=function(t,e){"string"==typeof t&&(t=new Ct(t,e||{}));var r=t.type;if(this.listens(r)){for(var i=0,n=(t.target=this)._listeners&&this._listeners[r]?this._listeners[r].slice():[];i<n.length;i+=1)n[i].call(this,t);for(var o=0,a=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];o<a.length;o+=1){var s=a[o];It(r,s,this._oneTimeListeners),s.call(this,t)}var l=this._eventedParent;l&&(f(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),l.fire(t))}else t instanceof Pt&&console.error(t.error);return this},kt.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&0<this._listeners[t].length||this._oneTimeListeners&&this._oneTimeListeners[t]&&0<this._oneTimeListeners[t].length||this._eventedParent&&this._eventedParent.listens(t)};var Lt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:(kt.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this},!1)},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"image",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"image",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"image",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"image",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"image",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}}},Ot=function(t,e,r,i){this.message=(t?t+": ":"")+r,i&&(this.identifier=i),null!=e&&e.__line__&&(this.line=e.__line__)};function Dt(t){var e=t.key,r=t.value;return r?[new Ot(e,r,"constants have been deprecated as of v8")]:[]}function Rt(t){for(var e=[],r=arguments.length-1;0<r--;)e[r]=arguments[r+1];for(var i=0,n=e;i<n.length;i+=1){var o=n[i];for(var a in o)t[a]=o[a]}return t}function zt(t){return t instanceof Number||t instanceof String||t instanceof Boolean}function Nt(t){return zt(t)?t.valueOf():t}function Bt(t){if(Array.isArray(t))return t.map(Bt);if(t instanceof Object&&!zt(t)){var e={};for(var r in t)e[r]=Bt(t[r]);return e}return Nt(t)}function Ft(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var r=0,i=e;r<i.length;r+=1){var n=i[r],o=n[0],a=n[1];this.bindings[o]=a}}var Ut,jt=((Ut=Error)&&(qt.__proto__=Ut),(qt.prototype=Object.create(Ut&&Ut.prototype)).constructor=qt);function qt(t,e){Ut.call(this,e),this.message=e,this.key=t}Ft.prototype.concat=function(t){return new Ft(this,t)},Ft.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},Ft.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Vt={kind:"null"},Gt={kind:"number"},Zt={kind:"string"},Ht={kind:"boolean"},Wt={kind:"color"},Kt={kind:"object"},Xt={kind:"value"},Yt={kind:"collator"},Jt={kind:"formatted"},Qt={kind:"image"};function $t(t,e){return{kind:"array",itemType:t,N:e}}function te(t){if("array"!==t.kind)return t.kind;var e=te(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}var ee=[Vt,Gt,Zt,Ht,Wt,Jt,Kt,$t(Xt),Qt];function re(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!re(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var r=0,i=ee;r<i.length;r+=1)if(!re(i[r],e))return null}return"Expected "+te(t)+" but found "+te(e)+" instead."}var ie=e(function(t,e){var d={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function f(t){return(t=Math.round(t))<0?0:255<t?255:t}function r(t){return t<0?0:1<t?1:t}function m(t){return"%"===t[t.length-1]?f(parseFloat(t)/100*255):f(parseInt(t))}function g(t){return"%"===t[t.length-1]?r(parseFloat(t)/100):r(parseFloat(t))}function y(t,e,r){return r<0?r+=1:1<r&&(r-=1),6*r<1?t+(e-t)*r*6:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}try{e.parseCSSColor=function(t){var e,r=t.replace(/ /g,"").toLowerCase();if(r in d)return d[r].slice();if("#"===r[0])return 4===r.length?0<=(e=parseInt(r.substr(1),16))&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===r.length&&0<=(e=parseInt(r.substr(1),16))&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var i=r.indexOf("("),n=r.indexOf(")");if(-1!==i&&n+1===r.length){var o=r.substr(0,i),a=r.substr(i+1,n-(i+1)).split(","),s=1;switch(o){case"rgba":if(4!==a.length)return null;s=g(a.pop());case"rgb":return 3!==a.length?null:[m(a[0]),m(a[1]),m(a[2]),s];case"hsla":if(4!==a.length)return null;s=g(a.pop());case"hsl":if(3!==a.length)return null;var l=(parseFloat(a[0])%360+360)%360/360,u=g(a[1]),c=g(a[2]),p=c<=.5?c*(u+1):c+u-c*u,h=2*c-p;return[f(255*y(h,p,l+1/3)),f(255*y(h,p,l)),f(255*y(h,p,l-1/3)),s];default:return null}}return null}}catch(t){}}).parseCSSColor,ne=function(t,e,r,i){void 0===i&&(i=1),this.r=t,this.g=e,this.b=r,this.a=i};ne.parse=function(t){if(t){if(t instanceof ne)return t;if("string"==typeof t){var e=ie(t);if(e)return new ne(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},ne.prototype.toString=function(){var t=this.toArray(),e=t[0],r=t[1],i=t[2],n=t[3];return"rgba("+Math.round(e)+","+Math.round(r)+","+Math.round(i)+","+n+")"},ne.prototype.toArray=function(){var t=this.r,e=this.g,r=this.b,i=this.a;return 0===i?[0,0,0,0]:[255*t/i,255*e/i,255*r/i,i]},ne.black=new ne(0,0,0,1),ne.white=new ne(1,1,1,1),ne.transparent=new ne(0,0,0,0),ne.red=new ne(1,0,0,1);var oe=function(t,e,r){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};function ae(t,e,r,i){this.text=t,this.scale=e,this.fontStack=r,this.textColor=i}oe.prototype.compare=function(t,e){return this.collator.compare(t,e)},oe.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var se=function(t){this.sections=t};se.fromString=function(t){return new se([new ae(t,null,null,null)])},se.prototype.toString=function(){return this.sections.map(function(t){return t.text}).join("")},se.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var i=r[e];t.push(i.text);var n={};i.fontStack&&(n["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(n["font-scale"]=i.scale),i.textColor&&(n["text-color"]=["rgba"].concat(i.textColor.toArray())),t.push(n)}return t};var le=function(t){this.name=t.name,this.available=t.available};function ue(t,e,r,i){return"number"==typeof t&&0<=t&&t<=255&&"number"==typeof e&&0<=e&&e<=255&&"number"==typeof r&&0<=r&&r<=255?void 0===i||"number"==typeof i&&0<=i&&i<=1?null:"Invalid rgba value ["+[t,e,r,i].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof i?[t,e,r,i]:[t,e,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ce(t){if(null===t)return Vt;if("string"==typeof t)return Zt;if("boolean"==typeof t)return Ht;if("number"==typeof t)return Gt;if(t instanceof ne)return Wt;if(t instanceof oe)return Yt;if(t instanceof se)return Jt;if(t instanceof le)return Qt;if(Array.isArray(t)){for(var e,r=t.length,i=0,n=t;i<n.length;i+=1){var o=ce(n[i]);if(e){if(e===o)continue;e=Xt;break}e=o}return $t(e||Xt,r)}return Kt}function pe(t){var e=typeof t;return null===t?"":"string"==e||"number"==e||"boolean"==e?String(t):t instanceof ne||t instanceof se||t instanceof le?t.toString():JSON.stringify(t)}function he(t,e){this.type=t,this.value=e}le.prototype.toString=function(){return this.name},le.fromString=function(t){return new le(t)},le.prototype.serialize=function(){return["image",this.name]},he.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!function t(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof ne)return!0;if(e instanceof oe)return!0;if(e instanceof se)return!0;if(e instanceof le)return!0;if(Array.isArray(e)){for(var r=0,i=e;r<i.length;r+=1)if(!t(i[r]))return!1;return!0}if("object"!=typeof e)return!1;for(var n in e)if(!t(e[n]))return!1;return!0}(t[1]))return e.error("invalid value");var r=t[1],i=ce(r),n=e.expectedType;return"array"!==i.kind||0!==i.N||!n||"array"!==n.kind||"number"==typeof n.N&&0!==n.N||(i=n),new he(i,r)},he.prototype.evaluate=function(){return this.value},he.prototype.eachChild=function(){},he.prototype.possibleOutputs=function(){return[this.value]},he.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof ne?["rgba"].concat(this.value.toArray()):this.value instanceof se?this.value.serialize():this.value};var de=function(t){this.name="ExpressionEvaluationError",this.message=t};function fe(t,e){this.type=t,this.args=e}de.prototype.toJSON=function(){return this.message};var me={string:Zt,number:Gt,boolean:Ht,object:Kt};function ge(t){this.type=Jt,this.sections=t}function ye(t){this.type=Qt,this.input=t}function ve(t,e){this.type=t,this.args=e}fe.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r,i=1,n=t[0];if("array"===n){var o,a;if(2<t.length){var s=t[1];if("string"!=typeof s||!(s in me)||"object"===s)return e.error('The item type argument of "array" must be one of string, number, boolean',1);o=me[s],i++}else o=Xt;if(3<t.length){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);a=t[2],i++}r=$t(o,a)}else r=me[n];for(var l=[];i<t.length;i++){var u=e.parse(t[i],i,Xt);if(!u)return null;l.push(u)}return new fe(r,l)},fe.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var r=this.args[e].evaluate(t);if(!re(this.type,ce(r)))return r;if(e===this.args.length-1)throw new de("Expected value to be of type "+te(this.type)+", but found "+te(ce(r))+" instead.")}return null},fe.prototype.eachChild=function(t){this.args.forEach(t)},fe.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}))},fe.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var r=t.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){e.push(r.kind);var i=t.N;("number"==typeof i||1<this.args.length)&&e.push(i)}}return e.concat(this.args.map(function(t){return t.serialize()}))},ge.parse=function(t,e){if(t.length<3)return e.error("Expected at least two arguments.");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");for(var r=[],i=1;i<t.length-1;i+=2){var n=e.parse(t[i],1,Xt);if(!n)return null;var o=n.type.kind;if("string"!==o&&"value"!==o&&"null"!==o)return e.error("Formatted text type must be 'string', 'value', or 'null'.");var a=t[i+1];if("object"!=typeof a||Array.isArray(a))return e.error("Format options argument must be an object.");var s=null;if(a["font-scale"]&&!(s=e.parse(a["font-scale"],1,Gt)))return null;var l=null;if(a["text-font"]&&!(l=e.parse(a["text-font"],1,$t(Zt))))return null;var u=null;if(a["text-color"]&&!(u=e.parse(a["text-color"],1,Wt)))return null;r.push({text:n,scale:s,font:l,textColor:u})}return new ge(r)},ge.prototype.evaluate=function(e){return new se(this.sections.map(function(t){return new ae(pe(t.text.evaluate(e)),t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},ge.prototype.eachChild=function(t){for(var e=0,r=this.sections;e<r.length;e+=1){var i=r[e];t(i.text),i.scale&&t(i.scale),i.font&&t(i.font),i.textColor&&t(i.textColor)}},ge.prototype.possibleOutputs=function(){return[void 0]},ge.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var i=r[e];t.push(i.text.serialize());var n={};i.scale&&(n["font-scale"]=i.scale.serialize()),i.font&&(n["text-font"]=i.font.serialize()),i.textColor&&(n["text-color"]=i.textColor.serialize()),t.push(n)}return t},ye.parse=function(t,e){if(2!==t.length)return e.error("Expected two arguments.");var r=e.parse(t[1],1,Zt);return r?new ye(r):e.error("No image name provided.")},ye.prototype.evaluate=function(t){var e=this.input.evaluate(t),r=!1;return t.availableImages&&-1<t.availableImages.indexOf(e)&&(r=!0),{name:e,available:r}},ye.prototype.eachChild=function(t){t(this.input)},ye.prototype.possibleOutputs=function(){return[void 0]},ye.prototype.serialize=function(){return["image",this.input.serialize()]};var _e={"to-boolean":Ht,"to-color":Wt,"to-number":Gt,"to-string":Zt};function xe(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null}ve.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r=t[0];if(("to-boolean"===r||"to-string"===r)&&2!==t.length)return e.error("Expected one argument.");for(var i=_e[r],n=[],o=1;o<t.length;o++){var a=e.parse(t[o],o,Xt);if(!a)return null;n.push(a)}return new ve(i,n)},ve.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,r,i=0,n=this.args;i<n.length;i+=1){if(r=null,(e=n[i].evaluate(t))instanceof ne)return e;if("string"==typeof e){var o=t.parseColor(e);if(o)return o}else if(Array.isArray(e)&&!(r=e.length<3||4<e.length?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":ue(e[0],e[1],e[2],e[3])))return new ne(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new de(r||"Could not parse color from value '"+("string"==typeof e?e:String(JSON.stringify(e)))+"'")}if("number"===this.type.kind){for(var a=null,s=0,l=this.args;s<l.length;s+=1){if(null===(a=l[s].evaluate(t)))return 0;var u=Number(a);if(!isNaN(u))return u}throw new de("Could not convert "+JSON.stringify(a)+" to number.")}if("formatted"===this.type.kind)return se.fromString(pe(this.args[0].evaluate(t)));if("image"!==this.type.kind)return pe(this.args[0].evaluate(t));var c=this.args[0].evaluate(t);return"string"==typeof c?le.fromString({name:c,available:!1}):c},ve.prototype.eachChild=function(t){this.args.forEach(t)},ve.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}))},ve.prototype.serialize=function(){if("formatted"===this.type.kind)return new ge([{text:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("image"===this.type.kind)return new ye(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var be=["Unknown","Point","LineString","Polygon"];xe.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},xe.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?be[this.feature.type]:this.feature.type:null},xe.prototype.properties=function(){return this.feature&&this.feature.properties||{}},xe.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e=e||(this._parseColorCache[t]=ne.parse(t))};var we=function(t,e,r,i){this.name=t,this.type=e,this._evaluate=r,this.args=i};function Se(t,e,r){this.type=Yt,this.locale=r,this.caseSensitive=t,this.diacriticSensitive=e}function Te(t){if(t instanceof we){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}var e=!0;return t.eachChild(function(t){e&&!Te(t)&&(e=!1)}),e}function Ee(t){if(t instanceof we&&"feature-state"===t.name)return!1;var e=!0;return t.eachChild(function(t){e&&!Ee(t)&&(e=!1)}),e}function Ie(t,e){if(t instanceof we&&0<=e.indexOf(t.name))return!1;var r=!0;return t.eachChild(function(t){r&&!Ie(t,e)&&(r=!1)}),r}function Ce(t,e){this.type=e.type,this.name=t,this.boundExpression=e}we.prototype.evaluate=function(t){return this._evaluate(t,this.args)},we.prototype.eachChild=function(t){this.args.forEach(t)},we.prototype.possibleOutputs=function(){return[void 0]},we.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},we.parse=function(r,t){var e,i=r[0],n=we.definitions[i];if(!n)return t.error('Unknown expression "'+i+'". If you wanted a literal array, use ["literal", [...]].',0);for(var o=Array.isArray(n)?n[0]:n.type,a=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,s=a.filter(function(t){var e=t[0];return!Array.isArray(e)||e.length===r.length-1}),l=null,u=0,c=s;u<c.length;u+=1){var p=c[u],h=p[0],d=p[1];l=new ke(t.registry,t.path,null,t.scope);for(var f=[],m=!1,g=1;g<r.length;g++){var y=r[g],v=Array.isArray(h)?h[g-1]:h.type,_=l.parse(y,1+f.length,v);if(!_){m=!0;break}f.push(_)}if(!m)if(Array.isArray(h)&&h.length!==f.length)l.error("Expected "+h.length+" arguments, but found "+f.length+" instead.");else{for(var x=0;x<f.length;x++){var b=Array.isArray(h)?h[x]:h.type,w=f[x];l.concat(x+1).checkSubtype(b,w.type)}if(0===l.errors.length)return new we(i,o,d,f)}}if(1===s.length)(e=t.errors).push.apply(e,l.errors);else{for(var S=(s.length?s:a).map(function(t){var e;return e=t[0],Array.isArray(e)?"("+e.map(te).join(", ")+")":"("+te(e.type)+"...)"}).join(" | "),T=[],E=1;E<r.length;E++){var I=t.parse(r[E],1+T.length);if(!I)return null;T.push(te(I.type))}t.error("Expected arguments of type "+S+", but found ("+T.join(", ")+") instead.")}return null},we.register=function(t,e){for(var r in we.definitions=e)t[r]=we},Se.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var r=t[1];if("object"!=typeof r||Array.isArray(r))return e.error("Collator options argument must be an object.");var i=e.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,Ht);if(!i)return null;var n=e.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,Ht);if(!n)return null;var o=null;return r.locale&&!(o=e.parse(r.locale,1,Zt))?null:new Se(i,n,o)},Se.prototype.evaluate=function(t){return new oe(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},Se.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},Se.prototype.possibleOutputs=function(){return[void 0]},Se.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]},Ce.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var r=t[1];return e.scope.has(r)?new Ce(r,e.scope.get(r)):e.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Ce.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Ce.prototype.eachChild=function(){},Ce.prototype.possibleOutputs=function(){return[void 0]},Ce.prototype.serialize=function(){return["var",this.name]};var ke=function(t,e,r,i,n){void 0===e&&(e=[]),void 0===i&&(i=new Ft),void 0===n&&(n=[]),this.registry=t,this.path=e,this.key=e.map(function(t){return"["+t+"]"}).join(""),this.scope=i,this.errors=n,this.expectedType=r};function Ae(t,e){for(var r,i,n=t.length-1,o=0,a=n,s=0;o<=a;)if(r=t[s=Math.floor((o+a)/2)],i=t[s+1],r<=e){if(s===n||e<i)return s;o=s+1}else{if(!(e<r))throw new de("Input is not a number.");a=s-1}return 0}ke.prototype.parse=function(t,e,r,i,n){return void 0===n&&(n={}),e?this.concat(e,r,i)._parse(t,n):this._parse(t,n)},ke.prototype._parse=function(t,e){function r(t,e,r){return"assert"===r?new fe(e,[t]):"coerce"===r?new ve(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var i=t[0];if("string"!=typeof i)return this.error("Expression name must be a string, but found "+typeof i+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var n=this.registry[i];if(n){var o=n.parse(t,this);if(!o)return null;if(this.expectedType){var a=this.expectedType,s=o.type;if("string"!==a.kind&&"number"!==a.kind&&"boolean"!==a.kind&&"object"!==a.kind&&"array"!==a.kind||"value"!==s.kind)if("color"!==a.kind&&"formatted"!==a.kind&&"image"!==a.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(a,s))return null}else o=r(o,a,e.typeAnnotation||"coerce");else o=r(o,a,e.typeAnnotation||"assert")}if(!(o instanceof he)&&"image"!==o.type.kind&&function e(t){if(t instanceof Ce)return e(t.boundExpression);if(t instanceof we&&"error"===t.name)return!1;if(t instanceof Se)return!1;var r=t instanceof ve||t instanceof fe,i=!0;return t.eachChild(function(t){i=r?i&&e(t):i&&t instanceof he}),!!i&&Te(t)&&Ie(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(o)){var l=new xe;try{o=new he(o.type,o.evaluate(l))}catch(t){return this.error(t.message),null}}return o}return this.error('Unknown expression "'+i+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===t?this.error("'undefined' value invalid. Use null instead."):"object"==typeof t?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof t+" instead.")},ke.prototype.concat=function(t,e,r){var i="number"==typeof t?this.path.concat(t):this.path,n=r?this.scope.concat(r):this.scope;return new ke(this.registry,i,e||null,n,this.errors)},ke.prototype.error=function(t){for(var e=[],r=arguments.length-1;0<r--;)e[r]=arguments[r+1];var i=""+this.key+e.map(function(t){return"["+t+"]"}).join("");this.errors.push(new jt(i,t))},ke.prototype.checkSubtype=function(t,e){var r=re(t,e);return r&&this.error(r),r};var Pe=function(t,e,r){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var i=0,n=r;i<n.length;i+=1){var o=n[i],a=o[0],s=o[1];this.labels.push(a),this.outputs.push(s)}};function Me(t,e,r){return t*(1-r)+e*r}Pe.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var r=e.parse(t[1],1,Gt);if(!r)return null;var i=[],n=null;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var o=1;o<t.length;o+=2){var a=1===o?-1/0:t[o],s=t[o+1],l=o,u=o+1;if("number"!=typeof a)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',l);if(i.length&&i[i.length-1][0]>=a)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',l);var c=e.parse(s,u,n);if(!c)return null;n=n||c.type,i.push([a,c])}return new Pe(n,r,i)},Pe.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);var i=this.input.evaluate(t);if(i<=e[0])return r[0].evaluate(t);var n=e.length;return i>=e[n-1]?r[n-1].evaluate(t):r[Ae(e,i)].evaluate(t)},Pe.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1)t(r[e])},Pe.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()}))},Pe.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)0<e&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var Le=Object.freeze({number:Me,color:function(t,e,r){return new ne(Me(t.r,e.r,r),Me(t.g,e.g,r),Me(t.b,e.b,r),Me(t.a,e.a,r))},array:function(t,r,i){return t.map(function(t,e){return Me(t,r[e],i)})}}),Oe=4/29,De=6/29,Re=3*De*De,ze=De*De*De,Ne=Math.PI/180,Be=180/Math.PI;function Fe(t){return ze<t?Math.pow(t,1/3):t/Re+Oe}function Ue(t){return De<t?t*t*t:Re*(t-Oe)}function je(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function qe(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Ve(t){var e=qe(t.r),r=qe(t.g),i=qe(t.b),n=Fe((.4124564*e+.3575761*r+.1804375*i)/.95047),o=Fe((.2126729*e+.7151522*r+.072175*i)/1);return{l:116*o-16,a:500*(n-o),b:200*(o-Fe((.0193339*e+.119192*r+.9503041*i)/1.08883)),alpha:t.a}}function Ge(t){var e=(t.l+16)/116,r=isNaN(t.a)?e:e+t.a/500,i=isNaN(t.b)?e:e-t.b/200;return e=1*Ue(e),r=.95047*Ue(r),i=1.08883*Ue(i),new ne(je(3.2404542*r-1.5371385*e-.4985314*i),je(-.969266*r+1.8760108*e+.041556*i),je(.0556434*r-.2040259*e+1.0572252*i),t.alpha)}var Ze={forward:Ve,reverse:Ge,interpolate:function(t,e,r){return{l:Me(t.l,e.l,r),a:Me(t.a,e.a,r),b:Me(t.b,e.b,r),alpha:Me(t.alpha,e.alpha,r)}}},He={forward:function(t){var e=Ve(t),r=e.l,i=e.a,n=e.b,o=Math.atan2(n,i)*Be;return{h:o<0?360+o:o,c:Math.sqrt(i*i+n*n),l:r,alpha:t.a}},reverse:function(t){var e=t.h*Ne,r=t.c;return Ge({l:t.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:t.alpha})},interpolate:function(t,e,r){return{h:function(t,e,r){var i=e-t;return t+r*(180<i||i<-180?i-360*Math.round(i/360):i)}(t.h,e.h,r),c:Me(t.c,e.c,r),l:Me(t.l,e.l,r),alpha:Me(t.alpha,e.alpha,r)}}},We=Object.freeze({lab:Ze,hcl:He}),Ke=function(t,e,r,i,n){this.type=t,this.operator=e,this.interpolation=r,this.input=i,this.labels=[],this.outputs=[];for(var o=0,a=n;o<a.length;o+=1){var s=a[o],l=s[0],u=s[1];this.labels.push(l),this.outputs.push(u)}};function Xe(t,e,r,i){var n=i-r,o=t-r;return 0==n?0:1===e?o/n:(Math.pow(e,o)-1)/(Math.pow(e,n)-1)}Ke.interpolationFactor=function(t,e,r,i){var n=0;if("exponential"===t.name)n=Xe(e,t.base,r,i);else if("linear"===t.name)n=Xe(e,1,r,i);else if("cubic-bezier"===t.name){var o=t.controlPoints;n=new a(o[0],o[1],o[2],o[3]).solve(Xe(e,1,r,i))}return n},Ke.parse=function(t,e){var r=t[0],i=t[1],n=t[2],o=t.slice(3);if(!Array.isArray(i)||0===i.length)return e.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){var a=i[1];if("number"!=typeof a)return e.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:a}}else{if("cubic-bezier"!==i[0])return e.error("Unknown interpolation type "+String(i[0]),1,0);var s=i.slice(1);if(4!==s.length||s.some(function(t){return"number"!=typeof t||t<0||1<t}))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:s}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(n=e.parse(n,2,Gt)))return null;var l=[],u=null;"interpolate-hcl"===r||"interpolate-lab"===r?u=Wt:e.expectedType&&"value"!==e.expectedType.kind&&(u=e.expectedType);for(var c=0;c<o.length;c+=2){var p=o[c],h=o[c+1],d=c+3,f=c+4;if("number"!=typeof p)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',d);if(l.length&&l[l.length-1][0]>=p)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',d);var m=e.parse(h,f,u);if(!m)return null;u=u||m.type,l.push([p,m])}return"number"===u.kind||"color"===u.kind||"array"===u.kind&&"number"===u.itemType.kind&&"number"==typeof u.N?new Ke(u,r,i,n,l):e.error("Type "+te(u)+" is not interpolatable.")},Ke.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);var i=this.input.evaluate(t);if(i<=e[0])return r[0].evaluate(t);var n=e.length;if(i>=e[n-1])return r[n-1].evaluate(t);var o=Ae(e,i),a=e[o],s=e[o+1],l=Ke.interpolationFactor(this.interpolation,i,a,s),u=r[o].evaluate(t),c=r[o+1].evaluate(t);return"interpolate"===this.operator?Le[this.type.kind.toLowerCase()](u,c,l):"interpolate-hcl"===this.operator?He.reverse(He.interpolate(He.forward(u),He.forward(c),l)):Ze.reverse(Ze.interpolate(Ze.forward(u),Ze.forward(c),l))},Ke.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1)t(r[e])},Ke.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()}))},Ke.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],r=0;r<this.labels.length;r++)e.push(this.labels[r],this.outputs[r].serialize());return e};var Ye=function(t,e){this.type=t,this.args=e};Ye.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var r=null,i=e.expectedType;i&&"value"!==i.kind&&(r=i);for(var n=[],o=0,a=t.slice(1);o<a.length;o+=1){var s=a[o],l=e.parse(s,1+n.length,r,void 0,{typeAnnotation:"omit"});if(!l)return null;r=r||l.type,n.push(l)}var u=i&&n.some(function(t){return re(i,t.type)});return new Ye(u?Xt:r,n)},Ye.prototype.evaluate=function(t){for(var e,r=null,i=0,n=0,o=this.args;n<o.length;n+=1){var a=o[n];if(i++,r=a.evaluate(t),"image"!==a.type.kind||r.available||(e=e||a.evaluate(t).name,r=null,i===this.args.length&&(r=e)),null!==r)break}return r},Ye.prototype.eachChild=function(t){this.args.forEach(t)},Ye.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}))},Ye.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Je=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};function Qe(t,e,r){this.type=t,this.index=e,this.input=r}function $e(t,e,r,i,n,o){this.inputType=t,this.type=e,this.input=r,this.cases=i,this.outputs=n,this.otherwise=o}function tr(t,e,r){this.type=t,this.branches=e,this.otherwise=r}function er(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function rr(t,e,r,i){return 0===i.compare(e,r)}function ir(s,l,u){var c="=="!==s&&"!="!==s;return a.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var r=t[0],i=e.parse(t[1],1,Xt);if(!i)return null;if(!er(r,i.type))return e.concat(1).error('"'+r+"\" comparisons are not supported for type '"+te(i.type)+"'.");var n=e.parse(t[2],2,Xt);if(!n)return null;if(!er(r,n.type))return e.concat(2).error('"'+r+"\" comparisons are not supported for type '"+te(n.type)+"'.");if(i.type.kind!==n.type.kind&&"value"!==i.type.kind&&"value"!==n.type.kind)return e.error("Cannot compare types '"+te(i.type)+"' and '"+te(n.type)+"'.");c&&("value"===i.type.kind&&"value"!==n.type.kind?i=new fe(n.type,[i]):"value"!==i.type.kind&&"value"===n.type.kind&&(n=new fe(i.type,[n])));var o=null;if(4===t.length){if("string"!==i.type.kind&&"string"!==n.type.kind&&"value"!==i.type.kind&&"value"!==n.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(o=e.parse(t[3],3,Yt)))return null}return new a(i,n,o)},a.prototype.evaluate=function(t){var e=this.lhs.evaluate(t),r=this.rhs.evaluate(t);if(c&&this.hasUntypedArgument){var i=ce(e),n=ce(r);if(i.kind!==n.kind||"string"!==i.kind&&"number"!==i.kind)throw new de('Expected arguments for "'+s+'" to be (string, string) or (number, number), but found ('+i.kind+", "+n.kind+") instead.")}if(this.collator&&!c&&this.hasUntypedArgument){var o=ce(e),a=ce(r);if("string"!==o.kind||"string"!==a.kind)return l(t,e,r)}return this.collator?u(t,e,r,this.collator.evaluate(t)):l(t,e,r)},a.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},a.prototype.possibleOutputs=function(){return[!0,!1]},a.prototype.serialize=function(){var e=[s];return this.eachChild(function(t){e.push(t.serialize())}),e},a;function a(t,e,r){this.type=Ht,this.lhs=t,this.rhs=e,this.collator=r,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}}function nr(t,e,r,i,n){this.type=Zt,this.number=t,this.locale=e,this.currency=r,this.minFractionDigits=i,this.maxFractionDigits=n}Je.prototype.evaluate=function(t){return this.result.evaluate(t)},Je.prototype.eachChild=function(t){for(var e=0,r=this.bindings;e<r.length;e+=1)t(r[e][1]);t(this.result)},Je.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var r=[],i=1;i<t.length-1;i+=2){var n=t[i];if("string"!=typeof n)return e.error("Expected string, but found "+typeof n+" instead.",i);if(/[^a-zA-Z0-9_]/.test(n))return e.error("Variable names must contain only alphanumeric characters or '_'.",i);var o=e.parse(t[i+1],i+1);if(!o)return null;r.push([n,o])}var a=e.parse(t[t.length-1],t.length-1,e.expectedType,r);return a?new Je(r,a):null},Je.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},Je.prototype.serialize=function(){for(var t=["let"],e=0,r=this.bindings;e<r.length;e+=1){var i=r[e],n=i[0],o=i[1];t.push(n,o.serialize())}return t.push(this.result.serialize()),t},Qe.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,Gt),i=e.parse(t[2],2,$t(e.expectedType||Xt));if(!r||!i)return null;var n=i.type;return new Qe(n.itemType,r,i)},Qe.prototype.evaluate=function(t){var e=this.index.evaluate(t),r=this.input.evaluate(t);if(e<0)throw new de("Array index out of bounds: "+e+" < 0.");if(e>=r.length)throw new de("Array index out of bounds: "+e+" > "+(r.length-1)+".");if(e!==Math.floor(e))throw new de("Array index must be an integer, but found "+e+" instead.");return r[e]},Qe.prototype.eachChild=function(t){t(this.index),t(this.input)},Qe.prototype.possibleOutputs=function(){return[void 0]},Qe.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]},$e.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var r,i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(var n={},o=[],a=2;a<t.length-1;a+=2){var s=t[a],l=t[a+1];Array.isArray(s)||(s=[s]);var u=e.concat(a);if(0===s.length)return u.error("Expected at least one branch label.");for(var c=0,p=s;c<p.length;c+=1){var h=p[c];if("number"!=typeof h&&"string"!=typeof h)return u.error("Branch labels must be numbers or strings.");if("number"==typeof h&&Math.abs(h)>Number.MAX_SAFE_INTEGER)return u.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof h&&Math.floor(h)!==h)return u.error("Numeric branch labels must be integer values.");if(r){if(u.checkSubtype(r,ce(h)))return null}else r=ce(h);if(void 0!==n[String(h)])return u.error("Branch labels must be unique.");n[String(h)]=o.length}var d=e.parse(l,a,i);if(!d)return null;i=i||d.type,o.push(d)}var f=e.parse(t[1],1,Xt);if(!f)return null;var m=e.parse(t[t.length-1],t.length-1,i);return m?"value"!==f.type.kind&&e.concat(1).checkSubtype(r,f.type)?null:new $e(r,i,f,n,o,m):null},$e.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(ce(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},$e.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},$e.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()})).concat(this.otherwise.possibleOutputs())},$e.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],i={},n=0,o=Object.keys(this.cases).sort();n<o.length;n+=1){var a=o[n];void 0===(p=i[this.cases[a]])?(i[this.cases[a]]=r.length,r.push([this.cases[a],[a]])):r[p][1].push(a)}for(var s=function(t){return"number"===e.inputType.kind?Number(t):t},l=0,u=r;l<u.length;l+=1){var c=u[l],p=c[0],h=c[1];1===h.length?t.push(s(h[0])):t.push(h.map(s)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t},tr.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(var i=[],n=1;n<t.length-1;n+=2){var o=e.parse(t[n],n,Ht);if(!o)return null;var a=e.parse(t[n+1],n+1,r);if(!a)return null;i.push([o,a]),r=r||a.type}var s=e.parse(t[t.length-1],t.length-1,r);return s?new tr(r,i,s):null},tr.prototype.evaluate=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var i=r[e],n=i[0],o=i[1];if(n.evaluate(t))return o.evaluate(t)}return this.otherwise.evaluate(t)},tr.prototype.eachChild=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var i=r[e],n=i[0],o=i[1];t(n),t(o)}t(this.otherwise)},tr.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.branches.map(function(t){return t[0],t[1].possibleOutputs()})).concat(this.otherwise.possibleOutputs())},tr.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var or=ir("==",function(t,e,r){return e===r},rr),ar=ir("!=",function(t,e,r){return e!==r},function(t,e,r,i){return!rr(0,e,r,i)}),sr=ir("<",function(t,e,r){return e<r},function(t,e,r,i){return i.compare(e,r)<0}),lr=ir(">",function(t,e,r){return r<e},function(t,e,r,i){return 0<i.compare(e,r)}),ur=ir("<=",function(t,e,r){return e<=r},function(t,e,r,i){return i.compare(e,r)<=0}),cr=ir(">=",function(t,e,r){return r<=e},function(t,e,r,i){return 0<=i.compare(e,r)});function pr(t){this.type=Gt,this.input=t}nr.parse=function(t,e){if(3!==t.length)return e.error("Expected two arguments.");var r=e.parse(t[1],1,Gt);if(!r)return null;var i=t[2];if("object"!=typeof i||Array.isArray(i))return e.error("NumberFormat options argument must be an object.");var n=null;if(i.locale&&!(n=e.parse(i.locale,1,Zt)))return null;var o=null;if(i.currency&&!(o=e.parse(i.currency,1,Zt)))return null;var a=null;if(i["min-fraction-digits"]&&!(a=e.parse(i["min-fraction-digits"],1,Gt)))return null;var s=null;return i["max-fraction-digits"]&&!(s=e.parse(i["max-fraction-digits"],1,Gt))?null:new nr(r,n,o,a,s)},nr.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},nr.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},nr.prototype.possibleOutputs=function(){return[void 0]},nr.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]},pr.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?e.error("Expected argument of type string or array, but found "+te(r.type)+" instead."):new pr(r):null},pr.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new de("Expected value to be of type string or array, but found "+te(ce(e))+" instead.")},pr.prototype.eachChild=function(t){t(this.input)},pr.prototype.possibleOutputs=function(){return[void 0]},pr.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var hr={"==":or,"!=":ar,">":lr,"<":sr,">=":cr,"<=":ur,array:fe,at:Qe,boolean:fe,case:tr,coalesce:Ye,collator:Se,format:ge,image:ye,interpolate:Ke,"interpolate-hcl":Ke,"interpolate-lab":Ke,length:pr,let:Je,literal:he,match:$e,number:fe,"number-format":nr,object:fe,step:Pe,string:fe,"to-boolean":ve,"to-color":ve,"to-number":ve,"to-string":ve,var:Ce};function dr(t,e){var r=e[0],i=e[1],n=e[2],o=e[3];r=r.evaluate(t),i=i.evaluate(t),n=n.evaluate(t);var a=o?o.evaluate(t):1,s=ue(r,i,n,a);if(s)throw new de(s);return new ne(r/255*a,i/255*a,n/255*a,a)}function fr(t,e){return t in e}function mr(t,e){var r=e[t];return void 0===r?null:r}function gr(t){return{type:t}}function yr(t){return{result:"success",value:t}}function vr(t){return{result:"error",value:t}}function _r(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function xr(t){return!!t.expression&&-1<t.expression.parameters.indexOf("zoom")}function br(t){return!!t.expression&&t.expression.interpolated}function wr(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Sr(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Tr(t){return t}function Er(t,e,r){return void 0!==t?t:void 0!==e?e:void 0!==r?r:void 0}function Ir(t,e,r,i,n){return Er(typeof r===n?i[r]:void 0,t.default,e.default)}function Cr(t,e,r){if("number"!==wr(r))return Er(t.default,e.default);var i=t.stops.length;if(1===i)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[i-1][0])return t.stops[i-1][1];var n=Ae(t.stops.map(function(t){return t[0]}),r);return t.stops[n][1]}function kr(t,e,r){var i=void 0!==t.base?t.base:1;if("number"!==wr(r))return Er(t.default,e.default);var n=t.stops.length;if(1===n)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[n-1][0])return t.stops[n-1][1];var o,a,s,l,u,c=Ae(t.stops.map(function(t){return t[0]}),r),p=(o=r,a=i,s=t.stops[c][0],l=t.stops[c+1][0]-s,u=o-s,0==l?0:1===a?u/l:(Math.pow(a,u)-1)/(Math.pow(a,l)-1)),h=t.stops[c][1],d=t.stops[c+1][1],f=Le[e.type]||Tr;if(t.colorSpace&&"rgb"!==t.colorSpace){var m=We[t.colorSpace];f=function(t,e){return m.reverse(m.interpolate(m.forward(t),m.forward(e),p))}}return"function"==typeof h.evaluate?{evaluate:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=h.evaluate.apply(void 0,t),i=d.evaluate.apply(void 0,t);if(void 0!==r&&void 0!==i)return f(r,i,p)}}:f(h,d,p)}function Ar(t,e,r){return"color"===e.type?r=ne.parse(r):"formatted"===e.type?r=se.fromString(r.toString()):"image"===e.type?r=le.fromString({name:r.toString(),available:!1}):wr(r)===e.type||"enum"===e.type&&e.values[r]||(r=void 0),Er(r,t.default,e.default)}we.register(hr,{error:[{kind:"error"},[Zt],function(t,e){var r=e[0];throw new de(r.evaluate(t))}],typeof:[Zt,[Xt],function(t,e){return te(ce(e[0].evaluate(t)))}],"to-rgba":[$t(Gt,4),[Wt],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[Wt,[Gt,Gt,Gt],dr],rgba:[Wt,[Gt,Gt,Gt,Gt],dr],has:{type:Ht,overloads:[[[Zt],function(t,e){return fr(e[0].evaluate(t),t.properties())}],[[Zt,Kt],function(t,e){var r=e[0],i=e[1];return fr(r.evaluate(t),i.evaluate(t))}]]},get:{type:Xt,overloads:[[[Zt],function(t,e){return mr(e[0].evaluate(t),t.properties())}],[[Zt,Kt],function(t,e){var r=e[0],i=e[1];return mr(r.evaluate(t),i.evaluate(t))}]]},"feature-state":[Xt,[Zt],function(t,e){return mr(e[0].evaluate(t),t.featureState||{})}],properties:[Kt,[],function(t){return t.properties()}],"geometry-type":[Zt,[],function(t){return t.geometryType()}],id:[Xt,[],function(t){return t.id()}],zoom:[Gt,[],function(t){return t.globals.zoom}],"heatmap-density":[Gt,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[Gt,[],function(t){return t.globals.lineProgress||0}],accumulated:[Xt,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[Gt,gr(Gt),function(t,e){for(var r=0,i=0,n=e;i<n.length;i+=1)r+=n[i].evaluate(t);return r}],"*":[Gt,gr(Gt),function(t,e){for(var r=1,i=0,n=e;i<n.length;i+=1)r*=n[i].evaluate(t);return r}],"-":{type:Gt,overloads:[[[Gt,Gt],function(t,e){var r=e[0],i=e[1];return r.evaluate(t)-i.evaluate(t)}],[[Gt],function(t,e){return-e[0].evaluate(t)}]]},"/":[Gt,[Gt,Gt],function(t,e){var r=e[0],i=e[1];return r.evaluate(t)/i.evaluate(t)}],"%":[Gt,[Gt,Gt],function(t,e){var r=e[0],i=e[1];return r.evaluate(t)%i.evaluate(t)}],ln2:[Gt,[],function(){return Math.LN2}],pi:[Gt,[],function(){return Math.PI}],e:[Gt,[],function(){return Math.E}],"^":[Gt,[Gt,Gt],function(t,e){var r=e[0],i=e[1];return Math.pow(r.evaluate(t),i.evaluate(t))}],sqrt:[Gt,[Gt],function(t,e){var r=e[0];return Math.sqrt(r.evaluate(t))}],log10:[Gt,[Gt],function(t,e){var r=e[0];return Math.log(r.evaluate(t))/Math.LN10}],ln:[Gt,[Gt],function(t,e){var r=e[0];return Math.log(r.evaluate(t))}],log2:[Gt,[Gt],function(t,e){var r=e[0];return Math.log(r.evaluate(t))/Math.LN2}],sin:[Gt,[Gt],function(t,e){var r=e[0];return Math.sin(r.evaluate(t))}],cos:[Gt,[Gt],function(t,e){var r=e[0];return Math.cos(r.evaluate(t))}],tan:[Gt,[Gt],function(t,e){var r=e[0];return Math.tan(r.evaluate(t))}],asin:[Gt,[Gt],function(t,e){var r=e[0];return Math.asin(r.evaluate(t))}],acos:[Gt,[Gt],function(t,e){var r=e[0];return Math.acos(r.evaluate(t))}],atan:[Gt,[Gt],function(t,e){var r=e[0];return Math.atan(r.evaluate(t))}],min:[Gt,gr(Gt),function(e,t){return Math.min.apply(Math,t.map(function(t){return t.evaluate(e)}))}],max:[Gt,gr(Gt),function(e,t){return Math.max.apply(Math,t.map(function(t){return t.evaluate(e)}))}],abs:[Gt,[Gt],function(t,e){var r=e[0];return Math.abs(r.evaluate(t))}],round:[Gt,[Gt],function(t,e){var r=e[0].evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[Gt,[Gt],function(t,e){var r=e[0];return Math.floor(r.evaluate(t))}],ceil:[Gt,[Gt],function(t,e){var r=e[0];return Math.ceil(r.evaluate(t))}],"filter-==":[Ht,[Zt,Xt],function(t,e){var r=e[0],i=e[1];return t.properties()[r.value]===i.value}],"filter-id-==":[Ht,[Xt],function(t,e){var r=e[0];return t.id()===r.value}],"filter-type-==":[Ht,[Zt],function(t,e){var r=e[0];return t.geometryType()===r.value}],"filter-<":[Ht,[Zt,Xt],function(t,e){var r=e[0],i=e[1],n=t.properties()[r.value],o=i.value;return typeof n==typeof o&&n<o}],"filter-id-<":[Ht,[Xt],function(t,e){var r=e[0],i=t.id(),n=r.value;return typeof i==typeof n&&i<n}],"filter->":[Ht,[Zt,Xt],function(t,e){var r=e[0],i=e[1],n=t.properties()[r.value],o=i.value;return typeof n==typeof o&&o<n}],"filter-id->":[Ht,[Xt],function(t,e){var r=e[0],i=t.id(),n=r.value;return typeof i==typeof n&&n<i}],"filter-<=":[Ht,[Zt,Xt],function(t,e){var r=e[0],i=e[1],n=t.properties()[r.value],o=i.value;return typeof n==typeof o&&n<=o}],"filter-id-<=":[Ht,[Xt],function(t,e){var r=e[0],i=t.id(),n=r.value;return typeof i==typeof n&&i<=n}],"filter->=":[Ht,[Zt,Xt],function(t,e){var r=e[0],i=e[1],n=t.properties()[r.value],o=i.value;return typeof n==typeof o&&o<=n}],"filter-id->=":[Ht,[Xt],function(t,e){var r=e[0],i=t.id(),n=r.value;return typeof i==typeof n&&n<=i}],"filter-has":[Ht,[Xt],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[Ht,[],function(t){return null!==t.id()}],"filter-type-in":[Ht,[$t(Zt)],function(t,e){return 0<=e[0].value.indexOf(t.geometryType())}],"filter-id-in":[Ht,[$t(Xt)],function(t,e){return 0<=e[0].value.indexOf(t.id())}],"filter-in-small":[Ht,[Zt,$t(Xt)],function(t,e){var r=e[0];return 0<=e[1].value.indexOf(t.properties()[r.value])}],"filter-in-large":[Ht,[Zt,$t(Xt)],function(t,e){var r=e[0],i=e[1];return function(t,e,r,i){for(;r<=i;){var n=r+i>>1;if(e[n]===t)return!0;e[n]>t?i=n-1:r=1+n}return!1}(t.properties()[r.value],i.value,0,i.value.length-1)}],all:{type:Ht,overloads:[[[Ht,Ht],function(t,e){var r=e[0],i=e[1];return r.evaluate(t)&&i.evaluate(t)}],[gr(Ht),function(t,e){for(var r=0,i=e;r<i.length;r+=1)if(!i[r].evaluate(t))return!1;return!0}]]},any:{type:Ht,overloads:[[[Ht,Ht],function(t,e){var r=e[0],i=e[1];return r.evaluate(t)||i.evaluate(t)}],[gr(Ht),function(t,e){for(var r=0,i=e;r<i.length;r+=1)if(i[r].evaluate(t))return!0;return!1}]]},"!":[Ht,[Ht],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[Ht,[Zt],function(t,e){var r=e[0],i=t.globals&&t.globals.isSupportedScript;return!i||i(r.evaluate(t))}],upcase:[Zt,[Zt],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[Zt,[Zt],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[Zt,gr(Xt),function(e,t){return t.map(function(t){return pe(t.evaluate(e))}).join("")}],"resolved-locale":[Zt,[Yt],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var Pr=function(t,e){var r;this.expression=t,this._warningHistory={},this._evaluator=new xe,this._defaultValue=e?"color"===(r=e).type&&Sr(r.default)?new ne(0,0,0,0):"color"===r.type?ne.parse(r.default)||null:void 0===r.default?null:r.default:null,this._enumValues=e&&"enum"===e.type?e.values:null};function Mr(t){return Array.isArray(t)&&0<t.length&&"string"==typeof t[0]&&t[0]in hr}function Lr(t,e){var r,i,n=new ke(hr,[],e?(i={color:Wt,string:Zt,number:Gt,enum:Zt,boolean:Ht,formatted:Jt,image:Qt},"array"===(r=e).type?$t(i[r.value]||Xt,r.length):i[r.type]):void 0),o=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return o?yr(new Pr(o,e)):vr(n.errors)}Pr.prototype.evaluateWithoutErrorHandling=function(t,e,r,i,n){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=r,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=n,this.expression.evaluate(this._evaluator)},Pr.prototype.evaluate=function(t,e,r,i,n){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=r||null,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=n||null;try{var o=this.expression.evaluate(this._evaluator);if(null==o)return this._defaultValue;if(this._enumValues&&!(o in this._enumValues))throw new de("Expected value to be one of "+Object.keys(this._enumValues).map(function(t){return JSON.stringify(t)}).join(", ")+", but found "+JSON.stringify(o)+" instead.");return o}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var Or=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Ee(e.expression)};Or.prototype.evaluateWithoutErrorHandling=function(t,e,r,i,n){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,i,n)},Or.prototype.evaluate=function(t,e,r,i,n){return this._styleExpression.evaluate(t,e,r,i,n)};var Dr=function(t,e,r,i){this.kind=t,this.zoomStops=r,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Ee(e.expression),this.interpolationType=i};function Rr(t,e){if("error"===(t=Lr(t,e)).result)return t;var r=t.value.expression,i=Te(r);if(!i&&!_r(e))return vr([new jt("","data expressions not supported")]);var n=Ie(r,["zoom"]);if(!n&&!xr(e))return vr([new jt("","zoom expressions not supported")]);var o=function r(t){var i=null;if(t instanceof Je)i=r(t.result);else if(t instanceof Ye)for(var e=0,n=t.args;e<n.length;e+=1){var o=n[e];if(i=r(o))break}else(t instanceof Pe||t instanceof Ke)&&t.input instanceof we&&"zoom"===t.input.name&&(i=t);return i instanceof jt||t.eachChild(function(t){var e=r(t);e instanceof jt?i=e:!i&&e?i=new jt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&e&&i!==e&&(i=new jt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}(r);if(!o&&!n)return vr([new jt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(o instanceof jt)return vr([o]);if(o instanceof Ke&&!br(e))return vr([new jt("",'"interpolate" expressions cannot be used with this property')]);if(!o)return yr(new Or(i?"constant":"source",t.value));var a=o instanceof Ke?o.interpolation:void 0;return yr(new Dr(i?"camera":"composite",t.value,o.labels,a))}function zr(t,e){this._parameters=t,this._specification=e,Rt(this,function t(i,n){var o,a,s,e="color"===n.type,r=i.stops&&"object"==typeof i.stops[0][0],l=r||void 0!==i.property,u=r||!l,c=i.type||(br(n)?"exponential":"interval");if(e&&((i=Rt({},i)).stops&&(i.stops=i.stops.map(function(t){return[t[0],ne.parse(t[1])]})),i.default?i.default=ne.parse(i.default):i.default=ne.parse(n.default)),i.colorSpace&&"rgb"!==i.colorSpace&&!We[i.colorSpace])throw new Error("Unknown color space: "+i.colorSpace);if("exponential"===c)o=kr;else if("interval"===c)o=Cr;else if("categorical"===c){o=Ir,a=Object.create(null);for(var p=0,h=i.stops;p<h.length;p+=1){var d=h[p];a[d[0]]=d[1]}s=typeof i.stops[0][0]}else{if("identity"!==c)throw new Error('Unknown function type "'+c+'"');o=Ar}if(r){for(var f={},m=[],g=0;g<i.stops.length;g++){var y=i.stops[g],v=y[0].zoom;void 0===f[v]&&(f[v]={zoom:v,type:i.type,property:i.property,default:i.default,stops:[]},m.push(v)),f[v].stops.push([y[0].value,y[1]])}for(var _=[],x=0,b=m;x<b.length;x+=1){var w=b[x];_.push([f[w].zoom,t(f[w],n)])}var S={name:"linear"};return{kind:"composite",interpolationType:S,interpolationFactor:Ke.interpolationFactor.bind(void 0,S),zoomStops:_.map(function(t){return t[0]}),evaluate:function(t,e){var r=t.zoom;return kr({stops:_,base:i.base},n,r).evaluate(r,e)}}}if(u){var T="exponential"===c?{name:"exponential",base:void 0!==i.base?i.base:1}:null;return{kind:"camera",interpolationType:T,interpolationFactor:Ke.interpolationFactor.bind(void 0,T),zoomStops:i.stops.map(function(t){return t[0]}),evaluate:function(t){var e=t.zoom;return o(i,n,e,a,s)}}}return{kind:"source",evaluate:function(t,e){var r=e&&e.properties?e.properties[i.property]:void 0;return void 0===r?Er(i.default,n.default):o(i,n,r,a,s)}}}(this._parameters,this._specification))}function Nr(t){var e=t.key,r=t.value,i=t.valueSpec||{},n=t.objectElementValidators||{},o=t.style,a=t.styleSpec,s=[],l=wr(r);if("object"!==l)return[new Ot(e,r,"object expected, "+l+" found")];for(var u in r){var c=u.split(".")[0],p=i[c]||i["*"],h=void 0;if(n[c])h=n[c];else if(i[c])h=si;else if(n["*"])h=n["*"];else{if(!i["*"]){s.push(new Ot(e,r[u],'unknown property "'+u+'"'));continue}h=si}s=s.concat(h({key:(e?e+".":e)+u,value:r[u],valueSpec:p,style:o,styleSpec:a,object:r,objectKey:u},r))}for(var d in i)n[d]||i[d].required&&void 0===i[d].default&&void 0===r[d]&&s.push(new Ot(e,r,'missing required property "'+d+'"'));return s}function Br(t){var e=t.value,r=t.valueSpec,i=t.style,n=t.styleSpec,o=t.key,a=t.arrayElementValidator||si;if("array"!==wr(e))return[new Ot(o,e,"array expected, "+wr(e)+" found")];if(r.length&&e.length!==r.length)return[new Ot(o,e,"array length "+r.length+" expected, length "+e.length+" found")];if(r["min-length"]&&e.length<r["min-length"])return[new Ot(o,e,"array length at least "+r["min-length"]+" expected, length "+e.length+" found")];var s={type:r.value,values:r.values};n.$version<7&&(s.function=r.function),"object"===wr(r.value)&&(s=r.value);for(var l=[],u=0;u<e.length;u++)l=l.concat(a({array:e,arrayIndex:u,value:e[u],valueSpec:s,style:i,styleSpec:n,key:o+"["+u+"]"}));return l}function Fr(t){var e=t.key,r=t.value,i=t.valueSpec,n=wr(r);return"number"!==n?[new Ot(e,r,"number expected, "+n+" found")]:"minimum"in i&&r<i.minimum?[new Ot(e,r,r+" is less than the minimum value "+i.minimum)]:"maximum"in i&&r>i.maximum?[new Ot(e,r,r+" is greater than the maximum value "+i.maximum)]:[]}function Ur(t){var a,s,n,l=t.valueSpec,u=Nt(t.value.type),c={},e="categorical"!==u&&void 0===t.value.property,r=!e,o="array"===wr(t.value.stops)&&"array"===wr(t.value.stops[0])&&"object"===wr(t.value.stops[0][0]),i=Nr({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===u)return[new Ot(t.key,t.value,'identity function may not have a "stops" property')];var e=[],r=t.value;return e=e.concat(Br({key:t.key,value:r,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:p})),"array"===wr(r)&&0===r.length&&e.push(new Ot(t.key,r,"array must have at least one stop")),e},default:function(t){return si({key:t.key,value:t.value,valueSpec:l,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===u&&e&&i.push(new Ot(t.key,t.value,'missing required property "property"')),"identity"===u||t.value.stops||i.push(new Ot(t.key,t.value,'missing required property "stops"')),"exponential"===u&&t.valueSpec.expression&&!br(t.valueSpec)&&i.push(new Ot(t.key,t.value,"exponential functions not supported")),8<=t.styleSpec.$version&&(r&&!_r(t.valueSpec)?i.push(new Ot(t.key,t.value,"property functions not supported")):e&&!xr(t.valueSpec)&&i.push(new Ot(t.key,t.value,"zoom functions not supported"))),"categorical"!==u&&!o||void 0!==t.value.property||i.push(new Ot(t.key,t.value,'"property" property is required')),i;function p(t){var e=[],r=t.value,i=t.key;if("array"!==wr(r))return[new Ot(i,r,"array expected, "+wr(r)+" found")];if(2!==r.length)return[new Ot(i,r,"array length 2 expected, length "+r.length+" found")];if(o){if("object"!==wr(r[0]))return[new Ot(i,r,"object expected, "+wr(r[0])+" found")];if(void 0===r[0].zoom)return[new Ot(i,r,"object stop key must have zoom")];if(void 0===r[0].value)return[new Ot(i,r,"object stop key must have value")];if(n&&n>Nt(r[0].zoom))return[new Ot(i,r[0].zoom,"stop zoom values must appear in ascending order")];Nt(r[0].zoom)!==n&&(n=Nt(r[0].zoom),s=void 0,c={}),e=e.concat(Nr({key:i+"[0]",value:r[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:Fr,value:h}}))}else e=e.concat(h({key:i+"[0]",value:r[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},r));return Mr(Bt(r[1]))?e.concat([new Ot(i+"[1]",r[1],"expressions are not allowed in function stops.")]):e.concat(si({key:i+"[1]",value:r[1],valueSpec:l,style:t.style,styleSpec:t.styleSpec}))}function h(t,e){var r=wr(t.value),i=Nt(t.value),n=null!==t.value?t.value:e;if(a){if(r!==a)return[new Ot(t.key,n,r+" stop domain type must match previous stop domain type "+a)]}else a=r;if("number"!==r&&"string"!==r&&"boolean"!==r)return[new Ot(t.key,n,"stop domain value must be a number, string, or boolean")];if("number"===r||"categorical"===u)return"categorical"!==u||"number"!==r||isFinite(i)&&Math.floor(i)===i?"categorical"!==u&&"number"===r&&void 0!==s&&i<s?[new Ot(t.key,n,"stop domain values must appear in ascending order")]:(s=i,"categorical"===u&&i in c?[new Ot(t.key,n,"stop domain values must be unique")]:(c[i]=!0,[])):[new Ot(t.key,n,"integer expected, found "+i)];var o="number expected, "+r+" found";return _r(l)&&void 0===u&&(o+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ot(t.key,n,o)]}}function jr(e){var t=("property"===e.expressionContext?Rr:Lr)(Bt(e.value),e.valueSpec);if("error"===t.result)return t.value.map(function(t){return new Ot(""+e.key+t.key,e.value,t.message)});var r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&-1!==r.possibleOutputs().indexOf(void 0))return[new Ot(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===e.expressionContext&&"layout"===e.propertyType&&!Ee(r))return[new Ot(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!Ee(r))return[new Ot(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!Ie(r,["zoom","feature-state"]))return[new Ot(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!Te(r))return[new Ot(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function qr(t){var e=t.key,r=t.value,i=t.valueSpec,n=[];return Array.isArray(i.values)?-1===i.values.indexOf(Nt(r))&&n.push(new Ot(e,r,"expected one of ["+i.values.join(", ")+"], "+JSON.stringify(r)+" found")):-1===Object.keys(i.values).indexOf(Nt(r))&&n.push(new Ot(e,r,"expected one of ["+Object.keys(i.values).join(", ")+"], "+JSON.stringify(r)+" found")),n}function Vr(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return 2<=t.length&&"$id"!==t[1]&&"$type"!==t[1];case"in":case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,r=t.slice(1);e<r.length;e+=1){var i=r[e];if(!Vr(i)&&"boolean"!=typeof i)return!1}return!0;default:return!0}}Dr.prototype.evaluateWithoutErrorHandling=function(t,e,r,i,n){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,i,n)},Dr.prototype.evaluate=function(t,e,r,i,n){return this._styleExpression.evaluate(t,e,r,i,n)},Dr.prototype.interpolationFactor=function(t,e,r){return this.interpolationType?Ke.interpolationFactor(this.interpolationType,t,e,r):0},zr.deserialize=function(t){return new zr(t._parameters,t._specification)};var Gr={type:"boolean",default:(zr.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}},!1),transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Zr(t){if(null==t)return function(){return!0};Vr(t)||(t=Wr(t));var r=Lr(t,Gr);if("error"===r.result)throw new Error(r.value.map(function(t){return t.key+": "+t.message}).join(", "));return function(t,e){return r.value.evaluate(t,e)}}function Hr(t,e){return t<e?-1:e<t?1:0}function Wr(t){if(!t)return!0;var e,r=t[0];return t.length<=1?"any"!==r:"=="===r?Kr(t[1],t[2],"=="):"!="===r?Jr(Kr(t[1],t[2],"==")):"<"===r||">"===r||"<="===r||">="===r?Kr(t[1],t[2],r):"any"===r?(e=t.slice(1),["any"].concat(e.map(Wr))):"all"===r?["all"].concat(t.slice(1).map(Wr)):"none"===r?["all"].concat(t.slice(1).map(Wr).map(Jr)):"in"===r?Xr(t[1],t.slice(2)):"!in"===r?Jr(Xr(t[1],t.slice(2))):"has"===r?Yr(t[1]):"!has"!==r||Jr(Yr(t[1]))}function Kr(t,e,r){switch(t){case"$type":return["filter-type-"+r,e];case"$id":return["filter-id-"+r,e];default:return["filter-"+r,t,e]}}function Xr(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return 200<e.length&&!e.some(function(t){return typeof t!=typeof e[0]})?["filter-in-large",t,["literal",e.sort(Hr)]]:["filter-in-small",t,["literal",e]]}}function Yr(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Jr(t){return["!",t]}function Qr(t){return Vr(Bt(t.value))?jr(Rt({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(e){var r=e.value,i=e.key;if("array"!==wr(r))return[new Ot(i,r,"array expected, "+wr(r)+" found")];var n,o=e.styleSpec,a=[];if(r.length<1)return[new Ot(i,r,"filter array must have at least 1 element")];switch(a=a.concat(qr({key:i+"[0]",value:r[0],valueSpec:o.filter_operator,style:e.style,styleSpec:e.styleSpec})),Nt(r[0])){case"<":case"<=":case">":case">=":2<=r.length&&"$type"===Nt(r[1])&&a.push(new Ot(i,r,'"$type" cannot be use with operator "'+r[0]+'"'));case"==":case"!=":3!==r.length&&a.push(new Ot(i,r,'filter array for operator "'+r[0]+'" must have 3 elements'));case"in":case"!in":2<=r.length&&"string"!==(n=wr(r[1]))&&a.push(new Ot(i+"[1]",r[1],"string expected, "+n+" found"));for(var s=2;s<r.length;s++)n=wr(r[s]),"$type"===Nt(r[1])?a=a.concat(qr({key:i+"["+s+"]",value:r[s],valueSpec:o.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==n&&"number"!==n&&"boolean"!==n&&a.push(new Ot(i+"["+s+"]",r[s],"string, number, or boolean expected, "+n+" found"));break;case"any":case"all":case"none":for(var l=1;l<r.length;l++)a=a.concat(t({key:i+"["+l+"]",value:r[l],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":n=wr(r[1]),2!==r.length?a.push(new Ot(i,r,'filter array for "'+r[0]+'" operator must have 2 elements')):"string"!==n&&a.push(new Ot(i+"[1]",r[1],"string expected, "+n+" found"))}return a}(t)}function $r(t,e){var r=t.key,i=t.style,n=t.styleSpec,o=t.value,a=t.objectKey,s=n[e+"_"+t.layerType];if(!s)return[];var l=a.match(/^(.*)-transition$/);if("paint"===e&&l&&s[l[1]]&&s[l[1]].transition)return si({key:r,value:o,valueSpec:n.transition,style:i,styleSpec:n});var u,c=t.valueSpec||s[a];if(!c)return[new Ot(r,o,'unknown property "'+a+'"')];if("string"===wr(o)&&_r(c)&&!c.tokens&&(u=/^{([^}]+)}$/.exec(o)))return[new Ot(r,o,'"'+a+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(u[1])+" }`.")];var p=[];return"symbol"===t.layerType&&("text-field"===a&&i&&!i.glyphs&&p.push(new Ot(r,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&Sr(Bt(o))&&"identity"===Nt(o.type)&&p.push(new Ot(r,o,'"text-font" does not support identity functions'))),p.concat(si({key:t.key,value:o,valueSpec:c,style:i,styleSpec:n,expressionContext:"property",propertyType:e,propertyKey:a}))}function ti(t){return $r(t,"paint")}function ei(t){return $r(t,"layout")}function ri(t){var e=[],r=t.value,i=t.key,n=t.style,o=t.styleSpec;r.type||r.ref||e.push(new Ot(i,r,'either "type" or "ref" is required'));var a,s=Nt(r.type),l=Nt(r.ref);if(r.id)for(var u=Nt(r.id),c=0;c<t.arrayIndex;c++){var p=n.layers[c];Nt(p.id)===u&&e.push(new Ot(i,r.id,'duplicate layer id "'+r.id+'", previously used at line '+p.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(t){t in r&&e.push(new Ot(i,r[t],'"'+t+'" is prohibited for ref layers'))}),n.layers.forEach(function(t){Nt(t.id)===l&&(a=t)}),a?a.ref?e.push(new Ot(i,r.ref,"ref cannot reference another ref layer")):s=Nt(a.type):e.push(new Ot(i,r.ref,'ref layer "'+l+'" not found'));else if("background"!==s)if(r.source){var h=n.sources&&n.sources[r.source],d=h&&Nt(h.type);h?"vector"===d&&"raster"===s?e.push(new Ot(i,r.source,'layer "'+r.id+'" requires a raster source')):"raster"===d&&"raster"!==s?e.push(new Ot(i,r.source,'layer "'+r.id+'" requires a vector source')):"vector"!==d||r["source-layer"]?"raster-dem"===d&&"hillshade"!==s?e.push(new Ot(i,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!r.paint||!r.paint["line-gradient"]||"geojson"===d&&h.lineMetrics||e.push(new Ot(i,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new Ot(i,r,'layer "'+r.id+'" must specify a "source-layer"')):e.push(new Ot(i,r.source,'source "'+r.source+'" not found'))}else e.push(new Ot(i,r,'missing required property "source"'));return e=e.concat(Nr({key:i,value:r,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return si({key:i+".type",value:r.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:r,objectKey:"type"})},filter:Qr,layout:function(t){return Nr({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return ei(Rt({layerType:s},t))}}})},paint:function(t){return Nr({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return ti(Rt({layerType:s},t))}}})}}}))}function ii(t){var e=t.value,r=t.key,i=t.styleSpec,n=t.style;if(!e.type)return[new Ot(r,e,'"type" is required')];var o,a=Nt(e.type);switch(a){case"vector":case"raster":case"raster-dem":return Nr({key:r,value:e,valueSpec:i["source_"+a.replace("-","_")],style:t.style,styleSpec:i});case"geojson":if(o=Nr({key:r,value:e,valueSpec:i.source_geojson,style:n,styleSpec:i}),e.cluster)for(var s in e.clusterProperties){var l=e.clusterProperties[s],u=l[0],c=l[1],p="string"==typeof u?[u,["accumulated"],["get",s]]:u;o.push.apply(o,jr({key:r+"."+s+".map",value:c,expressionContext:"cluster-map"})),o.push.apply(o,jr({key:r+"."+s+".reduce",value:p,expressionContext:"cluster-reduce"}))}return o;case"video":return Nr({key:r,value:e,valueSpec:i.source_video,style:n,styleSpec:i});case"image":return Nr({key:r,value:e,valueSpec:i.source_image,style:n,styleSpec:i});case"canvas":return[new Ot(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return qr({key:r+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:n,styleSpec:i})}}function ni(t){var e=t.value,r=t.styleSpec,i=r.light,n=t.style,o=[],a=wr(e);if(void 0===e)return o;if("object"!==a)return o.concat([new Ot("light",e,"object expected, "+a+" found")]);for(var s in e){var l=s.match(/^(.*)-transition$/);o=l&&i[l[1]]&&i[l[1]].transition?o.concat(si({key:s,value:e[s],valueSpec:r.transition,style:n,styleSpec:r})):i[s]?o.concat(si({key:s,value:e[s],valueSpec:i[s],style:n,styleSpec:r})):o.concat([new Ot(s,e[s],'unknown property "'+s+'"')])}return o}function oi(t){var e=t.value,r=t.key,i=wr(e);return"string"!==i?[new Ot(r,e,"string expected, "+i+" found")]:[]}var ai={"*":function(){return[]},array:Br,boolean:function(t){var e=t.value,r=t.key,i=wr(e);return"boolean"!==i?[new Ot(r,e,"boolean expected, "+i+" found")]:[]},number:Fr,color:function(t){var e=t.key,r=t.value,i=wr(r);return"string"!==i?[new Ot(e,r,"color expected, "+i+" found")]:null===ie(r)?[new Ot(e,r,'color expected, "'+r+'" found')]:[]},constants:Dt,enum:qr,filter:Qr,function:Ur,layer:ri,object:Nr,source:ii,light:ni,string:oi,formatted:function(t){return 0===oi(t).length?[]:jr(t)},image:function(t){return 0===oi(t).length?[]:jr(t)}};function si(t){var e=t.value,r=t.valueSpec,i=t.styleSpec;return r.expression&&Sr(Nt(e))?Ur(t):r.expression&&Mr(Bt(e))?jr(t):r.type&&ai[r.type]?ai[r.type](t):Nr(Rt({},t,{valueSpec:r.type?i[r.type]:r}))}function li(t){var e=t.value,r=t.key,i=oi(t);return i.length||(-1===e.indexOf("{fontstack}")&&i.push(new Ot(r,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&i.push(new Ot(r,e,'"glyphs" url must include a "{range}" token'))),i}function ui(t,e){void 0===e&&(e=Lt);var r=[];return r=r.concat(si({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:li,"*":function(){return[]}}})),t.constants&&(r=r.concat(Dt({key:"constants",value:t.constants,style:t,styleSpec:e}))),ci(r)}function ci(t){return[].concat(t).sort(function(t,e){return t.line-e.line})}function pi(r){return function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return ci(r.apply(this,t))}}ui.source=pi(ii),ui.light=pi(ni),ui.layer=pi(ri),ui.filter=pi(Qr),ui.paintProperty=pi(ti),ui.layoutProperty=pi(ei);var hi=ui,di=hi.light,fi=hi.paintProperty,mi=hi.layoutProperty;function gi(t,e){var r=!1;if(e&&e.length)for(var i=0,n=e;i<n.length;i+=1){var o=n[i];t.fire(new Pt(new Error(o.message))),r=!0}return r}var yi=_i,vi=3;function _i(t,e,r){var i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var n=new Int32Array(this.arrayBuffer);t=n[0],e=n[1],r=n[2],this.d=e+2*r;for(var o=0;o<this.d*this.d;o++){var a=n[vi+o],s=n[vi+o+1];i.push(a===s?null:n.subarray(a,s))}var l=n[vi+i.length],u=n[vi+i.length+1];this.keys=n.subarray(l,u),this.bboxes=n.subarray(u),this.insert=this._insertReadonly}else{this.d=e+2*r;for(var c=0;c<this.d*this.d;c++)i.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=r,this.scale=e/t,this.uid=0;var p=r/e*t;this.min=-p,this.max=t+p}_i.prototype.insert=function(t,e,r,i,n){this._forEachCell(e,r,i,n,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(i),this.bboxes.push(n)},_i.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},_i.prototype._insertCell=function(t,e,r,i,n,o){this.cells[n].push(o)},_i.prototype.query=function(t,e,r,i,n){var o=this.min,a=this.max;if(t<=o&&e<=o&&a<=r&&a<=i&&!n)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(t,e,r,i,this._queryCell,s,{},n),s},_i.prototype._queryCell=function(t,e,r,i,n,o,a,s){var l=this.cells[n];if(null!==l)for(var u=this.keys,c=this.bboxes,p=0;p<l.length;p++){var h=l[p];if(void 0===a[h]){var d=4*h;(s?s(c[0+d],c[1+d],c[2+d],c[3+d]):t<=c[2+d]&&e<=c[3+d]&&r>=c[0+d]&&i>=c[1+d])?(a[h]=!0,o.push(u[h])):a[h]=!1}}},_i.prototype._forEachCell=function(t,e,r,i,n,o,a,s){for(var l=this._convertToCellCoord(t),u=this._convertToCellCoord(e),c=this._convertToCellCoord(r),p=this._convertToCellCoord(i),h=l;h<=c;h++)for(var d=u;d<=p;d++){var f=this.d*d+h;if((!s||s(this._convertFromCellCoord(h),this._convertFromCellCoord(d),this._convertFromCellCoord(h+1),this._convertFromCellCoord(d+1)))&&n.call(this,t,e,r,i,f,o,a,s))return}},_i.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},_i.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},_i.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=vi+this.cells.length+1+1,r=0,i=0;i<this.cells.length;i++)r+=this.cells[i].length;var n=new Int32Array(e+r+this.keys.length+this.bboxes.length);n[0]=this.extent,n[1]=this.n,n[2]=this.padding;for(var o=e,a=0;a<t.length;a++){var s=t[a];n[vi+a]=o,n.set(s,o),o+=s.length}return n[vi+t.length]=o,n.set(this.keys,o),o+=this.keys.length,n[vi+t.length+1]=o,n.set(this.bboxes,o),o+=this.bboxes.length,n.buffer};var xi=self.ImageData,bi={};function wi(t,e,r){void 0===r&&(r={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),bi[t]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}for(var Si in wi("Object",Object),yi.serialize=function(t,e){var r=t.toArrayBuffer();return e&&e.push(r),{buffer:r}},yi.deserialize=function(t){return new yi(t.buffer)},wi("Grid",yi),wi("Color",ne),wi("Error",Error),wi("ResolvedImage",le),wi("StylePropertyFunction",zr),wi("StyleExpression",Pr,{omit:["_evaluator"]}),wi("ZoomDependentExpression",Dr),wi("ZoomConstantExpression",Or),wi("CompoundExpression",we,{omit:["_evaluate"]}),hr)hr[Si]._classRegistryKey||wi("Expression_"+Si,hr[Si]);function Ti(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(t instanceof ArrayBuffer)return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var r=t;return e&&e.push(r.buffer),r}if(t instanceof xi)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var i=[],n=0,o=t;n<o.length;n+=1){var a=o[n];i.push(Ti(a,e))}return i}if("object"!=typeof t)throw new Error("can't serialize object of type "+typeof t);var s=t.constructor,l=s._classRegistryKey;if(!l)throw new Error("can't serialize object of unregistered class");var u=s.serialize?s.serialize(t,e):{};if(!s.serialize){for(var c in t)if(t.hasOwnProperty(c)&&!(0<=bi[l].omit.indexOf(c))){var p=t[c];u[c]=0<=bi[l].shallow.indexOf(c)?p:Ti(p,e)}t instanceof Error&&(u.message=t.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==l&&(u.$name=l),u}function Ei(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof ArrayBuffer||ArrayBuffer.isView(t)||t instanceof xi)return t;if(Array.isArray(t))return t.map(Ei);if("object"!=typeof t)throw new Error("can't deserialize object of type "+typeof t);var e=t.$name||"Object",r=bi[e].klass;if(!r)throw new Error("can't deserialize unregistered class "+e);if(r.deserialize)return r.deserialize(t);for(var i=Object.create(r.prototype),n=0,o=Object.keys(t);n<o.length;n+=1){var a=o[n];if("$name"!==a){var s=t[a];i[a]=0<=bi[e].shallow.indexOf(a)?s:Ei(s)}}return i}function Ii(){this.first=!0}var Ci={"Latin-1 Supplement":function(t){return 128<=t&&t<=255},Arabic:function(t){return 1536<=t&&t<=1791},"Arabic Supplement":function(t){return 1872<=t&&t<=1919},"Arabic Extended-A":function(t){return 2208<=t&&t<=2303},"Hangul Jamo":function(t){return 4352<=t&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return 5120<=t&&t<=5759},Khmer:function(t){return 6016<=t&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return 6320<=t&&t<=6399},"General Punctuation":function(t){return 8192<=t&&t<=8303},"Letterlike Symbols":function(t){return 8448<=t&&t<=8527},"Number Forms":function(t){return 8528<=t&&t<=8591},"Miscellaneous Technical":function(t){return 8960<=t&&t<=9215},"Control Pictures":function(t){return 9216<=t&&t<=9279},"Optical Character Recognition":function(t){return 9280<=t&&t<=9311},"Enclosed Alphanumerics":function(t){return 9312<=t&&t<=9471},"Geometric Shapes":function(t){return 9632<=t&&t<=9727},"Miscellaneous Symbols":function(t){return 9728<=t&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return 11008<=t&&t<=11263},"CJK Radicals Supplement":function(t){return 11904<=t&&t<=12031},"Kangxi Radicals":function(t){return 12032<=t&&t<=12255},"Ideographic Description Characters":function(t){return 12272<=t&&t<=12287},"CJK Symbols and Punctuation":function(t){return 12288<=t&&t<=12351},Hiragana:function(t){return 12352<=t&&t<=12447},Katakana:function(t){return 12448<=t&&t<=12543},Bopomofo:function(t){return 12544<=t&&t<=12591},"Hangul Compatibility Jamo":function(t){return 12592<=t&&t<=12687},Kanbun:function(t){return 12688<=t&&t<=12703},"Bopomofo Extended":function(t){return 12704<=t&&t<=12735},"CJK Strokes":function(t){return 12736<=t&&t<=12783},"Katakana Phonetic Extensions":function(t){return 12784<=t&&t<=12799},"Enclosed CJK Letters and Months":function(t){return 12800<=t&&t<=13055},"CJK Compatibility":function(t){return 13056<=t&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return 13312<=t&&t<=19903},"Yijing Hexagram Symbols":function(t){return 19904<=t&&t<=19967},"CJK Unified Ideographs":function(t){return 19968<=t&&t<=40959},"Yi Syllables":function(t){return 40960<=t&&t<=42127},"Yi Radicals":function(t){return 42128<=t&&t<=42191},"Hangul Jamo Extended-A":function(t){return 43360<=t&&t<=43391},"Hangul Syllables":function(t){return 44032<=t&&t<=55215},"Hangul Jamo Extended-B":function(t){return 55216<=t&&t<=55295},"Private Use Area":function(t){return 57344<=t&&t<=63743},"CJK Compatibility Ideographs":function(t){return 63744<=t&&t<=64255},"Arabic Presentation Forms-A":function(t){return 64336<=t&&t<=65023},"Vertical Forms":function(t){return 65040<=t&&t<=65055},"CJK Compatibility Forms":function(t){return 65072<=t&&t<=65103},"Small Form Variants":function(t){return 65104<=t&&t<=65135},"Arabic Presentation Forms-B":function(t){return 65136<=t&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return 65280<=t&&t<=65519}};function ki(t){for(var e=0,r=t;e<r.length;e+=1)if(Ai(r[e].charCodeAt(0)))return!0;return!1}function Ai(t){return!(746!==t&&747!==t&&(t<4352||!(Ci["Bopomofo Extended"](t)||Ci.Bopomofo(t)||Ci["CJK Compatibility Forms"](t)&&!(65097<=t&&t<=65103)||Ci["CJK Compatibility Ideographs"](t)||Ci["CJK Compatibility"](t)||Ci["CJK Radicals Supplement"](t)||Ci["CJK Strokes"](t)||!(!Ci["CJK Symbols and Punctuation"](t)||12296<=t&&t<=12305||12308<=t&&t<=12319||12336===t)||Ci["CJK Unified Ideographs Extension A"](t)||Ci["CJK Unified Ideographs"](t)||Ci["Enclosed CJK Letters and Months"](t)||Ci["Hangul Compatibility Jamo"](t)||Ci["Hangul Jamo Extended-A"](t)||Ci["Hangul Jamo Extended-B"](t)||Ci["Hangul Jamo"](t)||Ci["Hangul Syllables"](t)||Ci.Hiragana(t)||Ci["Ideographic Description Characters"](t)||Ci.Kanbun(t)||Ci["Kangxi Radicals"](t)||Ci["Katakana Phonetic Extensions"](t)||Ci.Katakana(t)&&12540!==t||!(!Ci["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||65306<=t&&t<=65310||65339===t||65341===t||65343===t||65371<=t&&t<=65503||65507===t||65512<=t&&t<=65519)||!(!Ci["Small Form Variants"](t)||65112<=t&&t<=65118||65123<=t&&t<=65126)||Ci["Unified Canadian Aboriginal Syllabics"](t)||Ci["Unified Canadian Aboriginal Syllabics Extended"](t)||Ci["Vertical Forms"](t)||Ci["Yijing Hexagram Symbols"](t)||Ci["Yi Syllables"](t)||Ci["Yi Radicals"](t))))}function Pi(t){return!(Ai(t)||(e=t,Ci["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||Ci["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||Ci["Letterlike Symbols"](e)||Ci["Number Forms"](e)||Ci["Miscellaneous Technical"](e)&&(8960<=e&&e<=8967||8972<=e&&e<=8991||8996<=e&&e<=9e3||9003===e||9085<=e&&e<=9114||9150<=e&&e<=9165||9167===e||9169<=e&&e<=9179||9186<=e&&e<=9215)||Ci["Control Pictures"](e)&&9251!==e||Ci["Optical Character Recognition"](e)||Ci["Enclosed Alphanumerics"](e)||Ci["Geometric Shapes"](e)||Ci["Miscellaneous Symbols"](e)&&!(9754<=e&&e<=9759)||Ci["Miscellaneous Symbols and Arrows"](e)&&(11026<=e&&e<=11055||11088<=e&&e<=11097||11192<=e&&e<=11243)||Ci["CJK Symbols and Punctuation"](e)||Ci.Katakana(e)||Ci["Private Use Area"](e)||Ci["CJK Compatibility Forms"](e)||Ci["Small Form Variants"](e)||Ci["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||9984<=e&&e<=10087||10102<=e&&e<=10131||65532===e||65533===e));var e}function Mi(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ii,this.transition={})}var Li,Oi=!(Ii.prototype.update=function(t,e){var r=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=r,!0))}),Di=null,Ri=!1,zi=new kt,Ni={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Ri||null!=Ni.applyArabicShaping}};function Bi(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(Sr(t))return new zr(t,e);if(Mr(t)){var r=Rr(t,e);if("error"===r.result)throw new Error(r.value.map(function(t){return t.key+": "+t.message}).join(", "));return r.value}var i=t;return"string"==typeof t&&"color"===e.type&&(i=ne.parse(t)),{kind:"constant",evaluate:function(){return i}}}(void 0===e?t.specification.default:e,t.specification)}function Fi(t){this.property=t,this.value=new Bi(t,void 0)}function Ui(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}Mi.prototype.isSupportedScript=function(t){return function(t,e){for(var r=0,i=t;r<i.length;r+=1)if(n=i[r].charCodeAt(0),!e&&(1424<=n&&n<=2303||Ci["Arabic Presentation Forms-A"](n)||Ci["Arabic Presentation Forms-B"](n))||2304<=n&&n<=3583||3840<=n&&n<=4255||Ci.Khmer(n))return!1;var n;return!0}(t,Ni.isLoaded())},Mi.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Mi.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),r=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*e}},Bi.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},Bi.prototype.possiblyEvaluate=function(t,e){return this.property.possiblyEvaluate(this,t,e)},Fi.prototype.transitioned=function(t,e){return new ji(this.property,this.value,e,f({},t.transition,this.transition),t.now)},Fi.prototype.untransitioned=function(){return new ji(this.property,this.value,null,{},0)},Ui.prototype.getValue=function(t){return _(this._values[t].value.value)},Ui.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Fi(this._values[t].property)),this._values[t].value=new Bi(this._values[t].property,null===e?void 0:_(e))},Ui.prototype.getTransition=function(t){return _(this._values[t].transition)},Ui.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Fi(this._values[t].property)),this._values[t].transition=_(e)||void 0},Ui.prototype.serialize=function(){for(var t={},e=0,r=Object.keys(this._values);e<r.length;e+=1){var i=r[e],n=this.getValue(i);void 0!==n&&(t[i]=n);var o=this.getTransition(i);void 0!==o&&(t[i+"-transition"]=o)}return t},Ui.prototype.transitioned=function(t,e){for(var r=new qi(this._properties),i=0,n=Object.keys(this._values);i<n.length;i+=1){var o=n[i];r._values[o]=this._values[o].transitioned(t,e._values[o])}return r},Ui.prototype.untransitioned=function(){for(var t=new qi(this._properties),e=0,r=Object.keys(this._values);e<r.length;e+=1){var i=r[e];t._values[i]=this._values[i].untransitioned()}return t};var ji=function(t,e,r,i,n){this.property=t,this.value=e,this.begin=n+i.delay||0,this.end=this.begin+i.duration||0,t.specification.transition&&(i.delay||i.duration)&&(this.prior=r)};ji.prototype.possiblyEvaluate=function(t,e){var r=t.now||0,i=this.value.possiblyEvaluate(t,e),n=this.prior;if(n){if(r>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(r<this.begin)return n.possiblyEvaluate(t,e);var o=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(n.possiblyEvaluate(t,e),i,function(){if(o<=0)return 0;if(1<=o)return 1;var t=o*o,e=t*o;return 4*(o<.5?e:3*(o-t)+e-.75)}())}return i};var qi=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};function Vi(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}function Gi(t,e,r){this.property=t,this.value=e,this.parameters=r}qi.prototype.possiblyEvaluate=function(t,e){for(var r=new Zi(this._properties),i=0,n=Object.keys(this._values);i<n.length;i+=1){var o=n[i];r._values[o]=this._values[o].possiblyEvaluate(t,e)}return r},qi.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1){var r=e[t];if(this._values[r].prior)return!0}return!1},Vi.prototype.getValue=function(t){return _(this._values[t].value)},Vi.prototype.setValue=function(t,e){this._values[t]=new Bi(this._values[t].property,null===e?void 0:_(e))},Vi.prototype.serialize=function(){for(var t={},e=0,r=Object.keys(this._values);e<r.length;e+=1){var i=r[e],n=this.getValue(i);void 0!==n&&(t[i]=n)}return t},Vi.prototype.possiblyEvaluate=function(t,e){for(var r=new Zi(this._properties),i=0,n=Object.keys(this._values);i<n.length;i+=1){var o=n[i];r._values[o]=this._values[o].possiblyEvaluate(t,e)}return r},Gi.prototype.isConstant=function(){return"constant"===this.value.kind},Gi.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},Gi.prototype.evaluate=function(t,e,r){return this.property.evaluate(this.value,this.parameters,t,e,r)};var Zi=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};function Hi(t){this.specification=t}function Wi(t,e){this.specification=t,this.overrides=e}function Ki(t){this.specification=t}Zi.prototype.get=function(t){return this._values[t]},Hi.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},Hi.prototype.interpolate=function(t,e,r){var i=Le[this.specification.type];return i?i(t,e,r):t},Wi.prototype.possiblyEvaluate=function(t,e,r){return"constant"===t.expression.kind||"camera"===t.expression.kind?new Gi(this,{kind:"constant",value:t.expression.evaluate(e,null,{},r)},e):new Gi(this,t.expression,e)},Wi.prototype.interpolate=function(t,e,r){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new Gi(this,{kind:"constant",value:void 0},t.parameters);var i=Le[this.specification.type];return i?new Gi(this,{kind:"constant",value:i(t.value.value,e.value.value,r)},t.parameters):t},Wi.prototype.evaluate=function(t,e,r,i,n){return"constant"===t.kind?t.value:t.evaluate(e,r,i,n)};var Xi,Yi=(Ji.__proto__=Xi=Wi,((Ji.prototype=Object.create(Xi&&Xi.prototype)).constructor=Ji).prototype.possiblyEvaluate=function(t,e,r){if(void 0===t.value)return new Gi(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){var i=t.expression.evaluate(e,null,{},r),n="image"===t.property.specification.type&&"string"!=typeof i?i.name:i,o=this._calculate(n,n,n,e);return new Gi(this,{kind:"constant",value:o},e)}if("camera"!==t.expression.kind)return new Gi(this,t.expression,e);var a=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new Gi(this,{kind:"constant",value:a},e)},Ji.prototype.evaluate=function(t,e,r,i,n){if("source"!==t.kind)return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},r,i),t.evaluate({zoom:Math.floor(e.zoom)},r,i),t.evaluate({zoom:Math.floor(e.zoom)+1},r,i),e):t.value;var o=t.evaluate(e,r,i,n);return this._calculate(o,o,o,e)},Ji.prototype._calculate=function(t,e,r,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:r,to:e}},Ji.prototype.interpolate=function(t){return t},Ji);function Ji(){Xi.apply(this,arguments)}function Qi(t){this.specification=t}function $i(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var r=t[e];r.specification.overridable&&this.overridableProperties.push(e);var i=this.defaultPropertyValues[e]=new Bi(r,void 0),n=this.defaultTransitionablePropertyValues[e]=new Fi(r);this.defaultTransitioningPropertyValues[e]=n.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=i.possiblyEvaluate({})}}function tn(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}function en(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}Ki.prototype.possiblyEvaluate=function(t,e,r){if(void 0!==t.value){if("constant"!==t.expression.kind)return this._calculate(t.expression.evaluate(new Mi(Math.floor(e.zoom-1),e)),t.expression.evaluate(new Mi(Math.floor(e.zoom),e)),t.expression.evaluate(new Mi(Math.floor(e.zoom+1),e)),e);var i=t.expression.evaluate(e,null,{},r);return this._calculate(i,i,i,e)}},Ki.prototype._calculate=function(t,e,r,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:r,to:e}},Ki.prototype.interpolate=function(t){return t},Qi.prototype.possiblyEvaluate=function(t,e,r){return!!t.expression.evaluate(e,null,{},r)},Qi.prototype.interpolate=function(){return!1},wi("DataDrivenProperty",Wi),wi("DataConstantProperty",Hi),wi("CrossFadedDataDrivenProperty",Yi),wi("CrossFadedProperty",Ki),wi("ColorRampProperty",Qi);var rn,nn=(an.__proto__=rn=kt,((an.prototype=Object.create(rn&&rn.prototype)).constructor=an).prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},an.prototype.getLayoutProperty=function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)},an.prototype.setLayoutProperty=function(t,e,r){if(void 0===r&&(r={}),null!=e){var i="layers."+this.id+".layout."+t;if(this._validate(mi,i,t,e,r))return}"visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e},an.prototype.getPaintProperty=function(t){return g(t,"-transition")?this._transitionablePaint.getTransition(t.slice(0,-"-transition".length)):this._transitionablePaint.getValue(t)},an.prototype.setPaintProperty=function(t,e,r){if(void 0===r&&(r={}),null!=e){var i="layers."+this.id+".paint."+t;if(this._validate(fi,i,t,e,r))return!1}if(g(t,"-transition"))return this._transitionablePaint.setTransition(t.slice(0,-"-transition".length),e||void 0),!1;var n=this._transitionablePaint._values[t],o="cross-faded-data-driven"===n.property.specification["property-type"],a=n.value.isDataDriven(),s=n.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);var l=this._transitionablePaint._values[t].value;return l.isDataDriven()||a||o||this._handleOverridablePaintPropertyUpdate(t,s,l)},an.prototype._handleSpecialPaintPropertyUpdate=function(t){},an.prototype._handleOverridablePaintPropertyUpdate=function(t,e,r){return!1},an.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility},an.prototype.updateTransitions=function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)},an.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},an.prototype.recalculate=function(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,e)},an.prototype.serialize=function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),v(t,function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)})},an.prototype._validate=function(t,e,r,i,n){return void 0===n&&(n={}),(!n||!1!==n.validate)&&gi(this,t.call(hi,{key:e,layerType:this.type,objectKey:r,value:i,styleSpec:Lt,style:{glyphs:!0,sprite:!0}}))},an.prototype.is3D=function(){return!1},an.prototype.isTileClipped=function(){return!1},an.prototype.hasOffscreenPass=function(){return!1},an.prototype.resize=function(){},an.prototype.isStateDependent=function(){for(var t in this.paint._values){var e=this.paint.get(t);if(e instanceof Gi&&_r(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1},an),on={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};function an(t,e){if(rn.call(this),this.id=t.id,this.type=t.type,this._featureFilter=function(){return!0},"custom"!==t.type&&(t=t,this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),e.layout&&(this._unevaluatedLayout=new Vi(e.layout)),e.paint)){for(var r in this._transitionablePaint=new Ui(e.paint),t.paint)this.setPaintProperty(r,t.paint[r],{validate:!1});for(var i in t.layout)this.setLayoutProperty(i,t.layout[i],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}}function sn(t,o){void 0===o&&(o=1);var a=0,s=0;return{members:t.map(function(t){var e,r=(e=t.type,on[e].BYTES_PER_ELEMENT),i=a=ln(a,Math.max(o,r)),n=t.components||1;return s=Math.max(s,r),a+=r*n,{name:t.name,type:t.type,components:n,offset:i}}),size:ln(a,Math.max(s,o)),alignment:o}}function ln(t,e){return Math.ceil(t/e)*e}en.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},en.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},en.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},en.prototype.clear=function(){this.length=0},en.prototype.resize=function(t){this.reserve(t),this.length=t},en.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},en.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var un,cn=(pn.__proto__=un=en,((pn.prototype=Object.create(un&&un.prototype)).constructor=pn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},pn.prototype.emplaceBack=function(t,e){var r=this.length;return this.resize(r+1),this.emplace(r,t,e)},pn.prototype.emplace=function(t,e,r){var i=2*t;return this.int16[0+i]=e,this.int16[1+i]=r,t},pn);function pn(){un.apply(this,arguments)}cn.prototype.bytesPerElement=4,wi("StructArrayLayout2i4",cn);var hn,dn=(fn.__proto__=hn=en,((fn.prototype=Object.create(hn&&hn.prototype)).constructor=fn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},fn.prototype.emplaceBack=function(t,e,r,i){var n=this.length;return this.resize(n+1),this.emplace(n,t,e,r,i)},fn.prototype.emplace=function(t,e,r,i,n){var o=4*t;return this.int16[0+o]=e,this.int16[1+o]=r,this.int16[2+o]=i,this.int16[3+o]=n,t},fn);function fn(){hn.apply(this,arguments)}dn.prototype.bytesPerElement=8,wi("StructArrayLayout4i8",dn);var mn,gn=(yn.__proto__=mn=en,((yn.prototype=Object.create(mn&&mn.prototype)).constructor=yn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},yn.prototype.emplaceBack=function(t,e,r,i,n,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,r,i,n,o)},yn.prototype.emplace=function(t,e,r,i,n,o,a){var s=6*t;return this.int16[0+s]=e,this.int16[1+s]=r,this.int16[2+s]=i,this.int16[3+s]=n,this.int16[4+s]=o,this.int16[5+s]=a,t},yn);function yn(){mn.apply(this,arguments)}gn.prototype.bytesPerElement=12,wi("StructArrayLayout2i4i12",gn);var vn,_n=(xn.__proto__=vn=en,((xn.prototype=Object.create(vn&&vn.prototype)).constructor=xn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},xn.prototype.emplaceBack=function(t,e,r,i,n,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,r,i,n,o)},xn.prototype.emplace=function(t,e,r,i,n,o,a){var s=4*t,l=8*t;return this.int16[0+s]=e,this.int16[1+s]=r,this.uint8[4+l]=i,this.uint8[5+l]=n,this.uint8[6+l]=o,this.uint8[7+l]=a,t},xn);function xn(){vn.apply(this,arguments)}_n.prototype.bytesPerElement=8,wi("StructArrayLayout2i4ub8",_n);var bn,wn=(Sn.__proto__=bn=en,((Sn.prototype=Object.create(bn&&bn.prototype)).constructor=Sn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},Sn.prototype.emplaceBack=function(t,e,r,i,n,o,a,s){var l=this.length;return this.resize(l+1),this.emplace(l,t,e,r,i,n,o,a,s)},Sn.prototype.emplace=function(t,e,r,i,n,o,a,s,l){var u=8*t;return this.uint16[0+u]=e,this.uint16[1+u]=r,this.uint16[2+u]=i,this.uint16[3+u]=n,this.uint16[4+u]=o,this.uint16[5+u]=a,this.uint16[6+u]=s,this.uint16[7+u]=l,t},Sn);function Sn(){bn.apply(this,arguments)}wn.prototype.bytesPerElement=16,wi("StructArrayLayout8ui16",wn);var Tn,En=(In.__proto__=Tn=en,((In.prototype=Object.create(Tn&&Tn.prototype)).constructor=In).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},In.prototype.emplaceBack=function(t,e,r,i,n,o,a,s){var l=this.length;return this.resize(l+1),this.emplace(l,t,e,r,i,n,o,a,s)},In.prototype.emplace=function(t,e,r,i,n,o,a,s,l){var u=8*t;return this.int16[0+u]=e,this.int16[1+u]=r,this.int16[2+u]=i,this.int16[3+u]=n,this.uint16[4+u]=o,this.uint16[5+u]=a,this.uint16[6+u]=s,this.uint16[7+u]=l,t},In);function In(){Tn.apply(this,arguments)}En.prototype.bytesPerElement=16,wi("StructArrayLayout4i4ui16",En);var Cn,kn=(An.__proto__=Cn=en,((An.prototype=Object.create(Cn&&Cn.prototype)).constructor=An).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},An.prototype.emplaceBack=function(t,e,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,r)},An.prototype.emplace=function(t,e,r,i){var n=3*t;return this.float32[0+n]=e,this.float32[1+n]=r,this.float32[2+n]=i,t},An);function An(){Cn.apply(this,arguments)}kn.prototype.bytesPerElement=12,wi("StructArrayLayout3f12",kn);var Pn,Mn=(Ln.__proto__=Pn=en,((Ln.prototype=Object.create(Pn&&Pn.prototype)).constructor=Ln).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},Ln.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},Ln.prototype.emplace=function(t,e){var r=1*t;return this.uint32[0+r]=e,t},Ln);function Ln(){Pn.apply(this,arguments)}Mn.prototype.bytesPerElement=4,wi("StructArrayLayout1ul4",Mn);var On,Dn=(Rn.__proto__=On=en,((Rn.prototype=Object.create(On&&On.prototype)).constructor=Rn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},Rn.prototype.emplaceBack=function(t,e,r,i,n,o,a,s,l,u,c){var p=this.length;return this.resize(p+1),this.emplace(p,t,e,r,i,n,o,a,s,l,u,c)},Rn.prototype.emplace=function(t,e,r,i,n,o,a,s,l,u,c,p){var h=12*t,d=6*t;return this.int16[0+h]=e,this.int16[1+h]=r,this.int16[2+h]=i,this.int16[3+h]=n,this.int16[4+h]=o,this.int16[5+h]=a,this.uint32[3+d]=s,this.uint16[8+h]=l,this.uint16[9+h]=u,this.int16[10+h]=c,this.int16[11+h]=p,t},Rn);function Rn(){On.apply(this,arguments)}Dn.prototype.bytesPerElement=24,wi("StructArrayLayout6i1ul2ui2i24",Dn);var zn,Nn=(Bn.__proto__=zn=en,((Bn.prototype=Object.create(zn&&zn.prototype)).constructor=Bn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},Bn.prototype.emplaceBack=function(t,e,r,i,n,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,r,i,n,o)},Bn.prototype.emplace=function(t,e,r,i,n,o,a){var s=6*t;return this.int16[0+s]=e,this.int16[1+s]=r,this.int16[2+s]=i,this.int16[3+s]=n,this.int16[4+s]=o,this.int16[5+s]=a,t},Bn);function Bn(){zn.apply(this,arguments)}Nn.prototype.bytesPerElement=12,wi("StructArrayLayout2i2i2i12",Nn);var Fn,Un=(jn.__proto__=Fn=en,((jn.prototype=Object.create(Fn&&Fn.prototype)).constructor=jn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},jn.prototype.emplaceBack=function(t,e,r,i){var n=this.length;return this.resize(n+1),this.emplace(n,t,e,r,i)},jn.prototype.emplace=function(t,e,r,i,n){var o=12*t,a=3*t;return this.uint8[0+o]=e,this.uint8[1+o]=r,this.float32[1+a]=i,this.float32[2+a]=n,t},jn);function jn(){Fn.apply(this,arguments)}Un.prototype.bytesPerElement=12,wi("StructArrayLayout2ub2f12",Un);var qn,Vn=(Gn.__proto__=qn=en,((Gn.prototype=Object.create(qn&&qn.prototype)).constructor=Gn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},Gn.prototype.emplaceBack=function(t,e,r,i,n,o,a,s,l,u,c,p,h,d,f,m,g){var y=this.length;return this.resize(y+1),this.emplace(y,t,e,r,i,n,o,a,s,l,u,c,p,h,d,f,m,g)},Gn.prototype.emplace=function(t,e,r,i,n,o,a,s,l,u,c,p,h,d,f,m,g,y){var v=24*t,_=12*t,x=48*t;return this.int16[0+v]=e,this.int16[1+v]=r,this.uint16[2+v]=i,this.uint16[3+v]=n,this.uint32[2+_]=o,this.uint32[3+_]=a,this.uint32[4+_]=s,this.uint16[10+v]=l,this.uint16[11+v]=u,this.uint16[12+v]=c,this.float32[7+_]=p,this.float32[8+_]=h,this.uint8[36+x]=d,this.uint8[37+x]=f,this.uint8[38+x]=m,this.uint32[10+_]=g,this.int16[22+v]=y,t},Gn);function Gn(){qn.apply(this,arguments)}Vn.prototype.bytesPerElement=48,wi("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Vn);var Zn,Hn=(Wn.__proto__=Zn=en,((Wn.prototype=Object.create(Zn&&Zn.prototype)).constructor=Wn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},Wn.prototype.emplaceBack=function(t,e,r,i,n,o,a,s,l,u,c,p,h,d,f,m,g,y,v,_,x,b){var w=this.length;return this.resize(w+1),this.emplace(w,t,e,r,i,n,o,a,s,l,u,c,p,h,d,f,m,g,y,v,_,x,b)},Wn.prototype.emplace=function(t,e,r,i,n,o,a,s,l,u,c,p,h,d,f,m,g,y,v,_,x,b,w){var S=26*t,T=13*t;return this.int16[0+S]=e,this.int16[1+S]=r,this.int16[2+S]=i,this.int16[3+S]=n,this.int16[4+S]=o,this.int16[5+S]=a,this.int16[6+S]=s,this.uint16[7+S]=l,this.uint16[8+S]=u,this.uint16[9+S]=c,this.uint16[10+S]=p,this.uint16[11+S]=h,this.uint16[12+S]=d,this.uint16[13+S]=f,this.uint16[14+S]=m,this.uint16[15+S]=g,this.uint16[16+S]=y,this.uint16[17+S]=v,this.uint32[9+T]=_,this.float32[10+T]=x,this.float32[11+T]=b,this.float32[12+T]=w,t},Wn);function Wn(){Zn.apply(this,arguments)}Hn.prototype.bytesPerElement=52,wi("StructArrayLayout7i11ui1ul3f52",Hn);var Kn,Xn=(Yn.__proto__=Kn=en,((Yn.prototype=Object.create(Kn&&Kn.prototype)).constructor=Yn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},Yn.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},Yn.prototype.emplace=function(t,e){var r=1*t;return this.float32[0+r]=e,t},Yn);function Yn(){Kn.apply(this,arguments)}Xn.prototype.bytesPerElement=4,wi("StructArrayLayout1f4",Xn);var Jn,Qn=($n.__proto__=Jn=en,(($n.prototype=Object.create(Jn&&Jn.prototype)).constructor=$n).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},$n.prototype.emplaceBack=function(t,e,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,r)},$n.prototype.emplace=function(t,e,r,i){var n=3*t;return this.int16[0+n]=e,this.int16[1+n]=r,this.int16[2+n]=i,t},$n);function $n(){Jn.apply(this,arguments)}Qn.prototype.bytesPerElement=6,wi("StructArrayLayout3i6",Qn);var to,eo=(ro.__proto__=to=en,((ro.prototype=Object.create(to&&to.prototype)).constructor=ro).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},ro.prototype.emplaceBack=function(t,e,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,r)},ro.prototype.emplace=function(t,e,r,i){var n=2*t,o=4*t;return this.uint32[0+n]=e,this.uint16[2+o]=r,this.uint16[3+o]=i,t},ro);function ro(){to.apply(this,arguments)}eo.prototype.bytesPerElement=8,wi("StructArrayLayout1ul2ui8",eo);var io,no=(oo.__proto__=io=en,((oo.prototype=Object.create(io&&io.prototype)).constructor=oo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},oo.prototype.emplaceBack=function(t,e,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,r)},oo.prototype.emplace=function(t,e,r,i){var n=3*t;return this.uint16[0+n]=e,this.uint16[1+n]=r,this.uint16[2+n]=i,t},oo);function oo(){io.apply(this,arguments)}no.prototype.bytesPerElement=6,wi("StructArrayLayout3ui6",no);var ao,so=(lo.__proto__=ao=en,((lo.prototype=Object.create(ao&&ao.prototype)).constructor=lo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},lo.prototype.emplaceBack=function(t,e){var r=this.length;return this.resize(r+1),this.emplace(r,t,e)},lo.prototype.emplace=function(t,e,r){var i=2*t;return this.uint16[0+i]=e,this.uint16[1+i]=r,t},lo);function lo(){ao.apply(this,arguments)}so.prototype.bytesPerElement=4,wi("StructArrayLayout2ui4",so);var uo,co=(po.__proto__=uo=en,((po.prototype=Object.create(uo&&uo.prototype)).constructor=po).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},po.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},po.prototype.emplace=function(t,e){var r=1*t;return this.uint16[0+r]=e,t},po);function po(){uo.apply(this,arguments)}co.prototype.bytesPerElement=2,wi("StructArrayLayout1ui2",co);var ho,fo=(mo.__proto__=ho=en,((mo.prototype=Object.create(ho&&ho.prototype)).constructor=mo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},mo.prototype.emplaceBack=function(t,e){var r=this.length;return this.resize(r+1),this.emplace(r,t,e)},mo.prototype.emplace=function(t,e,r){var i=2*t;return this.float32[0+i]=e,this.float32[1+i]=r,t},mo);function mo(){ho.apply(this,arguments)}fo.prototype.bytesPerElement=8,wi("StructArrayLayout2f8",fo);var go,yo=(vo.__proto__=go=en,((vo.prototype=Object.create(go&&go.prototype)).constructor=vo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},vo.prototype.emplaceBack=function(t,e,r,i){var n=this.length;return this.resize(n+1),this.emplace(n,t,e,r,i)},vo.prototype.emplace=function(t,e,r,i,n){var o=4*t;return this.float32[0+o]=e,this.float32[1+o]=r,this.float32[2+o]=i,this.float32[3+o]=n,t},vo);function vo(){go.apply(this,arguments)}yo.prototype.bytesPerElement=16,wi("StructArrayLayout4f16",yo);var _o=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},radius:{configurable:!0},signedDistanceFromAnchor:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointX.set=function(t){this._structArray.int16[this._pos2+0]=t},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.anchorPointY.set=function(t){this._structArray.int16[this._pos2+1]=t},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.x1.set=function(t){this._structArray.int16[this._pos2+2]=t},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.y1.set=function(t){this._structArray.int16[this._pos2+3]=t},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.x2.set=function(t){this._structArray.int16[this._pos2+4]=t},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.y2.set=function(t){this._structArray.int16[this._pos2+5]=t},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.featureIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+8]=t},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+9]=t},r.radius.get=function(){return this._structArray.int16[this._pos2+10]},r.radius.set=function(t){this._structArray.int16[this._pos2+10]=t},r.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]},r.signedDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+11]=t},r.anchorPoint.get=function(){return new lt(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,r),e}(tn);_o.prototype.size=24;var xo,bo=((xo=Dn)&&(wo.__proto__=xo),((wo.prototype=Object.create(xo&&xo.prototype)).constructor=wo).prototype.get=function(t){return new _o(this,t)},wo);function wo(){xo.apply(this,arguments)}wi("CollisionBoxArray",bo);var So=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorX.set=function(t){this._structArray.int16[this._pos2+0]=t},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.anchorY.set=function(t){this._structArray.int16[this._pos2+1]=t},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.glyphStartIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.numGlyphs.set=function(t){this._structArray.uint16[this._pos2+3]=t},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.vertexStartIndex.set=function(t){this._structArray.uint32[this._pos4+2]=t},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineStartIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.lineLength.set=function(t){this._structArray.uint32[this._pos4+4]=t},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.segment.set=function(t){this._structArray.uint16[this._pos2+10]=t},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.lowerSize.set=function(t){this._structArray.uint16[this._pos2+11]=t},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.upperSize.set=function(t){this._structArray.uint16[this._pos2+12]=t},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetX.set=function(t){this._structArray.float32[this._pos4+7]=t},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.lineOffsetY.set=function(t){this._structArray.float32[this._pos4+8]=t},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.writingMode.set=function(t){this._structArray.uint8[this._pos1+36]=t},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(t){this._structArray.uint8[this._pos1+37]=t},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(t){this._structArray.uint8[this._pos1+38]=t},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(t){this._structArray.uint32[this._pos4+10]=t},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},r.associatedIconIndex.set=function(t){this._structArray.int16[this._pos2+22]=t},Object.defineProperties(e.prototype,r),e}(tn);So.prototype.size=48;var To,Eo=((To=Vn)&&(Io.__proto__=To),((Io.prototype=Object.create(To&&To.prototype)).constructor=Io).prototype.get=function(t){return new So(this,t)},Io);function Io(){To.apply(this,arguments)}wi("PlacedSymbolArray",Eo);var Co=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorX.set=function(t){this._structArray.int16[this._pos2+0]=t},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.anchorY.set=function(t){this._structArray.int16[this._pos2+1]=t},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.rightJustifiedTextSymbolIndex.set=function(t){this._structArray.int16[this._pos2+2]=t},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.centerJustifiedTextSymbolIndex.set=function(t){this._structArray.int16[this._pos2+3]=t},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.leftJustifiedTextSymbolIndex.set=function(t){this._structArray.int16[this._pos2+4]=t},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.verticalPlacedTextSymbolIndex.set=function(t){this._structArray.int16[this._pos2+5]=t},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.placedIconSymbolIndex.set=function(t){this._structArray.int16[this._pos2+6]=t},r.key.get=function(){return this._structArray.uint16[this._pos2+7]},r.key.set=function(t){this._structArray.uint16[this._pos2+7]=t},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.set=function(t){this._structArray.uint16[this._pos2+8]=t},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.set=function(t){this._structArray.uint16[this._pos2+9]=t},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.set=function(t){this._structArray.uint16[this._pos2+10]=t},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.set=function(t){this._structArray.uint16[this._pos2+11]=t},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.set=function(t){this._structArray.uint16[this._pos2+12]=t},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.set=function(t){this._structArray.uint16[this._pos2+13]=t},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.featureIndex.set=function(t){this._structArray.uint16[this._pos2+14]=t},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+15]},r.numHorizontalGlyphVertices.set=function(t){this._structArray.uint16[this._pos2+15]=t},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+16]},r.numVerticalGlyphVertices.set=function(t){this._structArray.uint16[this._pos2+16]=t},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+17]},r.numIconVertices.set=function(t){this._structArray.uint16[this._pos2+17]=t},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+9]},r.crossTileID.set=function(t){this._structArray.uint32[this._pos4+9]=t},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+10]},r.textBoxScale.set=function(t){this._structArray.float32[this._pos4+10]=t},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+11]},r.textOffset0.set=function(t){this._structArray.float32[this._pos4+11]=t},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+12]},r.textOffset1.set=function(t){this._structArray.float32[this._pos4+12]=t},Object.defineProperties(e.prototype,r),e}(tn);Co.prototype.size=52;var ko,Ao=((ko=Hn)&&(Po.__proto__=ko),((Po.prototype=Object.create(ko&&ko.prototype)).constructor=Po).prototype.get=function(t){return new Co(this,t)},Po);function Po(){ko.apply(this,arguments)}wi("SymbolInstanceArray",Ao);var Mo=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={offsetX:{configurable:!0}};return r.offsetX.get=function(){return this._structArray.float32[this._pos4+0]},r.offsetX.set=function(t){this._structArray.float32[this._pos4+0]=t},Object.defineProperties(e.prototype,r),e}(tn);Mo.prototype.size=4;var Lo,Oo=((Lo=Xn)&&(Do.__proto__=Lo),((Do.prototype=Object.create(Lo&&Lo.prototype)).constructor=Do).prototype.getoffsetX=function(t){return this.float32[1*t+0]},Do.prototype.get=function(t){return new Mo(this,t)},Do);function Do(){Lo.apply(this,arguments)}wi("GlyphOffsetArray",Oo);var Ro=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={x:{configurable:!0},y:{configurable:!0},tileUnitDistanceFromAnchor:{configurable:!0}};return r.x.get=function(){return this._structArray.int16[this._pos2+0]},r.x.set=function(t){this._structArray.int16[this._pos2+0]=t},r.y.get=function(){return this._structArray.int16[this._pos2+1]},r.y.set=function(t){this._structArray.int16[this._pos2+1]=t},r.tileUnitDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+2]},r.tileUnitDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+2]=t},Object.defineProperties(e.prototype,r),e}(tn);Ro.prototype.size=6;var zo,No=((zo=Qn)&&(Bo.__proto__=zo),((Bo.prototype=Object.create(zo&&zo.prototype)).constructor=Bo).prototype.getx=function(t){return this.int16[3*t+0]},Bo.prototype.gety=function(t){return this.int16[3*t+1]},Bo.prototype.gettileUnitDistanceFromAnchor=function(t){return this.int16[3*t+2]},Bo.prototype.get=function(t){return new Ro(this,t)},Bo);function Bo(){zo.apply(this,arguments)}wi("SymbolLineVertexArray",No);var Fo=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.featureIndex.set=function(t){this._structArray.uint32[this._pos4+0]=t},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},r.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+3]=t},Object.defineProperties(e.prototype,r),e}(tn);Fo.prototype.size=8;var Uo,jo=((Uo=eo)&&(qo.__proto__=Uo),((qo.prototype=Object.create(Uo&&Uo.prototype)).constructor=qo).prototype.get=function(t){return new Fo(this,t)},qo);function qo(){Uo.apply(this,arguments)}function Vo(t){void 0===t&&(t=[]),this.segments=t}wi("FeatureIndexArray",jo);var Go=sn([{name:"a_pos",components:2,type:"Int16"}],4).members;function Zo(t,e){return 256*(t=l(Math.floor(t),0,255))+l(Math.floor(e),0,255)}function Ho(){this.ids=[],this.positions=[],this.indexed=!1}function Wo(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function Ko(t,e){this.gl=t.gl,this.location=e}Vo.prototype.prepareSegment=function(t,e,r,i){var n=this.segments[this.segments.length-1];return Vo.MAX_VERTEX_ARRAY_LENGTH<t&&ut("Max vertices per segment is "+Vo.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!n||n.vertexLength+t>Vo.MAX_VERTEX_ARRAY_LENGTH||n.sortKey!==i)&&(n={vertexOffset:e.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},void 0!==i&&(n.sortKey=i),this.segments.push(n)),n},Vo.prototype.get=function(){return this.segments},Vo.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var r=e[t];for(var i in r.vaos)r.vaos[i].destroy()}},Vo.simpleSegment=function(t,e,r,i){return new Vo([{vertexOffset:t,primitiveOffset:e,vertexLength:r,primitiveLength:i,vaos:{},sortKey:0}])},Vo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,wi("SegmentVector",Vo),Ho.prototype.add=function(t,e,r,i){this.ids.push(t),this.positions.push(e,r,i)},Ho.prototype.getPositions=function(t){for(var e=0,r=this.ids.length-1;e<r;){var i=e+r>>1;this.ids[i]>=t?r=i:e=1+i}for(var n=[];this.ids[e]===t;){var o=this.positions[3*e],a=this.positions[3*e+1],s=this.positions[3*e+2];n.push({index:o,start:a,end:s}),e++}return n},Ho.serialize=function(t,e){var r=new Float64Array(t.ids),i=new Uint32Array(t.positions);return function t(e,r,i,n){if(!(n<=i)){for(var o=e[i+n>>1],a=i-1,s=n+1;;){for(;e[++a]<o;);for(;e[--s]>o;);if(s<=a)break;Wo(e,a,s),Wo(r,3*a,3*s),Wo(r,3*a+1,3*s+1),Wo(r,3*a+2,3*s+2)}t(e,r,i,s),t(e,r,s+1,n)}}(r,i,0,r.length-1),e.push(r.buffer,i.buffer),{ids:r,positions:i}},Ho.deserialize=function(t){var e=new Ho;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e},wi("FeaturePositionMap",Ho);var Xo,Yo,Jo,Qo,$o,ta,ea,ra=(ga.__proto__=ea=Ko,((ga.prototype=Object.create(ea&&ea.prototype)).constructor=ga).prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))},ga),ia=(ma.__proto__=ta=Ko,((ma.prototype=Object.create(ta&&ta.prototype)).constructor=ma).prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))},ma),na=(fa.__proto__=$o=Ko,((fa.prototype=Object.create($o&&$o.prototype)).constructor=fa).prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))},fa),oa=(da.__proto__=Qo=Ko,((da.prototype=Object.create(Qo&&Qo.prototype)).constructor=da).prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))},da),aa=(ha.__proto__=Jo=Ko,((ha.prototype=Object.create(Jo&&Jo.prototype)).constructor=ha).prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))},ha),sa=(pa.__proto__=Yo=Ko,((pa.prototype=Object.create(Yo&&Yo.prototype)).constructor=pa).prototype.set=function(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))},pa),la=new Float32Array(16),ua=(ca.__proto__=Xo=Ko,((ca.prototype=Object.create(Xo&&Xo.prototype)).constructor=ca).prototype.set=function(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(var e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}},ca);function ca(t,e){Xo.call(this,t,e),this.current=la}function pa(t,e){Yo.call(this,t,e),this.current=ne.transparent}function ha(t,e){Jo.call(this,t,e),this.current=[0,0,0,0]}function da(t,e){Qo.call(this,t,e),this.current=[0,0,0]}function fa(t,e){$o.call(this,t,e),this.current=[0,0]}function ma(t,e){ta.call(this,t,e),this.current=0}function ga(t,e){ea.call(this,t,e),this.current=0}function ya(t){return[Zo(255*t.r,255*t.g),Zo(255*t.b,255*t.a)]}function va(t,e,r){this.value=t,this.names=e,this.uniformNames=this.names.map(function(t){return"u_"+t}),this.type=r,this.maxValue=-1/0}function _a(t,e,r){this.value=t,this.names=e,this.uniformNames=this.names.map(function(t){return"u_"+t}),this.type=r,this.maxValue=-1/0,this.patternPositions={patternTo:null,patternFrom:null}}function xa(t,e,r,i){this.expression=t,this.names=e,this.type=r,this.uniformNames=this.names.map(function(t){return"a_"+t}),this.maxValue=-1/0,this.paintVertexAttributes=e.map(function(t){return{name:"a_"+t,type:"Float32",components:"color"===r?2:1,offset:0}}),this.paintVertexArray=new i}function ba(t,e,r,i,n,o){this.expression=t,this.names=e,this.uniformNames=this.names.map(function(t){return"u_"+t+"_t"}),this.type=r,this.useIntegerZoom=i,this.zoom=n,this.maxValue=-1/0;var a=o;this.paintVertexAttributes=e.map(function(t){return{name:"a_"+t,type:"Float32",components:"color"===r?4:2,offset:0}}),this.paintVertexArray=new a}function wa(t,e,r,i,n,o,a){this.expression=t,this.names=e,this.type=r,this.uniformNames=this.names.map(function(t){return"u_"+t+"_t"}),this.useIntegerZoom=i,this.zoom=n,this.maxValue=-1/0,this.layerId=a,this.paintVertexAttributes=e.map(function(t){return{name:"a_"+t,type:"Uint16",components:4,offset:0}}),this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o}function Sa(){this.binders={},this.cacheKey="",this._buffers=[],this._featureMap=new Ho,this._bufferOffset=0}function Ta(t,e,r,i){void 0===i&&(i=function(){return!0}),this.programConfigurations={};for(var n=0,o=e;n<o.length;n+=1){var a=o[n];this.programConfigurations[a.id]=Sa.createDynamic(a,r,i),this.programConfigurations[a.id].layoutAttributes=t}this.needsUpload=!1}function Ea(t,e,r){var i={color:{source:fo,composite:yo},number:{source:Xn,composite:fo}},n={"line-pattern":{source:wn,composite:wn},"fill-pattern":{source:wn,composite:wn},"fill-extrusion-pattern":{source:wn,composite:wn}}[t];return n&&n[r]||i[e][r]}va.prototype.defines=function(){return this.names.map(function(t){return"#define HAS_UNIFORM_u_"+t})},va.prototype.setConstantPatternPositions=function(){},va.prototype.populatePaintArray=function(){},va.prototype.updatePaintArray=function(){},va.prototype.upload=function(){},va.prototype.destroy=function(){},va.prototype.setUniforms=function(t,e,r,i){e.set(i.constantOr(this.value))},va.prototype.getBinding=function(t,e){return"color"===this.type?new sa(t,e):new ia(t,e)},va.serialize=function(t){var e=t.value,r=t.names,i=t.type;return{value:Ti(e),names:r,type:i}},va.deserialize=function(t){var e=t.value,r=t.names,i=t.type;return new va(Ei(e),r,i)},_a.prototype.defines=function(){return this.names.map(function(t){return"#define HAS_UNIFORM_u_"+t})},_a.prototype.populatePaintArray=function(){},_a.prototype.updatePaintArray=function(){},_a.prototype.upload=function(){},_a.prototype.destroy=function(){},_a.prototype.setConstantPatternPositions=function(t,e){this.patternPositions.patternTo=t.tlbr,this.patternPositions.patternFrom=e.tlbr},_a.prototype.setUniforms=function(t,e,r,i,n){var o=this.patternPositions;"u_pattern_to"===n&&o.patternTo&&e.set(o.patternTo),"u_pattern_from"===n&&o.patternFrom&&e.set(o.patternFrom)},_a.prototype.getBinding=function(t,e){return new aa(t,e)},xa.prototype.defines=function(){return[]},xa.prototype.setConstantPatternPositions=function(){},xa.prototype.populatePaintArray=function(t,e,r,i){var n=this.paintVertexArray,o=n.length;n.reserve(t);var a=this.expression.evaluate(new Mi(0),e,{},[],i);if("color"===this.type)for(var s=ya(a),l=o;l<t;l++)n.emplaceBack(s[0],s[1]);else{for(var u=o;u<t;u++)n.emplaceBack(a);this.maxValue=Math.max(this.maxValue,a)}},xa.prototype.updatePaintArray=function(t,e,r,i){var n=this.paintVertexArray,o=this.expression.evaluate({zoom:0},r,i);if("color"===this.type)for(var a=ya(o),s=t;s<e;s++)n.emplace(s,a[0],a[1]);else{for(var l=t;l<e;l++)n.emplace(l,o);this.maxValue=Math.max(this.maxValue,o)}},xa.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},xa.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},xa.prototype.setUniforms=function(t,e){e.set(0)},xa.prototype.getBinding=function(t,e){return new ia(t,e)},ba.prototype.defines=function(){return[]},ba.prototype.setConstantPatternPositions=function(){},ba.prototype.populatePaintArray=function(t,e,r,i){var n=this.paintVertexArray,o=n.length;n.reserve(t);var a=this.expression.evaluate(new Mi(this.zoom),e,{},[],i),s=this.expression.evaluate(new Mi(this.zoom+1),e,{},[],i);if("color"===this.type)for(var l=ya(a),u=ya(s),c=o;c<t;c++)n.emplaceBack(l[0],l[1],u[0],u[1]);else{for(var p=o;p<t;p++)n.emplaceBack(a,s);this.maxValue=Math.max(this.maxValue,a,s)}},ba.prototype.updatePaintArray=function(t,e,r,i){var n=this.paintVertexArray,o=this.expression.evaluate({zoom:this.zoom},r,i),a=this.expression.evaluate({zoom:this.zoom+1},r,i);if("color"===this.type)for(var s=ya(o),l=ya(a),u=t;u<e;u++)n.emplace(u,s[0],s[1],l[0],l[1]);else{for(var c=t;c<e;c++)n.emplace(c,o,a);this.maxValue=Math.max(this.maxValue,o,a)}},ba.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ba.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},ba.prototype.interpolationFactor=function(t){return this.useIntegerZoom?this.expression.interpolationFactor(Math.floor(t),this.zoom,this.zoom+1):this.expression.interpolationFactor(t,this.zoom,this.zoom+1)},ba.prototype.setUniforms=function(t,e,r){e.set(this.interpolationFactor(r.zoom))},ba.prototype.getBinding=function(t,e){return new ia(t,e)},wa.prototype.defines=function(){return[]},wa.prototype.setConstantPatternPositions=function(){},wa.prototype.populatePaintArray=function(t,e,r){var i=this.zoomInPaintVertexArray,n=this.zoomOutPaintVertexArray,o=this.layerId,a=i.length;if(i.reserve(t),n.reserve(t),r&&e.patterns&&e.patterns[o]){var s=e.patterns[o],l=s.min,u=s.mid,c=s.max,p=r[l],h=r[u],d=r[c];if(!p||!h||!d)return;for(var f=a;f<t;f++)i.emplaceBack(h.tl[0],h.tl[1],h.br[0],h.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1]),n.emplaceBack(h.tl[0],h.tl[1],h.br[0],h.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1])}},wa.prototype.updatePaintArray=function(t,e,r,i,n){var o=this.zoomInPaintVertexArray,a=this.zoomOutPaintVertexArray,s=this.layerId;if(n&&r.patterns&&r.patterns[s]){var l=r.patterns[s],u=l.min,c=l.mid,p=l.max,h=n[u],d=n[c],f=n[p];if(!h||!d||!f)return;for(var m=t;m<e;m++)o.emplace(m,d.tl[0],d.tl[1],d.br[0],d.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1]),a.emplace(m,d.tl[0],d.tl[1],d.br[0],d.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1])}},wa.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},wa.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()},wa.prototype.setUniforms=function(t,e){e.set(0)},wa.prototype.getBinding=function(t,e){return new ia(t,e)},Sa.createDynamic=function(t,e,r){var i,n,o=new Sa,a=[];for(var s in t.paint._values)if(r(s)){var l=t.paint.get(s);if(l instanceof Gi&&_r(l.property.specification)){var u=(i=s,n=t.type,{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from"],"fill-pattern":["pattern_to","pattern_from"],"fill-extrusion-pattern":["pattern_to","pattern_from"]}[i]||[i.replace(n+"-","").replace(/-/g,"_")]),c=l.property.specification.type,p=l.property.useIntegerZoom;if("cross-faded"===l.property.specification["property-type"]||"cross-faded-data-driven"===l.property.specification["property-type"])if("constant"===l.value.kind)o.binders[s]=new _a(l.value.value,u,c),a.push("/u_"+s);else{var h=Ea(s,c,"source");o.binders[s]=new wa(l.value,u,c,p,e,h,t.id),a.push("/a_"+s)}else if("constant"===l.value.kind)o.binders[s]=new va(l.value.value,u,c),a.push("/u_"+s);else if("source"===l.value.kind){var d=Ea(s,c,"source");o.binders[s]=new xa(l.value,u,c,d),a.push("/a_"+s)}else{var f=Ea(s,c,"composite");o.binders[s]=new ba(l.value,u,c,p,e,f),a.push("/z_"+s)}}}return o.cacheKey=a.sort().join(""),o},Sa.prototype.populatePaintArrays=function(t,e,r,i,n){for(var o in this.binders)this.binders[o].populatePaintArray(t,e,i,n);void 0!==e.id&&this._featureMap.add(+e.id,r,this._bufferOffset,t),this._bufferOffset=t},Sa.prototype.setConstantPatternPositions=function(t,e){for(var r in this.binders)this.binders[r].setConstantPatternPositions(t,e)},Sa.prototype.updatePaintArrays=function(t,e,r,i){var n=!1;for(var o in t)for(var a=0,s=this._featureMap.getPositions(+o);a<s.length;a+=1){var l=s[a],u=e.feature(l.index);for(var c in this.binders){var p=this.binders[c];if(!(p instanceof va||p instanceof _a)&&!0===p.expression.isStateDependent){var h=r.paint.get(c);p.expression=h.value,p.updatePaintArray(l.start,l.end,u,t[o],i),n=!0}}}return n},Sa.prototype.defines=function(){var t=[];for(var e in this.binders)t.push.apply(t,this.binders[e].defines());return t},Sa.prototype.getPaintVertexBuffers=function(){return this._buffers},Sa.prototype.getUniforms=function(t,e){var r=[];for(var i in this.binders)for(var n=this.binders[i],o=0,a=n.uniformNames;o<a.length;o+=1){var s=a[o];if(e[s]){var l=n.getBinding(t,e[s]);r.push({name:s,property:i,binding:l})}}return r},Sa.prototype.setUniforms=function(t,e,r,i){for(var n=0,o=e;n<o.length;n+=1){var a=o[n],s=a.name,l=a.property,u=a.binding;this.binders[l].setUniforms(t,u,i,r.get(l),s)}},Sa.prototype.updatePatternPaintBuffers=function(t){var e=[];for(var r in this.binders){var i=this.binders[r];if(i instanceof wa){var n=2===t.fromScale?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;n&&e.push(n)}else(i instanceof xa||i instanceof ba)&&i.paintVertexBuffer&&e.push(i.paintVertexBuffer)}this._buffers=e},Sa.prototype.upload=function(t){for(var e in this.binders)this.binders[e].upload(t);var r=[];for(var i in this.binders){var n=this.binders[i];(n instanceof xa||n instanceof ba)&&n.paintVertexBuffer&&r.push(n.paintVertexBuffer)}this._buffers=r},Sa.prototype.destroy=function(){for(var t in this.binders)this.binders[t].destroy()},Ta.prototype.populatePaintArrays=function(t,e,r,i,n){for(var o in this.programConfigurations)this.programConfigurations[o].populatePaintArrays(t,e,r,i,n);this.needsUpload=!0},Ta.prototype.updatePaintArrays=function(t,e,r,i){for(var n=0,o=r;n<o.length;n+=1){var a=o[n];this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(t,e,a,i)||this.needsUpload}},Ta.prototype.get=function(t){return this.programConfigurations[t]},Ta.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},Ta.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},wi("ConstantBinder",va),wi("CrossFadedConstantBinder",_a),wi("SourceExpressionBinder",xa),wi("CrossFadedCompositeBinder",wa),wi("CompositeExpressionBinder",ba),wi("ProgramConfiguration",Sa,{omit:["_buffers"]}),wi("ProgramConfigurationSet",Ta);var Ia=8192,Ca={min:-1*Math.pow(2,14),max:Math.pow(2,14)-1};function ka(t){for(var e=Ia/t.extent,r=t.loadGeometry(),i=0;i<r.length;i++)for(var n=r[i],o=0;o<n.length;o++){var a=n[o];a.x=Math.round(a.x*e),a.y=Math.round(a.y*e),(a.x<Ca.min||a.x>Ca.max||a.y<Ca.min||a.y>Ca.max)&&(ut("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a.x=l(a.x,Ca.min,Ca.max),a.y=l(a.y,Ca.min,Ca.max))}return r}function Aa(t,e,r,i,n){t.emplaceBack(2*e+(i+1)/2,2*r+(n+1)/2)}function Pa(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new cn,this.indexArray=new no,this.segments=new Vo,this.programConfigurations=new Ta(Go,t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})}function Ma(t,e){for(var r=0;r<t.length;r++)if(Ba(e,t[r]))return!0;for(var i=0;i<e.length;i++)if(Ba(t,e[i]))return!0;return!!Da(t,e)}function La(t,e){if(1===t.length)return Na(e,t[0]);for(var r=0;r<e.length;r++)for(var i=e[r],n=0;n<i.length;n++)if(Ba(t,i[n]))return!0;for(var o=0;o<t.length;o++)if(Na(e,t[o]))return!0;for(var a=0;a<e.length;a++)if(Da(t,e[a]))return!0;return!1}function Oa(t,e,r){if(1<t.length){if(Da(t,e))return!0;for(var i=0;i<e.length;i++)if(Ra(e[i],t,r))return!0}for(var n=0;n<t.length;n++)if(Ra(t[n],e,r))return!0;return!1}function Da(t,e){if(0===t.length||0===e.length)return!1;for(var r=0;r<t.length-1;r++)for(var i=t[r],n=t[r+1],o=0;o<e.length-1;o++)if(a=i,s=n,l=e[o],u=e[o+1],b(a,l,u)!==b(s,l,u)&&b(a,s,l)!==b(a,s,u))return!0;var a,s,l,u;return!1}function Ra(t,e,r){var i=r*r;if(1===e.length)return t.distSqr(e[0])<i;for(var n=1;n<e.length;n++)if(za(t,e[n-1],e[n])<i)return!0;return!1}function za(t,e,r){var i=e.distSqr(r);if(0===i)return t.distSqr(e);var n=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/i;return n<0?t.distSqr(e):1<n?t.distSqr(r):t.distSqr(r.sub(e)._mult(n)._add(e))}function Na(t,e){for(var r,i,n,o=!1,a=0;a<t.length;a++)for(var s=0,l=(r=t[a]).length-1;s<r.length;l=s++)i=r[s],n=r[l],i.y>e.y!=n.y>e.y&&e.x<(n.x-i.x)*(e.y-i.y)/(n.y-i.y)+i.x&&(o=!o);return o}function Ba(t,e){for(var r=!1,i=0,n=t.length-1;i<t.length;n=i++){var o=t[i],a=t[n];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(r=!r)}return r}function Fa(t,e,r){var i=r[0],n=r[2];if(t.x<i.x&&e.x<i.x||t.x>n.x&&e.x>n.x||t.y<i.y&&e.y<i.y||t.y>n.y&&e.y>n.y)return!1;var o=b(t,e,r[0]);return o!==b(t,e,r[1])||o!==b(t,e,r[2])||o!==b(t,e,r[3])}function Ua(t,e,r){var i=e.paint.get(t).value;return"constant"===i.kind?i.value:r.programConfigurations.get(e.id).binders[t].maxValue}function ja(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function qa(t,e,r,i,n){if(!e[0]&&!e[1])return t;var o=lt.convert(e)._mult(n);"viewport"===r&&o._rotate(-i);for(var a=[],s=0;s<t.length;s++){var l=t[s];a.push(l.sub(o))}return a}Pa.prototype.populate=function(t,e){var r=this.layers[0],i=[],n=null;"circle"===r.type&&(n=r.layout.get("circle-sort-key"));for(var o=0,a=t;o<a.length;o+=1){var s=a[o],l=s.feature,u=s.index,c=s.sourceLayerIndex;if(this.layers[0]._featureFilter(new Mi(this.zoom),l)){var p=ka(l),h=n?n.evaluate(l,{}):void 0,d={id:l.id,properties:l.properties,type:l.type,sourceLayerIndex:c,index:u,geometry:p,patterns:{},sortKey:h};i.push(d)}}n&&i.sort(function(t,e){return t.sortKey-e.sortKey});for(var f=0,m=i;f<m.length;f+=1){var g=m[f],y=g,v=y.geometry,_=y.index,x=y.sourceLayerIndex,b=t[_].feature;this.addFeature(g,v,_),e.featureIndex.insert(b,v,_,x,this.index)}},Pa.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},Pa.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Pa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Pa.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Go),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Pa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Pa.prototype.addFeature=function(t,e,r){for(var i=0,n=e;i<n.length;i+=1)for(var o=0,a=n[i];o<a.length;o+=1){var s=a[o],l=s.x,u=s.y;if(!(l<0||Ia<=l||u<0||Ia<=u)){var c=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),p=c.vertexLength;Aa(this.layoutVertexArray,l,u,-1,-1),Aa(this.layoutVertexArray,l,u,1,-1),Aa(this.layoutVertexArray,l,u,1,1),Aa(this.layoutVertexArray,l,u,-1,1),this.indexArray.emplaceBack(p,p+1,p+2),this.indexArray.emplaceBack(p,p+3,p+2),c.vertexLength+=4,c.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,{})},wi("CircleBucket",Pa,{omit:["layers"]});var Va,Ga,Za=new $i({"circle-sort-key":new Wi(Lt.layout_circle["circle-sort-key"])}),Ha={paint:new $i({"circle-radius":new Wi(Lt.paint_circle["circle-radius"]),"circle-color":new Wi(Lt.paint_circle["circle-color"]),"circle-blur":new Wi(Lt.paint_circle["circle-blur"]),"circle-opacity":new Wi(Lt.paint_circle["circle-opacity"]),"circle-translate":new Hi(Lt.paint_circle["circle-translate"]),"circle-translate-anchor":new Hi(Lt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Hi(Lt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Hi(Lt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Wi(Lt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Wi(Lt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Wi(Lt.paint_circle["circle-stroke-opacity"])}),layout:Za},Wa="undefined"!=typeof Float32Array?Float32Array:Array;function Ka(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3];return t[0]=r[0]*i+r[4]*n+r[8]*o+r[12]*a,t[1]=r[1]*i+r[5]*n+r[9]*o+r[13]*a,t[2]=r[2]*i+r[6]*n+r[10]*o+r[14]*a,t[3]=r[3]*i+r[7]*n+r[11]*o+r[15]*a,t}Math.PI,Va=new Wa(3),Wa!=Float32Array&&(Va[0]=0,Va[1]=0,Va[2]=0),Ga=new Wa(4),Wa!=Float32Array&&(Ga[0]=0,Ga[1]=0,Ga[2]=0,Ga[3]=0);var Xa,Ya=(Ja.__proto__=Xa=nn,((Ja.prototype=Object.create(Xa&&Xa.prototype)).constructor=Ja).prototype.createBucket=function(t){return new Pa(t)},Ja.prototype.queryRadius=function(t){var e=t;return Ua("circle-radius",this,e)+Ua("circle-stroke-width",this,e)+ja(this.paint.get("circle-translate"))},Ja.prototype.queryIntersectsFeature=function(t,e,r,i,n,o,a,s){for(var l=qa(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,a),u=this.paint.get("circle-radius").evaluate(e,r)+this.paint.get("circle-stroke-width").evaluate(e,r),c="map"===this.paint.get("circle-pitch-alignment"),p=c?l:function(t,e){return l.map(function(t){return Qa(t,e)})}(0,s),h=c?u*a:u,d=0,f=i;d<f.length;d+=1)for(var m=0,g=f[d];m<g.length;m+=1){var y=g[m],v=c?y:Qa(y,s),_=h,x=Ka([],[y.x,y.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?_*=x[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(_*=o.cameraToCenterDistance/x[3]),S=_,Ba(b=p,w=v)||Ra(w,b,S))return!0}var b,w,S;return!1},Ja);function Ja(t){Xa.call(this,t,Ha)}function Qa(t,e){var r=Ka([],[t.x,t.y,0,1],e);return new lt(r[0]/r[3],r[1]/r[3])}var $a,ts=(es.__proto__=$a=Pa,(es.prototype=Object.create($a&&$a.prototype)).constructor=es);function es(){$a.apply(this,arguments)}function rs(t,e,r,i){var n=e.width,o=e.height;if(i){if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==n*o*r)throw new RangeError("mismatched image size")}else i=new Uint8Array(n*o*r);return t.width=n,t.height=o,t.data=i,t}function is(t,e,r){var i=e.width,n=e.height;if(i!==t.width||n!==t.height){var o=rs({},{width:i,height:n},r);ns(t,o,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,i),height:Math.min(t.height,n)},r),t.width=i,t.height=n,t.data=o.data}}function ns(t,e,r,i,n,o){if(0===n.width||0===n.height)return e;if(n.width>t.width||n.height>t.height||r.x>t.width-n.width||r.y>t.height-n.height)throw new RangeError("out of range source coordinates for image copy");if(n.width>e.width||n.height>e.height||i.x>e.width-n.width||i.y>e.height-n.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=t.data,s=e.data,l=0;l<n.height;l++)for(var u=((r.y+l)*t.width+r.x)*o,c=((i.y+l)*e.width+i.x)*o,p=0;p<n.width*o;p++)s[c+p]=a[u+p];return e}wi("HeatmapBucket",ts,{omit:["layers"]});var os=function(t,e){rs(this,t,1,e)};function as(t,e){rs(this,t,4,e)}os.prototype.resize=function(t){is(this,t,1)},os.prototype.clone=function(){return new os({width:this.width,height:this.height},new Uint8Array(this.data))},os.copy=function(t,e,r,i,n){ns(t,e,r,i,n,1)},as.prototype.resize=function(t){is(this,t,4)},as.prototype.replace=function(t,e){e?this.data.set(t):t instanceof Uint8ClampedArray?this.data=new Uint8Array(t.buffer):this.data=t},as.prototype.clone=function(){return new as({width:this.width,height:this.height},new Uint8Array(this.data))},as.copy=function(t,e,r,i,n){ns(t,e,r,i,n,4)},wi("AlphaImage",os),wi("RGBAImage",as);var ss={paint:new $i({"heatmap-radius":new Wi(Lt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Wi(Lt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Hi(Lt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Qi(Lt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Hi(Lt.paint_heatmap["heatmap-opacity"])})};function ls(t,e){for(var r=new Uint8Array(1024),i={},n=0,o=0;n<256;n++,o+=4){i[e]=n/255;var a=t.evaluate(i);r[o+0]=Math.floor(255*a.r/a.a),r[o+1]=Math.floor(255*a.g/a.a),r[o+2]=Math.floor(255*a.b/a.a),r[o+3]=Math.floor(255*a.a)}return new as({width:256,height:1},r)}var us,cs,ps=(vs.__proto__=cs=nn,((vs.prototype=Object.create(cs&&cs.prototype)).constructor=vs).prototype.createBucket=function(t){return new ts(t)},vs.prototype._handleSpecialPaintPropertyUpdate=function(t){"heatmap-color"===t&&this._updateColorRamp()},vs.prototype._updateColorRamp=function(){var t=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=ls(t,"heatmapDensity"),this.colorRampTexture=null},vs.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},vs.prototype.queryRadius=function(){return 0},vs.prototype.queryIntersectsFeature=function(){return!1},vs.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},vs),hs={paint:new $i({"hillshade-illumination-direction":new Hi(Lt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Hi(Lt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Hi(Lt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Hi(Lt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Hi(Lt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Hi(Lt.paint_hillshade["hillshade-accent-color"])})},ds=(ys.__proto__=us=nn,((ys.prototype=Object.create(us&&us.prototype)).constructor=ys).prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},ys),fs=sn([{name:"a_pos",components:2,type:"Int16"}],4).members,ms=_s,gs=_s;function ys(t){us.call(this,t,hs)}function vs(t){cs.call(this,t,ss),this._updateColorRamp()}function _s(t,e,r){r=r||2;var i,n,o,a,s,l,u,c=e&&e.length,p=c?e[0]*r:t.length,h=xs(t,0,p,r,!0),d=[];if(!h||h.next===h.prev)return d;if(c&&(h=function(t,e,r,i){var n,o,a,s=[];for(n=0,o=e.length;n<o;n++)(a=xs(t,e[n]*i,n<o-1?e[n+1]*i:t.length,i,!1))===a.next&&(a.steiner=!0),s.push(Ps(a));for(s.sort(Cs),n=0;n<s.length;n++)ks(s[n],r),r=bs(r,r.next);return r}(t,e,h,r)),t.length>80*r){i=o=t[0],n=a=t[1];for(var f=r;f<p;f+=r)(s=t[f])<i&&(i=s),(l=t[f+1])<n&&(n=l),o<s&&(o=s),a<l&&(a=l);u=0!==(u=Math.max(o-i,a-n))?1/u:0}return ws(h,d,r,i,n,u),d}function xs(t,e,r,i,n){var o,a;if(n===0<qs(t,e,r,i))for(o=e;o<r;o+=i)a=Fs(o,t[o],t[o+1],a);else for(o=r-i;e<=o;o-=i)a=Fs(o,t[o],t[o+1],a);return a&&Os(a,a.next)&&(Us(a),a=a.next),a}function bs(t,e){if(!t)return t;e=e||t;var r,i=t;do{if(r=!1,i.steiner||!Os(i,i.next)&&0!==Ls(i.prev,i,i.next))i=i.next;else{if(Us(i),(i=e=i.prev)===i.next)break;r=!0}}while(r||i!==e);return e}function ws(t,e,r,i,n,o,a){if(t){!a&&o&&function(t,e,r,i){for(var n=t;null===n.z&&(n.z=As(n.x,n.y,e,r,i)),n.prevZ=n.prev,n.nextZ=n.next,(n=n.next)!==t;);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,r,i,n,o,a,s,l,u=1;do{for(r=t,o=t=null,a=0;r;){for(a++,i=r,e=s=0;e<u&&(s++,i=i.nextZ);e++);for(l=u;0<s||0<l&&i;)0!==s&&(0===l||!i||r.z<=i.z)?(r=(n=r).nextZ,s--):(i=(n=i).nextZ,l--),o?o.nextZ=n:t=n,n.prevZ=o,o=n;r=i}o.nextZ=null,u*=2}while(1<a)}(n)}(t,i,n,o);for(var s,l,u=t;t.prev!==t.next;)if(s=t.prev,l=t.next,o?Ts(t,i,n,o):Ss(t))e.push(s.i/r),e.push(t.i/r),e.push(l.i/r),Us(t),t=l.next,u=l.next;else if((t=l)===u){a?1===a?ws(t=Es(bs(t),e,r),e,r,i,n,o,2):2===a&&Is(t,e,r,i,n,o):ws(bs(t),e,r,i,n,o,1);break}}}function Ss(t){var e=t.prev,r=t,i=t.next;if(0<=Ls(e,r,i))return!1;for(var n=t.next.next;n!==t.prev;){if(Ms(e.x,e.y,r.x,r.y,i.x,i.y,n.x,n.y)&&0<=Ls(n.prev,n,n.next))return!1;n=n.next}return!0}function Ts(t,e,r,i){var n=t.prev,o=t,a=t.next;if(0<=Ls(n,o,a))return!1;for(var s=n.x<o.x?n.x<a.x?n.x:a.x:o.x<a.x?o.x:a.x,l=n.y<o.y?n.y<a.y?n.y:a.y:o.y<a.y?o.y:a.y,u=n.x>o.x?n.x>a.x?n.x:a.x:o.x>a.x?o.x:a.x,c=n.y>o.y?n.y>a.y?n.y:a.y:o.y>a.y?o.y:a.y,p=As(s,l,e,r,i),h=As(u,c,e,r,i),d=t.prevZ,f=t.nextZ;d&&d.z>=p&&f&&f.z<=h;){if(d!==t.prev&&d!==t.next&&Ms(n.x,n.y,o.x,o.y,a.x,a.y,d.x,d.y)&&0<=Ls(d.prev,d,d.next))return!1;if(d=d.prevZ,f!==t.prev&&f!==t.next&&Ms(n.x,n.y,o.x,o.y,a.x,a.y,f.x,f.y)&&0<=Ls(f.prev,f,f.next))return!1;f=f.nextZ}for(;d&&d.z>=p;){if(d!==t.prev&&d!==t.next&&Ms(n.x,n.y,o.x,o.y,a.x,a.y,d.x,d.y)&&0<=Ls(d.prev,d,d.next))return!1;d=d.prevZ}for(;f&&f.z<=h;){if(f!==t.prev&&f!==t.next&&Ms(n.x,n.y,o.x,o.y,a.x,a.y,f.x,f.y)&&0<=Ls(f.prev,f,f.next))return!1;f=f.nextZ}return!0}function Es(t,e,r){var i=t;do{var n=i.prev,o=i.next.next;!Os(n,o)&&Ds(n,i,i.next,o)&&Ns(n,o)&&Ns(o,n)&&(e.push(n.i/r),e.push(i.i/r),e.push(o.i/r),Us(i),Us(i.next),i=t=o),i=i.next}while(i!==t);return bs(i)}function Is(t,e,r,i,n,o){var a,s,l=t;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&(s=u,(a=l).next.i!==s.i&&a.prev.i!==s.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Ds(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(a,s)&&(Ns(a,s)&&Ns(s,a)&&function(t,e){for(var r=t,i=!1,n=(t.x+e.x)/2,o=(t.y+e.y)/2;r.y>o!=r.next.y>o&&r.next.y!==r.y&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(i=!i),(r=r.next)!==t;);return i}(a,s)&&(Ls(a.prev,a,s.prev)||Ls(a,s.prev,s))||Os(a,s)&&0<Ls(a.prev,a,a.next)&&0<Ls(s.prev,s,s.next)))){var c=Bs(l,u);return l=bs(l,l.next),c=bs(c,c.next),ws(l,e,r,i,n,o),void ws(c,e,r,i,n,o)}u=u.next}l=l.next}while(l!==t)}function Cs(t,e){return t.x-e.x}function ks(t,e){if(e=function(t,e){var r,i=e,n=t.x,o=t.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=n&&a<s){if((a=s)===n){if(o===i.y)return i;if(o===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!r)return null;if(n===a)return r;var l,u,c,p=r,h=r.x,d=r.y,f=1/0;for(i=r;n>=i.x&&i.x>=h&&n!==i.x&&Ms(o<d?n:a,o,h,d,o<d?a:n,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(n-i.x),Ns(i,t)&&(l<f||l===f&&(i.x>r.x||i.x===r.x&&(c=i,(Ls((u=r).prev,u,c.prev)<0||Ls(c.prev,u,u.next)<0)&&(Ls(u.prev,u,c.next)<0||Ls(c.next,u,u.next)<0))))&&(r=i,f=l)),(i=i.next)!==p;);return r}(t,e)){var r=Bs(e,t);bs(r,r.next)}}function As(t,e,r,i,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Ps(t){for(var e=t,r=t;(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),(e=e.next)!==t;);return r}function Ms(t,e,r,i,n,o,a,s){return 0<=(n-a)*(e-s)-(t-a)*(o-s)&&0<=(t-a)*(i-s)-(r-a)*(e-s)&&0<=(r-a)*(o-s)-(n-a)*(i-s)}function Ls(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Os(t,e){return t.x===e.x&&t.y===e.y}function Ds(t,e,r,i){var n=zs(Ls(t,e,r)),o=zs(Ls(t,e,i)),a=zs(Ls(r,i,t)),s=zs(Ls(r,i,e));return n!==o&&a!==s||!(0!==n||!Rs(t,r,e))||!(0!==o||!Rs(t,i,e))||!(0!==a||!Rs(r,t,i))||!(0!==s||!Rs(r,e,i))}function Rs(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function zs(t){return 0<t?1:t<0?-1:0}function Ns(t,e){return Ls(t.prev,t,t.next)<0?0<=Ls(t,e,t.next)&&0<=Ls(t,t.prev,e):Ls(t,e,t.prev)<0||Ls(t,t.next,e)<0}function Bs(t,e){var r=new js(t.i,t.x,t.y),i=new js(e.i,e.x,e.y),n=t.next,o=e.prev;return(t.next=e).prev=t,(r.next=n).prev=r,(i.next=r).prev=i,(o.next=i).prev=o,i}function Fs(t,e,r,i){var n=new js(t,e,r);return i?(n.next=i.next,(n.prev=i).next.prev=n,i.next=n):(n.prev=n).next=n,n}function Us(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function js(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function qs(t,e,r,i){for(var n=0,o=e,a=r-i;o<r;o+=i)n+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return n}function Vs(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function Gs(t,e){return t<e?-1:e<t?1:0}function Zs(t,e){var r,i,n,o,a,s=t.length;if(s<=1)return[t];for(var l,u,c=[],p=0;p<s;p++){var h=w(t[p]);0!==h&&(t[p].area=Math.abs(h),void 0===u&&(u=h<0),u===h<0?(l&&c.push(l),l=[t[p]]):l.push(t[p]))}if(l&&c.push(l),1<e)for(var d=0;d<c.length;d++)c[d].length<=e||(r=c[d],i=e,n=1,o=c[d].length-1,a=Hs,function t(e,r,i,n,o){for(;i<n;){if(600<n-i){var a=n-i+1,s=r-i+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(s-a/2<0?-1:1);t(e,r,Math.max(i,Math.floor(r-s*u/a+c)),Math.min(n,Math.floor(r+(a-s)*u/a+c)),o)}var p=e[r],h=i,d=n;for(Vs(e,i,r),0<o(e[n],p)&&Vs(e,i,n);h<d;){for(Vs(e,h,d),h++,d--;o(e[h],p)<0;)h++;for(;0<o(e[d],p);)d--}0===o(e[i],p)?Vs(e,i,d):Vs(e,++d,n),d<=r&&(i=d+1),r<=d&&(n=d-1)}}(r,i,n||0,o||r.length-1,a||Gs),c[d]=c[d].slice(0,e));return c}function Hs(t,e){return e.area-t.area}function Ws(t,e,r){for(var i=r.patternDependencies,n=!1,o=0,a=e;o<a.length;o+=1){var s=a[o].paint.get(t+"-pattern");s.isConstant()||(n=!0);var l=s.constantOr(null);l&&(n=!0,i[l.to]=!0,i[l.from]=!0)}return n}function Ks(t,e,r,i,n){for(var o=n.patternDependencies,a=0,s=e;a<s.length;a+=1){var l=s[a],u=l.paint.get(t+"-pattern").value;if("constant"!==u.kind){var c=u.evaluate({zoom:i-1},r,{},n.availableImages),p=u.evaluate({zoom:i},r,{},n.availableImages),h=u.evaluate({zoom:i+1},r,{},n.availableImages);c=c&&c.name?c.name:c,p=p&&p.name?p.name:p,h=h&&h.name?h.name:h,o[c]=!0,o[p]=!0,o[h]=!0,r.patterns[l.id]={min:c,mid:p,max:h}}}return r}function Xs(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new cn,this.indexArray=new no,this.indexArray2=new so,this.programConfigurations=new Ta(fs,t.layers,t.zoom),this.segments=new Vo,this.segments2=new Vo,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})}_s.deviation=function(t,e,r,i){var n=e&&e.length,o=n?e[0]*r:t.length,a=Math.abs(qs(t,0,o,r));if(n)for(var s=0,l=e.length;s<l;s++){var u=e[s]*r,c=s<l-1?e[s+1]*r:t.length;a-=Math.abs(qs(t,u,c,r))}var p=0;for(s=0;s<i.length;s+=3){var h=i[s]*r,d=i[s+1]*r,f=i[s+2]*r;p+=Math.abs((t[h]-t[f])*(t[1+d]-t[1+h])-(t[h]-t[d])*(t[1+f]-t[1+h]))}return 0===a&&0===p?0:Math.abs((p-a)/a)},_s.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},i=0,n=0;n<t.length;n++){for(var o=0;o<t[n].length;o++)for(var a=0;a<e;a++)r.vertices.push(t[n][o][a]);0<n&&(i+=t[n-1].length,r.holes.push(i))}return r},ms.default=gs,Xs.prototype.populate=function(t,e){this.hasPattern=Ws("fill",this.layers,e);for(var r=this.layers[0].layout.get("fill-sort-key"),i=[],n=0,o=t;n<o.length;n+=1){var a=o[n],s=a.feature,l=a.index,u=a.sourceLayerIndex;if(this.layers[0]._featureFilter(new Mi(this.zoom),s)){var c=ka(s),p=r?r.evaluate(s,{},e.availableImages):void 0,h={id:s.id,properties:s.properties,type:s.type,sourceLayerIndex:u,index:l,geometry:c,patterns:{},sortKey:p};i.push(h)}}r&&i.sort(function(t,e){return t.sortKey-e.sortKey});for(var d=0,f=i;d<f.length;d+=1){var m=f[d],g=m,y=g.geometry,v=g.index,_=g.sourceLayerIndex;if(this.hasPattern){var x=Ks("fill",this.layers,m,this.zoom,e);this.patternFeatures.push(x)}else this.addFeature(m,y,v,{});var b=t[v].feature;e.featureIndex.insert(b,y,v,_,this.index)}},Xs.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},Xs.prototype.addFeatures=function(t,e){for(var r=0,i=this.patternFeatures;r<i.length;r+=1){var n=i[r];this.addFeature(n,n.geometry,n.index,e)}},Xs.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Xs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Xs.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,fs),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},Xs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Xs.prototype.addFeature=function(t,e,r,i){for(var n=0,o=Zs(e,500);n<o.length;n+=1){for(var a=o[n],s=0,l=0,u=a;l<u.length;l+=1)s+=u[l].length;for(var c=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray),p=c.vertexLength,h=[],d=[],f=0,m=a;f<m.length;f+=1){var g=m[f];if(0!==g.length){g!==a[0]&&d.push(h.length/2);var y=this.segments2.prepareSegment(g.length,this.layoutVertexArray,this.indexArray2),v=y.vertexLength;this.layoutVertexArray.emplaceBack(g[0].x,g[0].y),this.indexArray2.emplaceBack(v+g.length-1,v),h.push(g[0].x),h.push(g[0].y);for(var _=1;_<g.length;_++)this.layoutVertexArray.emplaceBack(g[_].x,g[_].y),this.indexArray2.emplaceBack(v+_-1,v+_),h.push(g[_].x),h.push(g[_].y);y.vertexLength+=g.length,y.primitiveLength+=g.length}}for(var x=ms(h,d),b=0;b<x.length;b+=3)this.indexArray.emplaceBack(p+x[b],p+x[b+1],p+x[b+2]);c.vertexLength+=s,c.primitiveLength+=x.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,i)},wi("FillBucket",Xs,{omit:["layers","patternFeatures"]});var Ys,Js=new $i({"fill-sort-key":new Wi(Lt.layout_fill["fill-sort-key"])}),Qs={paint:new $i({"fill-antialias":new Hi(Lt.paint_fill["fill-antialias"]),"fill-opacity":new Wi(Lt.paint_fill["fill-opacity"]),"fill-color":new Wi(Lt.paint_fill["fill-color"]),"fill-outline-color":new Wi(Lt.paint_fill["fill-outline-color"]),"fill-translate":new Hi(Lt.paint_fill["fill-translate"]),"fill-translate-anchor":new Hi(Lt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Yi(Lt.paint_fill["fill-pattern"])}),layout:Js},$s=(rl.__proto__=Ys=nn,((rl.prototype=Object.create(Ys&&Ys.prototype)).constructor=rl).prototype.recalculate=function(t,e){Ys.prototype.recalculate.call(this,t,e);var r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},rl.prototype.createBucket=function(t){return new Xs(t)},rl.prototype.queryRadius=function(){return ja(this.paint.get("fill-translate"))},rl.prototype.queryIntersectsFeature=function(t,e,r,i,n,o,a){return La(qa(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,a),i)},rl.prototype.isTileClipped=function(){return!0},rl),tl=sn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,el=il;function rl(t){Ys.call(this,t,Qs)}function il(t,e,r,i,n){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=n,t.readFields(nl,this,e)}function nl(t,e,r){1==t?e.id=r.readVarint():2==t?function(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;){var i=e._keys[t.readVarint()],n=e._values[t.readVarint()];e.properties[i]=n}}(r,e):3==t?e.type=r.readVarint():4==t&&(e._geometry=r.pos)}function ol(t){for(var e,r,i=0,n=0,o=t.length,a=o-1;n<o;a=n++)e=t[n],i+=((r=t[a]).x-e.x)*(e.y+r.y);return i}il.types=["Unknown","Point","LineString","Polygon"],il.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,i=1,n=0,o=0,a=0,s=[];t.pos<r;){if(n<=0){var l=t.readVarint();i=7&l,n=l>>3}if(n--,1===i||2===i)o+=t.readSVarint(),a+=t.readSVarint(),1===i&&(e&&s.push(e),e=[]),e.push(new lt(o,a));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&s.push(e),s},il.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,i=0,n=0,o=0,a=1/0,s=-1/0,l=1/0,u=-1/0;t.pos<e;){if(i<=0){var c=t.readVarint();r=7&c,i=c>>3}if(i--,1===r||2===r)(n+=t.readSVarint())<a&&(a=n),s<n&&(s=n),(o+=t.readSVarint())<l&&(l=o),u<o&&(u=o);else if(7!==r)throw new Error("unknown command "+r)}return[a,l,s,u]},il.prototype.toGeoJSON=function(t,e,r){var i,n,o=this.extent*Math.pow(2,r),a=this.extent*t,s=this.extent*e,l=this.loadGeometry(),u=il.types[this.type];function c(t){for(var e=0;e<t.length;e++){var r=t[e],i=180-360*(r.y+s)/o;t[e]=[360*(r.x+a)/o-180,360/Math.PI*Math.atan(Math.exp(i*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(i=0;i<l.length;i++)p[i]=l[i][0];c(l=p);break;case 2:for(i=0;i<l.length;i++)c(l[i]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var r,i,n=[],o=0;o<e;o++){var a=ol(t[o]);0!==a&&(void 0===i&&(i=a<0),i===a<0?(r&&n.push(r),r=[t[o]]):r.push(t[o]))}return r&&n.push(r),n}(l),i=0;i<l.length;i++)for(n=0;n<l[i].length;n++)c(l[i][n])}1===l.length?l=l[0]:u="Multi"+u;var h={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(h.id=this.id),h};var al=sl;function sl(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(ll,this,e),this.length=this._features.length}function ll(t,e,r){15===t?e.version=r.readVarint():1===t?e.name=r.readString():5===t?e.extent=r.readVarint():2===t?e._features.push(r.pos):3===t?e._keys.push(r.readString()):4===t&&e._values.push(function(t){for(var e=null,r=t.readVarint()+t.pos;t.pos<r;){var i=t.readVarint()>>3;e=1==i?t.readString():2==i?t.readFloat():3==i?t.readDouble():4==i?t.readVarint64():5==i?t.readVarint():6==i?t.readSVarint():7==i?t.readBoolean():null}return e}(r))}function ul(t,e,r){if(3===t){var i=new al(r,r.readVarint()+r.pos);i.length&&(e[i.name]=i)}}sl.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new el(this._pbf,e,this.extent,this._keys,this._values)};var cl={VectorTile:function(t,e){this.layers=t.readFields(ul,{},e)},VectorTileFeature:el,VectorTileLayer:al},pl=cl.VectorTileFeature.types,hl=Math.pow(2,13);function dl(t,e,r,i,n,o,a,s){t.emplaceBack(e,r,2*Math.floor(i*hl)+a,n*hl*2,o*hl*2,Math.round(s))}function fl(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new gn,this.indexArray=new no,this.programConfigurations=new Ta(tl,t.layers,t.zoom),this.segments=new Vo,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})}fl.prototype.populate=function(t,e){this.features=[],this.hasPattern=Ws("fill-extrusion",this.layers,e);for(var r=0,i=t;r<i.length;r+=1){var n=i[r],o=n.feature,a=n.index,s=n.sourceLayerIndex;if(this.layers[0]._featureFilter(new Mi(this.zoom),o)){var l=ka(o),u={sourceLayerIndex:s,index:a,geometry:l,properties:o.properties,type:o.type,patterns:{}};void 0!==o.id&&(u.id=o.id),this.hasPattern?this.features.push(Ks("fill-extrusion",this.layers,u,this.zoom,e)):this.addFeature(u,l,a,{}),e.featureIndex.insert(o,l,a,s,this.index,!0)}}},fl.prototype.addFeatures=function(t,e){for(var r=0,i=this.features;r<i.length;r+=1){var n=i[r],o=n.geometry;this.addFeature(n,o,n.index,e)}},fl.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},fl.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},fl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},fl.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,tl),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},fl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},fl.prototype.addFeature=function(t,e,r,i){for(var n=0,o=Zs(e,500);n<o.length;n+=1){for(var a=o[n],s=0,l=0,u=a;l<u.length;l+=1)s+=u[l].length;for(var c=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),p=0,h=a;p<h.length;p+=1){var d=h[p];if(0!==d.length&&!((O=d).every(function(t){return t.x<0})||O.every(function(t){return t.x>Ia})||O.every(function(t){return t.y<0})||O.every(function(t){return t.y>Ia})))for(var f=0,m=0;m<d.length;m++){var g=d[m];if(1<=m){var y=d[m-1];if(L=y,!((M=g).x===L.x&&(M.x<0||M.x>Ia)||M.y===L.y&&(M.y<0||M.y>Ia))){c.vertexLength+4>Vo.MAX_VERTEX_ARRAY_LENGTH&&(c=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var v=g.sub(y)._perp()._unit(),_=y.dist(g);32768<f+_&&(f=0),dl(this.layoutVertexArray,g.x,g.y,v.x,v.y,0,0,f),dl(this.layoutVertexArray,g.x,g.y,v.x,v.y,0,1,f),f+=_,dl(this.layoutVertexArray,y.x,y.y,v.x,v.y,0,0,f),dl(this.layoutVertexArray,y.x,y.y,v.x,v.y,0,1,f);var x=c.vertexLength;this.indexArray.emplaceBack(x,x+2,x+1),this.indexArray.emplaceBack(x+1,x+2,x+3),c.vertexLength+=4,c.primitiveLength+=2}}}}if(c.vertexLength+s>Vo.MAX_VERTEX_ARRAY_LENGTH&&(c=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray)),"Polygon"===pl[t.type]){for(var b=[],w=[],S=c.vertexLength,T=0,E=a;T<E.length;T+=1){var I=E[T];if(0!==I.length){I!==a[0]&&w.push(b.length/2);for(var C=0;C<I.length;C++){var k=I[C];dl(this.layoutVertexArray,k.x,k.y,0,0,1,1,0),b.push(k.x),b.push(k.y)}}}for(var A=ms(b,w),P=0;P<A.length;P+=3)this.indexArray.emplaceBack(S+A[P],S+A[P+2],S+A[P+1]);c.primitiveLength+=A.length/3,c.vertexLength+=s}}var M,L,O;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,i)},wi("FillExtrusionBucket",fl,{omit:["layers","features"]});var ml,gl={paint:new $i({"fill-extrusion-opacity":new Hi(Lt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Wi(Lt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Hi(Lt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Hi(Lt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Yi(Lt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Wi(Lt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Wi(Lt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Hi(Lt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},yl=(vl.__proto__=ml=nn,((vl.prototype=Object.create(ml&&ml.prototype)).constructor=vl).prototype.createBucket=function(t){return new fl(t)},vl.prototype.queryRadius=function(){return ja(this.paint.get("fill-extrusion-translate"))},vl.prototype.is3D=function(){return!0},vl.prototype.queryIntersectsFeature=function(t,e,r,i,n,o,a,s){var l=qa(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,a),u=this.paint.get("fill-extrusion-height").evaluate(e,r),c=this.paint.get("fill-extrusion-base").evaluate(e,r),p=function(t,e){for(var r=[],i=0,n=l;i<n.length;i+=1){var o=n[i],a=[o.x,o.y,0,1];Ka(a,a,e),r.push(new lt(a[0]/a[3],a[1]/a[3]))}return r}(0,s),h=function(t,e,r,i){for(var n=[],o=[],a=i[8]*e,s=i[9]*e,l=i[10]*e,u=i[11]*e,c=i[8]*r,p=i[9]*r,h=i[10]*r,d=i[11]*r,f=0,m=t;f<m.length;f+=1){for(var g=[],y=[],v=0,_=m[f];v<_.length;v+=1){var x=_[v],b=x.x,w=x.y,S=i[0]*b+i[4]*w+i[12],T=i[1]*b+i[5]*w+i[13],E=i[2]*b+i[6]*w+i[14],I=i[3]*b+i[7]*w+i[15],C=E+l,k=I+u,A=S+c,P=T+p,M=E+h,L=I+d,O=new lt((S+a)/k,(T+s)/k);O.z=C/k,g.push(O);var D=new lt(A/L,P/L);D.z=M/L,y.push(D)}n.push(g),o.push(y)}return[n,o]}(i,c,u,s);return function(t,e,r){var i=1/0;La(r,e)&&(i=xl(r,e[0]));for(var n=0;n<e.length;n++)for(var o=e[n],a=t[n],s=0;s<o.length-1;s++){var l=o[s],u=o[s+1],c=a[s],p=[l,u,a[s+1],c,l];Ma(r,p)&&(i=Math.min(i,xl(r,p)))}return i!==1/0&&i}(h[0],h[1],p)},vl);function vl(t){ml.call(this,t,gl)}function _l(t,e){return t.x*e.x+t.y*e.y}function xl(t,e){if(1===t.length){var r=e[0],i=e[1],n=e[3],o=t[0],a=i.sub(r),s=n.sub(r),l=o.sub(r),u=_l(a,a),c=_l(a,s),p=_l(s,s),h=_l(l,a),d=_l(l,s),f=u*p-c*c,m=(p*h-c*d)/f,g=(u*d-c*h)/f,y=1-m-g;return r.z*y+i.z*m+n.z*g}for(var v=1/0,_=0,x=e;_<x.length;_+=1){var b=x[_];v=Math.min(v,b.z)}return v}function bl(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new _n,this.indexArray=new no,this.programConfigurations=new Ta(wl,t.layers,t.zoom),this.segments=new Vo,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})}var wl=sn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Sl=cl.VectorTileFeature.types,Tl=Math.cos(Math.PI/180*37.5),El=Math.pow(2,14)/.5;bl.prototype.populate=function(t,e){this.hasPattern=Ws("line",this.layers,e);for(var r=this.layers[0].layout.get("line-sort-key"),i=[],n=0,o=t;n<o.length;n+=1){var a=o[n],s=a.feature,l=a.index,u=a.sourceLayerIndex;if(this.layers[0]._featureFilter(new Mi(this.zoom),s)){var c=ka(s),p=r?r.evaluate(s,{}):void 0,h={id:s.id,properties:s.properties,type:s.type,sourceLayerIndex:u,index:l,geometry:c,patterns:{},sortKey:p};i.push(h)}}r&&i.sort(function(t,e){return t.sortKey-e.sortKey});for(var d=0,f=i;d<f.length;d+=1){var m=f[d],g=m,y=g.geometry,v=g.index,_=g.sourceLayerIndex;if(this.hasPattern){var x=Ks("line",this.layers,m,this.zoom,e);this.patternFeatures.push(x)}else this.addFeature(m,y,v,{});var b=t[v].feature;e.featureIndex.insert(b,y,v,_,this.index)}},bl.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},bl.prototype.addFeatures=function(t,e){for(var r=0,i=this.patternFeatures;r<i.length;r+=1){var n=i[r];this.addFeature(n,n.geometry,n.index,e)}},bl.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},bl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},bl.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,wl),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},bl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},bl.prototype.addFeature=function(t,e,r,i){for(var n=this.layers[0].layout,o=n.get("line-join").evaluate(t,{}),a=n.get("line-cap"),s=n.get("line-miter-limit"),l=n.get("line-round-limit"),u=0,c=e;u<c.length;u+=1){var p=c[u];this.addLine(p,t,o,a,s,l,r,i)}},bl.prototype.addLine=function(t,e,r,i,n,o,a,s){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+e.properties.mapbox_clip_start,this.clipEnd=+e.properties.mapbox_clip_end;for(var l=0;l<t.length-1;l++)this.totalDistance+=t[l].dist(t[l+1])}for(var u="Polygon"===Sl[e.type],c=t.length;2<=c&&t[c-1].equals(t[c-2]);)c--;for(var p=0;p<c-1&&t[p].equals(t[p+1]);)p++;if(!(c<(u?3:2))){"bevel"===r&&(n=1.05);var h,d=Ia/(512*this.overscaling)*15,f=this.segments.prepareSegment(10*c,this.layoutVertexArray,this.indexArray),m=void 0,g=void 0,y=void 0,v=void 0;this.e1=this.e2=-1,u&&(h=t[c-2],v=t[p].sub(h)._unit()._perp());for(var _=p;_<c;_++)if(!(g=u&&_===c-1?t[p+1]:t[_+1])||!t[_].equals(g)){v&&(y=v),h&&(m=h),h=t[_],v=g?g.sub(h)._unit()._perp():y;var x=(y=y||v).add(v);0===x.x&&0===x.y||x._unit();var b=y.x*v.x+y.y*v.y,w=x.x*v.x+x.y*v.y,S=0!=w?1/w:1/0,T=2*Math.sqrt(2-2*w),E=w<Tl&&m&&g,I=0<y.x*v.y-y.y*v.x;if(E&&p<_){var C=h.dist(m);if(2*d<C){var k=h.sub(h.sub(m)._mult(d/C)._round());this.updateDistance(m,k),this.addCurrentVertex(k,y,0,0,f),m=k}}var A=m&&g,P=A?r:u?"butt":i;if(A&&"round"===P&&(S<o?P="miter":S<=2&&(P="fakeround")),"miter"===P&&n<S&&(P="bevel"),"bevel"===P&&(2<S&&(P="flipbevel"),S<n&&(P="miter")),m&&this.updateDistance(m,h),"miter"===P)x._mult(S),this.addCurrentVertex(h,x,0,0,f);else if("flipbevel"===P){if(100<S)x=v.mult(-1);else{var M=S*y.add(v).mag()/y.sub(v).mag();x._perp()._mult(M*(I?-1:1))}this.addCurrentVertex(h,x,0,0,f),this.addCurrentVertex(h,x.mult(-1),0,0,f)}else if("bevel"===P||"fakeround"===P){var L=-Math.sqrt(S*S-1),O=I?L:0,D=I?0:L;if(m&&this.addCurrentVertex(h,y,O,D,f),"fakeround"===P)for(var R=Math.round(180*T/Math.PI/20),z=1;z<R;z++){var N=z/R;if(.5!==N){var B=N-.5;N+=N*B*(N-1)*((1.0904+b*(b*(3.55645-1.43519*b)-3.2452))*B*B+(.848013+b*(.215638*b-1.06021)))}var F=v.sub(y)._mult(N)._add(y)._unit()._mult(I?-1:1);this.addHalfVertex(h,F.x,F.y,!1,I,0,f)}g&&this.addCurrentVertex(h,v,-O,-D,f)}else if("butt"===P)this.addCurrentVertex(h,x,0,0,f);else if("square"===P){var U=m?1:-1;this.addCurrentVertex(h,x,U,U,f)}else"round"===P&&(m&&(this.addCurrentVertex(h,y,0,0,f),this.addCurrentVertex(h,y,1,1,f,!0)),g&&(this.addCurrentVertex(h,v,-1,-1,f,!0),this.addCurrentVertex(h,v,0,0,f)));if(E&&_<c-1){var j=h.dist(g);if(2*d<j){var q=h.add(g.sub(h)._mult(d/j)._round());this.updateDistance(h,q),this.addCurrentVertex(q,v,0,0,f),h=q}}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,s)}},bl.prototype.addCurrentVertex=function(t,e,r,i,n,o){void 0===o&&(o=!1);var a=e.x+e.y*r,s=e.y-e.x*r,l=-e.x+e.y*i,u=-e.y-e.x*i;this.addHalfVertex(t,a,s,o,!1,r,n),this.addHalfVertex(t,l,u,o,!0,-i,n),this.distance>El/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,e,r,i,n,o))},bl.prototype.addHalfVertex=function(t,e,r,i,n,o,a){var s=t.x,l=t.y,u=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((s<<1)+(i?1:0),(l<<1)+(n?1:0),Math.round(63*e)+128,Math.round(63*r)+128,1+(0===o?0:o<0?-1:1)|(63&u)<<2,u>>6);var c=a.vertexLength++;0<=this.e1&&0<=this.e2&&(this.indexArray.emplaceBack(this.e1,this.e2,c),a.primitiveLength++),n?this.e2=c:this.e1=c},bl.prototype.updateDistance=function(t,e){this.distance+=t.dist(e),this.scaledDistance=0<this.totalDistance?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(El-1):this.distance},wi("LineBucket",bl,{omit:["layers","patternFeatures"]});var Il,Cl=new $i({"line-cap":new Hi(Lt.layout_line["line-cap"]),"line-join":new Wi(Lt.layout_line["line-join"]),"line-miter-limit":new Hi(Lt.layout_line["line-miter-limit"]),"line-round-limit":new Hi(Lt.layout_line["line-round-limit"]),"line-sort-key":new Wi(Lt.layout_line["line-sort-key"])}),kl={paint:new $i({"line-opacity":new Wi(Lt.paint_line["line-opacity"]),"line-color":new Wi(Lt.paint_line["line-color"]),"line-translate":new Hi(Lt.paint_line["line-translate"]),"line-translate-anchor":new Hi(Lt.paint_line["line-translate-anchor"]),"line-width":new Wi(Lt.paint_line["line-width"]),"line-gap-width":new Wi(Lt.paint_line["line-gap-width"]),"line-offset":new Wi(Lt.paint_line["line-offset"]),"line-blur":new Wi(Lt.paint_line["line-blur"]),"line-dasharray":new Ki(Lt.paint_line["line-dasharray"]),"line-pattern":new Yi(Lt.paint_line["line-pattern"]),"line-gradient":new Qi(Lt.paint_line["line-gradient"])}),layout:Cl},Al=(Pl.__proto__=Il=Wi,((Pl.prototype=Object.create(Il&&Il.prototype)).constructor=Pl).prototype.possiblyEvaluate=function(t,e){return e=new Mi(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),Il.prototype.possiblyEvaluate.call(this,t,e)},Pl.prototype.evaluate=function(t,e,r,i){return e=f({},e,{zoom:Math.floor(e.zoom)}),Il.prototype.evaluate.call(this,t,e,r,i)},new Pl(kl.paint.properties["line-width"].specification));function Pl(){Il.apply(this,arguments)}Al.useIntegerZoom=!0;var Ml,Ll=(Ol.__proto__=Ml=nn,((Ol.prototype=Object.create(Ml&&Ml.prototype)).constructor=Ol).prototype._handleSpecialPaintPropertyUpdate=function(t){"line-gradient"===t&&this._updateGradient()},Ol.prototype._updateGradient=function(){var t=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=ls(t,"lineProgress"),this.gradientTexture=null},Ol.prototype.recalculate=function(t,e){Ml.prototype.recalculate.call(this,t,e),this.paint._values["line-floorwidth"]=Al.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)},Ol.prototype.createBucket=function(t){return new bl(t)},Ol.prototype.queryRadius=function(t){var e=t,r=Dl(Ua("line-width",this,e),Ua("line-gap-width",this,e)),i=Ua("line-offset",this,e);return r/2+Math.abs(i)+ja(this.paint.get("line-translate"))},Ol.prototype.queryIntersectsFeature=function(t,e,r,i,n,o,a){var s=qa(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,a),l=a/2*Dl(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),u=this.paint.get("line-offset").evaluate(e,r);return u&&(i=function(t,e){for(var r=[],i=new lt(0,0),n=0;n<t.length;n++){for(var o=t[n],a=[],s=0;s<o.length;s++){var l=o[s-1],u=o[s],c=o[s+1],p=0===s?i:u.sub(l)._unit()._perp(),h=s===o.length-1?i:c.sub(u)._unit()._perp(),d=p._add(h)._unit(),f=d.x*h.x+d.y*h.y;d._mult(1/f),a.push(d._mult(e)._add(u))}r.push(a)}return r}(i,u*a)),function(t,e,r){for(var i=0;i<e.length;i++){var n=e[i];if(3<=t.length)for(var o=0;o<n.length;o++)if(Ba(t,n[o]))return!0;if(Oa(t,n,r))return!0}return!1}(s,i,l)},Ol.prototype.isTileClipped=function(){return!0},Ol);function Ol(t){Ml.call(this,t,kl)}function Dl(t,e){return 0<e?e+2*t:t}var Rl=sn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}]),zl=sn([{name:"a_projected_pos",components:3,type:"Float32"}],4),Nl=(sn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),sn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Bl=(sn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),sn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Fl=sn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);function Ul(t,n,o){return t.sections.forEach(function(t){var e,r,i;t.text=(e=t.text,r=o,"uppercase"===(i=n.layout.get("text-transform").evaluate(r,{}))?e=e.toLocaleUpperCase():"lowercase"===i&&(e=e.toLocaleLowerCase()),Ni.applyArabicShaping&&(e=Ni.applyArabicShaping(e)),e)}),t}function jl(){this.text="",this.sectionIndex=[],this.sections=[]}sn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),sn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"}]),sn([{type:"Float32",name:"offsetX"}]),sn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var ql={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},Vl=24,Gl={horizontal:1,vertical:2,horizontalOnly:3};function Zl(t,e,r,i,n,o,a,s,l,u,c,p){var h,d=jl.fromFeature(t,r);u===Gl.vertical&&d.verticalizePunctuation();var f=Ni.processBidirectionalText,m=Ni.processStyledBidirectionalText;if(f&&1===d.sections.length){h=[];for(var g=0,y=f(d.toString(),Yl(d,s,i,e,p));g<y.length;g+=1){var v=y[g],_=new jl;_.text=v,_.sections=d.sections;for(var x=0;x<v.length;x++)_.sectionIndex.push(0);h.push(_)}}else if(m){h=[];for(var b=0,w=m(d.text,d.sectionIndex,Yl(d,s,i,e,p));b<w.length;b+=1){var S=w[b],T=new jl;T.text=S[0],T.sectionIndex=S[1],T.sections=d.sections,h.push(T)}}else h=function(t,e){for(var r=[],i=t.text,n=0,o=0,a=e;o<a.length;o+=1){var s=a[o];r.push(t.substring(n,s)),n=s}return n<i.length&&r.push(t.substring(n,i.length)),r}(d,Yl(d,s,i,e,p));var E=[],I={positionedGlyphs:E,text:d.toString(),top:l[1],bottom:l[1],left:l[0],right:l[0],writingMode:u,lineCount:h.length,yOffset:-17};return function(t,e,u,r,i,n,o,a,s){for(var l=0,c=t.yOffset,p=0,h=t.positionedGlyphs,d="right"===n?1:"left"===n?0:.5,f=0,m=u;f<m.length;f+=1){var g=m[f];g.trim();var y=g.getMaxScale();if(g.length()){for(var v=h.length,_=0;_<g.length();_++){var x=g.getSection(_),b=g.getSectionIndex(_),w=g.getCharCode(_),S=24*(y-x.scale),T=e[x.fontStack],E=T&&T[w];E&&(o===Gl.horizontal||!s&&!Ai(w)||s&&(Hl[w]||(C=w,Ci.Arabic(C)||Ci["Arabic Supplement"](C)||Ci["Arabic Extended-A"](C)||Ci["Arabic Presentation Forms-A"](C)||Ci["Arabic Presentation Forms-B"](C)))?(h.push({glyph:w,x:l,y:c+S,vertical:!1,scale:x.scale,fontStack:x.fontStack,sectionIndex:b}),l+=E.metrics.advance*x.scale+a):(h.push({glyph:w,x:l,y:c+S,vertical:!0,scale:x.scale,fontStack:x.fontStack,sectionIndex:b}),l+=Vl*x.scale+a))}if(h.length!==v){var I=l-a;p=Math.max(I,p),Ql(h,e,v,h.length-1,d)}l=0,c+=r*y}else c+=r}var C,k=Jl(i),A=k.horizontalAlign,P=k.verticalAlign;!function(t,e,r,i,n,o){for(var a=(d-A)*p,s=(-P*u.length+.5)*o,l=0;l<t.length;l++)t[l].x+=a,t[l].y+=s}(h,0,0,0,0,r);var M=c-t.yOffset;t.top+=-P*M,t.bottom=t.top+M,t.left+=-A*p,t.right=t.left+p}(I,e,h,n,o,a,u,s,c),!!E.length&&I}jl.fromFeature=function(t,e){for(var r=new jl,i=0;i<t.sections.length;i++){var n=t.sections[i];r.sections.push({scale:n.scale||1,fontStack:n.fontStack||e}),r.text+=n.text;for(var o=0;o<n.text.length;o++)r.sectionIndex.push(i)}return r},jl.prototype.length=function(){return this.text.length},jl.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},jl.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},jl.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},jl.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",r=0;r<t.length;r++){var i=t.charCodeAt(r+1)||null,n=t.charCodeAt(r-1)||null;i&&Pi(i)&&!ql[t[r+1]]||n&&Pi(n)&&!ql[t[r-1]]||!ql[t[r]]?e+=t[r]:e+=ql[t[r]]}return e}(this.text)},jl.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&Hl[this.text.charCodeAt(e)];e++)t++;for(var r=this.text.length,i=this.text.length-1;0<=i&&t<=i&&Hl[this.text.charCodeAt(i)];i--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)},jl.prototype.substring=function(t,e){var r=new jl;return r.text=this.text.substring(t,e),r.sectionIndex=this.sectionIndex.slice(t,e),r.sections=this.sections,r},jl.prototype.toString=function(){return this.text},jl.prototype.getMaxScale=function(){var r=this;return this.sectionIndex.reduce(function(t,e){return Math.max(t,r.sections[e].scale)},0)};var Hl={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Wl={};function Kl(t,e,r,i){var n=Math.pow(t-e,2);return i?t<e?n/2:2*n:n+Math.abs(r)*r}function Xl(t,e,r,i,n,o){for(var a=null,s=Kl(e,r,n,o),l=0,u=i;l<u.length;l+=1){var c=u[l],p=Kl(e-c.x,r,n,o)+c.badness;p<=s&&(a=c,s=p)}return{index:t,x:e,priorBreak:a,badness:s}}function Yl(t,e,r,i,n){if("point"!==n)return[];if(!t)return[];for(var o,a=[],s=function(t,e,r,i){for(var n=0,o=0;o<t.length();o++){var a=t.getSection(o),s=i[a.fontStack],l=s&&s[t.getCharCode(o)];l&&(n+=l.metrics.advance*a.scale+e)}return n/Math.max(1,Math.ceil(n/r))}(t,e,r,i),l=0<=t.text.indexOf("​"),u=0,c=0;c<t.length();c++){var p=t.getSection(c),h=t.getCharCode(c),d=i[p.fontStack],f=d&&d[h];if(f&&!Hl[h]&&(u+=f.metrics.advance*p.scale+e),c<t.length()-1){var m=!((o=h)<11904||!(Ci["Bopomofo Extended"](o)||Ci.Bopomofo(o)||Ci["CJK Compatibility Forms"](o)||Ci["CJK Compatibility Ideographs"](o)||Ci["CJK Compatibility"](o)||Ci["CJK Radicals Supplement"](o)||Ci["CJK Strokes"](o)||Ci["CJK Symbols and Punctuation"](o)||Ci["CJK Unified Ideographs Extension A"](o)||Ci["CJK Unified Ideographs"](o)||Ci["Enclosed CJK Letters and Months"](o)||Ci["Halfwidth and Fullwidth Forms"](o)||Ci.Hiragana(o)||Ci["Ideographic Description Characters"](o)||Ci["Kangxi Radicals"](o)||Ci["Katakana Phonetic Extensions"](o)||Ci.Katakana(o)||Ci["Vertical Forms"](o)||Ci["Yi Radicals"](o)||Ci["Yi Syllables"](o)));(Wl[h]||m)&&a.push(Xl(c+1,u,s,a,(g=h,y=t.getCharCode(c+1),v=void 0,v=0,10===g&&(v-=1e4),m&&l&&(v+=150),40!==g&&65288!==g||(v+=50),41!==y&&65289!==y||(v+=50),v),!1))}}var g,y,v;return function t(e){return e?t(e.priorBreak).concat(e.index):[]}(Xl(t.length(),u,s,a,0,!0))}function Jl(t){var e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function Ql(t,e,r,i,n){if(n){var o=t[i],a=e[o.fontStack],s=a&&a[o.glyph];if(s)for(var l=s.metrics.advance*o.scale,u=(t[i].x+l)*n,c=r;c<=i;c++)t[c].x-=u}}Wl[10]=!0,Wl[32]=!0,Wl[38]=!0,Wl[40]=!0,Wl[41]=!0,Wl[43]=!0,Wl[45]=!0,Wl[47]=!0,Wl[173]=!0,Wl[183]=!0,Wl[8203]=!0,Wl[8208]=!0,Wl[8211]=!0,Wl[8231]=!0;var $l,tu=(($l=lt)&&(eu.__proto__=$l),((eu.prototype=Object.create($l&&$l.prototype)).constructor=eu).prototype.clone=function(){return new eu(this.x,this.y,this.angle,this.segment)},eu);function eu(t,e,r,i){$l.call(this,t,e),this.angle=r,void 0!==i&&(this.segment=i)}wi("Anchor",tu);var ru=256;function iu(t,e){var r=e.expression;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new Mi(t+1))};if("source"===r.kind)return{kind:"source"};for(var i=r.zoomStops,n=r.interpolationType,o=0;o<i.length&&i[o]<=t;)o++;for(var a=o=Math.max(0,o-1);a<i.length&&i[a]<t+1;)a++;a=Math.min(i.length-1,a);var s=i[o],l=i[a];return"composite"===r.kind?{kind:"composite",minZoom:s,maxZoom:l,interpolationType:n}:{kind:"camera",minZoom:s,maxZoom:l,minSize:r.evaluate(new Mi(s)),maxSize:r.evaluate(new Mi(l)),interpolationType:n}}function nu(t,e,r){var i=e.uSize,n=e.uSizeT,o=r.lowerSize,a=r.upperSize;return"source"===t.kind?o/ru:"composite"===t.kind?Me(o/ru,a/ru,n):i}function ou(t,e){var r=0,i=0;if("constant"===t.kind)i=t.layoutSize;else if("source"!==t.kind){var n=t.interpolationType,o=t.minZoom,a=t.maxZoom,s=n?l(Ke.interpolationFactor(n,e,o,a),0,1):0;"camera"===t.kind?i=Me(t.minSize,t.maxSize,s):r=s}return{uSizeT:r,uSize:i}}var au=Object.freeze({getSizeData:iu,evaluateSizeForFeature:nu,evaluateSizeForZoom:ou,SIZE_PACK_FACTOR:ru}),su=cl.VectorTileFeature.types,lu=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function uu(t,e,r,i,n,o,a,s){t.emplaceBack(e,r,Math.round(32*i),Math.round(32*n),o,a,s?s[0]:0,s?s[1]:0)}function cu(t,e,r){t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r)}function pu(t){this.layoutVertexArray=new En,this.indexArray=new no,this.programConfigurations=t,this.segments=new Vo,this.dynamicLayoutVertexArray=new kn,this.opacityVertexArray=new Mn,this.placedSymbolArray=new Eo}function hu(t,e,r){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new r,this.segments=new Vo,this.collisionVertexArray=new Un}function du(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasPaintOverrides=!1;var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=iu(this.zoom,e["text-size"]),this.iconSizeData=iu(this.zoom,e["icon-size"]);var r=this.layers[0].layout,i=r.get("symbol-sort-key"),n=r.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==n&&void 0!==i.constantOr(1);var o="viewport-y"===n||"auto"===n&&!this.sortFeaturesByKey;this.sortFeaturesByY=o&&(r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement")),"point"===r.get("symbol-placement")&&(this.writingModes=r.get("text-writing-mode").map(function(t){return Gl[t]})),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id}),this.sourceID=t.sourceID}function fu(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Vt,this.defaultValue=t}pu.prototype.upload=function(t,e,r,i){r&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Rl.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,zl.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,lu,!0),this.opacityVertexBuffer.itemSize=1),(r||i)&&this.programConfigurations.upload(t)},pu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},wi("SymbolBuffers",pu),hu.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Nl.members,!0)},hu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},wi("CollisionBuffers",hu),du.prototype.createArrays=function(){var t=this.layers[0].layout;this.hasPaintOverrides=xu.hasPaintOverrides(t),this.text=new pu(new Ta(Rl.members,this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new pu(new Ta(Rl.members,this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.textCollisionBox=new hu(Nn,Bl.members,so),this.iconCollisionBox=new hu(Nn,Bl.members,so),this.textCollisionCircle=new hu(Nn,Fl.members,no),this.iconCollisionCircle=new hu(Nn,Fl.members,no),this.glyphOffsetArray=new Oo,this.lineVertexArray=new No,this.symbolInstances=new Ao},du.prototype.calculateGlyphDependencies=function(t,e,r,i,n){for(var o=0;o<t.length;o++)if(e[t.charCodeAt(o)]=!0,(r||i)&&n){var a=ql[t.charAt(o)];a&&(e[a.charCodeAt(0)]=!0)}},du.prototype.populate=function(t,e){var r=this.layers[0],i=r.layout,n=i.get("text-font"),o=i.get("text-field"),a=i.get("icon-image"),s=("constant"!==o.value.kind||0<o.value.value.toString().length)&&("constant"!==n.value.kind||0<n.value.value.length),l=("constant"!==a.value.kind||!!a.value.value)&&0<Object.keys(a.parameters).length,u=i.get("symbol-sort-key");if(this.features=[],s||l){for(var c=e.iconDependencies,p=e.glyphDependencies,h=e.availableImages,d=new Mi(this.zoom),f=0,m=t;f<m.length;f+=1){var g=m[f],y=g.feature,v=g.index,_=g.sourceLayerIndex;if(r._featureFilter(d,y)){var x=void 0;if(s){var b=r.getValueAndResolveTokens("text-field",y,h);x=Ul(b instanceof se?b:se.fromString(b),r,y)}var w=void 0;if(l){var S=r.getValueAndResolveTokens("icon-image",y,h);w=S instanceof le?S:S&&"string"!=typeof S?le.fromString(S):le.fromString({name:S,available:!1})}if(x||w){var T=this.sortFeaturesByKey?u.evaluate(y,{}):void 0,E={text:x,icon:w,index:v,sourceLayerIndex:_,geometry:ka(y),properties:y.properties,type:su[y.type],sortKey:T};if(void 0!==y.id&&(E.id=y.id),this.features.push(E),w&&(c[w.name]=!0),x){var I=n.evaluate(y,{}).join(","),C="map"===i.get("text-rotation-alignment")&&"point"!==i.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&0<=this.writingModes.indexOf(Gl.vertical);for(var k=0,A=x.sections;k<A.length;k+=1){var P=A[k],M=ki(x.toString()),L=P.fontStack||I,O=p[L]=p[L]||{};this.calculateGlyphDependencies(P.text,O,C,this.allowVerticalPlacement,M)}}}}}"line"===i.get("symbol-placement")&&(this.features=function(e){var n={},o={},a=[],r=0;function t(t){a.push(e[t]),r++}function i(t,e,r){var i=o[t];return delete o[t],o[e]=i,a[i].geometry[0].pop(),a[i].geometry[0]=a[i].geometry[0].concat(r[0]),i}function s(t,e,r){var i=n[e];return delete n[e],n[t]=i,a[i].geometry[0].shift(),a[i].geometry[0]=r[0].concat(a[i].geometry[0]),i}function l(t,e,r){var i=r?e[0][e[0].length-1]:e[0][0];return t+":"+i.x+":"+i.y}for(var u=0;u<e.length;u++){var c=e[u],p=c.geometry,h=c.text?c.text.toString():null;if(h){var d=l(h,p),f=l(h,p,!0);if(d in o&&f in n&&o[d]!==n[f]){var m=s(d,f,p),g=i(d,f,a[m].geometry);delete n[d],delete o[f],o[l(h,a[g].geometry,!0)]=g,a[m].geometry=null}else d in o?i(d,f,p):f in n?s(d,f,p):(t(u),n[d]=r-1,o[f]=r-1)}else t(u)}return a.filter(function(t){return t.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(t,e){return t.sortKey-e.sortKey})}},du.prototype.update=function(t,e,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,r),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,r))},du.prototype.isEmpty=function(){return 0===this.symbolInstances.length},du.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},du.prototype.upload=function(t){this.uploaded||(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t),this.textCollisionCircle.upload(t),this.iconCollisionCircle.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},du.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.textCollisionBox.destroy(),this.iconCollisionBox.destroy(),this.textCollisionCircle.destroy(),this.iconCollisionCircle.destroy()},du.prototype.addToLineVertexArray=function(t,e){var r=this.lineVertexArray.length;if(void 0!==t.segment){for(var i=t.dist(e[t.segment+1]),n=t.dist(e[t.segment]),o={},a=t.segment+1;a<e.length;a++)o[a]={x:e[a].x,y:e[a].y,tileUnitDistanceFromAnchor:i},a<e.length-1&&(i+=e[a+1].dist(e[a]));for(var s=t.segment||0;0<=s;s--)o[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:n},0<s&&(n+=e[s-1].dist(e[s]));for(var l=0;l<e.length;l++){var u=o[l];this.lineVertexArray.emplaceBack(u.x,u.y,u.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},du.prototype.addSymbols=function(r,t,l,e,i,n,o,u,a,s,c){function p(t){var e=t.tl,r=t.tr,i=t.bl,n=t.br,o=t.tex,a=g.vertexLength,s=t.glyphOffset[1];uu(f,u.x,u.y,e.x,s+e.y,o.x,o.y,l),uu(f,u.x,u.y,r.x,s+r.y,o.x+o.w,o.y,l),uu(f,u.x,u.y,i.x,s+i.y,o.x,o.y+o.h,l),uu(f,u.x,u.y,n.x,s+n.y,o.x+o.w,o.y+o.h,l),cu(m,u,_),d.emplaceBack(a,a+1,a+2),d.emplaceBack(a+1,a+2,a+3),g.vertexLength+=4,g.primitiveLength+=2,h.glyphOffsetArray.emplaceBack(t.glyphOffset[0])}var h=this,d=r.indexArray,f=r.layoutVertexArray,m=r.dynamicLayoutVertexArray,g=r.segments.prepareSegment(4*t.length,r.layoutVertexArray,r.indexArray,n.sortKey),y=this.glyphOffsetArray.length,v=g.vertexLength,_=this.allowVerticalPlacement&&o===Gl.vertical?Math.PI/2:0;if(n.text&&n.text.sections){var x=n.text.sections;if(this.hasPaintOverrides){for(var b,w=function(t,e){void 0===b||b===t&&!e||r.programConfigurations.populatePaintArrays(r.layoutVertexArray.length,n,n.index,{},x[b]),b=t},S=0,T=t;S<T.length;S+=1){var E=T[S];w(E.sectionIndex,!1),p(E)}w(b,!0)}else{for(var I=0,C=t;I<C.length;I+=1)p(C[I]);r.programConfigurations.populatePaintArrays(r.layoutVertexArray.length,n,n.index,{},x[0])}}else{for(var k=0,A=t;k<A.length;k+=1)p(A[k]);r.programConfigurations.populatePaintArrays(r.layoutVertexArray.length,n,n.index,{})}r.placedSymbolArray.emplaceBack(u.x,u.y,y,this.glyphOffsetArray.length-y,v,a,s,u.segment,l?l[0]:0,l?l[1]:0,e[0],e[1],o,0,!1,0,c)},du.prototype._addCollisionDebugVertex=function(t,e,r,i,n,o){return e.emplaceBack(0,0),t.emplaceBack(r.x,r.y,i,n,Math.round(o.x),Math.round(o.y))},du.prototype.addCollisionDebugVertices=function(t,e,r,i,n,o,a,s){var l=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),u=l.vertexLength,c=n.layoutVertexArray,p=n.collisionVertexArray,h=a.anchorX,d=a.anchorY;if(this._addCollisionDebugVertex(c,p,o,h,d,new lt(t,e)),this._addCollisionDebugVertex(c,p,o,h,d,new lt(r,e)),this._addCollisionDebugVertex(c,p,o,h,d,new lt(r,i)),this._addCollisionDebugVertex(c,p,o,h,d,new lt(t,i)),l.vertexLength+=4,s){var f=n.indexArray;f.emplaceBack(u,u+1,u+2),f.emplaceBack(u,u+2,u+3),l.primitiveLength+=2}else{var m=n.indexArray;m.emplaceBack(u,u+1),m.emplaceBack(u+1,u+2),m.emplaceBack(u+2,u+3),m.emplaceBack(u+3,u),l.primitiveLength+=4}},du.prototype.addDebugCollisionBoxes=function(t,e,r,i){for(var n=t;n<e;n++){var o=this.collisionBoxArray.get(n),a=o.x1,s=o.y1,l=o.x2,u=o.y2,c=0<o.radius;this.addCollisionDebugVertices(a,s,l,u,c?i?this.textCollisionCircle:this.iconCollisionCircle:i?this.textCollisionBox:this.iconCollisionBox,o.anchorPoint,r,c)}},du.prototype.generateCollisionDebugBuffers=function(){for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1)}},du.prototype._deserializeCollisionBoxesForSymbol=function(t,e,r,i,n,o,a){for(var s={},l=e;l<r;l++){var u=t.get(l);if(0===u.radius){s.textBox={x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2,anchorPointX:u.anchorPointX,anchorPointY:u.anchorPointY},s.textFeatureIndex=u.featureIndex;break}s.textCircles||(s.textCircles=[],s.textFeatureIndex=u.featureIndex),s.textCircles.push(u.anchorPointX,u.anchorPointY,u.radius,u.signedDistanceFromAnchor,1)}for(var c=i;c<n;c++){var p=t.get(c);if(0===p.radius){s.verticalTextBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},s.verticalTextFeatureIndex=p.featureIndex;break}}for(var h=o;h<a;h++){var d=t.get(h);if(0===d.radius){s.iconBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},s.iconFeatureIndex=d.featureIndex;break}}return s},du.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var r=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex))}},du.prototype.hasTextData=function(){return 0<this.text.segments.get().length},du.prototype.hasIconData=function(){return 0<this.icon.segments.get().length},du.prototype.hasTextCollisionBoxData=function(){return 0<this.textCollisionBox.segments.get().length},du.prototype.hasIconCollisionBoxData=function(){return 0<this.iconCollisionBox.segments.get().length},du.prototype.hasTextCollisionCircleData=function(){return 0<this.textCollisionCircle.segments.get().length},du.prototype.hasIconCollisionCircleData=function(){return 0<this.iconCollisionCircle.segments.get().length},du.prototype.addIndicesForPlacedTextSymbol=function(t){for(var e=this.text.placedSymbolArray.get(t),r=e.vertexStartIndex+4*e.numGlyphs,i=e.vertexStartIndex;i<r;i+=4)this.text.indexArray.emplaceBack(i,i+1,i+2),this.text.indexArray.emplaceBack(i+1,i+2,i+3)},du.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var e=Math.sin(t),r=Math.cos(t),i=[],n=[],o=[],a=0;a<this.symbolInstances.length;++a){o.push(a);var s=this.symbolInstances.get(a);i.push(0|Math.round(e*s.anchorX+r*s.anchorY)),n.push(s.featureIndex)}return o.sort(function(t,e){return i[t]-i[e]||n[e]-n[t]}),o},du.prototype.sortFeatures=function(t){var i=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(1<this.text.segments.get().length||1<this.icon.segments.get().length)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var e=0,r=this.symbolInstanceIndexes;e<r.length;e+=1){var n=r[e],o=this.symbolInstances.get(n);this.featureSortOrder.push(o.featureIndex),[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach(function(t,e,r){0<=t&&r.indexOf(t)===e&&i.addIndicesForPlacedTextSymbol(t)}),0<=o.verticalPlacedTextSymbolIndex&&this.addIndicesForPlacedTextSymbol(o.verticalPlacedTextSymbolIndex);var a=this.icon.placedSymbolArray.get(n);if(a.numGlyphs){var s=a.vertexStartIndex;this.icon.indexArray.emplaceBack(s,s+1,s+2),this.icon.indexArray.emplaceBack(s+1,s+2,s+3)}}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},wi("SymbolBucket",du,{omit:["layers","collisionBoxArray","features","compareText"]}),du.MAX_GLYPHS=65535,du.addDynamicAttributes=cu;var mu=new $i({"symbol-placement":new Hi(Lt.layout_symbol["symbol-placement"]),"symbol-spacing":new Hi(Lt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Hi(Lt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Wi(Lt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Hi(Lt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Hi(Lt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Hi(Lt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Hi(Lt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Hi(Lt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Wi(Lt.layout_symbol["icon-size"]),"icon-text-fit":new Hi(Lt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Hi(Lt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Wi(Lt.layout_symbol["icon-image"]),"icon-rotate":new Wi(Lt.layout_symbol["icon-rotate"]),"icon-padding":new Hi(Lt.layout_symbol["icon-padding"]),"icon-keep-upright":new Hi(Lt.layout_symbol["icon-keep-upright"]),"icon-offset":new Wi(Lt.layout_symbol["icon-offset"]),"icon-anchor":new Wi(Lt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Hi(Lt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Hi(Lt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Hi(Lt.layout_symbol["text-rotation-alignment"]),"text-field":new Wi(Lt.layout_symbol["text-field"]),"text-font":new Wi(Lt.layout_symbol["text-font"]),"text-size":new Wi(Lt.layout_symbol["text-size"]),"text-max-width":new Wi(Lt.layout_symbol["text-max-width"]),"text-line-height":new Hi(Lt.layout_symbol["text-line-height"]),"text-letter-spacing":new Wi(Lt.layout_symbol["text-letter-spacing"]),"text-justify":new Wi(Lt.layout_symbol["text-justify"]),"text-radial-offset":new Wi(Lt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Hi(Lt.layout_symbol["text-variable-anchor"]),"text-anchor":new Wi(Lt.layout_symbol["text-anchor"]),"text-max-angle":new Hi(Lt.layout_symbol["text-max-angle"]),"text-writing-mode":new Hi(Lt.layout_symbol["text-writing-mode"]),"text-rotate":new Wi(Lt.layout_symbol["text-rotate"]),"text-padding":new Hi(Lt.layout_symbol["text-padding"]),"text-keep-upright":new Hi(Lt.layout_symbol["text-keep-upright"]),"text-transform":new Wi(Lt.layout_symbol["text-transform"]),"text-offset":new Wi(Lt.layout_symbol["text-offset"]),"text-allow-overlap":new Hi(Lt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Hi(Lt.layout_symbol["text-ignore-placement"]),"text-optional":new Hi(Lt.layout_symbol["text-optional"])}),gu={paint:new $i({"icon-opacity":new Wi(Lt.paint_symbol["icon-opacity"]),"icon-color":new Wi(Lt.paint_symbol["icon-color"]),"icon-halo-color":new Wi(Lt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Wi(Lt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Wi(Lt.paint_symbol["icon-halo-blur"]),"icon-translate":new Hi(Lt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Hi(Lt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Wi(Lt.paint_symbol["text-opacity"]),"text-color":new Wi(Lt.paint_symbol["text-color"],{runtimeType:Wt,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new Wi(Lt.paint_symbol["text-halo-color"]),"text-halo-width":new Wi(Lt.paint_symbol["text-halo-width"]),"text-halo-blur":new Wi(Lt.paint_symbol["text-halo-blur"]),"text-translate":new Hi(Lt.paint_symbol["text-translate"]),"text-translate-anchor":new Hi(Lt.paint_symbol["text-translate-anchor"])}),layout:mu};fu.prototype.evaluate=function(t){if(t.formattedSection){var e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},fu.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},fu.prototype.possibleOutputs=function(){return[void 0]},fu.prototype.serialize=function(){return null},wi("FormatSectionOverride",fu,{omit:["defaultValue"]});var yu,vu,_u,xu=(Cu.__proto__=_u=nn,((Cu.prototype=Object.create(_u&&_u.prototype)).constructor=Cu).prototype.recalculate=function(t,e){if(_u.prototype.recalculate.call(this,t,e),"auto"===this.layout.get("icon-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var r=this.layout.get("text-writing-mode");if(r){for(var i=[],n=0,o=r;n<o.length;n+=1){var a=o[n];i.indexOf(a)<0&&i.push(a)}this.layout._values["text-writing-mode"]=i}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},Cu.prototype.getValueAndResolveTokens=function(t,e,r){var i,n=this.layout.get(t).evaluate(e,{},r),o=this._unevaluatedLayout._values[t];return o.isDataDriven()||Mr(o.value)||!n?n:(i=e.properties,n.replace(/{([^{}]+)}/g,function(t,e){return e in i?String(i[e]):""}))},Cu.prototype.createBucket=function(t){return new du(t)},Cu.prototype.queryRadius=function(){return 0},Cu.prototype.queryIntersectsFeature=function(){return!1},Cu.prototype._setPaintOverrides=function(){for(var t=0,e=gu.paint.overridableProperties;t<e.length;t+=1){var r=e[t];if(Cu.hasPaintOverride(this.layout,r)){var i,n=this.paint.get(r),o=new fu(n),a=new Pr(o,n.property.specification);i="constant"===n.value.kind||"source"===n.value.kind?new Or("source",a):new Dr("composite",a,n.value.zoomStops,n.value._interpolationType),this.paint._values[r]=new Gi(n.property,i,n.parameters)}}},Cu.prototype._handleOverridablePaintPropertyUpdate=function(t,e,r){return!(!this.layout||e.isDataDriven()||r.isDataDriven())&&Cu.hasPaintOverride(this.layout,t)},Cu.hasPaintOverride=function(t,e){function r(t){for(var e=0,r=t;e<r.length;e+=1){var i=r[e];if(n.overrides&&n.overrides.hasOverride(i))return void(o=!0)}}var i=t.get("text-field"),n=gu.paint.properties[e],o=!1;if("constant"===i.value.kind&&i.value.value instanceof se)r(i.value.value.sections);else if("source"===i.value.kind){var a=function(t){if(!o)if(t instanceof he&&ce(t.value)===Jt){var e=t.value;r(e.sections)}else t instanceof ge?r(t.sections):t.eachChild(a)},s=i.value;s._styleExpression&&a(s._styleExpression.expression)}return o},Cu.hasPaintOverrides=function(t){for(var e=0,r=gu.paint.overridableProperties;e<r.length;e+=1){var i=r[e];if(Cu.hasPaintOverride(t,i))return!0}return!1},Cu),bu={paint:new $i({"background-color":new Hi(Lt.paint_background["background-color"]),"background-pattern":new Ki(Lt.paint_background["background-pattern"]),"background-opacity":new Hi(Lt.paint_background["background-opacity"])})},wu=(Iu.__proto__=vu=nn,(Iu.prototype=Object.create(vu&&vu.prototype)).constructor=Iu),Su={paint:new $i({"raster-opacity":new Hi(Lt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Hi(Lt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Hi(Lt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Hi(Lt.paint_raster["raster-brightness-max"]),"raster-saturation":new Hi(Lt.paint_raster["raster-saturation"]),"raster-contrast":new Hi(Lt.paint_raster["raster-contrast"]),"raster-resampling":new Hi(Lt.paint_raster["raster-resampling"]),"raster-fade-duration":new Hi(Lt.paint_raster["raster-fade-duration"])})},Tu=(Eu.__proto__=yu=nn,(Eu.prototype=Object.create(yu&&yu.prototype)).constructor=Eu);function Eu(t){yu.call(this,t,Su)}function Iu(t){vu.call(this,t,bu)}function Cu(t){_u.call(this,t,gu)}var ku,Au=(Mu.__proto__=ku=nn,((Mu.prototype=Object.create(ku&&ku.prototype)).constructor=Mu).prototype.is3D=function(){return"3d"===this.implementation.renderingMode},Mu.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},Mu.prototype.recalculate=function(){},Mu.prototype.updateTransitions=function(){},Mu.prototype.hasTransition=function(){},Mu.prototype.serialize=function(){},Mu.prototype.onAdd=function(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},Mu.prototype.onRemove=function(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},Mu),Pu={circle:Ya,heatmap:ps,hillshade:ds,fill:$s,"fill-extrusion":yl,line:Ll,symbol:xu,background:wu,raster:Tu};function Mu(t){ku.call(this,t,{}),this.implementation=t}function Lu(t){for(var e=0,r=0,i=0,n=t;i<n.length;i+=1){var o=n[i];e+=o.w*o.h,r=Math.max(r,o.w)}t.sort(function(t,e){return e.h-t.h});for(var a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}],s=0,l=0,u=0,c=t;u<c.length;u+=1)for(var p=c[u],h=a.length-1;0<=h;h--){var d=a[h];if(!(p.w>d.w||p.h>d.h)){if(p.x=d.x,p.y=d.y,l=Math.max(l,p.y+p.h),s=Math.max(s,p.x+p.w),p.w===d.w&&p.h===d.h){var f=a.pop();h<a.length&&(a[h]=f)}else p.h===d.h?(d.x+=p.w,d.w-=p.w):(p.w===d.w||a.push({x:d.x+p.w,y:d.y,w:d.w-p.w,h:p.h}),d.y+=p.h,d.h-=p.h);break}}return{w:s,h:l,fill:e/(s*l)||0}}function Ou(t,e){var r=e.pixelRatio,i=e.version;this.paddedRect=t,this.pixelRatio=r,this.version=i}var Du={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};function Ru(t,e){var r={},i={};this.haveRenderCallbacks=[];var n=[];this.addImages(t,r,n),this.addImages(e,i,n);var o=Lu(n),a=o.w,s=o.h,l=new as({width:a||1,height:s||1});for(var u in t){var c=t[u],p=r[u].paddedRect;as.copy(c.data,l,{x:0,y:0},{x:p.x+1,y:p.y+1},c.data)}for(var h in e){var d=e[h],f=i[h].paddedRect,m=f.x+1,g=f.y+1,y=d.data.width,v=d.data.height;as.copy(d.data,l,{x:0,y:0},{x:m,y:g},d.data),as.copy(d.data,l,{x:0,y:v-1},{x:m,y:g-1},{width:y,height:1}),as.copy(d.data,l,{x:0,y:0},{x:m,y:g+v},{width:y,height:1}),as.copy(d.data,l,{x:y-1,y:0},{x:m-1,y:g},{width:1,height:v}),as.copy(d.data,l,{x:0,y:0},{x:m+y,y:g},{width:1,height:v})}this.image=l,this.iconPositions=r,this.patternPositions=i}function zu(t,e,r,i){this.context=t,this.format=r,this.texture=t.gl.createTexture(),this.update(e,i)}Du.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Du.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Du.tlbr.get=function(){return this.tl.concat(this.br)},Du.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Ou.prototype,Du),Ru.prototype.addImages=function(t,e,r){for(var i in t){var n=t[i],o={x:0,y:0,w:n.data.width+2,h:n.data.height+2};r.push(o),e[i]=new Ou(o,n),n.hasRenderCallback&&this.haveRenderCallbacks.push(i)}},Ru.prototype.patchUpdatedImages=function(t,e){for(var r in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[r],t.getImage(r),e),this.patchUpdatedImage(this.patternPositions[r],t.getImage(r),e)},Ru.prototype.patchUpdatedImage=function(t,e,r){if(t&&e&&t.version!==e.version){t.version=e.version;var i=t.tl,n=i[0],o=i[1];r.update(e.data,void 0,{x:n,y:o})}},wi("ImagePosition",Ou),wi("ImageAtlas",Ru);var Nu=self.HTMLImageElement,Bu=self.HTMLCanvasElement,Fu=self.HTMLVideoElement,Uu=self.ImageData;function ju(t,e,r,i,n){var o,a,s=8*n-i-1,l=(1<<s)-1,u=l>>1,c=-7,p=r?n-1:0,h=r?-1:1,d=t[e+p];for(p+=h,o=d&(1<<-c)-1,d>>=-c,c+=s;0<c;o=256*o+t[e+p],p+=h,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=i;0<c;a=256*a+t[e+p],p+=h,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,i),o-=u}return(d?-1:1)*a*Math.pow(2,o-i)}function qu(t,e,r,i,n,o){var a,s,l,u=8*o-n-1,c=(1<<u)-1,p=c>>1,h=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:o-1,f=i?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),2<=(e+=1<=a+p?h/l:h*Math.pow(2,1-p))*l&&(a++,l/=2),c<=a+p?(s=0,a=c):1<=a+p?(s=(e*l-1)*Math.pow(2,n),a+=p):(s=e*Math.pow(2,p-1)*Math.pow(2,n),a=0));8<=n;t[r+d]=255&s,d+=f,s/=256,n-=8);for(a=a<<n|s,u+=n;0<u;t[r+d]=255&a,d+=f,a/=256,u-=8);t[r+d-f]|=128*m}zu.prototype.update=function(t,e,r){var i=t.width,n=t.height,o=!(this.size&&this.size[0]===i&&this.size[1]===n||r),a=this.context,s=a.gl;if(this.useMipmap=Boolean(e&&e.useMipmap),s.bindTexture(s.TEXTURE_2D,this.texture),a.pixelStoreUnpackFlipY.set(!1),a.pixelStoreUnpack.set(1),a.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!e||!1!==e.premultiply)),o)this.size=[i,n],t instanceof Nu||t instanceof Bu||t instanceof Fu||t instanceof Uu?s.texImage2D(s.TEXTURE_2D,0,this.format,this.format,s.UNSIGNED_BYTE,t):s.texImage2D(s.TEXTURE_2D,0,this.format,i,n,0,this.format,s.UNSIGNED_BYTE,t.data);else{var l=r||{x:0,y:0},u=l.x,c=l.y;t instanceof Nu||t instanceof Bu||t instanceof Fu||t instanceof Uu?s.texSubImage2D(s.TEXTURE_2D,0,u,c,s.RGBA,s.UNSIGNED_BYTE,t):s.texSubImage2D(s.TEXTURE_2D,0,u,c,i,n,s.RGBA,s.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&s.generateMipmap(s.TEXTURE_2D)},zu.prototype.bind=function(t,e,r){var i=this.context.gl;i.bindTexture(i.TEXTURE_2D,this.texture),r!==i.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=i.LINEAR),t!==this.filter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,r||t),this.filter=t),e!==this.wrap&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e),this.wrap=e)},zu.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},zu.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Vu=Gu;function Gu(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}function Zu(t){return t.type===Gu.Bytes?t.readVarint()+t.pos:t.pos+1}function Hu(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Wu(t,e,r){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(i);for(var n=r.pos-1;t<=n;n--)r.buf[n+i]=r.buf[n]}function Ku(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function Xu(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function Yu(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function Ju(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function Qu(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function $u(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function tc(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function ec(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function rc(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function ic(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function nc(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function oc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}Gu.Varint=0,Gu.Fixed64=1,Gu.Bytes=2,Gu.Fixed32=5,Gu.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var i=this.readVarint(),n=i>>3,o=this.pos;this.type=7&i,t(n,e,this),this.pos===o&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=ic(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=oc(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=ic(this.buf,this.pos)+4294967296*ic(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=ic(this.buf,this.pos)+4294967296*oc(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=ju(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=ju(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,i=this.buf;return e=127&(r=i[this.pos++]),r<128?e:(e|=(127&(r=i[this.pos++]))<<7,r<128?e:(e|=(127&(r=i[this.pos++]))<<14,r<128?e:(e|=(127&(r=i[this.pos++]))<<21,r<128?e:function(t,e,r){var i,n,o=r.buf;if(i=(112&(n=o[r.pos++]))>>4,n<128)return Hu(t,i,e);if(i|=(127&(n=o[r.pos++]))<<3,n<128)return Hu(t,i,e);if(i|=(127&(n=o[r.pos++]))<<10,n<128)return Hu(t,i,e);if(i|=(127&(n=o[r.pos++]))<<17,n<128)return Hu(t,i,e);if(i|=(127&(n=o[r.pos++]))<<24,n<128)return Hu(t,i,e);if(i|=(1&(n=o[r.pos++]))<<31,n<128)return Hu(t,i,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=function(t,e,r){for(var i="",n=e;n<r;){var o,a,s,l=t[n],u=null,c=239<l?4:223<l?3:191<l?2:1;if(r<n+c)break;1===c?l<128&&(u=l):2===c?128==(192&(o=t[n+1]))&&(u=(31&l)<<6|63&o)<=127&&(u=null):3===c?(o=t[n+1],a=t[n+2],128==(192&o)&&128==(192&a)&&((u=(15&l)<<12|(63&o)<<6|63&a)<=2047||55296<=u&&u<=57343)&&(u=null)):4===c&&(o=t[n+1],a=t[n+2],s=t[n+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||1114112<=u)&&(u=null)),null===u?(u=65533,c=1):65535<u&&(u-=65536,i+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),i+=String.fromCharCode(u),n+=c}return i}(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Gu.Bytes)return t.push(this.readVarint(e));var r=Zu(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Gu.Bytes)return t.push(this.readSVarint());var e=Zu(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Gu.Bytes)return t.push(this.readBoolean());var e=Zu(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Gu.Bytes)return t.push(this.readFloat());var e=Zu(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Gu.Bytes)return t.push(this.readDouble());var e=Zu(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Gu.Bytes)return t.push(this.readFixed32());var e=Zu(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Gu.Bytes)return t.push(this.readSFixed32());var e=Zu(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Gu.Bytes)return t.push(this.readFixed64());var e=Zu(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Gu.Bytes)return t.push(this.readSFixed64());var e=Zu(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Gu.Varint)for(;127<this.buf[this.pos++];);else if(e===Gu.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Gu.Fixed32)this.pos+=4;else{if(e!==Gu.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),nc(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),nc(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),nc(this.buf,-1&t,this.pos),nc(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),nc(this.buf,-1&t,this.pos),nc(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(u){268435455<(u=+u||0)||u<0?function(t,e){var r,i,n,o,a,s,l;if(0<=u?(r=u%4294967296|0,i=u/4294967296|0):(i=~(-u/4294967296),4294967295^(r=~(-u%4294967296))?r=r+1|0:i=i+1|(r=0)),0x10000000000000000<=u||u<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),s=r,(l=e).buf[l.pos++]=127&s|128,s>>>=7,l.buf[l.pos++]=127&s|128,s>>>=7,l.buf[l.pos++]=127&s|128,s>>>=7,l.buf[l.pos++]=127&s|128,s>>>=7,l.buf[l.pos]=127&s,a=(7&(n=i))<<4,(o=e).buf[o.pos++]|=a|((n>>>=3)?128:0),n&&(o.buf[o.pos++]=127&n|((n>>>=7)?128:0),n&&(o.buf[o.pos++]=127&n|((n>>>=7)?128:0),n&&(o.buf[o.pos++]=127&n|((n>>>=7)?128:0),n&&(o.buf[o.pos++]=127&n|((n>>>=7)?128:0),n&&(o.buf[o.pos++]=127&n)))))}(0,this):(this.realloc(4),this.buf[this.pos++]=127&u|(127<u?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(127<u?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(127<u?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,r){for(var i,n,o=0;o<e.length;o++){if(55295<(i=e.charCodeAt(o))&&i<57344){if(!n){56319<i||o+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):n=i;continue}if(i<56320){t[r++]=239,t[r++]=191,t[r++]=189,n=i;continue}i=n-55296<<10|i-56320|65536,n=null}else n&&(t[r++]=239,t[r++]=191,t[r++]=189,n=null);i<128?t[r++]=i:(i<2048?t[r++]=i>>6|192:(i<65536?t[r++]=i>>12|224:(t[r++]=i>>18|240,t[r++]=i>>12&63|128),t[r++]=i>>6&63|128),t[r++]=63&i|128)}return r}(this.buf,t,this.pos);var r=this.pos-e;128<=r&&Wu(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),qu(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),qu(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var i=this.pos-r;128<=i&&Wu(r,i,this),this.pos=r-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,r){this.writeTag(t,Gu.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Ku,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Xu,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Qu,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Yu,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Ju,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,$u,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,tc,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,ec,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,rc,e)},writeBytesField:function(t,e){this.writeTag(t,Gu.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Gu.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Gu.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Gu.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Gu.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Gu.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Gu.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Gu.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Gu.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Gu.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var ac=3;function sc(t,e,r){1===t&&r.readMessage(lc,e)}function lc(t,e,r){if(3===t){var i=r.readMessage(uc,{}),n=i.id,o=i.bitmap,a=i.width,s=i.height,l=i.left,u=i.top,c=i.advance;e.push({id:n,bitmap:new os({width:a+2*ac,height:s+2*ac},o),metrics:{width:a,height:s,left:l,top:u,advance:c}})}}function uc(t,e,r){1===t?e.id=r.readVarint():2===t?e.bitmap=r.readBytes():3===t?e.width=r.readVarint():4===t?e.height=r.readVarint():5===t?e.left=r.readSVarint():6===t?e.top=r.readSVarint():7===t&&(e.advance=r.readVarint())}function cc(t){var e=this;this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){e._triggered=!1,e._callback()})}var pc=ac;function hc(t,e,r){this.target=t,this.parent=e,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},m(["receive","process"],this),this.invoker=new cc(this.process),this.target.addEventListener("message",this.receive,!1)}function dc(t,e,r){var i=2*Math.PI*6378137/256/Math.pow(2,r);return[t*i-2*Math.PI*6378137/2,e*i-2*Math.PI*6378137/2]}function fc(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}cc.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){t._triggered=!1,t._callback()},0))},hc.prototype.send=function(t,e,r,i){var n=this,o=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[o]=r);var a=[];return this.target.postMessage({id:o,type:t,hasCallback:!!r,targetMapId:i,sourceMapId:this.mapId,data:Ti(e,a)},a),{cancel:function(){r&&delete n.callbacks[o],n.target.postMessage({id:o,type:"<cancel>",targetMapId:i,sourceMapId:n.mapId})}}},hc.prototype.receive=function(t){var e=t.data,r=e.id;if(r&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){delete this.tasks[r];var i=this.cancelCallbacks[r];delete this.cancelCallbacks[r],i&&i()}else this.tasks[r]=e,this.taskQueue.push(r),this.invoker.trigger()},hc.prototype.process=function(){var i=this;if(this.taskQueue.length){var n=this.taskQueue.shift(),t=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),t)if("<response>"===t.type){var e=this.callbacks[n];delete this.callbacks[n],e&&(t.error?e(Ei(t.error)):e(null,Ei(t.data)))}else{var o=!1,r=t.hasCallback?function(t,e){o=!0,delete i.cancelCallbacks[n];var r=[];i.target.postMessage({id:n,type:"<response>",sourceMapId:i.mapId,error:t?Ti(t):null,data:Ti(e,r)},r)}:function(t){o=!0},a=null,s=Ei(t.data);if(this.parent[t.type])a=this.parent[t.type](t.sourceMapId,s,r);else if(this.parent.getWorkerSource){var l=t.type.split(".");a=this.parent.getWorkerSource(t.sourceMapId,l[0],s.source)[l[1]](s,r)}else r(new Error("Could not find function "+t.type));!o&&a&&a.cancel&&(this.cancelCallbacks[n]=a.cancel)}}},hc.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)},fc.prototype.setNorthEast=function(t){return this._ne=t instanceof mc?new mc(t.lng,t.lat):mc.convert(t),this},fc.prototype.setSouthWest=function(t){return this._sw=t instanceof mc?new mc(t.lng,t.lat):mc.convert(t),this},fc.prototype.extend=function(t){var e,r,i=this._sw,n=this._ne;if(t instanceof mc)r=e=t;else{if(!(t instanceof fc))return Array.isArray(t)?t.every(Array.isArray)?this.extend(fc.convert(t)):this.extend(mc.convert(t)):this;if(e=t._sw,r=t._ne,!e||!r)return this}return i||n?(i.lng=Math.min(e.lng,i.lng),i.lat=Math.min(e.lat,i.lat),n.lng=Math.max(r.lng,n.lng),n.lat=Math.max(r.lat,n.lat)):(this._sw=new mc(e.lng,e.lat),this._ne=new mc(r.lng,r.lat)),this},fc.prototype.getCenter=function(){return new mc((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},fc.prototype.getSouthWest=function(){return this._sw},fc.prototype.getNorthEast=function(){return this._ne},fc.prototype.getNorthWest=function(){return new mc(this.getWest(),this.getNorth())},fc.prototype.getSouthEast=function(){return new mc(this.getEast(),this.getSouth())},fc.prototype.getWest=function(){return this._sw.lng},fc.prototype.getSouth=function(){return this._sw.lat},fc.prototype.getEast=function(){return this._ne.lng},fc.prototype.getNorth=function(){return this._ne.lat},fc.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},fc.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},fc.prototype.isEmpty=function(){return!(this._sw&&this._ne)},fc.convert=function(t){return!t||t instanceof fc?t:new fc(t)};var mc=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,90<this.lat||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};mc.prototype.wrap=function(){return new mc(s(this.lng,-180,180),this.lat)},mc.prototype.toArray=function(){return[this.lng,this.lat]},mc.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},mc.prototype.toBounds=function(t){void 0===t&&(t=0);var e=360*t/40075017,r=e/Math.cos(Math.PI/180*this.lat);return new fc(new mc(this.lng-r,this.lat-e),new mc(this.lng+r,this.lat+e))},mc.convert=function(t){if(t instanceof mc)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new mc(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new mc(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var gc=2*Math.PI*6378137;function yc(t){return gc*Math.cos(t*Math.PI/180)}function vc(t){return(180+t)/360}function _c(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function xc(t,e){return t/yc(e)}function bc(t){var e=180-360*t;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90}function wc(t,e,r){void 0===r&&(r=0),this.x=+t,this.y=+e,this.z=+r}function Sc(t,e,r){this.z=t,this.x=e,this.y=r,this.key=Ic(0,t,e,r)}function Tc(t,e){this.wrap=t,this.canonical=e,this.key=Ic(t,e.z,e.x,e.y)}function Ec(t,e,r,i,n){this.overscaledZ=t,this.wrap=e,this.canonical=new Sc(r,+i,+n),this.key=Ic(e,t,i,n)}function Ic(t,e,r,i){(t*=2)<0&&(t=-1*t-1);var n=1<<e;return 32*(n*n*t+n*i+r)+e}function Cc(t,e,r){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(r&&"mapbox"!==r&&"terrarium"!==r)return ut('"'+r+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=e.height;var i=this.dim=e.height-2;this.data=new Uint32Array(e.data.buffer),this.encoding=r||"mapbox";for(var n=0;n<i;n++)this.data[this._idx(-1,n)]=this.data[this._idx(0,n)],this.data[this._idx(i,n)]=this.data[this._idx(i-1,n)],this.data[this._idx(n,-1)]=this.data[this._idx(n,0)],this.data[this._idx(n,i)]=this.data[this._idx(n,i-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(i,-1)]=this.data[this._idx(i-1,0)],this.data[this._idx(-1,i)]=this.data[this._idx(0,i-1)],this.data[this._idx(i,i)]=this.data[this._idx(i-1,i-1)]}function kc(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var r=t[e];this._stringToNumber[r]=e,this._numberToString[e]=r}}wc.fromLngLat=function(t,e){void 0===e&&(e=0);var r=mc.convert(t);return new wc(vc(r.lng),_c(r.lat),xc(e,r.lat))},wc.prototype.toLngLat=function(){return new mc(360*this.x-180,bc(this.y))},wc.prototype.toAltitude=function(){return this.z*yc(bc(this.y))},wc.prototype.meterInMercatorCoordinateUnits=function(){return 1/gc*(t=bc(this.y),1/Math.cos(t*Math.PI/180));var t},Sc.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},Sc.prototype.url=function(t,e){var r,i,n,o,a,s=(r=this.x,i=this.y,n=this.z,o=dc(256*r,256*(i=Math.pow(2,n)-i-1),n),a=dc(256*(r+1),256*(i+1),n),o[0]+","+o[1]+","+a[0]+","+a[1]),l=function(t,e,r){for(var i,n="",o=t;0<o;o--)n+=(e&(i=1<<o-1)?1:0)+(r&i?2:0);return n}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",l).replace("{bbox-epsg-3857}",s)},Sc.prototype.getTilePoint=function(t){var e=Math.pow(2,this.z);return new lt((t.x*e-this.x)*Ia,(t.y*e-this.y)*Ia)},Ec.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},Ec.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new Ec(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ec(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},Ec.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},Ec.prototype.children=function(t){if(this.overscaledZ>=t)return[new Ec(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,r=2*this.canonical.x,i=2*this.canonical.y;return[new Ec(e,this.wrap,e,r,i),new Ec(e,this.wrap,e,1+r,i),new Ec(e,this.wrap,e,r,1+i),new Ec(e,this.wrap,e,1+r,1+i)]},Ec.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},Ec.prototype.wrapped=function(){return new Ec(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Ec.prototype.unwrapTo=function(t){return new Ec(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},Ec.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Ec.prototype.toUnwrapped=function(){return new Tc(this.wrap,this.canonical)},Ec.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Ec.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new wc(t.x-this.wrap,t.y))},wi("CanonicalTileID",Sc),wi("OverscaledTileID",Ec,{omit:["posMatrix"]}),Cc.prototype.get=function(t,e){var r=new Uint8Array(this.data.buffer),i=4*this._idx(t,e);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(r[i],r[1+i],r[2+i])},Cc.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Cc.prototype._idx=function(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)},Cc.prototype._unpackMapbox=function(t,e,r){return(256*t*256+256*e+r)/10-1e4},Cc.prototype._unpackTerrarium=function(t,e,r){return 256*t+e+r/256-32768},Cc.prototype.getPixels=function(){return new as({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Cc.prototype.backfillBorder=function(t,e,r){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var i=e*this.dim,n=e*this.dim+this.dim,o=r*this.dim,a=r*this.dim+this.dim;switch(e){case-1:i=n-1;break;case 1:n=i+1}switch(r){case-1:o=a-1;break;case 1:a=o+1}for(var s=-e*this.dim,l=-r*this.dim,u=o;u<a;u++)for(var c=i;c<n;c++)this.data[this._idx(c,u)]=t.data[this._idx(c+s,u+l)]},wi("DEMData",Cc);var Ac=sn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function Pc(t,e,r,i){this.type="Feature",(this._vectorTileFeature=t)._z=e,t._x=r,t._y=i,this.properties=t.properties,null!=t.id&&(this.id=t.id)}kc.prototype.encode=function(t){return this._stringToNumber[t]},kc.prototype.decode=function(t){return this._numberToString[t]};var Mc={geometry:{configurable:!0}};function Lc(){this.state={},this.stateChanges={},this.deletedStates={}}function Oc(t,e,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=e||new yi(Ia,16,0),this.grid3D=new yi(Ia,16,0),this.featureIndexArray=r||new jo}function Dc(t){for(var e=1/0,r=1/0,i=-1/0,n=-1/0,o=0,a=t;o<a.length;o+=1){var s=a[o];e=Math.min(e,s.x),r=Math.min(r,s.y),i=Math.max(i,s.x),n=Math.max(n,s.y)}return{minX:e,minY:r,maxX:i,maxY:n}}function Rc(t,e){return e-t}function zc(t,e){this.tileID=t,this.uid=c(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.expiredRequestCount=0,this.state="loading"}function Nc(t,e,r,i,n){if(void 0===e.segment)return!0;for(var o=e,a=e.segment+1,s=0;-r/2<s;){if(--a<0)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;for(var l=[],u=0;s<r/2;){var c=t[a-1],p=t[a],h=t[a+1];if(!h)return!1;var d=c.angleTo(p)-p.angleTo(h);for(d=Math.abs((d+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:d}),u+=d;s-l[0].distance>i;)u-=l.shift().angleDelta;if(n<u)return!1;a++,s+=p.dist(h)}return!0}function Bc(t){for(var e=0,r=0;r<t.length-1;r++)e+=t[r].dist(t[r+1]);return e}function Fc(t,e,r){return t?.6*e*r:0}function Uc(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function jc(t,e,r,i,n,o){for(var a=Fc(r,n,o),s=Uc(r,i)*o,l=0,u=Bc(t)/2,c=0;c<t.length-1;c++){var p=t[c],h=t[c+1],d=p.dist(h);if(u<l+d){var f=(u-l)/d,m=Me(p.x,h.x,f),g=Me(p.y,h.y,f),y=new tu(m,g,h.angleTo(p),c);return y._round(),!a||Nc(t,y,s,a,e)?y:void 0}l+=d}}function qc(t,e,r,i,n,o,a,s,l,u,c,p){var h=a.top*s-l,d=a.bottom*s+l,f=a.left*s-l,m=a.right*s+l;if(this.boxStartIndex=t.length,u){var g=d-h,y=m-f;0<g&&(g=Math.max(10*s,g),this._addLineCollisionCircles(t,e,r,r.segment,y,g,i,n,o,c))}else{if(p){var v=new lt(f,h),_=new lt(m,h),x=new lt(f,d),b=new lt(m,d),w=p*Math.PI/180;v._rotate(w),_._rotate(w),x._rotate(w),b._rotate(w),f=Math.min(v.x,_.x,x.x,b.x),m=Math.max(v.x,_.x,x.x,b.x),h=Math.min(v.y,_.y,x.y,b.y),d=Math.max(v.y,_.y,x.y,b.y)}t.emplaceBack(r.x,r.y,f,h,m,d,i,n,o,0,0)}this.boxEndIndex=t.length}Mc.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Mc.geometry.set=function(t){this._geometry=t},Pc.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t},Object.defineProperties(Pc.prototype,Mc),Lc.prototype.updateState=function(t,e,r){var i=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][i]=this.stateChanges[t][i]||{},f(this.stateChanges[t][i],r),null===this.deletedStates[t])for(var n in this.deletedStates[t]={},this.state[t])n!==i&&(this.deletedStates[t][n]=null);else if(this.deletedStates[t]&&null===this.deletedStates[t][i])for(var o in this.deletedStates[t][i]={},this.state[t][i])r[o]||(this.deletedStates[t][i][o]=null);else for(var a in r)this.deletedStates[t]&&this.deletedStates[t][i]&&null===this.deletedStates[t][i][a]&&delete this.deletedStates[t][i][a]},Lc.prototype.removeFeatureState=function(t,e,r){if(null!==this.deletedStates[t]){var i=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},r&&void 0!==e&&0<=e)null!==this.deletedStates[t][i]&&(this.deletedStates[t][i]=this.deletedStates[t][i]||{},this.deletedStates[t][i][r]=null);else if(void 0!==e&&0<=e)if(this.stateChanges[t]&&this.stateChanges[t][i])for(r in this.deletedStates[t][i]={},this.stateChanges[t][i])this.deletedStates[t][i][r]=null;else this.deletedStates[t][i]=null;else this.deletedStates[t]=null}},Lc.prototype.getState=function(t,e){var r=String(e),i=this.state[t]||{},n=this.stateChanges[t]||{},o=f({},i[r],n[r]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){var a=this.deletedStates[t][e];if(null===a)return{};for(var s in a)delete o[s]}return o},Lc.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},Lc.prototype.coalesceChanges=function(t,e){var r={};for(var i in this.stateChanges){this.state[i]=this.state[i]||{};var n={};for(var o in this.stateChanges[i])this.state[i][o]||(this.state[i][o]={}),f(this.state[i][o],this.stateChanges[i][o]),n[o]=this.state[i][o];r[i]=n}for(var a in this.deletedStates){this.state[a]=this.state[a]||{};var s={};if(null===this.deletedStates[a])for(var l in this.state[a])s[l]={},this.state[a][l]={};else for(var u in this.deletedStates[a]){if(null===this.deletedStates[a][u])this.state[a][u]={};else for(var c=0,p=Object.keys(this.deletedStates[a][u]);c<p.length;c+=1){var h=p[c];delete this.state[a][u][h]}s[u]=this.state[a][u]}r[a]=r[a]||{},f(r[a],s)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(var d in t)t[d].setFeatureState(r,e)},Oc.prototype.insert=function(t,e,r,i,n,o){var a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,i,n);for(var s=o?this.grid3D:this.grid,l=0;l<e.length;l++){for(var u=e[l],c=[1/0,1/0,-1/0,-1/0],p=0;p<u.length;p++){var h=u[p];c[0]=Math.min(c[0],h.x),c[1]=Math.min(c[1],h.y),c[2]=Math.max(c[2],h.x),c[3]=Math.max(c[3],h.y)}c[0]<Ia&&c[1]<Ia&&0<=c[2]&&0<=c[3]&&s.insert(a,c[0],c[1],c[2],c[3])}},Oc.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new cl.VectorTile(new Vu(this.rawTileData)).layers,this.sourceLayerCoder=new kc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Oc.prototype.query=function(n,o,a){var s=this;this.loadVTLayers();for(var l=n.params||{},u=Ia/n.tileSize/n.scale,c=Zr(l.filter),p=n.queryGeometry,h=n.queryPadding*u,t=Dc(p),d=this.grid.query(t.minX-h,t.minY-h,t.maxX+h,t.maxY+h),e=Dc(n.cameraQueryGeometry),r=0,i=this.grid3D.query(e.minX-h,e.minY-h,e.maxX+h,e.maxY+h,function(t,e,r,i){return function(t,e,r,i,n){for(var o=0,a=t;o<a.length;o+=1){var s=a[o];if(e<=s.x&&r<=s.y&&i>=s.x&&n>=s.y)return!0}var l=[new lt(e,r),new lt(e,n),new lt(i,n),new lt(i,r)];if(2<t.length)for(var u=0,c=l;u<c.length;u+=1)if(Ba(t,c[u]))return!0;for(var p=0;p<t.length-1;p++)if(Fa(t[p],t[p+1],l))return!0;return!1}(n.cameraQueryGeometry,t-h,e-h,r+h,i+h)});r<i.length;r+=1){var f=i[r];d.push(f)}d.sort(Rc);for(var m,g={},y=function(t){var e=d[t];if(e!==m){m=e;var r=s.featureIndexArray.get(e),i=null;s.loadMatchingFeature(g,r.bucketIndex,r.sourceLayerIndex,r.featureIndex,c,l.layers,o,function(t,e){i=i||ka(t);var r={};return t.id&&(r=a.getState(e.sourceLayer||"_geojsonTileLayer",t.id)),e.queryIntersectsFeature(p,t,r,i,s.z,n.transform,u,n.pixelPosMatrix)})}},v=0;v<d.length;v++)y(v);return g},Oc.prototype.loadMatchingFeature=function(t,e,r,i,n,o,a,s){var l=this.bucketLayerIDs[e];if(!o||function(t,e){for(var r=0;r<t.length;r++)if(0<=e.indexOf(t[r]))return!0;return!1}(o,l)){var u=this.sourceLayerCoder.decode(r),c=this.vtLayers[u].feature(i);if(n(new Mi(this.tileID.overscaledZ),c))for(var p=0;p<l.length;p++){var h=l[p];if(!(o&&o.indexOf(h)<0)){var d=a[h];if(d){var f=!s||s(c,d);if(f){var m=new Pc(c,this.z,this.x,this.y);m.layer=d.serialize();var g=t[h];void 0===g&&(g=t[h]=[]),g.push({featureIndex:i,feature:m,intersectionZ:f})}}}}}},Oc.prototype.lookupSymbolFeatures=function(t,e,r,i,n,o){var a={};this.loadVTLayers();for(var s=Zr(i),l=0,u=t;l<u.length;l+=1){var c=u[l];this.loadMatchingFeature(a,e,r,c,s,n,o)}return a},Oc.prototype.hasLayer=function(t){for(var e=0,r=this.bucketLayerIDs;e<r.length;e+=1)for(var i=0,n=r[e];i<n.length;i+=1)if(t===n[i])return!0;return!1},wi("FeatureIndex",Oc,{omit:["rawTileData","sourceLayerCoder"]}),zc.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<L.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},zc.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},zc.prototype.loadVectorData=function(t,e,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var i in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,o){var a={};if(!o)return a;for(var e=function(){var t=l[s],r=t.layerIds.map(function(t){return o.getLayer(t)}).filter(Boolean);if(0!==r.length){t.layers=r,t.stateDependentLayerIds&&(t.stateDependentLayers=t.stateDependentLayerIds.map(function(e){return r.filter(function(t){return t.id===e})[0]}));for(var e=0,i=r;e<i.length;e+=1){var n=i[e];a[n.id]=t}}},s=0,l=t;s<l.length;s+=1)e();return a}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var n=this.buckets[i];if(n instanceof du){if(this.hasSymbolBuckets=!0,!r)break;n.justReloaded=!0}}for(var o in this.queryPadding=0,this.buckets){var a=this.buckets[o];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(o).queryRadius(a))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new bo},zc.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},zc.prototype.unloadDEMData=function(){this.dem=null,this.neighboringTiles=null,this.state="unloaded"},zc.prototype.getBucket=function(t){return this.buckets[t.id]},zc.prototype.upload=function(t){for(var e in this.buckets){var r=this.buckets[e];r.uploadPending()&&r.upload(t)}var i=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new zu(t,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new zu(t,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null)},zc.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},zc.prototype.queryRenderedFeatures=function(t,e,r,i,n,o,a,s,l){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:r,cameraQueryGeometry:i,scale:n,tileSize:this.tileSize,pixelPosMatrix:l,transform:a,params:o,queryPadding:this.queryPadding*s},t,e):{}},zc.prototype.querySourceFeatures=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData){var r=this.latestFeatureIndex.loadVTLayers(),i=e?e.sourceLayer:"",n=r._geojsonTileLayer||r[i];if(n)for(var o=Zr(e&&e.filter),a=this.tileID.canonical,s=a.z,l=a.x,u=a.y,c={z:s,x:l,y:u},p=0;p<n.length;p++){var h=n.feature(p);if(o(new Mi(this.tileID.overscaledZ),h)){var d=new Pc(h,s,l,u);d.tile=c,t.push(d)}}}},zc.prototype.clearMask=function(){this.segments&&(this.segments.destroy(),delete this.segments),this.maskedBoundsBuffer&&(this.maskedBoundsBuffer.destroy(),delete this.maskedBoundsBuffer),this.maskedIndexBuffer&&(this.maskedIndexBuffer.destroy(),delete this.maskedIndexBuffer)},zc.prototype.setMask=function(t,e){if(!h(this.mask,t)&&(this.mask=t,this.clearMask(),!h(t,{0:!0}))){var r=new dn,i=new no;this.segments=new Vo,this.segments.prepareSegment(0,r,i);for(var n=Object.keys(t),o=0;o<n.length;o++){var a=t[+n[o]],s=Ia>>a.z,l=new lt(a.x*s,a.y*s),u=new lt(l.x+s,l.y+s),c=this.segments.prepareSegment(4,r,i);r.emplaceBack(l.x,l.y,l.x,l.y),r.emplaceBack(u.x,l.y,u.x,l.y),r.emplaceBack(l.x,u.y,l.x,u.y),r.emplaceBack(u.x,u.y,u.x,u.y);var p=c.vertexLength;i.emplaceBack(p,p+1,p+2),i.emplaceBack(p+1,p+2,p+3),c.vertexLength+=4,c.primitiveLength+=2}this.maskedBoundsBuffer=e.createVertexBuffer(r,Ac.members),this.maskedIndexBuffer=e.createIndexBuffer(i)}},zc.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},zc.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},zc.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var r=S(t.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var i=Date.now(),n=!1;if(this.expirationTime>i)n=!1;else if(e)if(this.expirationTime<e)n=!0;else{var o=this.expirationTime-e;o?this.expirationTime=i+Math.max(o,3e4):n=!0}else n=!0;n?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},zc.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},zc.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var r=this.latestFeatureIndex.loadVTLayers();for(var i in this.buckets){var n=this.buckets[i],o=n.layers[0].sourceLayer||"_geojsonTileLayer",a=r[o],s=t[o];a&&s&&0!==Object.keys(s).length&&(n.update(s,a,this.imageAtlas&&this.imageAtlas.patternPositions||{}),e&&e.style&&(this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(i).queryRadius(n))))}}},zc.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},zc.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<L.now()},zc.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},zc.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=L.now()+t},qc.prototype._addLineCollisionCircles=function(t,e,r,i,n,o,a,s,l,u){var c=o/2,p=Math.floor(n/c)||1,h=1+.4*Math.log(u)/Math.LN2,d=Math.floor(p*h/2),f=-o/2,m=r,g=i+1,y=f,v=-n/2,_=v-n/4;do{if(--g<0){if(v<y)return;g=0;break}y-=e[g].dist(m),m=e[g]}while(_<y);for(var x=e[g].dist(e[g+1]),b=-d;b<p+d;b++){var w=b*c,S=v+w;if(w<0&&(S+=w),n<w&&(S+=w-n),!(S<y)){for(;y+x<S;){if(y+=x,++g+1>=e.length)return;x=e[g].dist(e[g+1])}var T=S-y,E=e[g],I=e[g+1].sub(E)._unit()._mult(T)._add(E)._round(),C=Math.abs(S-f)<c?0:.8*(S-f);t.emplaceBack(I.x,I.y,-o/2,-o/2,o/2,o/2,a,s,l,o/2,C)}}};var Vc=function(t,e){if(void 0===t&&(t=[]),void 0===e&&(e=Gc),this.data=t,this.length=this.data.length,this.compare=e,0<this.length)for(var r=(this.length>>1)-1;0<=r;r--)this._down(r)};function Gc(t,e){return t<e?-1:e<t?1:0}function Zc(t,e,r){void 0===e&&(e=1),void 0===r&&(r=!1);for(var i=1/0,n=1/0,o=-1/0,a=-1/0,s=t[0],l=0;l<s.length;l++){var u=s[l];(!l||u.x<i)&&(i=u.x),(!l||u.y<n)&&(n=u.y),(!l||u.x>o)&&(o=u.x),(!l||u.y>a)&&(a=u.y)}var c=o-i,p=a-n,h=Math.min(c,p),d=h/2,f=new Vc([],Hc);if(0===h)return new lt(i,n);for(var m=i;m<o;m+=h)for(var g=n;g<a;g+=h)f.push(new Wc(m+d,g+d,d,t));for(var y=function(t){for(var e=0,r=0,i=0,n=t[0],o=0,a=n.length,s=a-1;o<a;s=o++){var l=n[o],u=n[s],c=l.x*u.y-u.x*l.y;r+=(l.x+u.x)*c,i+=(l.y+u.y)*c,e+=3*c}return new Wc(r/e,i/e,0,t)}(t),v=f.length;f.length;){var _=f.pop();(_.d>y.d||!y.d)&&(y=_,r&&console.log("found best %d after %d probes",Math.round(1e4*_.d)/1e4,v)),_.max-y.d<=e||(d=_.h/2,f.push(new Wc(_.p.x-d,_.p.y-d,d,t)),f.push(new Wc(_.p.x+d,_.p.y-d,d,t)),f.push(new Wc(_.p.x-d,_.p.y+d,d,t)),f.push(new Wc(_.p.x+d,_.p.y+d,d,t)),v+=4)}return r&&(console.log("num probes: "+v),console.log("best distance: "+y.d)),y.p}function Hc(t,e){return e.max-t.max}function Wc(t,e,r,i){this.p=new lt(t,e),this.h=r,this.d=function(t,e){for(var r=!1,i=1/0,n=0;n<e.length;n++)for(var o=e[n],a=0,s=o.length,l=s-1;a<s;l=a++){var u=o[a],c=o[l];u.y>t.y!=c.y>t.y&&t.x<(c.x-u.x)*(t.y-u.y)/(c.y-u.y)+u.x&&(r=!r),i=Math.min(i,za(t,u,c))}return(r?1:-1)*Math.sqrt(i)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}Vc.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},Vc.prototype.pop=function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,0<this.length&&(this.data[0]=e,this._down(0)),t}},Vc.prototype.peek=function(){return this.data[0]},Vc.prototype._up=function(t){for(var e=this.data,r=this.compare,i=e[t];0<t;){var n=t-1>>1,o=e[n];if(0<=r(i,o))break;e[t]=o,t=n}e[t]=i},Vc.prototype._down=function(t){for(var e=this.data,r=this.compare,i=this.length>>1,n=e[t];t<i;){var o=1+(t<<1),a=e[o],s=o+1;if(s<this.length&&r(e[s],a)<0&&(a=e[o=s]),0<=r(a,n))break;e[t]=a,t=o}e[t]=n};var Kc=e(function(t){t.exports=function(t,e){var r,i,n,o,a,s,l,u;for(r=3&t.length,i=t.length-r,n=e,a=3432918353,s=461845907,u=0;u<i;)l=255&t.charCodeAt(u)|(255&t.charCodeAt(++u))<<8|(255&t.charCodeAt(++u))<<16|(255&t.charCodeAt(++u))<<24,++u,n=27492+(65535&(o=5*(65535&(n=(n^=l=(65535&(l=(l=(65535&l)*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|n>>>19))+((5*(n>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(l=0,r){case 3:l^=(255&t.charCodeAt(u+2))<<16;case 2:l^=(255&t.charCodeAt(u+1))<<8;case 1:n^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(u)))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return n^=t.length,n=2246822507*(65535&(n^=n>>>16))+((2246822507*(n>>>16)&65535)<<16)&4294967295,n=3266489909*(65535&(n^=n>>>13))+((3266489909*(n>>>16)&65535)<<16)&4294967295,(n^=n>>>16)>>>0}}),Xc=e(function(t){t.exports=function(t,e){for(var r,i=t.length,n=e^i,o=0;4<=i;)r=1540483477*(65535&(r=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+((1540483477*(r>>>16)&65535)<<16),n=1540483477*(65535&n)+((1540483477*(n>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),i-=4,++o;switch(i){case 3:n^=(255&t.charCodeAt(o+2))<<16;case 2:n^=(255&t.charCodeAt(o+1))<<8;case 1:n=1540483477*(65535&(n^=255&t.charCodeAt(o)))+((1540483477*(n>>>16)&65535)<<16)}return n=1540483477*(65535&(n^=n>>>13))+((1540483477*(n>>>16)&65535)<<16),(n^=n>>>15)>>>0}}),Yc=Kc,Jc=Kc,Qc=Xc;Yc.murmur3=Jc,Yc.murmur2=Qc;var $c=Number.POSITIVE_INFINITY;function tp(t,e){return e[1]!==$c?function(t,e,r){var i=0,n=0;switch(e=Math.abs(e),r=Math.abs(r),t){case"top-right":case"top-left":case"top":n=r-7;break;case"bottom-right":case"bottom-left":case"bottom":n=7-r}switch(t){case"top-right":case"bottom-right":case"right":i=-e;break;case"top-left":case"bottom-left":case"left":i=e}return[i,n]}(t,e[0],e[1]):function(t,e){var r=0,i=0;e<0&&(e=0);var n=e/Math.sqrt(2);switch(t){case"top-right":case"top-left":i=n-7;break;case"bottom-right":case"bottom-left":i=7-n;break;case"bottom":i=7-e;break;case"top":i=e-7}switch(t){case"top-right":case"bottom-right":r=-n;break;case"top-left":case"bottom-left":r=n;break;case"left":r=e;break;case"right":r=-e}return[r,i]}(t,e[0])}function ep(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}var rp=65535;function ip(t,e,r,i,n,o,a,s,l,u,c,p,h,d){var f=function(t,e,r,i,n,o,a,s){for(var l=i.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=e.positionedGlyphs,c=[],p=0;p<u.length;p++){var h=u[p],d=a[h.fontStack],f=d&&d[h.glyph];if(f){var m=f.rect;if(m){var g=pc+1,y=f.metrics.advance*h.scale/2,v=n?[h.x+y,h.y]:[0,0],_=n?[0,0]:[h.x+y+r[0],h.y+r[1]],x=(n||s)&&h.vertical,b=[0,0];x&&(b=_,_=[0,0]);var w=(f.metrics.left-g)*h.scale-y+_[0],S=(-f.metrics.top-g)*h.scale+_[1],T=w+m.w*h.scale,E=S+m.h*h.scale,I=new lt(w,S),C=new lt(T,S),k=new lt(w,E),A=new lt(T,E);if(x){var P=new lt(-y,y-e.yOffset),M=-Math.PI/2,L=Vl/2-y,O=new lt(5-e.yOffset-L,0),D=new(Function.prototype.bind.apply(lt,[null].concat(b)));I._rotateAround(M,P)._add(O)._add(D),C._rotateAround(M,P)._add(O)._add(D),k._rotateAround(M,P)._add(O)._add(D),A._rotateAround(M,P)._add(O)._add(D)}if(l){var R=Math.sin(l),z=Math.cos(l),N=[z,-R,R,z];I._matMult(N),C._matMult(N),k._matMult(N),A._matMult(N)}c.push({tl:I,tr:C,bl:k,br:A,tex:m,writingMode:e.writingMode,glyphOffset:v,sectionIndex:h.sectionIndex})}}}return c}(0,r,a,i,n,o,p,t.allowVerticalPlacement),m=t.textSizeData,g=null;"source"===m.kind?(g=[ru*i.layout.get("text-size").evaluate(o,{})])[0]>rp&&ut(t.layerIds[0]+': Value for "text-size" is >= 256. Reduce your "text-size".'):"composite"===m.kind&&((g=[ru*d.compositeTextSizes[0].evaluate(o,{}),ru*d.compositeTextSizes[1].evaluate(o,{})])[0]>rp||g[1]>rp)&&ut(t.layerIds[0]+': Value for "text-size" is >= 256. Reduce your "text-size".'),t.addSymbols(t.text,f,g,a,n,o,l,e,s.lineStartIndex,s.lineLength,h);for(var y=0,v=u;y<v.length;y+=1)c[v[y]]=t.text.placedSymbolArray.length-1;return 4*f.length}function np(t,e,r,i){var n=t.compareText;if(e in n){for(var o=n[e],a=o.length-1;0<=a;a--)if(i.dist(o[a])<r)return!0}else n[e]=[];return n[e].push(i),!1}t.Actor=hc,t.AlphaImage=os,t.CanonicalTileID=Sc,t.CollisionBoxArray=bo,t.Color=ne,t.DEMData=Cc,t.DataConstantProperty=Hi,t.DictionaryCoder=kc,t.EXTENT=Ia,t.ErrorEvent=Pt,t.EvaluationParameters=Mi,t.Event=Ct,t.Evented=kt,t.FeatureIndex=Oc,t.FillBucket=Xs,t.FillExtrusionBucket=fl,t.ImageAtlas=Ru,t.ImagePosition=Ou,t.LineBucket=bl,t.LngLat=mc,t.LngLatBounds=fc,t.MercatorCoordinate=wc,t.ONE_EM=Vl,t.OverscaledTileID=Ec,t.Point=lt,t.Point$1=lt,t.ProgramConfiguration=Sa,t.Properties=$i,t.Protobuf=Vu,t.RGBAImage=as,t.RequestManager=B,t.ResourceType=ht,t.SegmentVector=Vo,t.SourceFeatureState=Lc,t.StructArrayLayout1ui2=co,t.StructArrayLayout2i4=cn,t.StructArrayLayout2ui4=so,t.StructArrayLayout3ui6=no,t.StructArrayLayout4i8=dn,t.SymbolBucket=du,t.Texture=zu,t.Tile=zc,t.Transitionable=Ui,t.Uniform1f=ia,t.Uniform1i=ra,t.Uniform2f=na,t.Uniform3f=oa,t.Uniform4f=aa,t.UniformColor=sa,t.UniformMatrix4f=ua,t.UnwrappedTileID=Tc,t.ValidationError=Ot,t.WritingMode=Gl,t.ZoomHistory=Ii,t.addDynamicAttributes=cu,t.asyncAll=function(t,e,i){if(!t.length)return i(null,[]);var n=t.length,o=new Array(t.length),a=null;t.forEach(function(t,r){e(t,function(t,e){t&&(a=t),o[r]=e,0==--n&&i(a,o)})})},t.bezier=n,t.bindAll=m,t.browser=L,t.cacheEntryPossiblyAdded=function(t){++pt>nt&&(t.getActor().send("enforceCacheSizeLimit",it),pt=0)},t.clamp=l,t.clearTileCache=function(t){var e=self.caches.delete(rt);t&&e.catch(t).then(function(){return t()})},t.clone=function(t){var e=new Wa(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.clone$1=_,t.config=O,t.create=function(){var t=new Wa(16);return Wa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.create$1=function(){var t=new Wa(9);return Wa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},t.create$2=function(){var t=new Wa(4);return Wa!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},t.createCommonjsModule=e,t.createExpression=Lr,t.createLayout=sn,t.createStyleLayer=function(t){return"custom"===t.type?new Au(t):new Pu[t.type](t)},t.deepEqual=h,t.ease=o,t.emitValidationErrors=gi,t.endsWith=g,t.enforceCacheSizeLimit=function(i){self.caches&&self.caches.open(rt).then(function(r){r.keys().then(function(t){for(var e=0;e<t.length-i;e++)r.delete(t[e])})})},t.evaluateSizeForFeature=nu,t.evaluateSizeForZoom=ou,t.evaluateVariableOffset=tp,t.evented=zi,t.extend=f,t.featureFilter=Zr,t.filterObject=v,t.fromRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=-r,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.getAnchorAlignment=Jl,t.getAnchorJustification=ep,t.getArrayBuffer=xt,t.getImage=Tt,t.getJSON=function(t,e){return _t(f(t,{type:"json"}),e)},t.getReferrer=yt,t.getVideo=function(t,e){var r,i,n=self.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(var o=0;o<t.length;o++){var a=self.document.createElement("source");r=t[o],i=void 0,(i=self.document.createElement("a")).href=r,i.protocol===self.document.location.protocol&&i.host===self.document.location.host||(n.crossOrigin="Anonymous"),a.src=t[o],n.appendChild(a)}return{cancel:function(){}}},t.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.invert=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=e[9],h=e[10],d=e[11],f=e[12],m=e[13],g=e[14],y=e[15],v=r*s-i*a,_=r*l-n*a,x=r*u-o*a,b=i*l-n*s,w=i*u-o*s,S=n*u-o*l,T=c*m-p*f,E=c*g-h*f,I=c*y-d*f,C=p*g-h*m,k=p*y-d*m,A=h*y-d*g,P=v*A-_*k+x*C+b*I-w*E+S*T;return P?(P=1/P,t[0]=(s*A-l*k+u*C)*P,t[1]=(n*k-i*A-o*C)*P,t[2]=(m*S-g*w+y*b)*P,t[3]=(h*w-p*S-d*b)*P,t[4]=(l*I-a*A-u*E)*P,t[5]=(r*A-n*I+o*E)*P,t[6]=(g*x-f*S-y*_)*P,t[7]=(c*S-h*x+d*_)*P,t[8]=(a*k-s*I+u*T)*P,t[9]=(i*I-r*k-o*T)*P,t[10]=(f*w-m*x+y*v)*P,t[11]=(p*x-c*w-d*v)*P,t[12]=(s*E-a*C-l*T)*P,t[13]=(r*C-i*E+n*T)*P,t[14]=(m*_-f*b-g*v)*P,t[15]=(c*b-p*_+h*v)*P,t):null},t.isChar=Ci,t.isMapboxURL=U,t.keysDifference=function(t,e){var r=[];for(var i in t)i in e||r.push(i);return r},t.makeRequest=_t,t.mapObject=y,t.mercatorXfromLng=vc,t.mercatorYfromLat=_c,t.mercatorZfromAltitude=xc,t.multiply=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=e[8],h=e[9],d=e[10],f=e[11],m=e[12],g=e[13],y=e[14],v=e[15],_=r[0],x=r[1],b=r[2],w=r[3];return t[0]=_*i+x*s+b*p+w*m,t[1]=_*n+x*l+b*h+w*g,t[2]=_*o+x*u+b*d+w*y,t[3]=_*a+x*c+b*f+w*v,_=r[4],x=r[5],b=r[6],w=r[7],t[4]=_*i+x*s+b*p+w*m,t[5]=_*n+x*l+b*h+w*g,t[6]=_*o+x*u+b*d+w*y,t[7]=_*a+x*c+b*f+w*v,_=r[8],x=r[9],b=r[10],w=r[11],t[8]=_*i+x*s+b*p+w*m,t[9]=_*n+x*l+b*h+w*g,t[10]=_*o+x*u+b*d+w*y,t[11]=_*a+x*c+b*f+w*v,_=r[12],x=r[13],b=r[14],w=r[15],t[12]=_*i+x*s+b*p+w*m,t[13]=_*n+x*l+b*h+w*g,t[14]=_*o+x*u+b*d+w*y,t[15]=_*a+x*c+b*f+w*v,t},t.mvt=cl,t.number=Me,t.ortho=function(t,e,r,i,n,o,a){var s=1/(e-r),l=1/(i-n),u=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*s,t[13]=(n+i)*l,t[14]=(a+o)*u,t[15]=1,t},t.parseGlyphPBF=function(t){return new Vu(t).readFields(sc,[])},t.pbf=Vu,t.performSymbolLayout=function(D,R,z,N,B,t){D.createArrays();var e=512*D.overscaling;D.tilePixelRatio=Ia/e,D.compareText={},D.iconsNeedLinear=!1;var F=D.layers[0].layout,r=D.layers[0]._unevaluatedLayout._values,U={};if("composite"===D.textSizeData.kind){var i=D.textSizeData,n=i.minZoom,o=i.maxZoom;U.compositeTextSizes=[r["text-size"].possiblyEvaluate(new Mi(n)),r["text-size"].possiblyEvaluate(new Mi(o))]}if("composite"===D.iconSizeData.kind){var a=D.iconSizeData,s=a.minZoom,l=a.maxZoom;U.compositeIconSizes=[r["icon-size"].possiblyEvaluate(new Mi(s)),r["icon-size"].possiblyEvaluate(new Mi(l))]}U.layoutTextSize=r["text-size"].possiblyEvaluate(new Mi(D.zoom+1)),U.layoutIconSize=r["icon-size"].possiblyEvaluate(new Mi(D.zoom+1)),U.textMaxSize=r["text-size"].possiblyEvaluate(new Mi(18));for(var j=F.get("text-line-height")*Vl,q="map"===F.get("text-rotation-alignment")&&"point"!==F.get("symbol-placement"),V=F.get("text-keep-upright"),u=function(){var t=Z[G],e=F.get("text-font").evaluate(t,{}).join(","),r=z,i={horizontal:{},vertical:void 0},n=t.text,o=[0,0];if(n){var a=n.toString(),s=F.get("text-letter-spacing").evaluate(t,{})*Vl,l=function(){for(var t=0,e=a;t<e.length;t+=1)if(r=e[t].charCodeAt(0),Ci.Arabic(r)||Ci["Arabic Supplement"](r)||Ci["Arabic Extended-A"](r)||Ci["Arabic Presentation Forms-A"](r)||Ci["Arabic Presentation Forms-B"](r))return!1;var r;return!0}()?s:0,u=F.get("text-anchor").evaluate(t,{}),c=F.get("text-variable-anchor");if(!c){var p=F.get("text-radial-offset").evaluate(t,{});o=p?tp(u,[p*Vl,$c]):F.get("text-offset").evaluate(t,{}).map(function(t){return t*Vl})}var h=q?"center":F.get("text-justify").evaluate(t,{}),d=F.get("symbol-placement"),f="point"===d?F.get("text-max-width").evaluate(t,{})*Vl:0,m=function(){D.allowVerticalPlacement&&ki(a)&&(i.vertical=Zl(n,R,e,f,j,u,"left",l,o,Gl.vertical,!0,d))};if(!q&&c){for(var g="auto"===h?c.map(function(t){return ep(t)}):[h],y=!1,v=0;v<g.length;v++){var _=g[v];if(!i.horizontal[_])if(y)i.horizontal[_]=i.horizontal[0];else{var x=Zl(n,R,e,f,j,"center",_,l,o,Gl.horizontal,!1,d);x&&(y=1===(i.horizontal[_]=x).lineCount)}}m()}else{"auto"===h&&(h=ep(u));var b=Zl(n,R,e,f,j,u,h,l,o,Gl.horizontal,!1,d);b&&(i.horizontal[h]=b),m(),ki(a)&&q&&V&&(i.vertical=Zl(n,R,e,f,j,u,h,l,o,Gl.vertical,!1,d))}}var w,S,T,E,I,C,k,A,P,M,L=void 0;if(t.icon&&t.icon.name){var O=N[t.icon.name];O&&(w=B[t.icon.name],S=F.get("icon-offset").evaluate(t,{}),T=Jl(F.get("icon-anchor").evaluate(t,{})),E=T.horizontalAlign,I=T.verticalAlign,C=S[0],k=S[1],A=C-w.displaySize[0]*E,P=A+w.displaySize[0],M=k-w.displaySize[1]*I,L={image:w,top:M,bottom:M+w.displaySize[1],left:A,right:P},void 0===D.sdfIcons?D.sdfIcons=O.sdf:D.sdfIcons!==O.sdf&&ut("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),O.pixelRatio!==D.pixelRatio?D.iconsNeedLinear=!0:0!==F.get("icon-rotate").constantOr(1)&&(D.iconsNeedLinear=!0))}(Object.keys(i.horizontal).length||L)&&function(r,i,n,o,a,s,l){var t=s.layoutTextSize.evaluate(i,{}),e=s.layoutIconSize.evaluate(i,{}),u=s.textMaxSize.evaluate(i,{});void 0===u&&(u=t);var c,p,h,d,f,m,g,y,v,_,x,b,w,S=r.layers[0].layout,T=S.get("icon-offset").evaluate(i,{}),E=function(t){for(var e in t)return t[e];return null}(n.horizontal),I=t/24,C=r.tilePixelRatio*I,k=r.tilePixelRatio*u/24,A=r.tilePixelRatio*e,P=r.tilePixelRatio*S.get("symbol-spacing"),M=S.get("text-padding")*r.tilePixelRatio,L=S.get("icon-padding")*r.tilePixelRatio,O=S.get("text-max-angle")/180*Math.PI,D="map"===S.get("text-rotation-alignment")&&"point"!==S.get("symbol-placement"),R="map"===S.get("icon-rotation-alignment")&&"point"!==S.get("symbol-placement"),z=S.get("symbol-placement"),N=P/2,B=S.get("icon-text-fit");function F(t,e){e.x<0||e.x>=Ia||e.y<0||e.y>=Ia||function(t,e,r,i,n,o,a,s,l,u,c,p,h,d,f,m,g,y,v,_,x){var b,w,S,T,E=t.addToLineVertexArray(e,r),I=0,C=0,k=0,A=-1,P={},M=Yc(""),L=0,O=0;if(O=void 0===o._unevaluatedLayout.getValue("text-radial-offset")?(L=(b=o.layout.get("text-offset").evaluate(v,{}).map(function(t){return t*Vl}))[0],b[1]):(L=o.layout.get("text-radial-offset").evaluate(v,{})*Vl,$c),t.allowVerticalPlacement&&i.vertical){var D=o.layout.get("text-rotate").evaluate(v,{})+90,R=i.vertical;T=new qc(a,r,e,s,l,u,R,c,p,h,t.overscaling,D)}if(n){var z=o.layout.get("icon-rotate").evaluate(v,{}),N=function(t,e){var r=t.image,i=t.right-t.left,n=(i*r.paddedRect.w/(r.paddedRect.w-2)-i)/2,o=t.left-n,a=t.right+n,s=t.bottom-t.top,l=(s*r.paddedRect.h/(r.paddedRect.h-2)-s)/2,u=t.top-l,c=t.bottom+l,p=new lt(o,u),h=new lt(a,u),d=new lt(a,c),f=new lt(o,c),m=e*Math.PI/180;if(m){var g=Math.sin(m),y=Math.cos(m),v=[y,-g,g,y];p._matMult(v),h._matMult(v),f._matMult(v),d._matMult(v)}return[{tl:p,tr:h,bl:f,br:d,tex:r.paddedRect,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0}]}(n,z);S=new qc(a,r,e,s,l,u,n,f,m,!1,t.overscaling,z),I=4*N.length;var B=t.iconSizeData,F=null;"source"===B.kind?(F=[ru*o.layout.get("icon-size").evaluate(v,{})])[0]>rp&&ut(t.layerIds[0]+': Value for "icon-size" is >= 256. Reduce your "icon-size".'):"composite"===B.kind&&((F=[ru*x.compositeIconSizes[0].evaluate(v,{}),ru*x.compositeIconSizes[1].evaluate(v,{})])[0]>rp||F[1]>rp)&&ut(t.layerIds[0]+': Value for "icon-size" is >= 256. Reduce your "icon-size".'),t.addSymbols(t.icon,N,F,y,g,v,!1,e,E.lineStartIndex,E.lineLength,-1),A=t.icon.placedSymbolArray.length-1}for(var U in i.horizontal){var j=i.horizontal[U];if(!w){M=Yc(j.text);var q=o.layout.get("text-rotate").evaluate(v,{});w=new qc(a,r,e,s,l,u,j,c,p,h,t.overscaling,q)}var V=1===j.lineCount;if(C+=ip(t,e,j,o,h,v,d,E,i.vertical?Gl.horizontal:Gl.horizontalOnly,V?Object.keys(i.horizontal):[U],P,_,A,x),V)break}i.vertical&&(k+=ip(t,e,i.vertical,o,h,v,d,E,Gl.vertical,["vertical"],P,_,A,x));var G=w?w.boxStartIndex:t.collisionBoxArray.length,Z=w?w.boxEndIndex:t.collisionBoxArray.length,H=T?T.boxStartIndex:t.collisionBoxArray.length,W=T?T.boxEndIndex:t.collisionBoxArray.length,K=S?S.boxStartIndex:t.collisionBoxArray.length,X=S?S.boxEndIndex:t.collisionBoxArray.length;t.glyphOffsetArray.length>=du.MAX_GLYPHS&&ut("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),t.symbolInstances.emplaceBack(e.x,e.y,0<=P.right?P.right:-1,0<=P.center?P.center:-1,0<=P.left?P.left:-1,P.vertical||-1,A,M,G,Z,H,W,K,X,s,C,k,I,0,c,L,O)}(r,e,t,n,o,r.layers[0],r.collisionBoxArray,i.index,i.sourceLayerIndex,r.index,C,M,D,l,A,L,R,T,i,a,s)}if(o&&"none"!==B&&E&&(o=function(t,e,r,i,n,o){var a,s,l,u,c=t.image,p=e.left*o,h=e.right*o;s="width"===r||"both"===r?(u=n[0]+p-i[3],n[0]+h+i[1]):(u=n[0]+(p+h-c.displaySize[0])/2)+c.displaySize[0];var d=e.top*o,f=e.bottom*o;return l="height"===r||"both"===r?(a=n[1]+d-i[0],n[1]+f+i[2]):(a=n[1]+(d+f-c.displaySize[1])/2)+c.displaySize[1],{image:c,top:a,right:s,bottom:l,left:u}}(o,E,B,S.get("icon-text-fit-padding"),T,I)),"line"===z)for(var U=0,j=function(t,e,r,i,n){for(var o=[],a=0;a<t.length;a++)for(var s=t[a],l=void 0,u=0;u<s.length-1;u++){var c=s[u],p=s[u+1];c.x<0&&p.x<0||(c.x<0?c=new lt(0,c.y+(p.y-c.y)*((0-c.x)/(p.x-c.x)))._round():p.x<0&&(p=new lt(0,c.y+(p.y-c.y)*((0-c.x)/(p.x-c.x)))._round()),c.y<0&&p.y<0||(c.y<0?c=new lt(c.x+(p.x-c.x)*((0-c.y)/(p.y-c.y)),0)._round():p.y<0&&(p=new lt(c.x+(p.x-c.x)*((0-c.y)/(p.y-c.y)),0)._round()),c.x>=i&&p.x>=i||(c.x>=i?c=new lt(i,c.y+(p.y-c.y)*((i-c.x)/(p.x-c.x)))._round():p.x>=i&&(p=new lt(i,c.y+(p.y-c.y)*((i-c.x)/(p.x-c.x)))._round()),c.y>=n&&p.y>=n||(c.y>=n?c=new lt(c.x+(p.x-c.x)*((n-c.y)/(p.y-c.y)),n)._round():p.y>=n&&(p=new lt(c.x+(p.x-c.x)*((n-c.y)/(p.y-c.y)),n)._round()),l&&c.equals(l[l.length-1])||(l=[c],o.push(l)),l.push(p)))))}return o}(i.geometry,0,0,Ia,Ia);U<j.length;U+=1)for(var q=j[U],V=0,G=(c=q,p=P,h=O,d=n.vertical||E,f=o,m=24,g=k,y=r.overscaling,v=Ia,_=Fc(d,m,g),x=Uc(d,f),b=x*g,w=0===c[0].x||c[0].x===v||0===c[0].y||c[0].y===v,p-b<p/4&&(p=b+p/4),function t(e,r,i,n,o,a,s,l,u){for(var c=a/2,p=Bc(e),h=0,d=r-i,f=[],m=0;m<e.length-1;m++){for(var g=e[m],y=e[m+1],v=g.dist(y),_=y.angleTo(g);d+i<h+v;){var x=((d+=i)-h)/v,b=Me(g.x,y.x,x),w=Me(g.y,y.y,x);if(0<=b&&b<u&&0<=w&&w<u&&0<=d-c&&d+c<=p){var S=new tu(b,w,_,m);S._round(),n&&!Nc(e,S,a,n,o)||f.push(S)}}h+=v}return l||f.length||s||(f=t(e,h/2,i,n,o,a,s,!0,u)),f}(c,w?p/2*y%p:(x/2+2*m)*g*y%p,p,_,h,b,w,!1,v));V<G.length;V+=1){var Z=G[V];E&&np(r,E.text,N,Z)||F(q,Z)}else if("line-center"===z)for(var H=0,W=i.geometry;H<W.length;H+=1){var K=W[H];if(1<K.length){var X=jc(K,O,n.vertical||E,o,24,k);X&&F(K,X)}}else if("Polygon"===i.type)for(var Y=0,J=Zs(i.geometry,0);Y<J.length;Y+=1){var Q=J[Y],$=Zc(Q,16);F(Q[0],new tu($.x,$.y,0))}else if("LineString"===i.type)for(var tt=0,et=i.geometry;tt<et.length;tt+=1){var rt=et[tt];F(rt,new tu(rt[0].x,rt[0].y,0))}else if("Point"===i.type)for(var it=0,nt=i.geometry;it<nt.length;it+=1)for(var ot=0,at=nt[it];ot<at.length;ot+=1){var st=at[ot];F([st],new tu(st.x,st.y,0))}}(D,t,i,L,r,U,o)},G=0,Z=D.features;G<Z.length;G+=1)u();t&&D.generateCollisionDebugBuffers()},t.perspective=function(t,e,r,i,n){var o,a=1/Math.tan(e/2);return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=n&&n!==1/0?(o=1/(i-n),t[10]=(n+i)*o,t[14]=2*n*i*o):(t[10]=-1,t[14]=-2*i),t},t.pick=function(t,e){for(var r={},i=0;i<e.length;i++){var n=e[i];n in t&&(r[n]=t[n])}return r},t.plugin=Ni,t.polygonIntersectsPolygon=Ma,t.postMapLoadEvent=et,t.postTurnstileEvent=$,t.potpack=Lu,t.rasterBoundsAttributes=Ac,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.register=wi,t.registerForPluginAvailability=function(t){return Di?t({pluginURL:Di,completionCallback:Li}):zi.once("pluginAvailable",t),t},t.rotate=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=Math.sin(r),l=Math.cos(r);return t[0]=i*l+o*s,t[1]=n*l+a*s,t[2]=i*-s+o*l,t[3]=n*-s+a*l,t},t.rotateX=function(t,e,r){var i=Math.sin(r),n=Math.cos(r),o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],p=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*n+u*i,t[5]=a*n+c*i,t[6]=s*n+p*i,t[7]=l*n+h*i,t[8]=u*n-o*i,t[9]=c*n-a*i,t[10]=p*n-s*i,t[11]=h*n-l*i,t},t.rotateZ=function(t,e,r){var i=Math.sin(r),n=Math.cos(r),o=e[0],a=e[1],s=e[2],l=e[3],u=e[4],c=e[5],p=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n+u*i,t[1]=a*n+c*i,t[2]=s*n+p*i,t[3]=l*n+h*i,t[4]=u*n-o*i,t[5]=c*n-a*i,t[6]=p*n-s*i,t[7]=h*n-l*i,t},t.scale=function(t,e,r){var i=r[0],n=r[1],o=r[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.setCacheLimits=function(t,e){it=t,nt=e},t.setRTLTextPlugin=function(t,e){if(Oi)throw new Error("setRTLTextPlugin cannot be called multiple times.");Oi=!0,Di=L.resolveURL(t),Li=function(t){t?(Oi=!1,Di=null,e&&e(t)):Ri=!0},zi.fire(new Ct("pluginAvailable",{pluginURL:Di,completionCallback:Li}))},t.sphericalToCartesian=function(t){var e=t[0],r=t[1],i=t[2];return r+=90,r*=Math.PI/180,i*=Math.PI/180,{x:e*Math.cos(r)*Math.sin(i),y:e*Math.sin(r)*Math.sin(i),z:e*Math.cos(i)}},t.styleSpec=Lt,t.symbolSize=au,t.transformMat3=function(t,e,r){var i=e[0],n=e[1],o=e[2];return t[0]=i*r[0]+n*r[3]+o*r[6],t[1]=i*r[1]+n*r[4]+o*r[7],t[2]=i*r[2]+n*r[5]+o*r[8],t},t.transformMat4=Ka,t.translate=function(t,e,r){var i,n,o,a,s,l,u,c,p,h,d,f,m=r[0],g=r[1],y=r[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*y+e[12],t[13]=e[1]*m+e[5]*g+e[9]*y+e[13],t[14]=e[2]*m+e[6]*g+e[10]*y+e[14],t[15]=e[3]*m+e[7]*g+e[11]*y+e[15]):(i=e[0],n=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=e[8],h=e[9],d=e[10],f=e[11],t[0]=i,t[1]=n,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=p,t[9]=h,t[10]=d,t[11]=f,t[12]=i*m+s*g+p*y+e[12],t[13]=n*m+l*g+h*y+e[13],t[14]=o*m+u*g+d*y+e[14],t[15]=a*m+c*g+f*y+e[15]),t},t.uniqueId=c,t.validateCustomStyleLayer=function(t){var e=[],r=t.id;return void 0===r&&e.push({message:"layers."+r+': missing required property "id"'}),void 0===t.render&&e.push({message:"layers."+r+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),e},t.validateLight=di,t.validateStyle=hi,t.values=function(t){var e=[];for(var r in t)e.push(t[r]);return e},t.vectorTile=cl,t.version="1.4.1",t.warnOnce=ut,t.webpSupported=D,t.window=self,t.wrap=s}),r(["./shared"],function(A){function l(t){var e=typeof t;if("number"==e||"boolean"==e||"string"==e||null==t)return JSON.stringify(t);if(Array.isArray(t)){for(var r="[",i=0,n=t;i<n.length;i+=1)r+=l(n[i])+",";return r+"]"}for(var o=Object.keys(t).sort(),a="{",s=0;s<o.length;s++)a+=JSON.stringify(o[s])+":"+l(t[o[s]])+",";return a+"}"}function v(t){for(var e="",r=0,i=A.refProperties;r<i.length;r+=1)e+="/"+l(t[i[r]]);return e}function r(t){this.keyCache={},t&&this.replace(t)}function P(t){var e={},r=[];for(var i in t){var n=t[i],o=e[i]={};for(var a in n){var s=n[+a];if(s&&0!==s.bitmap.width&&0!==s.bitmap.height){var l={x:0,y:0,w:s.bitmap.width+2,h:s.bitmap.height+2};r.push(l),o[a]={rect:l,metrics:s.metrics}}}}var u=A.potpack(r),c=u.w,p=u.h,h=new A.AlphaImage({width:c||1,height:p||1});for(var d in t){var f=t[d];for(var m in f){var g=f[+m];if(g&&0!==g.bitmap.width&&0!==g.bitmap.height){var y=e[d][m].rect;A.AlphaImage.copy(g.bitmap,h,{x:0,y:0},{x:y.x+1,y:y.y+1},g.bitmap)}}}this.image=h,this.positions=e}function e(t){this.tileID=new A.OverscaledTileID(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies}function M(t,e,r){for(var i=new A.EvaluationParameters(e),n=0,o=t;n<o.length;n+=1)o[n].recalculate(i,r)}function t(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},p.mark(this._marks.start)}r.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},r.prototype.update=function(t,e){for(var r=this,i=0,n=t;i<n.length;i+=1){var o=n[i];this._layerConfigs[o.id]=o;var a=this._layers[o.id]=A.createStyleLayer(o);a._featureFilter=A.featureFilter(a.filter),this.keyCache[o.id]&&delete this.keyCache[o.id]}for(var s=0,l=e;s<l.length;s+=1){var u=l[s];delete this.keyCache[u],delete this._layerConfigs[u],delete this._layers[u]}this.familiesBySource={};for(var c=0,p=function(t,e){for(var r={},i=0;i<t.length;i++){var n=e&&e[t[i].id]||v(t[i]);e&&(e[t[i].id]=n);var o=r[n];(o=o||(r[n]=[])).push(t[i])}var a=[];for(var s in r)a.push(r[s]);return a}(A.values(this._layerConfigs),this.keyCache);c<p.length;c+=1){var h=p[c].map(function(t){return r._layers[t.id]}),d=h[0];if("none"!==d.visibility){var f=d.source||"",m=this.familiesBySource[f];m=m||(this.familiesBySource[f]={});var g=d.sourceLayer||"_geojsonTileLayer",y=m[g];(y=y||(m[g]=[])).push(h)}}},A.register("GlyphAtlas",P),e.prototype.parse=function(t,e,n,r,o){var i=this;this.status="parsing",this.data=t,this.collisionBoxArray=new A.CollisionBoxArray;var a=new A.DictionaryCoder(Object.keys(t.layers).sort()),s=new A.FeatureIndex(this.tileID);s.bucketLayerIDs=[];var l,u,c,p,h={},d={featureIndex:s,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:n},f=e.familiesBySource[this.source];for(var m in f){var g=t.layers[m];if(g){1===g.version&&A.warnOnce('Vector tile source "'+this.source+'" layer "'+m+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var y=a.encode(m),v=[],_=0;_<g.length;_++){var x=g.feature(_);v.push({feature:x,index:_,sourceLayerIndex:y})}for(var b=0,w=f[m];b<w.length;b+=1){var S=w[b],T=S[0];T.minzoom&&this.zoom<Math.floor(T.minzoom)||T.maxzoom&&this.zoom>=T.maxzoom||"none"!==T.visibility&&(M(S,this.zoom,n),(h[T.id]=T.createBucket({index:s.bucketLayerIDs.length,layers:S,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:y,sourceID:this.source})).populate(v,d),s.bucketLayerIDs.push(S.map(function(t){return t.id})))}}}var E=A.mapObject(d.glyphDependencies,function(t){return Object.keys(t).map(Number)});Object.keys(E).length?r.send("getGlyphs",{uid:this.uid,stacks:E},function(t,e){l||(l=t,u=e,k.call(i))}):u={};var I=Object.keys(d.iconDependencies);I.length?r.send("getImages",{icons:I},function(t,e){l||(l=t,c=e,k.call(i))}):c={};var C=Object.keys(d.patternDependencies);function k(){if(l)return o(l);if(u&&c&&p){var t=new P(u),e=new A.ImageAtlas(c,p);for(var r in h){var i=h[r];i instanceof A.SymbolBucket?(M(i.layers,this.zoom,n),A.performSymbolLayout(i,u,t.positions,c,e.iconPositions,this.showCollisionBoxes)):i.hasPattern&&(i instanceof A.LineBucket||i instanceof A.FillBucket||i instanceof A.FillExtrusionBucket)&&(M(i.layers,this.zoom,n),i.addFeatures(d,e.patternPositions))}this.status="done",o(null,{buckets:A.values(h).filter(function(t){return!t.isEmpty()}),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,imageAtlas:e,glyphMap:this.returnDependencies?u:null,iconMap:this.returnDependencies?c:null,glyphPositions:this.returnDependencies?t.positions:null})}}C.length?r.send("getImages",{icons:C},function(t,e){l||(l=t,p=e,k.call(i))}):p={},k.call(this)};var i="undefined"!=typeof performance,p={getEntriesByName:function(t){return!!(i&&performance&&performance.getEntriesByName)&&performance.getEntriesByName(t)},mark:function(t){return!!(i&&performance&&performance.mark)&&performance.mark(t)},measure:function(t,e,r){return!!(i&&performance&&performance.measure)&&performance.measure(t,e,r)},clearMarks:function(t){return!!(i&&performance&&performance.clearMarks)&&performance.clearMarks(t)},clearMeasures:function(t){return!!(i&&performance&&performance.clearMeasures)&&performance.clearMeasures(t)}};function n(t,n){var e=A.getArrayBuffer(t.request,function(t,e,r,i){t?n(t):e&&n(null,{vectorTile:new A.vectorTile.VectorTile(new A.pbf(e)),rawData:e,cacheControl:r,expires:i})});return function(){e.cancel(),n()}}function o(t,e,r,i){this.actor=t,this.layerIndex=e,this.availableImages=r,this.loadVectorData=i||n,this.loading={},this.loaded={}}function a(){this.loaded={}}t.prototype.finish=function(){p.mark(this._marks.end);var t=p.getEntriesByName(this._marks.measure);return 0===t.length&&(p.measure(this._marks.measure,this._marks.start,this._marks.end),t=p.getEntriesByName(this._marks.measure),p.clearMarks(this._marks.start),p.clearMarks(this._marks.end),p.clearMeasures(this._marks.measure)),t},p.Performance=t,o.prototype.loadTile=function(t,a){var s=this,l=t.uid;this.loading||(this.loading={});var u=!!(t&&t.request&&t.request.collectResourceTiming)&&new p.Performance(t.request),c=this.loading[l]=new e(t);c.abort=this.loadVectorData(t,function(t,e){if(delete s.loading[l],t||!e)return c.status="done",s.loaded[l]=c,a(t);var r=e.rawData,i={};e.expires&&(i.expires=e.expires),e.cacheControl&&(i.cacheControl=e.cacheControl);var n={};if(u){var o=u.finish();o&&(n.resourceTiming=JSON.parse(JSON.stringify(o)))}c.vectorTile=e.vectorTile,c.parse(e.vectorTile,s.layerIndex,s.availableImages,s.actor,function(t,e){if(t||!e)return a(t);a(null,A.extend({rawTileData:r.slice(0)},e,i,n))}),s.loaded=s.loaded||{},s.loaded[l]=c})},o.prototype.reloadTile=function(t,i){var n=this,e=this.loaded,r=t.uid,o=this;if(e&&e[r]){var a=e[r];a.showCollisionBoxes=t.showCollisionBoxes;var s=function(t,e){var r=a.reloadCallback;r&&(delete a.reloadCallback,a.parse(a.vectorTile,o.layerIndex,n.availableImages,o.actor,r)),i(t,e)};"parsing"===a.status?a.reloadCallback=s:"done"===a.status&&(a.vectorTile?a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}},o.prototype.abortTile=function(t,e){var r=this.loading,i=t.uid;r&&r[i]&&r[i].abort&&(r[i].abort(),delete r[i]),e()},o.prototype.removeTile=function(t,e){var r=this.loaded,i=t.uid;r&&r[i]&&delete r[i],e()},a.prototype.loadTile=function(t,e){var r=t.uid,i=t.encoding,n=t.rawImageData,o=new A.DEMData(r,n,i);this.loaded=this.loaded||{},e(null,this.loaded[r]=o)},a.prototype.removeTile=function(t){var e=this.loaded,r=t.uid;e&&e[r]&&delete e[r]};var u={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142};function s(t){var e=0;if(t&&0<t.length){e+=Math.abs(c(t[0]));for(var r=1;r<t.length;r++)e-=Math.abs(c(t[r]))}return e}function c(t){var e,r,i,n,o,a,s=0,l=t.length;if(2<l){for(a=0;a<l;a++)o=a===l-2?(i=l-2,n=l-1,0):a===l-1?(i=l-1,n=0,1):(n=(i=a)+1,a+2),e=t[i],r=t[n],s+=(h(t[o][0])-h(e[0]))*Math.sin(h(r[1]));s=s*u.RADIUS*u.RADIUS/2}return s}function h(t){return t*Math.PI/180}var d={geometry:function t(e){var r,i=0;switch(e.type){case"Polygon":return s(e.coordinates);case"MultiPolygon":for(r=0;r<e.coordinates.length;r++)i+=s(e.coordinates[r]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(r=0;r<e.geometries.length;r++)i+=t(e.geometries[r]);return i}},ring:c};function f(e,r){return function(t){return e(t,r)}}function m(t,e){e=!!e,t[0]=g(t[0],e);for(var r=1;r<t.length;r++)t[r]=g(t[r],!e);return t}function g(t,e){return r=t,0<=d.ring(r)===e?t:t.reverse();var r}function y(t){this._feature=t,this.extent=A.EXTENT,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))}var _=A.vectorTile.VectorTileFeature.prototype.toGeoJSON;y.prototype.loadGeometry=function(){if(1===this._feature.type){for(var t=[],e=0,r=this._feature.geometry;e<r.length;e+=1){var i=r[e];t.push([new A.Point$1(i[0],i[1])])}return t}for(var n=[],o=0,a=this._feature.geometry;o<a.length;o+=1){for(var s=[],l=0,u=a[o];l<u.length;l+=1){var c=u[l];s.push(new A.Point$1(c[0],c[1]))}n.push(s)}return n},y.prototype.toGeoJSON=function(t,e,r){return _.call(this,t,e,r)};var x=function(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=A.EXTENT,this.length=t.length,this._features=t};x.prototype.feature=function(t){return new y(this._features[t])};var b=A.vectorTile.VectorTileFeature,w=S;function S(t,e){this.options=e||{},this.features=t,this.length=t.length}function T(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}S.prototype.feature=function(t){return new T(this.features[t],this.options.extent)},T.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var r=t[e],i=[],n=0;n<r.length;n++)i.push(new A.Point$1(r[n][0],r[n][1]));this.geometry.push(i)}return this.geometry},T.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,r=-1/0,i=1/0,n=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var l=a[s];e=Math.min(e,l.x),r=Math.max(r,l.x),i=Math.min(i,l.y),n=Math.max(n,l.y)}return[e,i,r,n]},T.prototype.toGeoJSON=b.prototype.toGeoJSON;var E=k,I=k,C=w;function k(t){var e=new A.pbf;return function(t,e){for(var r in t.layers)e.writeMessage(3,L,t.layers[r])}(t,e),e.finish()}function L(t,e){var r;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var i={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<t.length;r++)i.feature=t.feature(r),e.writeMessage(2,O,i);var n=i.keys;for(r=0;r<n.length;r++)e.writeStringField(3,n[r]);var o=i.values;for(r=0;r<o.length;r++)e.writeMessage(4,B,o[r])}function O(t,e){var r=t.feature;void 0!==r.id&&e.writeVarintField(1,r.id),e.writeMessage(2,D,t),e.writeVarintField(3,r.type),e.writeMessage(4,N,r)}function D(t,e){var r=t.feature,i=t.keys,n=t.values,o=t.keycache,a=t.valuecache;for(var s in r.properties){var l=o[s];void 0===l&&(i.push(s),l=i.length-1,o[s]=l),e.writeVarint(l);var u=r.properties[s],c=typeof u;"string"!=c&&"boolean"!=c&&"number"!=c&&(u=JSON.stringify(u));var p=c+":"+u,h=a[p];void 0===h&&(n.push(u),h=n.length-1,a[p]=h),e.writeVarint(h)}}function R(t,e){return(e<<3)+(7&t)}function z(t){return t<<1^t>>31}function N(t,e){for(var r=t.loadGeometry(),i=t.type,n=0,o=0,a=r.length,s=0;s<a;s++){var l=r[s],u=1;1===i&&(u=l.length),e.writeVarint(R(1,u));for(var c=3===i?l.length-1:l.length,p=0;p<c;p++){1===p&&1!==i&&e.writeVarint(R(2,c-1));var h=l[p].x-n,d=l[p].y-o;e.writeVarint(z(h)),e.writeVarint(z(d)),n+=h,o+=d}3===i&&e.writeVarint(R(7,1))}}function B(t,e){var r=typeof t;"string"==r?e.writeStringField(1,t):"boolean"==r?e.writeBooleanField(7,t):"number"==r&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function F(t,e,r,i){U(t,r,i),U(e,2*r,2*i),U(e,2*r+1,2*i+1)}function U(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function j(t,e,r,i){var n=t-r,o=e-i;return n*n+o*o}function q(t){return t[0]}function V(t){return t[1]}function G(t,e,r,i,n){void 0===e&&(e=q),void 0===r&&(r=V),void 0===i&&(i=64),void 0===n&&(n=Float64Array),this.nodeSize=i;for(var o=(this.points=t).length<65536?Uint16Array:Uint32Array,a=this.ids=new o(t.length),s=this.coords=new n(2*t.length),l=0;l<t.length;l++)s[2*(a[l]=l)]=e(t[l]),s[2*l+1]=r(t[l]);!function t(e,r,i,n,o,a){if(!(o-n<=i)){var s=n+o>>1;!function t(e,r,i,n,o,a){for(;n<o;){if(600<o-n){var s=o-n+1,l=i-n+1,u=Math.log(s),c=.5*Math.exp(2*u/3),p=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);t(e,r,i,Math.max(n,Math.floor(i-l*c/s+p)),Math.min(o,Math.floor(i+(s-l)*c/s+p)),a)}var h=r[2*i+a],d=n,f=o;for(F(e,r,n,i),r[2*o+a]>h&&F(e,r,n,o);d<f;){for(F(e,r,d,f),d++,f--;r[2*d+a]<h;)d++;for(;r[2*f+a]>h;)f--}r[2*n+a]===h?F(e,r,n,f):F(e,r,++f,o),f<=i&&(n=f+1),i<=f&&(o=f-1)}}(e,r,s,n,o,a%2),t(e,r,i,n,s-1,a+1),t(e,r,i,1+s,o,a+1)}}(a,s,i,0,a.length-1,0)}function Z(t){this.options=J(Object.create(H),t),this.trees=new Array(this.options.maxZoom+1)}E.fromVectorTileJs=I,E.fromGeojsonVt=function(t,e){e=e||{};var r={};for(var i in t)r[i]=new w(t[i].features,e),r[i].name=i,r[i].version=e.version,r[i].extent=e.extent;return k({layers:r})},E.GeoJSONWrapper=C,G.prototype.range=function(t,e,r,i){return function(t,e,r,i,n,o,a){for(var s,l,u=[0,t.length-1,0],c=[];u.length;){var p=u.pop(),h=u.pop(),d=u.pop();if(h-d<=a)for(var f=d;f<=h;f++)s=e[2*f],l=e[2*f+1],r<=s&&s<=n&&i<=l&&l<=o&&c.push(t[f]);else{var m=Math.floor((d+h)/2);s=e[2*m],l=e[2*m+1],r<=s&&s<=n&&i<=l&&l<=o&&c.push(t[m]);var g=(p+1)%2;(0===p?r<=s:i<=l)&&(u.push(d),u.push(m-1),u.push(g)),(0===p?s<=n:l<=o)&&(u.push(m+1),u.push(h),u.push(g))}}return c}(this.ids,this.coords,t,e,r,i,this.nodeSize)};var H={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:(G.prototype.within=function(t,e,r){return function(t,e,r,i,n,o){for(var a=[0,t.length-1,0],s=[],l=n*n;a.length;){var u=a.pop(),c=a.pop(),p=a.pop();if(c-p<=o)for(var h=p;h<=c;h++)j(e[2*h],e[2*h+1],r,i)<=l&&s.push(t[h]);else{var d=Math.floor((p+c)/2),f=e[2*d],m=e[2*d+1];j(f,m,r,i)<=l&&s.push(t[d]);var g=(u+1)%2;(0===u?r-n<=f:i-n<=m)&&(a.push(p),a.push(d-1),a.push(g)),(0===u?f<=r+n:m<=i+n)&&(a.push(d+1),a.push(c),a.push(g))}}return s}(this.ids,this.coords,t,e,r,this.nodeSize)},!1),reduce:null,map:function(t){return t}};function W(t){return{type:"Feature",id:t.id,properties:K(t),geometry:{type:"Point",coordinates:[(i=t.x,360*(i-.5)),(e=t.y,r=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(r))/Math.PI-90)]}};var e,r,i}function K(t){var e=t.numPoints,r=1e4<=e?Math.round(e/1e3)+"k":1e3<=e?Math.round(e/100)/10+"k":e;return J(J({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:r})}function X(t){return t/360+.5}function Y(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:1<r?1:r}function J(t,e){for(var r in e)t[r]=e[r];return t}function Q(t){return t.x}function $(t){return t.y}function tt(t,e,r,i,n,o){var a=n-r,s=o-i;if(0!==a||0!==s){var l=((t-r)*a+(e-i)*s)/(a*a+s*s);1<l?(r=n,i=o):0<l&&(r+=a*l,i+=s*l)}return(a=t-r)*a+(s=e-i)*s}function et(t,e,r,i){var n={id:void 0===t?null:t,type:e,geometry:r,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,r=t.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)rt(t,e);else if("Polygon"===r||"MultiLineString"===r)for(var i=0;i<e.length;i++)rt(t,e[i]);else if("MultiPolygon"===r)for(i=0;i<e.length;i++)for(var n=0;n<e[i].length;n++)rt(t,e[i][n])}(n),n}function rt(t,e){for(var r=0;r<e.length;r+=3)t.minX=Math.min(t.minX,e[r]),t.minY=Math.min(t.minY,e[r+1]),t.maxX=Math.max(t.maxX,e[r]),t.maxY=Math.max(t.maxY,e[r+1])}function it(t,e,r,i){if(e.geometry){var n=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],l=e.id;if(r.promoteId?l=e.properties[r.promoteId]:r.generateId&&(l=i||0),"Point"===o)nt(n,s);else if("MultiPoint"===o)for(var u=0;u<n.length;u++)nt(n[u],s);else if("LineString"===o)ot(n,s,a,!1);else if("MultiLineString"===o){if(r.lineMetrics){for(u=0;u<n.length;u++)s=[],ot(n[u],s,a,!1),t.push(et(l,"LineString",s,e.properties));return}at(n,s,a,!1)}else if("Polygon"===o)at(n,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"!==o)throw new Error("Input data is not a valid GeoJSON object.");for(u=0;u<e.geometry.geometries.length;u++)it(t,{id:l,geometry:e.geometry.geometries[u],properties:e.properties},r,i);return}for(u=0;u<n.length;u++){var c=[];at(n[u],c,a,!0),s.push(c)}}t.push(et(l,o,s,e.properties))}}function nt(t,e){e.push(st(t[0])),e.push(lt(t[1])),e.push(0)}function ot(t,e,r,i){for(var n,o,a=0,s=0;s<t.length;s++){var l=st(t[s][0]),u=lt(t[s][1]);e.push(l),e.push(u),e.push(0),0<s&&(a+=i?(n*u-l*o)/2:Math.sqrt(Math.pow(l-n,2)+Math.pow(u-o,2))),n=l,o=u}var c=e.length-3;e[2]=1,function t(e,r,i,n){for(var o,a=n,s=i-r>>1,l=i-r,u=e[r],c=e[r+1],p=e[i],h=e[i+1],d=r+3;d<i;d+=3){var f=tt(e[d],e[d+1],u,c,p,h);if(a<f)o=d,a=f;else if(f===a){var m=Math.abs(d-s);m<l&&(o=d,l=m)}}n<a&&(3<o-r&&t(e,r,o,n),e[o+2]=a,3<i-o&&t(e,o,i,n))}(e,0,c,r),e[2+c]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function at(t,e,r,i){for(var n=0;n<t.length;n++){var o=[];ot(t[n],o,r,i),e.push(o)}}function st(t){return t/360+.5}function lt(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:1<r?1:r}function ut(t,e,r,i,n,o,a,s){if(i/=e,o>=(r/=e)&&a<i)return t;if(a<r||i<=o)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],p=c.geometry,h=c.type,d=0===n?c.minX:c.minY,f=0===n?c.maxX:c.maxY;if(r<=d&&f<i)l.push(c);else if(!(f<r||i<=d)){var m=[];if("Point"===h||"MultiPoint"===h)ct(p,m,r,i,n);else if("LineString"===h)pt(p,m,r,i,n,!1,s.lineMetrics);else if("MultiLineString"===h)dt(p,m,r,i,n,!1);else if("Polygon"===h)dt(p,m,r,i,n,!0);else if("MultiPolygon"===h)for(var g=0;g<p.length;g++){var y=[];dt(p[g],y,r,i,n,!0),y.length&&m.push(y)}if(m.length){if(s.lineMetrics&&"LineString"===h){for(g=0;g<m.length;g++)l.push(et(c.id,h,m[g],c.tags));continue}"LineString"!==h&&"MultiLineString"!==h||(1===m.length?(h="LineString",m=m[0]):h="MultiLineString"),"Point"!==h&&"MultiPoint"!==h||(h=3===m.length?"Point":"MultiPoint"),l.push(et(c.id,h,m,c.tags))}}}return l.length?l:null}function ct(t,e,r,i,n){for(var o=0;o<t.length;o+=3){var a=t[o+n];r<=a&&a<=i&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function pt(t,e,r,i,n,o,a){for(var s,l,u=ht(t),c=0===n?mt:gt,p=t.start,h=0;h<t.length-3;h+=3){var d=t[h],f=t[h+1],m=t[h+2],g=t[h+3],y=t[h+4],v=0===n?d:f,_=0===n?g:y,x=!1;a&&(s=Math.sqrt(Math.pow(d-g,2)+Math.pow(f-y,2))),v<r?r<_&&(l=c(u,d,f,g,y,r),a&&(u.start=p+s*l)):i<v?_<i&&(l=c(u,d,f,g,y,i),a&&(u.start=p+s*l)):ft(u,d,f,m),_<r&&r<=v&&(l=c(u,d,f,g,y,r),x=!0),i<_&&v<=i&&(l=c(u,d,f,g,y,i),x=!0),!o&&x&&(a&&(u.end=p+s*l),e.push(u),u=ht(t)),a&&(p+=s)}var b=t.length-3;d=t[b],f=t[b+1],m=t[b+2],(v=0===n?d:f)>=r&&v<=i&&ft(u,d,f,m),b=u.length-3,o&&3<=b&&(u[b]!==u[0]||u[b+1]!==u[1])&&ft(u,u[0],u[1],u[2]),u.length&&e.push(u)}function ht(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function dt(t,e,r,i,n,o){for(var a=0;a<t.length;a++)pt(t[a],e,r,i,n,o,!1)}function ft(t,e,r,i){t.push(e),t.push(r),t.push(i)}function mt(t,e,r,i,n,o){var a=(o-e)/(i-e);return t.push(o),t.push(r+(n-r)*a),t.push(1),a}function gt(t,e,r,i,n,o){var a=(o-r)/(n-r);return t.push(e+(i-e)*a),t.push(o),t.push(1),a}function yt(t,e){for(var r=[],i=0;i<t.length;i++){var n,o=t[i],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)n=vt(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){n=[];for(var s=0;s<o.geometry.length;s++)n.push(vt(o.geometry[s],e))}else if("MultiPolygon"===a)for(n=[],s=0;s<o.geometry.length;s++){for(var l=[],u=0;u<o.geometry[s].length;u++)l.push(vt(o.geometry[s][u],e));n.push(l)}r.push(et(o.id,a,n,o.tags))}return r}function vt(t,e){var r=[];r.size=t.size,void 0!==t.start&&(r.start=t.start,r.end=t.end);for(var i=0;i<t.length;i+=3)r.push(t[i]+e,t[i+1],t[i+2]);return r}function _t(t,e){if(t.transformed)return t;var r,i,n,o=1<<t.z,a=t.x,s=t.y;for(r=0;r<t.features.length;r++){var l=t.features[r],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(i=0;i<u.length;i+=2)l.geometry.push(xt(u[i],u[i+1],e,o,a,s));else for(i=0;i<u.length;i++){var p=[];for(n=0;n<u[i].length;n+=2)p.push(xt(u[i][n],u[i][n+1],e,o,a,s));l.geometry.push(p)}}return t.transformed=!0,t}function xt(t,e,r,i,n,o){return[Math.round(r*(t*i-n)),Math.round(r*(e*i-o))]}function bt(t,e,r,i,n){for(var o=e===n.maxZoom?0:n.tolerance/((1<<e)*n.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,wt(a,t[s],o,n);var l=t[s].minX,u=t[s].minY,c=t[s].maxX,p=t[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),p>a.maxY&&(a.maxY=p)}return a}function wt(t,e,r,i){var n=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<n.length;s+=3)a.push(n[s]),a.push(n[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)St(a,n,t,r,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<n.length;s++)St(a,n[s],t,r,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<n.length;l++){var u=n[l];for(s=0;s<u.length;s++)St(a,u[s],t,r,!0,0===s)}if(a.length){var c=e.tags||null;if("LineString"===o&&i.lineMetrics){for(var p in c={},e.tags)c[p]=e.tags[p];c.mapbox_clip_start=n.start/n.size,c.mapbox_clip_end=n.end/n.size}var h={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c};null!==e.id&&(h.id=e.id),t.features.push(h)}}function St(t,e,r,i,n,o){var a=i*i;if(0<i&&e.size<(n?a:i))r.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===i||e[l+2]>a)&&(r.numSimplified++,s.push(e[l]),s.push(e[l+1])),r.numPoints++;n&&function(t,e){for(var r=0,i=0,n=t.length,o=n-2;i<n;o=i,i+=2)r+=(t[i]-t[o])*(t[i+1]+t[o+1]);if(0<r===e)for(i=0,n=t.length;i<n/2;i+=2){var a=t[i],s=t[i+1];t[i]=t[n-2-i],t[i+1]=t[n-1-i],t[n-2-i]=a,t[n-1-i]=s}}(s,o),t.push(s)}}function Tt(t,e){var r=(e=this.options=function(t,e){for(var r in e)t[r]=e[r];return t}(Object.create(this.options),e)).debug;if(r&&console.time("preprocess data"),e.maxZoom<0||24<e.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var i,n,o,a,s,l,u=function(t,e){var r=[];if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)it(r,t.features[i],e,i);else"Feature"===t.type?it(r,t,e):it(r,{geometry:t},e);return r}(t,e);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(i=u,o=(n=e).buffer/n.extent,s=ut(a=i,1,-1-o,o,0,-1,2,n),l=ut(i,1,1-o,2+o,0,-1,2,n),(s||l)&&(a=ut(i,1,-o,1+o,0,-1,2,n)||[],s&&(a=yt(s,1).concat(a)),l&&(a=a.concat(yt(l,-1)))),u=a).length&&this.splitTile(u,0,0,0),r&&(u.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Et(t,e,r){return 32*((1<<t)*r+e)+t}function It(t,e){var r=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var i=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!i)return e(null,null);var n=new x(i.features),o=E(n);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:n,rawData:o.buffer})}Z.prototype.load=function(t){var e=this.options,r=e.log,i=e.minZoom,n=e.maxZoom,o=e.nodeSize;r&&console.time("total time");var a,s,l,u,c,p="prepare "+t.length+" points";r&&console.time(p),this.points=t;for(var h=[],d=0;d<t.length;d++)t[d].geometry&&h.push((a=t[d],s=d,l=a.geometry.coordinates,u=l[0],c=l[1],{x:X(u),y:Y(c),zoom:1/0,index:s,parentId:-1}));this.trees[n+1]=new G(h,Q,$,o,Float32Array),r&&console.timeEnd(p);for(var f=n;i<=f;f--){var m=+Date.now();h=this._cluster(h,f),this.trees[f]=new G(h,Q,$,o,Float32Array),r&&console.log("z%d: %d clusters in %dms",f,h.length,+Date.now()-m)}return r&&console.timeEnd("total time"),this},Z.prototype.getClusters=function(t,e){var r=((t[0]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,t[1])),n=180===t[2]?180:((t[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,t[3]));if(360<=t[2]-t[0])r=-180,n=180;else if(n<r){var a=this.getClusters([r,i,180,o],e),s=this.getClusters([-180,i,n,o],e);return a.concat(s)}for(var l=this.trees[this._limitZoom(e)],u=[],c=0,p=l.range(X(r),Y(o),X(n),Y(i));c<p.length;c+=1){var h=p[c],d=l.points[h];u.push(d.numPoints?W(d):this.points[d.index])}return u},Z.prototype.getChildren=function(t){var e=t>>5,r=t%32,i="No cluster with the specified id.",n=this.trees[r];if(!n)throw new Error(i);var o=n.points[e];if(!o)throw new Error(i);for(var a=this.options.radius/(this.options.extent*Math.pow(2,r-1)),s=[],l=0,u=n.within(o.x,o.y,a);l<u.length;l+=1){var c=u[l],p=n.points[c];p.parentId===t&&s.push(p.numPoints?W(p):this.points[p.index])}if(0===s.length)throw new Error(i);return s},Z.prototype.getLeaves=function(t,e,r){e=e||10,r=r||0;var i=[];return this._appendLeaves(i,t,e,r,0),i},Z.prototype.getTile=function(t,e,r){var i=this.trees[this._limitZoom(t)],n=Math.pow(2,t),o=this.options,a=o.extent,s=o.radius/a,l=(r-s)/n,u=(r+1+s)/n,c={features:[]};return this._addTileFeatures(i.range((e-s)/n,l,(e+1+s)/n,u),i.points,e,r,n,c),0===e&&this._addTileFeatures(i.range(1-s/n,l,1,u),i.points,n,r,n,c),e===n-1&&this._addTileFeatures(i.range(0,l,s/n,u),i.points,-1,r,n,c),c.features.length?c:null},Z.prototype.getClusterExpansionZoom=function(t){for(var e=t%32-1;e<=this.options.maxZoom;){var r=this.getChildren(t);if(e++,1!==r.length)break;t=r[0].properties.cluster_id}return e},Z.prototype._appendLeaves=function(t,e,r,i,n){for(var o=0,a=this.getChildren(e);o<a.length;o+=1){var s=a[o],l=s.properties;if(l&&l.cluster?n+l.point_count<=i?n+=l.point_count:n=this._appendLeaves(t,l.cluster_id,r,i,n):n<i?n++:t.push(s),t.length===r)break}return n},Z.prototype._addTileFeatures=function(t,e,r,i,n,o){for(var a=0,s=t;a<s.length;a+=1){var l=e[s[a]],u={type:1,geometry:[[Math.round(this.options.extent*(l.x*n-r)),Math.round(this.options.extent*(l.y*n-i))]],tags:l.numPoints?K(l):this.points[l.index].properties},c=l.numPoints?l.id:this.points[l.index].id;void 0!==c&&(u.id=c),o.features.push(u)}},Z.prototype._limitZoom=function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},Z.prototype._cluster=function(t,e){for(var r=[],i=this.options,n=i.radius,o=i.extent,a=i.reduce,s=n/(o*Math.pow(2,e)),l=0;l<t.length;l++){var u=t[l];if(!(u.zoom<=e)){u.zoom=e;for(var c=this.trees[e+1],p=c.within(u.x,u.y,s),h=u.numPoints||1,d=u.x*h,f=u.y*h,m=a&&1<h?this._map(u,!0):null,g=(l<<5)+(e+1),y=0,v=p;y<v.length;y+=1){var _=v[y],x=c.points[_];if(!(x.zoom<=e)){x.zoom=e;var b=x.numPoints||1;d+=x.x*b,f+=x.y*b,h+=b,x.parentId=g,a&&a(m=m||this._map(u,!0),this._map(x))}}1===h?r.push(u):(u.parentId=g,r.push({x:d/h,y:f/h,zoom:1/0,id:g,parentId:-1,numPoints:h,properties:m}))}}return r},Tt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:(Z.prototype._map=function(t,e){if(t.numPoints)return e?J({},t.properties):t.properties;var r=this.points[t.index].properties,i=this.options.map(r);return e&&i===r?J({},i):i},!1),promoteId:null,generateId:!1,debug:0},Tt.prototype.splitTile=function(t,e,r,i,n,o,a){for(var s=[t,e,r,i],l=this.options,u=l.debug;s.length;){i=s.pop(),r=s.pop(),e=s.pop(),t=s.pop();var c=1<<e,p=Et(e,r,i),h=this.tiles[p];if(!h&&(1<u&&console.time("creation"),h=this.tiles[p]=bt(t,e,r,i,l),this.tileCoords.push({z:e,x:r,y:i}),u)){1<u&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,r,i,h.numFeatures,h.numPoints,h.numSimplified),console.timeEnd("creation"));var d="z"+e;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(h.source=t,n){if(e===l.maxZoom||e===n)continue;var f=1<<n-e;if(r!==Math.floor(o/f)||i!==Math.floor(a/f))continue}else if(e===l.indexMaxZoom||h.numPoints<=l.indexMaxPoints)continue;if(h.source=null,0!==t.length){1<u&&console.time("clipping");var m,g,y,v,_,x,b=.5*l.buffer/l.extent,w=.5-b,S=.5+b,T=1+b;m=g=y=v=null,_=ut(t,c,r-b,r+S,0,h.minX,h.maxX,l),x=ut(t,c,r+w,r+T,0,h.minX,h.maxX,l),t=null,_&&(m=ut(_,c,i-b,i+S,1,h.minY,h.maxY,l),g=ut(_,c,i+w,i+T,1,h.minY,h.maxY,l),_=null),x&&(y=ut(x,c,i-b,i+S,1,h.minY,h.maxY,l),v=ut(x,c,i+w,i+T,1,h.minY,h.maxY,l),x=null),1<u&&console.timeEnd("clipping"),s.push(m||[],e+1,2*r,2*i),s.push(g||[],e+1,2*r,2*i+1),s.push(y||[],e+1,2*r+1,2*i),s.push(v||[],e+1,2*r+1,2*i+1)}}},Tt.prototype.getTile=function(t,e,r){var i=this.options,n=i.extent,o=i.debug;if(t<0||24<t)return null;var a=1<<t,s=Et(t,e=(e%a+a)%a,r);if(this.tiles[s])return _t(this.tiles[s],n);1<o&&console.log("drilling down to z%d-%d-%d",t,e,r);for(var l,u=t,c=e,p=r;!l&&0<u;)u--,c=Math.floor(c/2),p=Math.floor(p/2),l=this.tiles[Et(u,c,p)];return l&&l.source?(1<o&&console.log("found parent tile z%d-%d-%d",u,c,p),1<o&&console.time("drilling down"),this.splitTile(l.source,u,c,p,t,e,r),1<o&&console.timeEnd("drilling down"),this.tiles[s]?_t(this.tiles[s],n):null):null};var Ct,kt=(At.__proto__=Ct=o,((At.prototype=Object.create(Ct&&Ct.prototype)).constructor=At).prototype.loadData=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=t,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},At.prototype._loadData=function(){var n=this;if(this._pendingCallback&&this._pendingLoadDataParams){var o=this._pendingCallback,a=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var s=!!(a&&a.request&&a.request.collectResourceTiming)&&new p.Performance(a.request);this.loadGeoJSON(a,function(t,e){if(t||!e)return o(t);if("object"!=typeof e)return o(new Error("Input data given to '"+a.source+"' is not a valid GeoJSON object."));!function t(e,r){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.map(f(t,r)),e;case"GeometryCollection":return e.geometries=e.geometries.map(f(t,r)),e;case"Feature":return e.geometry=t(e.geometry,r),e;case"Polygon":case"MultiPolygon":return n=r,"Polygon"===(i=e).type?i.coordinates=m(i.coordinates,n):"MultiPolygon"===i.type&&(i.coordinates=i.coordinates.map(f(m,n))),i;default:return e}var i,n}(e,!0);try{n._geoJSONIndex=a.cluster?new Z(function(t){var e=t.superclusterOptions,r=t.clusterProperties;if(!r||!e)return e;for(var o={},a={},s={accumulated:null,zoom:0},l={properties:null},u=Object.keys(r),i=0,n=u;i<n.length;i+=1){var c=n[i],p=r[c],h=p[0],d=p[1],f=A.createExpression(d),m=A.createExpression("string"==typeof h?[h,["accumulated"],["get",c]]:h);o[c]=f.value,a[c]=m.value}return e.map=function(t){l.properties=t;for(var e={},r=0,i=u;r<i.length;r+=1){var n=i[r];e[n]=o[n].evaluate(s,l)}return e},e.reduce=function(t,e){l.properties=e;for(var r=0,i=u;r<i.length;r+=1){var n=i[r];s.accumulated=t[n],t[n]=a[n].evaluate(s,l)}},e}(a)).load(e.features):new Tt(e,a.geojsonVtOptions)}catch(t){return o(t)}n.loaded={};var r={};if(s){var i=s.finish();i&&(r.resourceTiming={},r.resourceTiming[a.source]=JSON.parse(JSON.stringify(i)))}o(null,r)})}},At.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},At.prototype.reloadTile=function(t,e){var r=this.loaded,i=t.uid;return r&&r[i]?Ct.prototype.reloadTile.call(this,t,e):this.loadTile(t,e)},At.prototype.loadGeoJSON=function(e,r){if(e.request)A.getJSON(e.request,r);else{if("string"!=typeof e.data)return r(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."));try{return r(null,JSON.parse(e.data))}catch(t){return r(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."))}}},At.prototype.removeSource=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},At.prototype.getClusterExpansionZoom=function(t,e){e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))},At.prototype.getClusterChildren=function(t,e){e(null,this._geoJSONIndex.getChildren(t.clusterId))},At.prototype.getClusterLeaves=function(t,e){e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))},At);function At(t,e,r,i){Ct.call(this,t,e,r,It),i&&(this.loadGeoJSON=i)}function Pt(t){var r=this;this.self=t,this.actor=new A.Actor(t,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:o,geojson:kt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(t,e){if(r.workerSourceTypes[t])throw new Error('Worker source with name "'+t+'" already registered.');r.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=function(t){if(A.plugin.isLoaded())throw new Error("RTL text plugin already registered.");A.plugin.applyArabicShaping=t.applyArabicShaping,A.plugin.processBidirectionalText=t.processBidirectionalText,A.plugin.processStyledBidirectionalText=t.processStyledBidirectionalText}}return Pt.prototype.setReferrer=function(t,e){this.referrer=e},Pt.prototype.setImages=function(t,e,r){this.availableImages[t]=e,r()},Pt.prototype.setLayers=function(t,e,r){this.getLayerIndex(t).replace(e),r()},Pt.prototype.updateLayers=function(t,e,r){this.getLayerIndex(t).update(e.layers,e.removedIds),r()},Pt.prototype.loadTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).loadTile(e,r)},Pt.prototype.loadDEMTile=function(t,e,r){this.getDEMWorkerSource(t,e.source).loadTile(e,r)},Pt.prototype.reloadTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).reloadTile(e,r)},Pt.prototype.abortTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).abortTile(e,r)},Pt.prototype.removeTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).removeTile(e,r)},Pt.prototype.removeDEMTile=function(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)},Pt.prototype.removeSource=function(t,e,r){if(this.workerSources[t]&&this.workerSources[t][e.type]&&this.workerSources[t][e.type][e.source]){var i=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==i.removeSource?i.removeSource(e,r):r()}},Pt.prototype.loadWorkerSource=function(t,e,r){try{this.self.importScripts(e.url),r()}catch(t){r(t.toString())}},Pt.prototype.loadRTLTextPlugin=function(t,e,r){try{A.plugin.isLoaded()||(this.self.importScripts(e),r(A.plugin.isLoaded()?null:new Error("RTL Text Plugin failed to import scripts from "+e)))}catch(t){r(t.toString())}},Pt.prototype.getAvailableImages=function(t){var e=this.availableImages[t];return e=e||[]},Pt.prototype.getLayerIndex=function(t){var e=this.layerIndexes[t];return e=e||(this.layerIndexes[t]=new r)},Pt.prototype.getWorkerSource=function(i,t,e){var n=this;if(this.workerSources[i]||(this.workerSources[i]={}),this.workerSources[i][t]||(this.workerSources[i][t]={}),!this.workerSources[i][t][e]){var r={send:function(t,e,r){n.actor.send(t,e,r,i)}};this.workerSources[i][t][e]=new this.workerSourceTypes[t](r,this.getLayerIndex(i),this.getAvailableImages(i))}return this.workerSources[i][t][e]},Pt.prototype.getDEMWorkerSource=function(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new a),this.demWorkerSources[t][e]},Pt.prototype.enforceCacheSizeLimit=function(t,e){A.enforceCacheSizeLimit(e)},"undefined"!=typeof WorkerGlobalScope&&void 0!==A.window&&A.window instanceof WorkerGlobalScope&&(A.window.worker=new Pt(A.window)),Pt}),r(["./shared"],function(mt){var r=mt.createCommonjsModule(function(t){function o(t){return!!("undefined"!=typeof window&&"undefined"!=typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,r=new Blob([""],{type:"text/javascript"}),i=URL.createObjectURL(r);try{e=new Worker(i),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(i),t}()&&"Uint8ClampedArray"in window&&ArrayBuffer.isView&&(e=t&&t.failIfMajorPerformanceCaveat,void 0===a[e]&&(a[e]=(r=e,i=document.createElement("canvas"),(n=Object.create(o.webGLContextAttributes)).failIfMajorPerformanceCaveat=r,i.probablySupportsContext?i.probablySupportsContext("webgl",n)||i.probablySupportsContext("experimental-webgl",n):i.supportsContext?i.supportsContext("webgl",n)||i.supportsContext("experimental-webgl",n):i.getContext("webgl",n)||i.getContext("experimental-webgl",n))),a[e]));var e,r,i,n}t.exports?t.exports=o:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=o);var a={};o.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),v={create:function(t,e,r){var i=mt.window.document.createElement(t);return void 0!==e&&(i.className=e),r&&r.appendChild(i),i},createNS:function(t,e){return mt.window.document.createElementNS(t,e)}},i=mt.window.document.documentElement.style;function t(t){if(!i)return t[0];for(var e=0;e<t.length;e++)if(t[e]in i)return t[e];return t[0]}var e,n=t(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);v.disableDrag=function(){i&&n&&(e=i[n],i[n]="none")},v.enableDrag=function(){i&&n&&(i[n]=e)};var o=t(["transform","WebkitTransform"]),a=!(v.setTransform=function(t,e){t.style[o]=e});try{var s=Object.defineProperty({},"passive",{get:function(){a=!0}});mt.window.addEventListener("test",s,s),mt.window.removeEventListener("test",s,s)}catch(mt){a=!1}v.addEventListener=function(t,e,r,i){void 0===i&&(i={}),"passive"in i&&a?t.addEventListener(e,r,i):t.addEventListener(e,r,i.capture)},v.removeEventListener=function(t,e,r,i){void 0===i&&(i={}),"passive"in i&&a?t.removeEventListener(e,r,i):t.removeEventListener(e,r,i.capture)};var l=function(t){t.preventDefault(),t.stopPropagation(),mt.window.removeEventListener("click",l,!0)};v.suppressClick=function(){mt.window.addEventListener("click",l,!0),mt.window.setTimeout(function(){mt.window.removeEventListener("click",l,!0)},0)},v.mousePos=function(t,e){var r=t.getBoundingClientRect(),i=mt.window.TouchEvent&&e instanceof mt.window.TouchEvent?e.touches[0]:e;return new mt.Point(i.clientX-r.left-t.clientLeft,i.clientY-r.top-t.clientTop)},v.touchPos=function(t,e){for(var r=t.getBoundingClientRect(),i=[],n="touchend"===e.type?e.changedTouches:e.touches,o=0;o<n.length;o++)i.push(new mt.Point(n[o].clientX-r.left-t.clientLeft,n[o].clientY-r.top-t.clientTop));return i},v.mouseButton=function(t){return void 0!==mt.window.InstallTrigger&&2===t.button&&t.ctrlKey&&0<=mt.window.navigator.platform.toUpperCase().indexOf("MAC")?0:t.button},v.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};var u,c=((u=mt.Evented)&&(p.__proto__=u),((p.prototype=Object.create(u&&u.prototype)).constructor=p).prototype.isLoaded=function(){return this.loaded},p.prototype.setLoaded=function(t){if(this.loaded!==t&&(this.loaded=t)){for(var e=0,r=this.requestors;e<r.length;e+=1){var i=r[e],n=i.ids,o=i.callback;this._notify(n,o)}this.requestors=[]}},p.prototype.getImage=function(t){return this.images[t]},p.prototype.addImage=function(t,e){this.images[t]=e},p.prototype.updateImage=function(t,e){var r=this.images[t];e.version=r.version+1,this.images[t]=e,this.updatedImages[t]=!0},p.prototype.removeImage=function(t){var e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()},p.prototype.listImages=function(){return Object.keys(this.images)},p.prototype.getImages=function(t,e){var r=!0;if(!this.isLoaded())for(var i=0,n=t;i<n.length;i+=1){var o=n[i];this.images[o]||(r=!1)}this.isLoaded()||r?this._notify(t,e):this.requestors.push({ids:t,callback:e})},p.prototype._notify=function(t,e){for(var r={},i=0,n=t;i<n.length;i+=1){var o=n[i];this.images[o]||this.fire(new mt.Event("styleimagemissing",{id:o}));var a=this.images[o];a?r[o]={data:a.data.clone(),pixelRatio:a.pixelRatio,sdf:a.sdf,version:a.version,hasRenderCallback:Boolean(a.userImage&&a.userImage.render)}:mt.warnOnce('Image "'+o+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}e(null,r)},p.prototype.getPixelSize=function(){var t=this.atlasImage;return{width:t.width,height:t.height}},p.prototype.getPattern=function(t){var e=this.patterns[t],r=this.getImage(t);if(!r)return null;if(e&&e.position.version===r.version)return e.position;if(e)e.position.version=r.version;else{var i={w:r.data.width+2,h:r.data.height+2,x:0,y:0},n=new mt.ImagePosition(i,r);this.patterns[t]={bin:i,position:n}}return this._updatePatternAtlas(),this.patterns[t].position},p.prototype.bind=function(t){var e=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new mt.Texture(t,this.atlasImage,e.RGBA),this.atlasTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE)},p.prototype._updatePatternAtlas=function(){var t=[];for(var e in this.patterns)t.push(this.patterns[e].bin);var r=mt.potpack(t),i=r.w,n=r.h,o=this.atlasImage;for(var a in o.resize({width:i||1,height:n||1}),this.patterns){var s=this.patterns[a].bin,l=s.x+1,u=s.y+1,c=this.images[a].data,p=c.width,h=c.height;mt.RGBAImage.copy(c,o,{x:0,y:0},{x:l,y:u},{width:p,height:h}),mt.RGBAImage.copy(c,o,{x:0,y:h-1},{x:l,y:u-1},{width:p,height:1}),mt.RGBAImage.copy(c,o,{x:0,y:0},{x:l,y:u+h},{width:p,height:1}),mt.RGBAImage.copy(c,o,{x:p-1,y:0},{x:l-1,y:u},{width:1,height:h}),mt.RGBAImage.copy(c,o,{x:0,y:0},{x:l+p,y:u},{width:1,height:h})}this.dirty=!0},p.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},p.prototype.dispatchRenderCallbacks=function(t){for(var e=0,r=t;e<r.length;e+=1){var i=r[e];if(!this.callbackDispatchedThisFrame[i]){this.callbackDispatchedThisFrame[i]=!0;var n=this.images[i];a=void 0,(a=(o=n).userImage)&&a.render&&a.render()&&(o.data.replace(new Uint8Array(a.data.buffer)),1)&&this.updateImage(i,n)}}var o,a},p);function p(){u.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new mt.RGBAImage({width:1,height:1}),this.dirty=!0}var h=m,d=m,f=1e20;function m(t,e,r,i,n,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=i||.25,this.fontFamily=n||"sans-serif",this.fontWeight=o||"normal",this.radius=r||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(0<=navigator.userAgent.indexOf("Gecko/")?1.2:1))}function g(t,e,r,i,n,o,a){for(var s=0;s<e;s++){for(var l=0;l<r;l++)i[l]=t[l*e+s];for(y(i,n,o,a,r),l=0;l<r;l++)t[l*e+s]=n[l]}for(l=0;l<r;l++){for(s=0;s<e;s++)i[s]=t[l*e+s];for(y(i,n,o,a,e),s=0;s<e;s++)t[l*e+s]=Math.sqrt(n[s])}}function y(t,e,r,i,n){i[r[0]=0]=-f,i[1]=+f;for(var o=1,a=0;o<n;o++){for(var s=(t[o]+o*o-(t[r[a]]+r[a]*r[a]))/(2*o-2*r[a]);s<=i[a];)a--,s=(t[o]+o*o-(t[r[a]]+r[a]*r[a]))/(2*o-2*r[a]);r[++a]=o,i[a]=s,i[a+1]=+f}for(a=o=0;o<n;o++){for(;i[a+1]<o;)a++;e[o]=(o-r[a])*(o-r[a])+t[r[a]]}}function _(t,e){this.requestManager=t,this.localIdeographFontFamily=e,this.entries={}}function x(){this.specification=mt.styleSpec.light.position}function b(t,e){this.width=t,this.height=e,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}}m.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),r=new Uint8ClampedArray(this.size*this.size),i=0;i<this.size*this.size;i++){var n=e.data[4*i+3]/255;this.gridOuter[i]=1==n?0:0==n?f:Math.pow(Math.max(0,.5-n),2),this.gridInner[i]=1==n?f:0==n?0:Math.pow(Math.max(0,n-.5),2)}for(g(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),g(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),i=0;i<this.size*this.size;i++){var o=this.gridOuter[i]-this.gridInner[i];r[i]=Math.max(0,Math.min(255,Math.round(255-255*(o/this.radius+this.cutoff))))}return r},h.default=d,_.prototype.setURL=function(t){this.url=t},_.prototype.getGlyphs=function(t,u){var l=this,e=[];for(var r in t)for(var i=0,n=t[r];i<n.length;i+=1){var o=n[i];e.push({stack:r,id:o})}mt.asyncAll(e,function(t,r){var i=t.stack,n=t.id,o=l.entries[i],e=(o=o||(l.entries[i]={glyphs:{},requests:{}})).glyphs[n];if(void 0===e){if(e=l._tinySDF(o,i,n))return o.glyphs[n]=e,void r(null,{stack:i,id:n,glyph:e});var a=Math.floor(n/256);if(65535<256*a)r(new Error("glyphs > 65535 not supported"));else{var s=o.requests[a];s||(s=o.requests[a]=[],_.loadGlyphRange(i,a,l.url,l.requestManager,function(t,e){if(e)for(var r in e)l._doesCharSupportLocalGlyph(+r)||(o.glyphs[+r]=e[+r]);for(var i=0,n=s;i<n.length;i+=1)(0,n[i])(t,e);delete o.requests[a]})),s.push(function(t,e){t?r(t):e&&r(null,{stack:i,id:n,glyph:e[n]||null})})}}else r(null,{stack:i,id:n,glyph:e})},function(t,e){if(t)u(t);else if(e){for(var r={},i=0,n=e;i<n.length;i+=1){var o=n[i],a=o.stack,s=o.id,l=o.glyph;(r[a]||(r[a]={}))[s]=l&&{id:l.id,bitmap:l.bitmap.clone(),metrics:l.metrics}}u(null,r)}})},_.prototype._doesCharSupportLocalGlyph=function(t){return!!this.localIdeographFontFamily&&(mt.isChar["CJK Unified Ideographs"](t)||mt.isChar["Hangul Syllables"](t)||mt.isChar.Hiragana(t)||mt.isChar.Katakana(t))},_.prototype._tinySDF=function(t,e,r){var i=this.localIdeographFontFamily;if(i&&this._doesCharSupportLocalGlyph(r)){var n=t.tinySDF;if(!n){var o="400";/bold/i.test(e)?o="900":/medium/i.test(e)?o="500":/light/i.test(e)&&(o="200"),n=t.tinySDF=new _.TinySDF(24,3,8,.25,i,o)}return{id:r,bitmap:new mt.AlphaImage({width:30,height:30},n.draw(String.fromCharCode(r))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},_.loadGlyphRange=function(t,e,r,i,a){var n=256*e,o=255+n,s=i.transformRequest(i.normalizeGlyphsURL(r).replace("{fontstack}",t).replace("{range}",n+"-"+o),mt.ResourceType.Glyphs);mt.getArrayBuffer(s,function(t,e){if(t)a(t);else if(e){for(var r={},i=0,n=mt.parseGlyphPBF(e);i<n.length;i+=1){var o=n[i];r[o.id]=o}a(null,r)}})},_.TinySDF=h,x.prototype.possiblyEvaluate=function(t,e){return mt.sphericalToCartesian(t.expression.evaluate(e))},x.prototype.interpolate=function(t,e,r){return{x:mt.number(t.x,e.x,r),y:mt.number(t.y,e.y,r),z:mt.number(t.z,e.z,r)}};var w,S=new mt.Properties({anchor:new mt.DataConstantProperty(mt.styleSpec.light.anchor),position:new x,color:new mt.DataConstantProperty(mt.styleSpec.light.color),intensity:new mt.DataConstantProperty(mt.styleSpec.light.intensity)}),T=((w=mt.Evented)&&(E.__proto__=w),((E.prototype=Object.create(w&&w.prototype)).constructor=E).prototype.getLight=function(){return this._transitionable.serialize()},E.prototype.setLight=function(t,e){if(void 0===e&&(e={}),!this._validate(mt.validateLight,t,e))for(var r in t){var i=t[r];mt.endsWith(r,"-transition")?this._transitionable.setTransition(r.slice(0,-"-transition".length),i):this._transitionable.setValue(r,i)}},E.prototype.updateTransitions=function(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)},E.prototype.hasTransition=function(){return this._transitioning.hasTransition()},E.prototype.recalculate=function(t){this.properties=this._transitioning.possiblyEvaluate(t)},E.prototype._validate=function(t,e,r){return(!r||!1!==r.validate)&&mt.emitValidationErrors(this,t.call(mt.validateStyle,mt.extend({value:e,style:{glyphs:!0,sprite:!0},styleSpec:mt.styleSpec})))},E);function E(t){w.call(this),this._transitionable=new mt.Transitionable(S),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}function I(t,e){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=mt.uniqueId();for(var r=this.workerPool.acquire(this.id),i=0;i<r.length;i++){var n=r[i],o=new I.Actor(n,e,this.id);o.name="Worker "+i,this.actors.push(o)}}function C(i,n,o){function t(t,e){if(t)return o(t);if(e){var r=mt.pick(mt.extend(e,i),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);e.vector_layers&&(r.vectorLayers=e.vector_layers,r.vectorLayerIds=r.vectorLayers.map(function(t){return t.id})),i.url&&(r.tiles=n.canonicalizeTileset(r,i.url)),o(null,r)}}return i.url?mt.getJSON(n.transformRequest(n.normalizeSourceURL(i.url),mt.ResourceType.Source),t):mt.browser.frame(function(){return t(null,i)})}function k(t,e,r){this.bounds=mt.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=r||24}b.prototype.getDash=function(t,e){var r=t.join(",")+String(e);return this.positions[r]||(this.positions[r]=this.addDash(t,e)),this.positions[r]},b.prototype.addDash=function(t,e){var r=e?7:0,i=2*r+1;if(this.nextRow+i>this.height)return mt.warnOnce("LineAtlas out of space"),null;for(var n=0,o=0;o<t.length;o++)n+=t[o];for(var a=this.width/n,s=a/2,l=t.length%2==1,u=-r;u<=r;u++)for(var c=this.nextRow+r+u,p=this.width*c,h=l?-t[t.length-1]:0,d=t[0],f=1,m=0;m<this.width;m++){for(;d<m/a;)h=d,d+=t[f],l&&f===t.length-1&&(d+=t[0]),f++;var g=Math.abs(m-h*a),y=Math.abs(m-d*a),v=Math.min(g,y),_=f%2==1,x=void 0;if(e){var b=r?u/r*(1+s):0;if(_){var w=s-Math.abs(b);x=Math.sqrt(v*v+w*w)}else x=s-Math.sqrt(v*v+b*b)}else x=(_?1:-1)*v;this.data[3+4*(p+m)]=Math.max(0,Math.min(255,x+128))}var S={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:n};return this.nextRow+=i,this.dirty=!0,S},b.prototype.bind=function(t){var e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.RGBA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,this.data))},I.prototype.broadcast=function(r,i,t){t=t||function(){},mt.asyncAll(this.actors,function(t,e){t.send(r,i,e)},t)},I.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},I.prototype.remove=function(){this.actors.forEach(function(t){t.remove()}),this.actors=[],this.workerPool.release(this.id)},I.Actor=mt.Actor,k.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},k.prototype.contains=function(t){var e=Math.pow(2,t.z),r=Math.floor(mt.mercatorXfromLng(this.bounds.getWest())*e),i=Math.floor(mt.mercatorYfromLat(this.bounds.getNorth())*e),n=Math.ceil(mt.mercatorXfromLng(this.bounds.getEast())*e),o=Math.ceil(mt.mercatorYfromLat(this.bounds.getSouth())*e);return t.x>=r&&t.x<n&&t.y>=i&&t.y<o};var A,P,M,L,O,D=((O=mt.Evented)&&(V.__proto__=O),((V.prototype=Object.create(O&&O.prototype)).constructor=V).prototype.load=function(){var r=this;this._loaded=!1,this.fire(new mt.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=C(this._options,this.map._requestManager,function(t,e){r._tileJSONRequest=null,r._loaded=!0,t?r.fire(new mt.ErrorEvent(t)):e&&(mt.extend(r,e),e.bounds&&(r.tileBounds=new k(e.bounds,r.minzoom,r.maxzoom)),mt.postTurnstileEvent(e.tiles,r.map._requestManager._customAccessToken),mt.postMapLoadEvent(e.tiles,r.map._getMapId(),r.map._requestManager._skuToken,r.map._requestManager._customAccessToken),r.fire(new mt.Event("data",{dataType:"source",sourceDataType:"metadata"})),r.fire(new mt.Event("data",{dataType:"source",sourceDataType:"content"})))})},V.prototype.loaded=function(){return this._loaded},V.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},V.prototype.onAdd=function(t){this.map=t,this.load()},V.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},V.prototype.serialize=function(){return mt.extend({},this._options)},V.prototype.loadTile=function(r,i){var t=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),this.url,null),e={request:this.map._requestManager.transformRequest(t,mt.ResourceType.Tile),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:mt.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};function n(t,e){return delete r.request,r.aborted?i(null):t&&404!==t.status?i(t):(e&&e.resourceTiming&&(r.resourceTiming=e.resourceTiming),this.map._refreshExpiredTiles&&e&&r.setExpiryData(e),r.loadVectorData(e,this.map.painter),mt.cacheEntryPossiblyAdded(this.dispatcher),i(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}e.request.collectResourceTiming=this._collectResourceTiming,r.actor&&"expired"!==r.state?"loading"===r.state?r.reloadCallback=i:r.request=r.actor.send("reloadTile",e,n.bind(this)):(r.actor=this.dispatcher.getActor(),r.request=r.actor.send("loadTile",e,n.bind(this)))},V.prototype.abortTile=function(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)},V.prototype.unloadTile=function(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)},V.prototype.hasTransition=function(){return!1},V),R=((L=mt.Evented)&&(q.__proto__=L),((q.prototype=Object.create(L&&L.prototype)).constructor=q).prototype.load=function(){var r=this;this._loaded=!1,this.fire(new mt.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=C(this._options,this.map._requestManager,function(t,e){r._tileJSONRequest=null,r._loaded=!0,t?r.fire(new mt.ErrorEvent(t)):e&&(mt.extend(r,e),e.bounds&&(r.tileBounds=new k(e.bounds,r.minzoom,r.maxzoom)),mt.postTurnstileEvent(e.tiles),mt.postMapLoadEvent(e.tiles,r.map._getMapId(),r.map._requestManager._skuToken),r.fire(new mt.Event("data",{dataType:"source",sourceDataType:"metadata"})),r.fire(new mt.Event("data",{dataType:"source",sourceDataType:"content"})))})},q.prototype.loaded=function(){return this._loaded},q.prototype.onAdd=function(t){this.map=t,this.load()},q.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},q.prototype.serialize=function(){return mt.extend({},this._options)},q.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},q.prototype.loadTile=function(n,o){var a=this,t=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);n.request=mt.getImage(this.map._requestManager.transformRequest(t,mt.ResourceType.Tile),function(t,e){if(delete n.request,n.aborted)n.state="unloaded",o(null);else if(t)n.state="errored",o(t);else if(e){a.map._refreshExpiredTiles&&n.setExpiryData(e),delete e.cacheControl,delete e.expires;var r=a.map.painter.context,i=r.gl;n.texture=a.map.painter.getTileTexture(e.width),n.texture?n.texture.update(e,{useMipmap:!0}):(n.texture=new mt.Texture(r,e,i.RGBA,{useMipmap:!0}),n.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE,i.LINEAR_MIPMAP_NEAREST),r.extTextureFilterAnisotropic&&i.texParameterf(i.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax)),n.state="loaded",mt.cacheEntryPossiblyAdded(a.dispatcher),o(null)}})},q.prototype.abortTile=function(t,e){t.request&&(t.request.cancel(),delete t.request),e()},q.prototype.unloadTile=function(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()},q.prototype.hasTransition=function(){return!1},q),z=(j.__proto__=M=R,((j.prototype=Object.create(M&&M.prototype)).constructor=j).prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},j.prototype.loadTile=function(n,o){var t=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);n.request=mt.getImage(this.map._requestManager.transformRequest(t,mt.ResourceType.Tile),function(t,e){if(delete n.request,n.aborted)n.state="unloaded",o(null);else if(t)n.state="errored",o(t);else if(e){this.map._refreshExpiredTiles&&n.setExpiryData(e),delete e.cacheControl,delete e.expires;var r=mt.browser.getImageData(e,1),i={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:r,encoding:this.encoding};n.actor&&"expired"!==n.state||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",i,function(t,e){t&&(n.state="errored",o(t)),e&&(n.dem=e,n.needsHillshadePrepare=!0,n.state="loaded",o(null))}.bind(this)))}}.bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)},j.prototype._getNeighboringTiles=function(t){var e=t.canonical,r=Math.pow(2,e.z),i=(e.x-1+r)%r,n=0===e.x?t.wrap-1:t.wrap,o=(e.x+1+r)%r,a=e.x+1===r?t.wrap+1:t.wrap,s={};return s[new mt.OverscaledTileID(t.overscaledZ,n,e.z,i,e.y).key]={backfilled:!1},s[new mt.OverscaledTileID(t.overscaledZ,a,e.z,o,e.y).key]={backfilled:!1},0<e.y&&(s[new mt.OverscaledTileID(t.overscaledZ,n,e.z,i,e.y-1).key]={backfilled:!1},s[new mt.OverscaledTileID(t.overscaledZ,t.wrap,e.z,e.x,e.y-1).key]={backfilled:!1},s[new mt.OverscaledTileID(t.overscaledZ,a,e.z,o,e.y-1).key]={backfilled:!1}),e.y+1<r&&(s[new mt.OverscaledTileID(t.overscaledZ,n,e.z,i,e.y+1).key]={backfilled:!1},s[new mt.OverscaledTileID(t.overscaledZ,t.wrap,e.z,e.x,e.y+1).key]={backfilled:!1},s[new mt.OverscaledTileID(t.overscaledZ,a,e.z,o,e.y+1).key]={backfilled:!1}),s},j.prototype.unloadTile=function(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})},j),N=((P=mt.Evented)&&(U.__proto__=P),((U.prototype=Object.create(P&&P.prototype)).constructor=U).prototype.load=function(){var r=this;this.fire(new mt.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(t){if(t)r.fire(new mt.ErrorEvent(t));else{var e={dataType:"source",sourceDataType:"metadata"};r._collectResourceTiming&&r._resourceTiming&&0<r._resourceTiming.length&&(e.resourceTiming=r._resourceTiming,r._resourceTiming=[]),r.fire(new mt.Event("data",e))}})},U.prototype.onAdd=function(t){this.map=t,this.load()},U.prototype.setData=function(t){var r=this;return this._data=t,this.fire(new mt.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(t){if(t)r.fire(new mt.ErrorEvent(t));else{var e={dataType:"source",sourceDataType:"content"};r._collectResourceTiming&&r._resourceTiming&&0<r._resourceTiming.length&&(e.resourceTiming=r._resourceTiming,r._resourceTiming=[]),r.fire(new mt.Event("data",e))}}),this},U.prototype.getClusterExpansionZoom=function(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this},U.prototype.getClusterChildren=function(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this},U.prototype.getClusterLeaves=function(t,e,r,i){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:r},i),this},U.prototype._updateWorkerData=function(r){var i=this;this._loaded=!1;var n=mt.extend({},this.workerOptions),t=this._data;"string"==typeof t?(n.request=this.map._requestManager.transformRequest(mt.browser.resolveURL(t),mt.ResourceType.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(t),this.actor.send(this.type+".loadData",n,function(t,e){i._removed||e&&e.abandoned||(i._loaded=!0,e&&e.resourceTiming&&e.resourceTiming[i.id]&&(i._resourceTiming=e.resourceTiming[i.id].slice(0)),i.actor.send(i.type+".coalesce",{source:n.source},null),r(t))})},U.prototype.loaded=function(){return this._loaded},U.prototype.loadTile=function(r,i){var n=this,o=r.actor?"reloadTile":"loadTile";r.actor=this.actor;var t={type:this.type,uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:mt.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};r.request=this.actor.send(o,t,function(t,e){return delete r.request,r.unloadVectorData(),r.aborted?i(null):t?i(t):(r.loadVectorData(e,n.map.painter,"reloadTile"==o),i(null))})},U.prototype.abortTile=function(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0},U.prototype.unloadTile=function(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})},U.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},U.prototype.serialize=function(){return mt.extend({},this._options,{type:this.type,data:this._data})},U.prototype.hasTransition=function(){return!1},U),B=((A=mt.Evented)&&(F.__proto__=A),((F.prototype=Object.create(A&&A.prototype)).constructor=F).prototype.load=function(r,i){var n=this;this._loaded=!1,this.fire(new mt.Event("dataloading",{dataType:"source"})),this.url=this.options.url,mt.getImage(this.map._requestManager.transformRequest(this.url,mt.ResourceType.Image),function(t,e){n._loaded=!0,t?n.fire(new mt.ErrorEvent(t)):e&&(n.image=e,r&&(n.coordinates=r),i&&i(),n._finishLoading())})},F.prototype.loaded=function(){return this._loaded},F.prototype.updateImage=function(t){var e=this;return this.image&&t.url&&(this.options.url=t.url,this.load(t.coordinates,function(){e.texture=null})),this},F.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new mt.Event("data",{dataType:"source",sourceDataType:"metadata"})))},F.prototype.onAdd=function(t){this.map=t,this.load()},F.prototype.setCoordinates=function(t){var e=this,h=(this.coordinates=t).map(mt.MercatorCoordinate.fromLngLat);this.tileID=function(){for(var t=1/0,e=1/0,r=-1/0,i=-1/0,n=0,o=h;n<o.length;n+=1){var a=o[n];t=Math.min(t,a.x),e=Math.min(e,a.y),r=Math.max(r,a.x),i=Math.max(i,a.y)}var s=r-t,l=i-e,u=Math.max(s,l),c=Math.max(0,Math.floor(-Math.log(u)/Math.LN2)),p=Math.pow(2,c);return new mt.CanonicalTileID(c,Math.floor((t+r)/2*p),Math.floor((e+i)/2*p))}(),this.minzoom=this.maxzoom=this.tileID.z;var r=h.map(function(t){return e.tileID.getTilePoint(t)._round()});return this._boundsArray=new mt.StructArrayLayout4i8,this._boundsArray.emplaceBack(r[0].x,r[0].y,0,0),this._boundsArray.emplaceBack(r[1].x,r[1].y,mt.EXTENT,0),this._boundsArray.emplaceBack(r[3].x,r[3].y,0,mt.EXTENT),this._boundsArray.emplaceBack(r[2].x,r[2].y,mt.EXTENT,mt.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new mt.Event("data",{dataType:"source",sourceDataType:"content"})),this},F.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var t=this.map.painter.context,e=t.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,mt.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=mt.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new mt.Texture(t,this.image,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[r];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},F.prototype.loadTile=function(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t).buckets={}:t.state="errored",e(null)},F.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},F.prototype.hasTransition=function(){return!1},F);function F(t,e,r,i){A.call(this),this.id=t,this.dispatcher=r,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(i),this.options=e}function U(t,e,r,i){P.call(this),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=r.getActor(),this.setEventedParent(i),this._data=e.data,this._options=mt.extend({},e),this._collectResourceTiming=e.collectResourceTiming,this._resourceTiming=[],void 0!==e.maxzoom&&(this.maxzoom=e.maxzoom),e.type&&(this.type=e.type),e.attribution&&(this.attribution=e.attribution);var n=mt.EXTENT/this.tileSize;this.workerOptions=mt.extend({source:this.id,cluster:e.cluster||!1,geojsonVtOptions:{buffer:(void 0!==e.buffer?e.buffer:128)*n,tolerance:(void 0!==e.tolerance?e.tolerance:.375)*n,extent:mt.EXTENT,maxZoom:this.maxzoom,lineMetrics:e.lineMetrics||!1,generateId:e.generateId||!1},superclusterOptions:{maxZoom:void 0!==e.clusterMaxZoom?Math.min(e.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:mt.EXTENT,radius:(e.clusterRadius||50)*n,log:!1},clusterProperties:e.clusterProperties},e.workerOptions)}function j(t,e,r,i){M.call(this,t,e,r,i),this.type="raster-dem",this.maxzoom=22,this._options=mt.extend({type:"raster-dem"},e),this.encoding=e.encoding||"mapbox"}function q(t,e,r,i){L.call(this),this.id=t,this.dispatcher=r,this.setEventedParent(i),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=mt.extend({type:"raster"},e),mt.extend(this,mt.pick(e,["url","scheme","tileSize"]))}function V(t,e,r,i){if(O.call(this),this.id=t,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,mt.extend(this,mt.pick(e,["url","scheme","tileSize"])),this._options=mt.extend({type:"vector"},e),this._collectResourceTiming=e.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(i)}var G,Z,H=(Y.__proto__=Z=B,((Y.prototype=Object.create(Z&&Z.prototype)).constructor=Y).prototype.load=function(){var r=this;this._loaded=!1;var t=this.options;this.urls=[];for(var e=0,i=t.urls;e<i.length;e+=1){var n=i[e];this.urls.push(this.map._requestManager.transformRequest(n,mt.ResourceType.Source).url)}mt.getVideo(this.urls,function(t,e){r._loaded=!0,t?r.fire(new mt.ErrorEvent(t)):e&&(r.video=e,r.video.loop=!0,r.video.addEventListener("playing",function(){r.map.triggerRepaint()}),r.map&&r.video.play(),r._finishLoading())})},Y.prototype.pause=function(){this.video&&this.video.pause()},Y.prototype.play=function(){this.video&&this.video.play()},Y.prototype.seek=function(t){if(this.video){var e=this.video.seekable;t<e.start(0)||t>e.end(0)?this.fire(new mt.ErrorEvent(new mt.ValidationError("Playback for this video can be set only between the "+e.start(0)+" and "+e.end(0)+"-second mark."))):this.video.currentTime=t}},Y.prototype.getVideo=function(){return this.video},Y.prototype.onAdd=function(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},Y.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var t=this.map.painter.context,e=t.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,mt.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=mt.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE),e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,this.video)):(this.texture=new mt.Texture(t,this.video,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[r];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},Y.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},Y.prototype.hasTransition=function(){return this.video&&!this.video.paused},Y),W=(X.__proto__=G=B,((X.prototype=Object.create(G&&G.prototype)).constructor=X).prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof mt.window.HTMLCanvasElement?this.options.canvas:mt.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new mt.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},X.prototype.getCanvas=function(){return this.canvas},X.prototype.onAdd=function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()},X.prototype.onRemove=function(){this.pause()},X.prototype.prepare=function(){var t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var e=this.map.painter.context,r=e.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,mt.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=mt.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new mt.Texture(e,this.canvas,r.RGBA,{premultiply:!0}),this.tiles){var n=this.tiles[i];"loaded"!==n.state&&(n.state="loaded",n.texture=this.texture)}}},X.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},X.prototype.hasTransition=function(){return this._playing},X.prototype._hasInvalidDimensions=function(){for(var t=0,e=[this.canvas.width,this.canvas.height];t<e.length;t+=1){var r=e[t];if(isNaN(r)||r<=0)return!0}return!1},X),K={vector:D,raster:R,"raster-dem":z,geojson:N,video:H,image:B,canvas:W};function X(t,e,r,i){G.call(this,t,e,r,i),e.coordinates?Array.isArray(e.coordinates)&&4===e.coordinates.length&&!e.coordinates.some(function(t){return!Array.isArray(t)||2!==t.length||t.some(function(t){return"number"!=typeof t})})||this.fire(new mt.ErrorEvent(new mt.ValidationError("sources."+t,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new mt.ErrorEvent(new mt.ValidationError("sources."+t,null,'missing required property "coordinates"'))),e.animate&&"boolean"!=typeof e.animate&&this.fire(new mt.ErrorEvent(new mt.ValidationError("sources."+t,null,'optional "animate" property must be a boolean value'))),e.canvas?"string"==typeof e.canvas||e.canvas instanceof mt.window.HTMLCanvasElement||this.fire(new mt.ErrorEvent(new mt.ValidationError("sources."+t,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new mt.ErrorEvent(new mt.ValidationError("sources."+t,null,'missing required property "canvas"'))),this.options=e,this.animate=void 0===e.animate||e.animate}function Y(t,e,r,i){Z.call(this,t,e,r,i),this.roundZoom=!0,this.type="video",this.options=e}function J(i,t,e,r,n){var o,a,s,l=function(t,e,r){if(t)for(var i=0,n=t;i<n.length;i+=1){var o=e[n[i]];if(o&&o.source===r&&"fill-extrusion"===o.type)return!0}else for(var a in e){var s=e[a];if(s.source===r&&"fill-extrusion"===s.type)return!0}return!1}(r&&r.layers,t,i.id),u=n.maxPitchScaleFactor(),c=i.tilesIn(e,u,l);c.sort(Q);for(var m=[],p=0,h=c;p<h.length;p+=1){var d=h[p];m.push({wrappedTileID:d.tileID.wrapped().key,queryResults:d.tile.queryRenderedFeatures(t,i._state,d.queryGeometry,d.cameraQueryGeometry,d.scale,r,n,u,(o=i.transform,a=d.tileID,s=mt.identity([]),mt.translate(s,s,[1,1,0]),mt.scale(s,s,[.5*o.width,.5*o.height,1]),mt.multiply(s,s,o.calculatePosMatrix(a.toUnwrapped()))))})}var f=function(){for(var t={},e={},r=0,i=m;r<i.length;r+=1){var n=i[r],o=n.queryResults,a=n.wrappedTileID,s=e[a]=e[a]||{};for(var l in o)for(var u=o[l],c=s[l]=s[l]||{},p=t[l]=t[l]||[],h=0,d=u;h<d.length;h+=1){var f=d[h];c[f.featureIndex]||(c[f.featureIndex]=!0,p.push(f))}}return t}();for(var g in f)f[g].forEach(function(t){var e=t.feature,r=i.getFeatureState(e.layer["source-layer"],e.id);e.source=e.layer.source,e.layer["source-layer"]&&(e.sourceLayer=e.layer["source-layer"]),e.state=r});return f}function Q(t,e){var r=t.tileID,i=e.tileID;return r.overscaledZ-i.overscaledZ||r.canonical.y-i.canonical.y||r.wrap-i.wrap||r.canonical.x-i.canonical.x}function $(t,e){this.max=t,this.onRemove=e,this.reset()}function tt(t,e,r){var i=(this.context=t).gl;this.buffer=i.createBuffer(),this.dynamicDraw=Boolean(r),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}function et(t,e,r,i){this.length=e.length,this.attributes=r,this.itemSize=e.bytesPerElement,this.dynamicDraw=i;var n=(this.context=t).gl;this.buffer=n.createBuffer(),t.bindVertexBuffer.set(this.buffer),n.bufferData(n.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}$.prototype.reset=function(){for(var t in this.data)for(var e=0,r=this.data[t];e<r.length;e+=1){var i=r[e];i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value)}return this.data={},this.order=[],this},$.prototype.add=function(t,e,r){var i=this,n=t.wrapped().key;void 0===this.data[n]&&(this.data[n]=[]);var o={value:e,timeout:void 0};if(void 0!==r&&(o.timeout=setTimeout(function(){i.remove(t,o)},r)),this.data[n].push(o),this.order.push(n),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},$.prototype.has=function(t){return t.wrapped().key in this.data},$.prototype.getAndRemove=function(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null},$.prototype._getAndRemoveByKey=function(t){var e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value},$.prototype.get=function(t){return this.has(t)?this.data[t.wrapped().key][0].value:null},$.prototype.remove=function(t,e){if(!this.has(t))return this;var r=t.wrapped().key,i=void 0===e?0:this.data[r].indexOf(e),n=this.data[r][i];return this.data[r].splice(i,1),n.timeout&&clearTimeout(n.timeout),0===this.data[r].length&&delete this.data[r],this.onRemove(n.value),this.order.splice(this.order.indexOf(r),1),this},$.prototype.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this},tt.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},tt.prototype.updateData=function(t){var e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)},tt.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)};var rt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};function it(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}function nt(t,e,r){this.context=t,this.width=e,this.height=r;var i=t.gl,n=this.framebuffer=i.createFramebuffer();this.colorAttachment=new ve(t,n),this.depthAttachment=new _e(t,n)}et.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},et.prototype.updateData=function(t){var e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)},et.prototype.enableAttributes=function(t,e){for(var r=0;r<this.attributes.length;r++){var i=this.attributes[r],n=e.attributes[i.name];void 0!==n&&t.enableVertexAttribArray(n)}},et.prototype.setVertexAttribPointers=function(t,e,r){for(var i=0;i<this.attributes.length;i++){var n=this.attributes[i],o=e.attributes[n.name];void 0!==o&&t.vertexAttribPointer(o,n.components,t[rt[n.type]],!1,this.itemSize,n.offset+this.itemSize*(r||0))}},et.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)},it.prototype.get=function(){return this.current},it.prototype.set=function(t){},it.prototype.getDefault=function(){return this.default},it.prototype.setDefault=function(){this.set(this.default)};var ot,at,st,lt,ut,ct,pt,ht,dt,ft,gt,yt,vt,_t,xt,bt,wt,St,Tt,Et,It,Ct,kt,At,Pt,Mt,Lt,Ot,Dt,Rt,zt,Nt,Bt,Ft,Ut=($e.__proto__=Ft=it,(($e.prototype=Object.create(Ft&&Ft.prototype)).constructor=$e).prototype.getDefault=function(){return mt.Color.transparent},$e.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a&&!this.dirty||(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},$e),jt=(Qe.__proto__=Bt=it,((Qe.prototype=Object.create(Bt&&Bt.prototype)).constructor=Qe).prototype.getDefault=function(){return 1},Qe.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.clearDepth(t),this.current=t,this.dirty=!1)},Qe),qt=(Je.__proto__=Nt=it,((Je.prototype=Object.create(Nt&&Nt.prototype)).constructor=Je).prototype.getDefault=function(){return 0},Je.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.clearStencil(t),this.current=t,this.dirty=!1)},Je),Vt=(Ye.__proto__=zt=it,((Ye.prototype=Object.create(zt&&zt.prototype)).constructor=Ye).prototype.getDefault=function(){return[!0,!0,!0,!0]},Ye.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&!this.dirty||(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},Ye),Gt=(Xe.__proto__=Rt=it,((Xe.prototype=Object.create(Rt&&Rt.prototype)).constructor=Xe).prototype.getDefault=function(){return!0},Xe.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.depthMask(t),this.current=t,this.dirty=!1)},Xe),Zt=(Ke.__proto__=Dt=it,((Ke.prototype=Object.create(Dt&&Dt.prototype)).constructor=Ke).prototype.getDefault=function(){return 255},Ke.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.stencilMask(t),this.current=t,this.dirty=!1)},Ke),Ht=(We.__proto__=Ot=it,((We.prototype=Object.create(Ot&&Ot.prototype)).constructor=We).prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},We.prototype.set=function(t){var e=this.current;t.func===e.func&&t.ref===e.ref&&t.mask===e.mask&&!this.dirty||(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)},We),Wt=(He.__proto__=Lt=it,((He.prototype=Object.create(Lt&&Lt.prototype)).constructor=He).prototype.getDefault=function(){var t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]},He.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&!this.dirty||(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)},He),Kt=(Ze.__proto__=Mt=it,((Ze.prototype=Object.create(Mt&&Mt.prototype)).constructor=Ze).prototype.getDefault=function(){return!1},Ze.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}},Ze),Xt=(Ge.__proto__=Pt=it,((Ge.prototype=Object.create(Pt&&Pt.prototype)).constructor=Ge).prototype.getDefault=function(){return[0,1]},Ge.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&!this.dirty||(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)},Ge),Yt=(Ve.__proto__=At=it,((Ve.prototype=Object.create(At&&At.prototype)).constructor=Ve).prototype.getDefault=function(){return!1},Ve.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}},Ve),Jt=(qe.__proto__=kt=it,((qe.prototype=Object.create(kt&&kt.prototype)).constructor=qe).prototype.getDefault=function(){return this.gl.LESS},qe.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.depthFunc(t),this.current=t,this.dirty=!1)},qe),Qt=(je.__proto__=Ct=it,((je.prototype=Object.create(Ct&&Ct.prototype)).constructor=je).prototype.getDefault=function(){return!1},je.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}},je),$t=(Ue.__proto__=It=it,((Ue.prototype=Object.create(It&&It.prototype)).constructor=Ue).prototype.getDefault=function(){var t=this.gl;return[t.ONE,t.ZERO]},Ue.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&!this.dirty||(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)},Ue),te=(Fe.__proto__=Et=it,((Fe.prototype=Object.create(Et&&Et.prototype)).constructor=Fe).prototype.getDefault=function(){return mt.Color.transparent},Fe.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a&&!this.dirty||(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},Fe),ee=(Be.__proto__=Tt=it,((Be.prototype=Object.create(Tt&&Tt.prototype)).constructor=Be).prototype.getDefault=function(){return this.gl.FUNC_ADD},Be.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.blendEquation(t),this.current=t,this.dirty=!1)},Be),re=(Ne.__proto__=St=it,((Ne.prototype=Object.create(St&&St.prototype)).constructor=Ne).prototype.getDefault=function(){return!1},Ne.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}},Ne),ie=(ze.__proto__=wt=it,((ze.prototype=Object.create(wt&&wt.prototype)).constructor=ze).prototype.getDefault=function(){return this.gl.BACK},ze.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.cullFace(t),this.current=t,this.dirty=!1)},ze),ne=(Re.__proto__=bt=it,((Re.prototype=Object.create(bt&&bt.prototype)).constructor=Re).prototype.getDefault=function(){return this.gl.CCW},Re.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.frontFace(t),this.current=t,this.dirty=!1)},Re),oe=(De.__proto__=xt=it,((De.prototype=Object.create(xt&&xt.prototype)).constructor=De).prototype.getDefault=function(){return null},De.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.useProgram(t),this.current=t,this.dirty=!1)},De),ae=(Oe.__proto__=_t=it,((Oe.prototype=Object.create(_t&&_t.prototype)).constructor=Oe).prototype.getDefault=function(){return this.gl.TEXTURE0},Oe.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.activeTexture(t),this.current=t,this.dirty=!1)},Oe),se=(Le.__proto__=vt=it,((Le.prototype=Object.create(vt&&vt.prototype)).constructor=Le).prototype.getDefault=function(){var t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]},Le.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&!this.dirty||(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},Le),le=(Me.__proto__=yt=it,((Me.prototype=Object.create(yt&&yt.prototype)).constructor=Me).prototype.getDefault=function(){return null},Me.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}},Me),ue=(Pe.__proto__=gt=it,((Pe.prototype=Object.create(gt&&gt.prototype)).constructor=Pe).prototype.getDefault=function(){return null},Pe.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},Pe),ce=(Ae.__proto__=ft=it,((Ae.prototype=Object.create(ft&&ft.prototype)).constructor=Ae).prototype.getDefault=function(){return null},Ae.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}},Ae),pe=(ke.__proto__=dt=it,((ke.prototype=Object.create(dt&&dt.prototype)).constructor=ke).prototype.getDefault=function(){return null},ke.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}},ke),he=(Ce.__proto__=ht=it,((Ce.prototype=Object.create(ht&&ht.prototype)).constructor=Ce).prototype.getDefault=function(){return null},Ce.prototype.set=function(t){var e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1},Ce),de=(Ie.__proto__=pt=it,((Ie.prototype=Object.create(pt&&pt.prototype)).constructor=Ie).prototype.getDefault=function(){return null},Ie.prototype.set=function(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)},Ie),fe=(Ee.__proto__=ct=it,((Ee.prototype=Object.create(ct&&ct.prototype)).constructor=Ee).prototype.getDefault=function(){return 4},Ee.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}},Ee),me=(Te.__proto__=ut=it,((Te.prototype=Object.create(ut&&ut.prototype)).constructor=Te).prototype.getDefault=function(){return!1},Te.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}},Te),ge=(Se.__proto__=lt=it,((Se.prototype=Object.create(lt&&lt.prototype)).constructor=Se).prototype.getDefault=function(){return!1},Se.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}},Se),ye=(we.__proto__=st=it,((we.prototype=Object.create(st&&st.prototype)).constructor=we).prototype.getDefault=function(){return null},we),ve=(be.__proto__=at=ye,((be.prototype=Object.create(at&&at.prototype)).constructor=be).prototype.setDirty=function(){this.dirty=!0},be.prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}},be),_e=(xe.__proto__=ot=ye,((xe.prototype=Object.create(ot&&ot.prototype)).constructor=xe).prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},xe);function xe(){ot.apply(this,arguments)}function be(){at.apply(this,arguments)}function we(t,e){st.call(this,t),this.context=t,this.parent=e}function Se(){lt.apply(this,arguments)}function Te(){ut.apply(this,arguments)}function Ee(){ct.apply(this,arguments)}function Ie(t){pt.call(this,t),this.vao=t.extVertexArrayObject}function Ce(){ht.apply(this,arguments)}function ke(){dt.apply(this,arguments)}function Ae(){ft.apply(this,arguments)}function Pe(){gt.apply(this,arguments)}function Me(){yt.apply(this,arguments)}function Le(){vt.apply(this,arguments)}function Oe(){_t.apply(this,arguments)}function De(){xt.apply(this,arguments)}function Re(){bt.apply(this,arguments)}function ze(){wt.apply(this,arguments)}function Ne(){St.apply(this,arguments)}function Be(){Tt.apply(this,arguments)}function Fe(){Et.apply(this,arguments)}function Ue(){It.apply(this,arguments)}function je(){Ct.apply(this,arguments)}function qe(){kt.apply(this,arguments)}function Ve(){At.apply(this,arguments)}function Ge(){Pt.apply(this,arguments)}function Ze(){Mt.apply(this,arguments)}function He(){Lt.apply(this,arguments)}function We(){Ot.apply(this,arguments)}function Ke(){Dt.apply(this,arguments)}function Xe(){Rt.apply(this,arguments)}function Ye(){zt.apply(this,arguments)}function Je(){Nt.apply(this,arguments)}function Qe(){Bt.apply(this,arguments)}function $e(){Ft.apply(this,arguments)}nt.prototype.destroy=function(){var t=this.context.gl,e=this.colorAttachment.get();e&&t.deleteTexture(e);var r=this.depthAttachment.get();r&&t.deleteRenderbuffer(r),t.deleteFramebuffer(this.framebuffer)};var tr=function(t,e,r){this.func=t,this.mask=e,this.range=r};tr.ReadOnly=!1,tr.ReadWrite=!0,tr.disabled=new tr(519,tr.ReadOnly,[0,1]);var er=function(t,e,r,i,n,o){this.test=t,this.ref=e,this.mask=r,this.fail=i,this.depthFail=n,this.pass=o};function rr(t,e,r){this.blendFunction=t,this.blendColor=e,this.mask=r}er.disabled=new er({func:519,mask:0},0,0,7680,7680,7680),rr.disabled=new rr(rr.Replace=[1,0],mt.Color.transparent,[!1,!1,!1,!1]),rr.unblended=new rr(rr.Replace,mt.Color.transparent,[!0,!0,!0,!0]),rr.alphaBlended=new rr([1,771],mt.Color.transparent,[!0,!0,!0,!0]);var ir=function(t,e,r){this.enable=t,this.mode=e,this.frontFace=r};function nr(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Ut(this),this.clearDepth=new jt(this),this.clearStencil=new qt(this),this.colorMask=new Vt(this),this.depthMask=new Gt(this),this.stencilMask=new Zt(this),this.stencilFunc=new Ht(this),this.stencilOp=new Wt(this),this.stencilTest=new Kt(this),this.depthRange=new Xt(this),this.depthTest=new Yt(this),this.depthFunc=new Jt(this),this.blend=new Qt(this),this.blendFunc=new $t(this),this.blendColor=new te(this),this.blendEquation=new ee(this),this.cullFace=new re(this),this.cullFaceSide=new ie(this),this.frontFace=new ne(this),this.program=new oe(this),this.activeTexture=new ae(this),this.viewport=new se(this),this.bindFramebuffer=new le(this),this.bindRenderbuffer=new ue(this),this.bindTexture=new ce(this),this.bindVertexBuffer=new pe(this),this.bindElementBuffer=new he(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new de(this),this.pixelStoreUnpack=new fe(this),this.pixelStoreUnpackPremultiplyAlpha=new me(this),this.pixelStoreUnpackFlipY=new ge(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&t.getExtension("OES_texture_half_float_linear")}ir.disabled=new ir(!1,1029,2305),ir.backCCW=new ir(!0,1029,2305),nr.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},nr.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},nr.prototype.createIndexBuffer=function(t,e){return new tt(this,t,e)},nr.prototype.createVertexBuffer=function(t,e,r){return new et(this,t,e,r)},nr.prototype.createRenderbuffer=function(t,e,r){var i=this.gl,n=i.createRenderbuffer();return this.bindRenderbuffer.set(n),i.renderbufferStorage(i.RENDERBUFFER,t,e,r),this.bindRenderbuffer.set(null),n},nr.prototype.createFramebuffer=function(t,e){return new nt(this,t,e)},nr.prototype.clear=function(t){var e=t.color,r=t.depth,i=this.gl,n=0;e&&(n|=i.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==r&&(n|=i.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),i.clear(n)},nr.prototype.setCullFace=function(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))},nr.prototype.setDepthMode=function(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)},nr.prototype.setStencilMode=function(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)},nr.prototype.setColorMode=function(t){mt.deepEqual(t.blendFunction,rr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)},nr.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var or,ar=((or=mt.Evented)&&(sr.__proto__=or),((sr.prototype=Object.create(or&&or.prototype)).constructor=sr).prototype.onAdd=function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)},sr.prototype.onRemove=function(t){this._source&&this._source.onRemove&&this._source.onRemove(t)},sr.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var t in this._tiles){var e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0},sr.prototype.getSource=function(){return this._source},sr.prototype.pause=function(){this._paused=!0},sr.prototype.resume=function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}},sr.prototype._loadTile=function(t,e){return this._source.loadTile(t,e)},sr.prototype._unloadTile=function(t){if(this._source.unloadTile)return this._source.unloadTile(t,function(){})},sr.prototype._abortTile=function(t){if(this._source.abortTile)return this._source.abortTile(t,function(){})},sr.prototype.serialize=function(){return this._source.serialize()},sr.prototype.prepare=function(t){for(var e in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var r=this._tiles[e];r.upload(t),r.prepare(this.map.style.imageManager)}},sr.prototype.getIds=function(){return Object.keys(this._tiles).map(Number).sort(lr)},sr.prototype.getRenderableIds=function(t){var a=this,e=[];for(var r in this._tiles)this._isIdRenderable(+r,t)&&e.push(+r);return t?e.sort(function(t,e){var r=a._tiles[t].tileID,i=a._tiles[e].tileID,n=new mt.Point(r.canonical.x,r.canonical.y)._rotate(a.transform.angle),o=new mt.Point(i.canonical.x,i.canonical.y)._rotate(a.transform.angle);return r.overscaledZ-i.overscaledZ||o.y-n.y||o.x-n.x}):e.sort(lr)},sr.prototype.hasRenderableParent=function(t){var e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)},sr.prototype._isIdRenderable=function(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())},sr.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var t in this._cache.reset(),this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")},sr.prototype._reloadTile=function(t,e){var r=this._tiles[t];r&&("loading"!==r.state&&(r.state=e),this._loadTile(r,this._tileLoaded.bind(this,r,t,e)))},sr.prototype._tileLoaded=function(t,e,r,i){if(i)return t.state="errored",void(404!==i.status?this._source.fire(new mt.ErrorEvent(i,{tile:t})):this.update(this.transform));t.timeAdded=mt.browser.now(),"expired"===r&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(e,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new mt.Event("data",{dataType:"source",tile:t,coord:t.tileID}))},sr.prototype._backfillDEM=function(t){for(var e=this.getRenderableIds(),r=0;r<e.length;r++){var i=e[r];if(t.neighboringTiles&&t.neighboringTiles[i]){var n=this.getTileByID(i);o(t,n),o(n,t)}}function o(t,e){t.needsHillshadePrepare=!0;var r=e.tileID.canonical.x-t.tileID.canonical.x,i=e.tileID.canonical.y-t.tileID.canonical.y,n=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===r&&0==i||1<Math.abs(i)||(1<Math.abs(r)&&(1===Math.abs(r+n)?r+=n:1===Math.abs(r-n)&&(r-=n)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,r,i),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}},sr.prototype.getTile=function(t){return this.getTileByID(t.key)},sr.prototype.getTileByID=function(t){return this._tiles[t]},sr.prototype.getZoom=function(t){return t.zoom+t.scaleZoom(t.tileSize/this._source.tileSize)},sr.prototype._retainLoadedChildren=function(t,e,r,i){for(var n in this._tiles){var o=this._tiles[n];if(!(i[n]||!o.hasData()||o.tileID.overscaledZ<=e||o.tileID.overscaledZ>r)){for(var a=o.tileID;o&&o.tileID.overscaledZ>e+1;){var s=o.tileID.scaledTo(o.tileID.overscaledZ-1);(o=this._tiles[s.key])&&o.hasData()&&(a=s)}for(var l=a;l.overscaledZ>e;)if(t[(l=l.scaledTo(l.overscaledZ-1)).key]){i[a.key]=a;break}}}},sr.prototype.findLoadedParent=function(t,e){for(var r=t.overscaledZ-1;e<=r;r--){var i=t.scaledTo(r);if(!i)return;var n=String(i.key),o=this._tiles[n];if(o&&o.hasData())return o;if(this._cache.has(i))return this._cache.get(i)}},sr.prototype.updateCacheSize=function(t){var e=(Math.ceil(t.width/this._source.tileSize)+1)*(Math.ceil(t.height/this._source.tileSize)+1),r=Math.floor(5*e),i="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(i)},sr.prototype.handleWrapJump=function(t){var e=(t-(void 0===this._prevLng?t:this._prevLng))/360,r=Math.round(e);if(this._prevLng=t,r){var i={};for(var n in this._tiles){var o=this._tiles[n];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+r),i[o.tileID.key]=o}for(var a in this._tiles=i,this._timers)clearTimeout(this._timers[a]),delete this._timers[a];for(var s in this._tiles){var l=this._tiles[s];this._setTileReloadTimer(s,l)}}},sr.prototype.update=function(t){var e=this;if(this.transform=t,this._sourceLoaded&&!this._paused){var r;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?r=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(t){return new mt.OverscaledTileID(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)}):(r=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(r=r.filter(function(t){return e._source.hasTile(t)}))):r=[];var i=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(t)),n=Math.max(i-sr.maxOverzooming,this._source.minzoom),o=Math.max(i+sr.maxUnderzooming,this._source.minzoom),a=this._updateRetainedTiles(r,i);if(ur(this._source.type)){for(var s={},l={},u=0,c=Object.keys(a);u<c.length;u+=1){var p=c[u],h=a[p],d=this._tiles[p];if(d&&!(d.fadeEndTime&&d.fadeEndTime<=mt.browser.now())){var f=this.findLoadedParent(h,n);f&&(this._addTile(f.tileID),s[f.tileID.key]=f.tileID),l[p]=h}}for(var m in this._retainLoadedChildren(l,i,o,a),s)a[m]||(this._coveredTiles[m]=!0,a[m]=s[m])}for(var g in a)this._tiles[g].clearFadeHold();for(var y=0,v=mt.keysDifference(this._tiles,a);y<v.length;y+=1){var _=v[y],x=this._tiles[_];x.hasSymbolBuckets&&!x.holdingForFade()?x.setHoldDuration(this.map._fadeDuration):x.hasSymbolBuckets&&!x.symbolFadeFinished()||this._removeTile(_)}}},sr.prototype.releaseSymbolFadeTiles=function(){for(var t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)},sr.prototype._updateRetainedTiles=function(t,e){for(var r={},i={},n=Math.max(e-sr.maxOverzooming,this._source.minzoom),o=Math.max(e+sr.maxUnderzooming,this._source.minzoom),a={},s=0,l=t;s<l.length;s+=1){var u=l[s],c=this._addTile(u);r[u.key]=u,c.hasData()||e<this._source.maxzoom&&(a[u.key]=u)}this._retainLoadedChildren(a,e,o,r);for(var p=0,h=t;p<h.length;p+=1){var d=h[p],f=this._tiles[d.key];if(!f.hasData()){if(e+1>this._source.maxzoom){var m=d.children(this._source.maxzoom)[0],g=this.getTile(m);if(g&&g.hasData()){r[m.key]=m;continue}}else{var y=d.children(this._source.maxzoom);if(r[y[0].key]&&r[y[1].key]&&r[y[2].key]&&r[y[3].key])continue}for(var v=f.wasRequested(),_=d.overscaledZ-1;n<=_;--_){var x=d.scaledTo(_);if(i[x.key])break;if(i[x.key]=!0,!(f=this.getTile(x))&&v&&(f=this._addTile(x)),f&&(r[x.key]=x,v=f.wasRequested(),f.hasData()))break}}}return r},sr.prototype._addTile=function(t){var e=this._tiles[t.key];if(e)return e;(e=this._cache.getAndRemove(t))&&(this._setTileReloadTimer(t.key,e),e.tileID=t,this._state.initializeTileState(e,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,e)));var r=Boolean(e);return r||(e=new mt.Tile(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(e,this._tileLoaded.bind(this,e,t.key,e.state))),e?(e.uses++,this._tiles[t.key]=e,r||this._source.fire(new mt.Event("dataloading",{tile:e,coord:e.tileID,dataType:"source"})),e):null},sr.prototype._setTileReloadTimer=function(t,e){var r=this;t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);var i=e.getExpiryTimeout();i&&(this._timers[t]=setTimeout(function(){r._reloadTile(t,"expired"),delete r._timers[t]},i))},sr.prototype._removeTile=function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),0<e.uses||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))},sr.prototype.clearTiles=function(){for(var t in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(t);this._cache.reset()},sr.prototype.tilesIn=function(t,l,e){var u=this,c=[],p=this.transform;if(!p)return c;for(var r=e?p.getCameraQueryGeometry(t):t,h=t.map(function(t){return p.pointCoordinate(t)}),d=r.map(function(t){return p.pointCoordinate(t)}),f=this.getIds(),m=1/0,g=1/0,y=-1/0,v=-1/0,i=0,n=d;i<n.length;i+=1){var o=n[i];m=Math.min(m,o.x),g=Math.min(g,o.y),y=Math.max(y,o.x),v=Math.max(v,o.y)}for(var a=function(t){var e=u._tiles[f[t]];if(!e.holdingForFade()){var r=e.tileID,i=Math.pow(2,p.zoom-e.tileID.overscaledZ),n=l*e.queryPadding*mt.EXTENT/e.tileSize/i,o=[r.getTilePoint(new mt.MercatorCoordinate(m,g)),r.getTilePoint(new mt.MercatorCoordinate(y,v))];if(o[0].x-n<mt.EXTENT&&o[0].y-n<mt.EXTENT&&0<=o[1].x+n&&0<=o[1].y+n){var a=h.map(function(t){return r.getTilePoint(t)}),s=d.map(function(t){return r.getTilePoint(t)});c.push({tile:e,tileID:r,queryGeometry:a,cameraQueryGeometry:s,scale:i})}}},s=0;s<f.length;s++)a(s);return c},sr.prototype.getVisibleCoordinates=function(t){for(var e=this,r=this.getRenderableIds(t).map(function(t){return e._tiles[t].tileID}),i=0,n=r;i<n.length;i+=1){var o=n[i];o.posMatrix=this.transform.calculatePosMatrix(o.toUnwrapped())}return r},sr.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(ur(this._source.type))for(var t in this._tiles){var e=this._tiles[t];if(void 0!==e.fadeEndTime&&e.fadeEndTime>=mt.browser.now())return!0}return!1},sr.prototype.setFeatureState=function(t,e,r){t=t||"_geojsonTileLayer",this._state.updateState(t,e,r)},sr.prototype.removeFeatureState=function(t,e,r){t=t||"_geojsonTileLayer",this._state.removeFeatureState(t,e,r)},sr.prototype.getFeatureState=function(t,e){return t=t||"_geojsonTileLayer",this._state.getState(t,e)},sr);function sr(t,e,r){var i=this;or.call(this),this.id=t,this.dispatcher=r,this.on("data",function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(i._sourceLoaded=!0),i._sourceLoaded&&!i._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(i.reload(),i.transform&&i.update(i.transform))}),this.on("error",function(){i._sourceErrored=!0}),this._source=function(t,e,r,i){var n=new K[e.type](t,e,r,i);if(n.id!==t)throw new Error("Expected Source id to be "+t+" instead of "+n.id);return mt.bindAll(["load","abort","unload","serialize","prepare"],n),n}(t,e,r,this),this._tiles={},this._cache=new $(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._coveredTiles={},this._state=new mt.SourceFeatureState}function lr(t,e){return t%32-e%32||e-t}function ur(t){return"raster"===t||"image"===t||"video"===t}function cr(){return new mt.window.Worker(ko.workerUrl)}function pr(){this.active={}}ar.maxOverzooming=10,ar.maxUnderzooming=3,pr.prototype.acquire=function(t){if(!this.workers)for(this.workers=[];this.workers.length<pr.workerCount;)this.workers.push(new cr);return this.active[t]=!0,this.workers.slice()},pr.prototype.release=function(t){delete this.active[t],0===Object.keys(this.active).length&&(this.workers.forEach(function(t){t.terminate()}),this.workers=null)};var hr,dr=Math.floor(mt.browser.hardwareConcurrency/2);function fr(t,e){var r={};for(var i in t)"ref"!==i&&(r[i]=t[i]);return mt.refProperties.forEach(function(t){t in e&&(r[t]=e[t])}),r}function mr(t){t=t.slice();for(var e=Object.create(null),r=0;r<t.length;r++)e[t[r].id]=t[r];for(var i=0;i<t.length;i++)"ref"in t[i]&&(t[i]=fr(t[i],e[t[i].ref]));return t}pr.workerCount=Math.max(Math.min(dr,6),1);var gr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function yr(t,e,r){r.push({command:gr.addSource,args:[t,e[t]]})}function vr(t,e,r){e.push({command:gr.removeSource,args:[t]}),r[t]=!0}function _r(t,e,r){var i;for(i in t[r])if(t[r].hasOwnProperty(i)&&"data"!==i&&!mt.deepEqual(t[r][i],e[r][i]))return!1;for(i in e[r])if(e[r].hasOwnProperty(i)&&"data"!==i&&!mt.deepEqual(t[r][i],e[r][i]))return!1;return!0}function xr(t,e,r,i,n,o){var a;for(a in e=e||{},t=t||{})t.hasOwnProperty(a)&&(mt.deepEqual(t[a],e[a])||r.push({command:o,args:[i,a,e[a],n]}));for(a in e)e.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(mt.deepEqual(t[a],e[a])||r.push({command:o,args:[i,a,e[a],n]}))}function br(t){return t.id}function wr(t,e){return t[e.id]=e,t}function Sr(t,e,r){var i=this.boxCells=[],n=this.circleCells=[];this.xCellCount=Math.ceil(t/r),this.yCellCount=Math.ceil(e/r);for(var o=0;o<this.xCellCount*this.yCellCount;o++)i.push([]),n.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0}function Tr(t,e,r,i,n){var o=mt.create();return e?(mt.scale(o,o,[1/n,1/n,1]),r||mt.rotateZ(o,o,i.angle)):mt.multiply(o,i.labelPlaneMatrix,t),o}function Er(t,e,r,i,n){if(e){var o=mt.clone(t);return mt.scale(o,o,[n,n,1]),r||mt.rotateZ(o,o,-i.angle),o}return i.glCoordMatrix}function Ir(t,e){var r=[t.x,t.y,0,1];Rr(r,r,e);var i=r[3];return{point:new mt.Point(r[0]/i,r[1]/i),signedDistanceFromCamera:i}}function Cr(t,e,r,i,n,o,a,s){var l,u,c,p,h=i?t.textSizeData:t.iconSizeData,d=mt.evaluateSizeForZoom(h,r.transform.zoom),f=[256/r.width*2+1,256/r.height*2+1],m=i?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;m.clear();for(var g=t.lineVertexArray,y=i?t.text.placedSymbolArray:t.icon.placedSymbolArray,v=r.transform.width/r.transform.height,_=!1,x=0;x<y.length;x++){var b=y.get(x);if(b.hidden||b.writingMode===mt.WritingMode.vertical&&!_)Dr(b.numGlyphs,m);else{_=!1;var w=[b.anchorX,b.anchorY,0,1];if(mt.transformMat4(w,w,e),u=f,c=(l=w)[0]/l[3],p=l[1]/l[3],c>=-u[0]&&c<=u[0]&&p>=-u[1]&&p<=u[1]){var S=.5+w[3]/r.transform.cameraToCenterDistance*.5,T=mt.evaluateSizeForFeature(h,d,b),E=a?T*S:T/S,I=new mt.Point(b.anchorX,b.anchorY),C=Ir(I,n).point,k={},A=Pr(b,E,!1,s,e,n,o,t.glyphOffsetArray,g,m,C,I,k,v);_=A.useVertical,(A.notEnoughRoom||_||A.needsFlipping&&Pr(b,E,!0,s,e,n,o,t.glyphOffsetArray,g,m,C,I,k,v).notEnoughRoom)&&Dr(b.numGlyphs,m)}else Dr(b.numGlyphs,m)}}i?t.text.dynamicLayoutVertexBuffer.updateData(m):t.icon.dynamicLayoutVertexBuffer.updateData(m)}function kr(t,e,r,i,n,o,a,s,l,u,c,p){var h=s.glyphStartIndex+s.numGlyphs,d=s.lineStartIndex,f=s.lineStartIndex+s.lineLength,m=e.getoffsetX(s.glyphStartIndex),g=e.getoffsetX(h-1),y=Lr(t*m,r,i,n,o,a,s.segment,d,f,l,u,c,p);if(!y)return null;var v=Lr(t*g,r,i,n,o,a,s.segment,d,f,l,u,c,p);return v?{first:y,last:v}:null}function Ar(t,e,r,i){return t===mt.WritingMode.horizontal&&Math.abs(r.y-e.y)>Math.abs(r.x-e.x)*i?{useVertical:!0}:(t===mt.WritingMode.vertical?e.y<r.y:e.x>r.x)?{needsFlipping:!0}:null}function Pr(t,e,r,i,n,o,a,s,l,u,c,p,h,d){var f,m=e/24,g=t.lineOffsetX*m,y=t.lineOffsetY*m;if(1<t.numGlyphs){var v=t.glyphStartIndex+t.numGlyphs,_=t.lineStartIndex,x=t.lineStartIndex+t.lineLength,b=kr(m,s,g,y,r,c,p,t,l,o,h,!1);if(!b)return{notEnoughRoom:!0};var w=Ir(b.first.point,a).point,S=Ir(b.last.point,a).point;if(i&&!r){var T=Ar(t.writingMode,w,S,d);if(T)return T}f=[b.first];for(var E=t.glyphStartIndex+1;E<v-1;E++)f.push(Lr(m*s.getoffsetX(E),g,y,r,c,p,t.segment,_,x,l,o,h,!1));f.push(b.last)}else{if(i&&!r){var I=Ir(p,n).point,C=t.lineStartIndex+t.segment+1,k=new mt.Point(l.getx(C),l.gety(C)),A=Ir(k,n),P=0<A.signedDistanceFromCamera?A.point:Mr(p,k,I,1,n),M=Ar(t.writingMode,I,P,d);if(M)return M}var L=Lr(m*s.getoffsetX(t.glyphStartIndex),g,y,r,c,p,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,l,o,h,!1);if(!L)return{notEnoughRoom:!0};f=[L]}for(var O=0,D=f;O<D.length;O+=1){var R=D[O];mt.addDynamicAttributes(u,R.point,R.angle)}return{}}function Mr(t,e,r,i,n){var o=Ir(t.add(t.sub(e)._unit()),n).point,a=r.sub(o);return r.add(a._mult(i/a.mag()))}function Lr(t,e,r,i,n,o,a,s,l,u,c,p,h){var d=i?t-e:t+e,f=0<d?1:-1,m=0;i&&(f*=-1,m=Math.PI),f<0&&(m+=Math.PI);for(var g=0<f?s+a:s+a+1,y=g,v=n,_=n,x=0,b=0,w=Math.abs(d);x+b<=w;){if((g+=f)<s||l<=g)return null;if(_=v,void 0===(v=p[g])){var S=new mt.Point(u.getx(g),u.gety(g)),T=Ir(S,c);if(0<T.signedDistanceFromCamera)v=p[g]=T.point;else{var E=g-f;v=Mr(0===x?o:new mt.Point(u.getx(E),u.gety(E)),S,_,w-x+1,c)}}x+=b,b=_.dist(v)}var I=(w-x)/b,C=v.sub(_),k=C.mult(I)._add(_);return k._add(C._unit()._perp()._mult(r*f)),{point:k,angle:m+Math.atan2(v.y-_.y,v.x-_.x),tileDistance:h?{prevTileDistance:g-f===y?0:u.gettileUnitDistanceFromAnchor(g-f),lastSegmentViewportDistance:w-x}:null}}Sr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Sr.prototype.insert=function(t,e,r,i,n){this._forEachCell(e,r,i,n,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(i),this.bboxes.push(n)},Sr.prototype.insertCircle=function(t,e,r,i){this._forEachCell(e-i,r-i,e+i,r+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(r),this.circles.push(i)},Sr.prototype._insertBoxCell=function(t,e,r,i,n,o){this.boxCells[n].push(o)},Sr.prototype._insertCircleCell=function(t,e,r,i,n,o){this.circleCells[n].push(o)},Sr.prototype._query=function(t,e,r,i,n,o){if(r<0||t>this.width||i<0||e>this.height)return!n&&[];var a=[];if(t<=0&&e<=0&&this.width<=r&&this.height<=i){if(n)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var l=0;l<this.circleKeys.length;l++){var u=this.circles[3*l],c=this.circles[3*l+1],p=this.circles[3*l+2];a.push({key:this.circleKeys[l],x1:u-p,y1:c-p,x2:u+p,y2:c+p})}return o?a.filter(o):a}var h={hitTest:n,seenUids:{box:{},circle:{}}};return this._forEachCell(t,e,r,i,this._queryCell,a,h,o),n?0<a.length:a},Sr.prototype._queryCircle=function(t,e,r,i,n){var o=t-r,a=t+r,s=e-r,l=e+r;if(a<0||o>this.width||l<0||s>this.height)return!i&&[];var u=[],c={hitTest:i,circle:{x:t,y:e,radius:r},seenUids:{box:{},circle:{}}};return this._forEachCell(o,s,a,l,this._queryCellCircle,u,c,n),i?0<u.length:u},Sr.prototype.query=function(t,e,r,i,n){return this._query(t,e,r,i,!1,n)},Sr.prototype.hitTest=function(t,e,r,i,n){return this._query(t,e,r,i,!0,n)},Sr.prototype.hitTestCircle=function(t,e,r,i){return this._queryCircle(t,e,r,!0,i)},Sr.prototype._queryCell=function(t,e,r,i,n,o,a,s){var l=a.seenUids,u=this.boxCells[n];if(null!==u)for(var c=this.bboxes,p=0,h=u;p<h.length;p+=1){var d=h[p];if(!l.box[d]){l.box[d]=!0;var f=4*d;if(t<=c[2+f]&&e<=c[3+f]&&r>=c[0+f]&&i>=c[1+f]&&(!s||s(this.boxKeys[d]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[d],x1:c[f],y1:c[1+f],x2:c[2+f],y2:c[3+f]})}}}var m=this.circleCells[n];if(null!==m)for(var g=this.circles,y=0,v=m;y<v.length;y+=1){var _=v[y];if(!l.circle[_]){l.circle[_]=!0;var x=3*_;if(this._circleAndRectCollide(g[x],g[1+x],g[2+x],t,e,r,i)&&(!s||s(this.circleKeys[_]))){if(a.hitTest)return o.push(!0),!0;var b=g[x],w=g[1+x],S=g[2+x];o.push({key:this.circleKeys[_],x1:b-S,y1:w-S,x2:b+S,y2:w+S})}}}},Sr.prototype._queryCellCircle=function(t,e,r,i,n,o,a,s){var l=a.circle,u=a.seenUids,c=this.boxCells[n];if(null!==c)for(var p=this.bboxes,h=0,d=c;h<d.length;h+=1){var f=d[h];if(!u.box[f]){u.box[f]=!0;var m=4*f;if(this._circleAndRectCollide(l.x,l.y,l.radius,p[0+m],p[1+m],p[2+m],p[3+m])&&(!s||s(this.boxKeys[f])))return o.push(!0),!0}}var g=this.circleCells[n];if(null!==g)for(var y=this.circles,v=0,_=g;v<_.length;v+=1){var x=_[v];if(!u.circle[x]){u.circle[x]=!0;var b=3*x;if(this._circlesCollide(y[b],y[1+b],y[2+b],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[x])))return o.push(!0),!0}}},Sr.prototype._forEachCell=function(t,e,r,i,n,o,a,s){for(var l=this._convertToXCellCoord(t),u=this._convertToYCellCoord(e),c=this._convertToXCellCoord(r),p=this._convertToYCellCoord(i),h=l;h<=c;h++)for(var d=u;d<=p;d++){var f=this.xCellCount*d+h;if(n.call(this,t,e,r,i,f,o,a,s))return}},Sr.prototype._convertToXCellCoord=function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))},Sr.prototype._convertToYCellCoord=function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))},Sr.prototype._circlesCollide=function(t,e,r,i,n,o){var a=i-t,s=n-e,l=r+o;return a*a+s*s<l*l},Sr.prototype._circleAndRectCollide=function(t,e,r,i,n,o,a){var s=(o-i)/2,l=Math.abs(t-(i+s));if(s+r<l)return!1;var u=(a-n)/2,c=Math.abs(e-(n+u));if(u+r<c)return!1;if(l<=s||c<=u)return!0;var p=l-s,h=c-u;return p*p+h*h<=r*r};var Or=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Dr(t,e){for(var r=0;r<t;r++){var i=e.length;e.resize(i+4),e.float32.set(Or,3*i)}}function Rr(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[4]*n+r[12],t[1]=r[1]*i+r[5]*n+r[13],t[3]=r[3]*i+r[7]*n+r[15],t}function zr(t,e,r){void 0===e&&(e=new Sr(t.width+200,t.height+200,25)),void 0===r&&(r=new Sr(t.width+200,t.height+200,25)),this.transform=t,this.grid=e,this.ignoredGrid=r,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+100,this.screenBottomBoundary=t.height+100,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200}function Nr(t,e,r){t[e+4]=r?1:0}function Br(t,e,r){return e*(mt.EXTENT/(t.tileSize*Math.pow(2,r-t.tileID.overscaledZ)))}function Fr(t,e,r,i){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):i&&r?1:0,this.placed=r}function Ur(t,e,r,i,n){this.text=new Fr(t?t.text:null,e,r,n),this.icon=new Fr(t?t.icon:null,e,i,n)}function jr(t,e,r){this.text=t,this.icon=e,this.skipFade=r}function qr(t,e,r,i,n){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=r,this.bucketIndex=i,this.tileID=n}function Vr(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}function Gr(t,e,r,i,n){var o=mt.getAnchorAlignment(t),a=-(o.horizontalAlign-.5)*e,s=-(o.verticalAlign-.5)*r,l=mt.evaluateVariableOffset(t,i);return new mt.Point(a+l[0]*n,s+l[1]*n)}function Zr(t,e,r,i,n,o){var a=t.x1,s=t.x2,l=t.y1,u=t.y2,c=t.anchorPointX,p=t.anchorPointY,h=new mt.Point(e,r);return i&&h._rotate(n?o:-o),{x1:a+h.x,y1:l+h.y,x2:s+h.x,y2:u+h.y,anchorPointX:c,anchorPointY:p}}function Hr(t,e,r,i){this.transform=t.clone(),this.collisionIndex=new zr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new Vr(r),(this.prevPlacement=i)&&(i.prevPlacement=void 0),this.placedOrientations={}}function Wr(t,e,r,i,n){t.emplaceBack(e?1:0,r?1:0,i||0,n||0),t.emplaceBack(e?1:0,r?1:0,i||0,n||0),t.emplaceBack(e?1:0,r?1:0,i||0,n||0),t.emplaceBack(e?1:0,r?1:0,i||0,n||0)}zr.prototype.placeCollisionBox=function(t,e,r,i,n){var o=this.projectAndGetPerspectiveRatio(i,t.anchorPointX,t.anchorPointY),a=r*o.perspectiveRatio,s=t.x1*a+o.point.x,l=t.y1*a+o.point.y,u=t.x2*a+o.point.x,c=t.y2*a+o.point.y;return!this.isInsideGrid(s,l,u,c)||!e&&this.grid.hitTest(s,l,u,c,n)?{box:[],offscreen:!1}:{box:[s,l,u,c],offscreen:this.isOffscreen(s,l,u,c)}},zr.prototype.approximateTileDistance=function(t,e,r,i,n){var o=n?1:i/this.pitchfactor,a=t.lastSegmentViewportDistance*r;return t.prevTileDistance+a+(o-1)*a*Math.abs(Math.sin(e))},zr.prototype.placeCollisionCircles=function(t,e,r,i,n,o,a,s,l,u,c,p,h){var d=[],f=this.projectAnchor(l,n.anchorX,n.anchorY),m=s/24,g=n.lineOffsetX*s,y=n.lineOffsetY*s,v=new mt.Point(n.anchorX,n.anchorY),_=kr(m,a,g,y,!1,Ir(v,u).point,v,n,o,u,{},!0),x=!1,b=!1,w=!0,S=f.perspectiveRatio*i,T=1/(i*r),E=0,I=0;_&&(E=this.approximateTileDistance(_.first.tileDistance,_.first.angle,T,f.cameraDistance,p),I=this.approximateTileDistance(_.last.tileDistance,_.last.angle,T,f.cameraDistance,p));for(var C=0;C<t.length;C+=5){var k=t[C],A=t[C+1],P=t[C+2],M=t[C+3];if(!_||M<-E||I<M)Nr(t,C,!1);else{var L=this.projectPoint(l,k,A),O=P*S;if(0<d.length){var D=L.x-d[d.length-4],R=L.y-d[d.length-3];if(D*D+R*R<O*O*2&&C+8<t.length){var z=t[C+8];if(-E<z&&z<I){Nr(t,C,!1);continue}}}var N=C/5;d.push(L.x,L.y,O,N),Nr(t,C,!0);var B=L.x-O,F=L.y-O,U=L.x+O,j=L.y+O;if(w=w&&this.isOffscreen(B,F,U,j),b=b||this.isInsideGrid(B,F,U,j),!e&&this.grid.hitTestCircle(L.x,L.y,O,h)){if(!c)return{circles:[],offscreen:!1};x=!0}}}return{circles:x||!b?[]:d,offscreen:w}},zr.prototype.queryRenderedSymbols=function(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var e=[],r=1/0,i=1/0,n=-1/0,o=-1/0,a=0,s=t;a<s.length;a+=1){var l=s[a],u=new mt.Point(l.x+100,l.y+100);r=Math.min(r,u.x),i=Math.min(i,u.y),n=Math.max(n,u.x),o=Math.max(o,u.y),e.push(u)}for(var c={},p={},h=0,d=this.grid.query(r,i,n,o).concat(this.ignoredGrid.query(r,i,n,o));h<d.length;h+=1){var f=d[h],m=f.key;if(void 0===c[m.bucketInstanceId]&&(c[m.bucketInstanceId]={}),!c[m.bucketInstanceId][m.featureIndex]){var g=[new mt.Point(f.x1,f.y1),new mt.Point(f.x2,f.y1),new mt.Point(f.x2,f.y2),new mt.Point(f.x1,f.y2)];mt.polygonIntersectsPolygon(e,g)&&(c[m.bucketInstanceId][m.featureIndex]=!0,void 0===p[m.bucketInstanceId]&&(p[m.bucketInstanceId]=[]),p[m.bucketInstanceId].push(m.featureIndex))}}return p},zr.prototype.insertCollisionBox=function(t,e,r,i,n){var o={bucketInstanceId:r,featureIndex:i,collisionGroupID:n};(e?this.ignoredGrid:this.grid).insert(o,t[0],t[1],t[2],t[3])},zr.prototype.insertCollisionCircles=function(t,e,r,i,n){for(var o=e?this.ignoredGrid:this.grid,a={bucketInstanceId:r,featureIndex:i,collisionGroupID:n},s=0;s<t.length;s+=4)o.insertCircle(a,t[s],t[s+1],t[s+2])},zr.prototype.projectAnchor=function(t,e,r){var i=[e,r,0,1];return Rr(i,i,t),{perspectiveRatio:.5+this.transform.cameraToCenterDistance/i[3]*.5,cameraDistance:i[3]}},zr.prototype.projectPoint=function(t,e,r){var i=[e,r,0,1];return Rr(i,i,t),new mt.Point((i[0]/i[3]+1)/2*this.transform.width+100,(-i[1]/i[3]+1)/2*this.transform.height+100)},zr.prototype.projectAndGetPerspectiveRatio=function(t,e,r){var i=[e,r,0,1];return Rr(i,i,t),{point:new mt.Point((i[0]/i[3]+1)/2*this.transform.width+100,(-i[1]/i[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/i[3]*.5}},zr.prototype.isOffscreen=function(t,e,r,i){return r<100||t>=this.screenRightBoundary||i<100||e>this.screenBottomBoundary},zr.prototype.isInsideGrid=function(t,e,r,i){return 0<=r&&t<this.gridRightBoundary&&0<=i&&e<this.gridBottomBoundary},Fr.prototype.isHidden=function(){return 0===this.opacity&&!this.placed},Ur.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()},Vr.prototype.get=function(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){var e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:function(t){return t.collisionGroupID===e}}}return this.collisionGroups[t]},Hr.prototype.placeLayerTile=function(t,e,r,i){var n=e.getBucket(t),o=e.latestFeatureIndex;if(n&&o&&t.id===n.layerIds[0]){var a=e.collisionBoxArray,s=n.layers[0].layout,l=Math.pow(2,this.transform.zoom-e.tileID.overscaledZ),u=e.tileSize/mt.EXTENT,c=this.transform.calculatePosMatrix(e.tileID.toUnwrapped()),p=Tr(c,"map"===s.get("text-pitch-alignment"),"map"===s.get("text-rotation-alignment"),this.transform,Br(e,1,this.transform.zoom)),h=Tr(c,"map"===s.get("icon-pitch-alignment"),"map"===s.get("icon-rotation-alignment"),this.transform,Br(e,1,this.transform.zoom));this.retainedQueryData[n.bucketInstanceId]=new qr(n.bucketInstanceId,o,n.sourceLayerIndex,n.index,e.tileID),this.placeLayerBucket(n,c,p,h,l,u,r,e.holdingForFade(),i,a)}},Hr.prototype.attemptAnchorPlacement=function(t,e,r,i,n,o,a,s,l,u,c,p,h,d){var f,m=[p.textOffset0,p.textOffset1],g=Gr(t,r,i,m,n),y=this.collisionIndex.placeCollisionBox(Zr(e,g.x,g.y,o,a,this.transform.angle),c,s,l,u.predicate);if(0<y.box.length)return this.prevPlacement&&this.prevPlacement.variableOffsets[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID].text&&(f=this.prevPlacement.variableOffsets[p.crossTileID].anchor),this.variableOffsets[p.crossTileID]={textOffset:m,width:r,height:i,anchor:t,textBoxScale:n,prevAnchor:f},this.markUsedJustification(h,t,p,d),h.allowVerticalPlacement&&(this.markUsedOrientation(h,d,p),this.placedOrientations[p.crossTileID]=d),{shift:g,placedGlyphBoxes:y}},Hr.prototype.placeLayerBucket=function(A,P,M,t,L,O,D,R,z,e){var N=this,B=A.layers[0].layout,F=mt.evaluateSizeForZoom(A.textSizeData,this.transform.zoom),U=B.get("text-optional"),j=B.get("icon-optional"),q=B.get("text-allow-overlap"),r=B.get("icon-allow-overlap"),V=q&&(r||!A.hasIconData()||j),G=r&&(q||!A.hasTextData()||U),Z=this.collisionGroups.get(A.sourceID),H="map"===B.get("text-rotation-alignment"),W="map"===B.get("text-pitch-alignment"),K="none"!==B.get("icon-text-fit"),i="viewport-y"===B.get("symbol-z-order");function n(p,n){if(!z[p.crossTileID])if(R)N.placements[p.crossTileID]=new jr(!1,!1,!1);else{var t,h=!1,e=!1,r=!0,d=null,o={box:null,offscreen:null},a={box:null,offscreen:null},i=null,s=null,l=0,u=0,c=0;n.textFeatureIndex&&(l=n.textFeatureIndex),n.verticalTextFeatureIndex&&(u=n.verticalTextFeatureIndex);var f=n.textBox;if(f){var m=function(t){var e=mt.WritingMode.horizontal;if(A.allowVerticalPlacement&&!t&&N.prevPlacement){var r=N.prevPlacement.placedOrientations[p.crossTileID];r&&(e=N.placedOrientations[p.crossTileID]=r,N.markUsedOrientation(A,e,p))}return e},g=function(t,e){if(A.allowVerticalPlacement&&0<p.numVerticalGlyphVertices&&n.verticalTextBox)for(var r=0,i=A.writingModes;r<i.length&&(i[r]===mt.WritingMode.vertical?(o=e(),a=o):o=t(),!(o&&o.box&&o.box.length));r+=1);else o=t()};if(B.get("text-variable-anchor")){var y=B.get("text-variable-anchor");if(N.prevPlacement&&N.prevPlacement.variableOffsets[p.crossTileID]){var v=N.prevPlacement.variableOffsets[p.crossTileID];0<y.indexOf(v.anchor)&&(y=y.filter(function(t){return t!==v.anchor})).unshift(v.anchor)}var _=function(t,e){for(var r=t.x2-t.x1,i=t.y2-t.y1,n=p.textBoxScale,o={box:[],offscreen:!1},a=q?2*y.length:y.length,s=0;s<a;++s){var l=y[s%y.length],u=s>=y.length,c=N.attemptAnchorPlacement(l,t,r,i,n,H,W,O,P,Z,u,p,A,e);if(c&&(o=c.placedGlyphBoxes)&&o.box&&o.box.length){h=!0,d=c.shift;break}}return o};g(function(){return _(f,mt.WritingMode.horizontal)},function(){var t=n.verticalTextBox,e=o&&o.box&&o.box.length;return A.allowVerticalPlacement&&!e&&0<p.numVerticalGlyphVertices&&t?_(t,mt.WritingMode.vertical):{box:null,offscreen:null}}),o&&(h=o.box,r=o.offscreen);var x=m(o&&o.box);if(!h&&N.prevPlacement){var b=N.prevPlacement.variableOffsets[p.crossTileID];b&&(N.variableOffsets[p.crossTileID]=b,N.markUsedJustification(A,b.anchor,p,x))}}else{var w=function(t,e){var r=N.collisionIndex.placeCollisionBox(t,B.get("text-allow-overlap"),O,P,Z.predicate);return r&&r.box&&r.box.length&&(N.markUsedOrientation(A,e,p),N.placedOrientations[p.crossTileID]=e),r};g(function(){return w(f,mt.WritingMode.horizontal)},function(){var t=n.verticalTextBox;return A.allowVerticalPlacement&&0<p.numVerticalGlyphVertices&&t?w(t,mt.WritingMode.vertical):{box:null,offscreen:null}}),m(o&&o.box&&o.box.length)}}h=(t=o)&&t.box&&0<t.box.length,r=t&&t.offscreen;var S=n.textCircles;if(S){var T=A.text.placedSymbolArray.get(p.centerJustifiedTextSymbolIndex),E=mt.evaluateSizeForFeature(A.textSizeData,F,T);i=N.collisionIndex.placeCollisionCircles(S,B.get("text-allow-overlap"),L,O,T,A.lineVertexArray,A.glyphOffsetArray,E,P,M,D,W,Z.predicate),h=B.get("text-allow-overlap")||0<i.circles.length,r=r&&i.offscreen}if(n.iconFeatureIndex&&(c=n.iconFeatureIndex),n.iconBox){var I=K&&d?Zr(n.iconBox,d.x,d.y,H,W,N.transform.angle):n.iconBox;e=0<(s=N.collisionIndex.placeCollisionBox(I,B.get("icon-allow-overlap"),O,P,Z.predicate)).box.length,r=r&&s.offscreen}var C=U||0===p.numHorizontalGlyphVertices&&0===p.numVerticalGlyphVertices,k=j||0===p.numIconVertices;C||k?k?C||(e=e&&h):h=e&&h:e=h=e&&h,h&&t&&t.box&&(a&&a.box&&u?N.collisionIndex.insertCollisionBox(t.box,B.get("text-ignore-placement"),A.bucketInstanceId,u,Z.ID):N.collisionIndex.insertCollisionBox(t.box,B.get("text-ignore-placement"),A.bucketInstanceId,l,Z.ID)),e&&s&&N.collisionIndex.insertCollisionBox(s.box,B.get("icon-ignore-placement"),A.bucketInstanceId,c,Z.ID),h&&i&&N.collisionIndex.insertCollisionCircles(i.circles,B.get("text-ignore-placement"),A.bucketInstanceId,l,Z.ID),N.placements[p.crossTileID]=new jr(h||V,e||G,r||A.justReloaded),z[p.crossTileID]=!0}}if(!A.collisionArrays&&e&&A.deserializeCollisionBoxes(e),i)for(var o=A.getSortedSymbolIndexes(this.transform.angle),a=o.length-1;0<=a;--a){var s=o[a];n(A.symbolInstances.get(s),A.collisionArrays[s])}else for(var l=0;l<A.symbolInstances.length;++l)n(A.symbolInstances.get(l),A.collisionArrays[l]);A.justReloaded=!1},Hr.prototype.markUsedJustification=function(t,e,r,i){var n,o={left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex};n=i===mt.WritingMode.vertical?r.verticalPlacedTextSymbolIndex:o[mt.getAnchorJustification(e)];for(var a=0,s=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];a<s.length;a+=1){var l=s[a];0<=l&&(t.text.placedSymbolArray.get(l).crossTileID=0<=n&&l!==n?0:r.crossTileID)}},Hr.prototype.markUsedOrientation=function(t,e,r){for(var i=e===mt.WritingMode.horizontal||e===mt.WritingMode.horizontalOnly?e:0,n=e===mt.WritingMode.vertical?e:0,o=0,a=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];o<a.length;o+=1){var s=a[o];t.text.placedSymbolArray.get(s).placedOrientation=i}r.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=n)},Hr.prototype.commit=function(t){this.commitTime=t;var e=this.prevPlacement,r=!1,i=e&&0!==this.fadeDuration?(this.commitTime-e.commitTime)/this.fadeDuration:1,n=e?e.opacities:{},o=e?e.variableOffsets:{},a=e?e.placedOrientations:{};for(var s in this.placements){var l=this.placements[s],u=n[s];r=u?(this.opacities[s]=new Ur(u,i,l.text,l.icon),r||l.text!==u.text.placed||l.icon!==u.icon.placed):(this.opacities[s]=new Ur(null,i,l.text,l.icon,l.skipFade),r||l.text||l.icon)}for(var c in n){var p=n[c];if(!this.opacities[c]){var h=new Ur(p,i,!1,!1);h.isHidden()||(this.opacities[c]=h,r=r||p.text.placed||p.icon.placed)}}for(var d in o)this.variableOffsets[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.variableOffsets[d]=o[d]);for(var f in a)this.placedOrientations[f]||!this.opacities[f]||this.opacities[f].isHidden()||(this.placedOrientations[f]=a[f]);r?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)},Hr.prototype.updateLayerOpacities=function(t,e){for(var r={},i=0,n=e;i<n.length;i+=1){var o=n[i],a=o.getBucket(t);a&&o.latestFeatureIndex&&t.id===a.layerIds[0]&&this.updateBucketOpacities(a,r,o.collisionBoxArray)}},Hr.prototype.updateBucketOpacities=function(e,t,r){e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear(),e.hasIconCollisionCircleData()&&e.iconCollisionCircle.collisionVertexArray.clear(),e.hasTextCollisionCircleData()&&e.textCollisionCircle.collisionVertexArray.clear();var i=e.layers[0].layout,n=new Ur(null,0,!1,!1,!0),o=i.get("text-allow-overlap"),a=i.get("icon-allow-overlap"),s=i.get("text-variable-anchor"),l="map"===i.get("text-rotation-alignment"),u="map"===i.get("text-pitch-alignment"),c="none"!==i.get("icon-text-fit"),p=new Ur(null,0,o&&(a||!e.hasIconData()||i.get("icon-optional")),a&&(o||!e.hasTextData()||i.get("text-optional")),!0);!e.collisionArrays&&r&&(e.hasIconCollisionBoxData()||e.hasIconCollisionCircleData()||e.hasTextCollisionBoxData()||e.hasTextCollisionCircleData())&&e.deserializeCollisionBoxes(r);for(var h=0;h<e.symbolInstances.length;h++){var d=e.symbolInstances.get(h),f=d.numHorizontalGlyphVertices,m=d.numVerticalGlyphVertices,g=d.crossTileID,y=t[g],v=this.opacities[g];y?v=n:v||(v=p,this.opacities[g]=v),t[g]=!0;var _=0<f||0<m,x=0<d.numIconVertices;if(_){for(var b=ei(v.text),w=(f+m)/4,S=0;S<w;S++)e.text.opacityVertexArray.emplaceBack(b);var T=v.text.isHidden()?1:0,E=this.placedOrientations[d.crossTileID],I=E===mt.WritingMode.horizontal||E===mt.WritingMode.horizontalOnly?1:0,C=E===mt.WritingMode.vertical?1:0;[d.rightJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.leftJustifiedTextSymbolIndex].forEach(function(t){0<=t&&(e.text.placedSymbolArray.get(t).hidden=T||C)}),0<=d.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).hidden=T||I);var k=this.variableOffsets[d.crossTileID];k&&this.markUsedJustification(e,k.anchor,d,E);var A=this.placedOrientations[d.crossTileID];A&&(this.markUsedJustification(e,"left",d,A),this.markUsedOrientation(e,A,d))}if(x){for(var P=ei(v.icon),M=0;M<d.numIconVertices/4;M++)e.icon.opacityVertexArray.emplaceBack(P);e.icon.placedSymbolArray.get(h).hidden=v.icon.isHidden()}if(e.hasIconCollisionBoxData()||e.hasIconCollisionCircleData()||e.hasTextCollisionBoxData()||e.hasTextCollisionCircleData()){var L=e.collisionArrays[h];if(L){var O=new mt.Point(0,0);if(L.textBox){var D=!0;if(s){var R=this.variableOffsets[g];R?(O=Gr(R.anchor,R.width,R.height,R.textOffset,R.textBoxScale),l&&O._rotate(u?this.transform.angle:-this.transform.angle)):D=!1}Wr(e.textCollisionBox.collisionVertexArray,v.text.placed,!D,O.x,O.y)}L.iconBox&&Wr(e.iconCollisionBox.collisionVertexArray,v.icon.placed,!1,c?O.x:0,c?O.y:0);var z=L.textCircles;if(z&&e.hasTextCollisionCircleData())for(var N=0;N<z.length;N+=5){var B=y||0===z[N+4];Wr(e.textCollisionCircle.collisionVertexArray,v.text.placed,B)}}}}e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.hasIconCollisionCircleData()&&e.iconCollisionCircle.collisionVertexBuffer&&e.iconCollisionCircle.collisionVertexBuffer.updateData(e.iconCollisionCircle.collisionVertexArray),e.hasTextCollisionCircleData()&&e.textCollisionCircle.collisionVertexBuffer&&e.textCollisionCircle.collisionVertexBuffer.updateData(e.textCollisionCircle.collisionVertexArray)},Hr.prototype.symbolFadeChange=function(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration},Hr.prototype.hasTransitions=function(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration},Hr.prototype.stillRecent=function(t){return this.commitTime+this.fadeDuration>t},Hr.prototype.setStale=function(){this.stale=!0};var Kr=Math.pow(2,25),Xr=Math.pow(2,24),Yr=Math.pow(2,17),Jr=Math.pow(2,16),Qr=Math.pow(2,9),$r=Math.pow(2,8),ti=Math.pow(2,1);function ei(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;var e=t.placed?1:0,r=Math.floor(127*t.opacity);return r*Kr+e*Xr+r*Yr+e*Jr+r*Qr+e*$r+r*ti+e}function ri(){this._currentTileIndex=0,this._seenCrossTileIDs={}}function ii(t,e,r,i,n,o,a){this.placement=new Hr(t,n,o,a),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=r,this._showCollisionBoxes=i,this._done=!1}function ni(t,e,r){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=r;for(var i=0;i<e.length;i++){var n=e.get(i),o=n.key;this.indexedSymbolInstances[o]||(this.indexedSymbolInstances[o]=[]),this.indexedSymbolInstances[o].push({crossTileID:n.crossTileID,coord:this.getScaledCoordinates(n,t)})}}ri.prototype.continuePlacement=function(t,e,r,i,n){for(;this._currentTileIndex<t.length;){var o=t[this._currentTileIndex];if(e.placeLayerTile(i,o,r,this._seenCrossTileIDs),this._currentTileIndex++,n())return!0}},ii.prototype.isDone=function(){return this._done},ii.prototype.continuePlacement=function(t,e,r){for(var i=this,n=mt.browser.now(),o=function(){var t=mt.browser.now()-n;return!i._forceFullPlacement&&2<t};0<=this._currentPlacementIndex;){var a=e[t[this._currentPlacementIndex]],s=this.placement.collisionIndex.transform.zoom;if("symbol"===a.type&&(!a.minzoom||a.minzoom<=s)&&(!a.maxzoom||a.maxzoom>s)){if(this._inProgressLayer||(this._inProgressLayer=new ri),this._inProgressLayer.continuePlacement(r[a.source],this.placement,this._showCollisionBoxes,a,o))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},ii.prototype.commit=function(t){return this.placement.commit(t),this.placement};var oi=512/mt.EXTENT/2;function ai(){this.maxCrossTileID=0}function si(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}function li(){this.layerIndexes={},this.crossTileIDs=new ai,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}function ui(t,e){return mt.emitValidationErrors(t,e&&e.filter(function(t){return"source.canvas"!==t.identifier}))}ni.prototype.getScaledCoordinates=function(t,e){var r=e.canonical.z-this.tileID.canonical.z,i=oi/Math.pow(2,r);return{x:Math.floor((e.canonical.x*mt.EXTENT+t.anchorX)*i),y:Math.floor((e.canonical.y*mt.EXTENT+t.anchorY)*i)}},ni.prototype.findMatches=function(t,e,r){for(var i=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z),n=0;n<t.length;n++){var o=t.get(n);if(!o.crossTileID){var a=this.indexedSymbolInstances[o.key];if(a)for(var s=this.getScaledCoordinates(o,e),l=0,u=a;l<u.length;l+=1){var c=u[l];if(Math.abs(c.coord.x-s.x)<=i&&Math.abs(c.coord.y-s.y)<=i&&!r[c.crossTileID]){r[c.crossTileID]=!0,o.crossTileID=c.crossTileID;break}}}}},ai.prototype.generate=function(){return++this.maxCrossTileID},si.prototype.handleWrapJump=function(t){var e=Math.round((t-this.lng)/360);if(0!==e)for(var r in this.indexes){var i=this.indexes[r],n={};for(var o in i){var a=i[o];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+e),n[a.tileID.key]=a}this.indexes[r]=n}this.lng=t},si.prototype.addBucket=function(t,e,r){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(var i=0;i<e.symbolInstances.length;i++)e.symbolInstances.get(i).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});var n=this.usedCrossTileIDs[t.overscaledZ];for(var o in this.indexes){var a=this.indexes[o];if(Number(o)>t.overscaledZ)for(var s in a){var l=a[s];l.tileID.isChildOf(t)&&l.findMatches(e.symbolInstances,t,n)}else{var u=a[t.scaledTo(Number(o)).key];u&&u.findMatches(e.symbolInstances,t,n)}}for(var c=0;c<e.symbolInstances.length;c++){var p=e.symbolInstances.get(c);p.crossTileID||(p.crossTileID=r.generate(),n[p.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new ni(t,e.symbolInstances,e.bucketInstanceId),!0},si.prototype.removeBucketCrossTileIDs=function(t,e){for(var r in e.indexedSymbolInstances)for(var i=0,n=e.indexedSymbolInstances[r];i<n.length;i+=1){var o=n[i];delete this.usedCrossTileIDs[t][o.crossTileID]}},si.prototype.removeStaleBuckets=function(t){var e=!1;for(var r in this.indexes){var i=this.indexes[r];for(var n in i)t[i[n].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,i[n]),delete i[n],e=!0)}return e},li.prototype.addLayer=function(t,e,r){var i=this.layerIndexes[t.id];void 0===i&&(i=this.layerIndexes[t.id]=new si);var n=!1,o={};i.handleWrapJump(r);for(var a=0,s=e;a<s.length;a+=1){var l=s[a],u=l.getBucket(t);u&&t.id===u.layerIds[0]&&(u.bucketInstanceId||(u.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(l.tileID,u,this.crossTileIDs)&&(n=!0),o[u.bucketInstanceId]=!0)}return i.removeStaleBuckets(o)&&(n=!0),n},li.prototype.pruneUnusedLayers=function(t){var e={};for(var r in t.forEach(function(t){e[t]=!0}),this.layerIndexes)e[r]||delete this.layerIndexes[r]};var ci,pi=mt.pick(gr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),hi=mt.pick(gr,["setCenter","setZoom","setBearing","setPitch"]),di=((ci=mt.Evented)&&(fi.__proto__=ci),((fi.prototype=Object.create(ci&&ci.prototype)).constructor=fi).prototype.loadURL=function(t,e){var r=this;void 0===e&&(e={}),this.fire(new mt.Event("dataloading",{dataType:"style"}));var i="boolean"==typeof e.validate?e.validate:!mt.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,e.accessToken);var n=this.map._requestManager.transformRequest(t,mt.ResourceType.Style);this._request=mt.getJSON(n,function(t,e){r._request=null,t?r.fire(new mt.ErrorEvent(t)):e&&r._load(e,i)})},fi.prototype.loadJSON=function(t,e){var r=this;void 0===e&&(e={}),this.fire(new mt.Event("dataloading",{dataType:"style"})),this._request=mt.browser.frame(function(){r._request=null,r._load(t,!1!==e.validate)})},fi.prototype._load=function(t,e){var r,i,p,h,d,f,n,o,a,s=this;if(!e||!ui(this,mt.validateStyle(t))){for(var l in this._loaded=!0,(this.stylesheet=t).sources)this.addSource(l,t.sources[l],{validate:!1});t.sprite?this._spriteRequest=(r=t.sprite,i=this.map._requestManager,p=function(t,e){if(s._spriteRequest=null,t)s.fire(new mt.ErrorEvent(t));else if(e)for(var r in e)s.imageManager.addImage(r,e[r]);s.imageManager.setLoaded(!0),s.dispatcher.broadcast("setImages",s.imageManager.listImages()),s.fire(new mt.Event("data",{dataType:"style"}))},n=1<mt.browser.devicePixelRatio?"@2x":"",o=mt.getJSON(i.transformRequest(i.normalizeSpriteURL(r,n,".json"),mt.ResourceType.SpriteJSON),function(t,e){o=null,f||(f=t,h=e,y())}),a=mt.getImage(i.transformRequest(i.normalizeSpriteURL(r,n,".png"),mt.ResourceType.SpriteImage),function(t,e){a=null,f||(f=t,d=e,y())}),{cancel:function(){o&&(o.cancel(),o=null),a&&(a.cancel(),a=null)}}):this.imageManager.setLoaded(!0),this.glyphManager.setURL(t.glyphs);var u=mr(this.stylesheet.layers);this._order=u.map(function(t){return t.id}),this._layers={};for(var c=0,m=u;c<m.length;c+=1){var g=m[c];(g=mt.createStyleLayer(g)).setEventedParent(this,{layer:{id:g.id}}),this._layers[g.id]=g}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new T(this.stylesheet.light),this.fire(new mt.Event("data",{dataType:"style"})),this.fire(new mt.Event("style.load"))}function y(){if(f)p(f);else if(h&&d){var t=mt.browser.getImageData(d),e={};for(var r in h){var i=h[r],n=i.width,o=i.height,a=i.x,s=i.y,l=i.sdf,u=i.pixelRatio,c=new mt.RGBAImage({width:n,height:o});mt.RGBAImage.copy(t,c,{x:a,y:s},{x:0,y:0},{width:n,height:o}),e[r]={data:c,pixelRatio:u,sdf:l}}p(null,e)}}},fi.prototype._validateLayer=function(t){var e=this.sourceCaches[t.source];if(e){var r=t.sourceLayer;if(r){var i=e.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(r))&&this.fire(new mt.ErrorEvent(new Error('Source layer "'+r+'" does not exist on source "'+i.id+'" as specified by style layer "'+t.id+'"')))}}},fi.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()},fi.prototype._serializeLayers=function(t){for(var e=[],r=0,i=t;r<i.length;r+=1){var n=i[r],o=this._layers[n];"custom"!==o.type&&e.push(o.serialize())}return e},fi.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(var e in this._layers)if(this._layers[e].hasTransition())return!0;return!1},fi.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},fi.prototype.update=function(t){if(this._loaded){var e=this._changed;if(this._changed){var r=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);for(var n in(r.length||i.length)&&this._updateWorkerLayers(r,i),this._updatedSources){var o=this._updatedSources[n];"reload"===o?this._reloadSource(n):"clear"===o&&this._clearSource(n)}for(var a in this._updatedPaintProps)this._layers[a].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}for(var s in this.sourceCaches)this.sourceCaches[s].used=!1;for(var l=0,u=this._order;l<u.length;l+=1){var c=u[l],p=this._layers[c];p.recalculate(t,this.imageManager.listImages()),!p.isHidden(t.zoom)&&p.source&&(this.sourceCaches[p.source].used=!0)}this.light.recalculate(t),this.z=t.zoom,e&&this.fire(new mt.Event("data",{dataType:"style"}))}},fi.prototype._updateWorkerLayers=function(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})},fi.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={}},fi.prototype.setState=function(t){var e=this;if(this._checkLoaded(),ui(this,mt.validateStyle(t)))return!1;(t=mt.clone$1(t)).layers=mr(t.layers);var r=function(t,e){if(!t)return[{command:gr.setStyle,args:[e]}];var r=[];try{if(!mt.deepEqual(t.version,e.version))return[{command:gr.setStyle,args:[e]}];mt.deepEqual(t.center,e.center)||r.push({command:gr.setCenter,args:[e.center]}),mt.deepEqual(t.zoom,e.zoom)||r.push({command:gr.setZoom,args:[e.zoom]}),mt.deepEqual(t.bearing,e.bearing)||r.push({command:gr.setBearing,args:[e.bearing]}),mt.deepEqual(t.pitch,e.pitch)||r.push({command:gr.setPitch,args:[e.pitch]}),mt.deepEqual(t.sprite,e.sprite)||r.push({command:gr.setSprite,args:[e.sprite]}),mt.deepEqual(t.glyphs,e.glyphs)||r.push({command:gr.setGlyphs,args:[e.glyphs]}),mt.deepEqual(t.transition,e.transition)||r.push({command:gr.setTransition,args:[e.transition]}),mt.deepEqual(t.light,e.light)||r.push({command:gr.setLight,args:[e.light]});var i={},n=[];!function(t,e,r,i){var n,o,a,s;for(n in e=e||{},t=t||{})t.hasOwnProperty(n)&&(e.hasOwnProperty(n)||vr(n,r,i));for(n in e)e.hasOwnProperty(n)&&(t.hasOwnProperty(n)?mt.deepEqual(t[n],e[n])||("geojson"===t[n].type&&"geojson"===e[n].type&&_r(t,e,n)?r.push({command:gr.setGeoJSONSourceData,args:[n,e[n].data]}):(a=e,vr(o=n,s=r,i),yr(o,a,s))):yr(n,e,r))}(t.sources,e.sources,n,i);var o=[];t.layers&&t.layers.forEach(function(t){i[t.source]?r.push({command:gr.removeLayer,args:[t.id]}):o.push(t)}),r=r.concat(n),function(t,e,r){e=e||[];var i,n,o,a,s,l,u,c=(t=t||[]).map(br),p=e.map(br),h=t.reduce(wr,{}),d=e.reduce(wr,{}),f=c.slice(),m=Object.create(null);for(n=i=0;i<c.length;i++)o=c[i],d.hasOwnProperty(o)?n++:(r.push({command:gr.removeLayer,args:[o]}),f.splice(f.indexOf(o,n),1));for(n=i=0;i<p.length;i++)o=p[p.length-1-i],f[f.length-1-i]!==o&&(h.hasOwnProperty(o)?(r.push({command:gr.removeLayer,args:[o]}),f.splice(f.lastIndexOf(o,f.length-n),1)):n++,l=f[f.length-i],r.push({command:gr.addLayer,args:[d[o],l]}),f.splice(f.length-i,0,o),m[o]=!0);for(i=0;i<p.length;i++)if(a=h[o=p[i]],s=d[o],!m[o]&&!mt.deepEqual(a,s))if(mt.deepEqual(a.source,s.source)&&mt.deepEqual(a["source-layer"],s["source-layer"])&&mt.deepEqual(a.type,s.type)){for(u in xr(a.layout,s.layout,r,o,null,gr.setLayoutProperty),xr(a.paint,s.paint,r,o,null,gr.setPaintProperty),mt.deepEqual(a.filter,s.filter)||r.push({command:gr.setFilter,args:[o,s.filter]}),mt.deepEqual(a.minzoom,s.minzoom)&&mt.deepEqual(a.maxzoom,s.maxzoom)||r.push({command:gr.setLayerZoomRange,args:[o,s.minzoom,s.maxzoom]}),a)a.hasOwnProperty(u)&&"layout"!==u&&"paint"!==u&&"filter"!==u&&"metadata"!==u&&"minzoom"!==u&&"maxzoom"!==u&&(0===u.indexOf("paint.")?xr(a[u],s[u],r,o,u.slice(6),gr.setPaintProperty):mt.deepEqual(a[u],s[u])||r.push({command:gr.setLayerProperty,args:[o,u,s[u]]}));for(u in s)s.hasOwnProperty(u)&&!a.hasOwnProperty(u)&&"layout"!==u&&"paint"!==u&&"filter"!==u&&"metadata"!==u&&"minzoom"!==u&&"maxzoom"!==u&&(0===u.indexOf("paint.")?xr(a[u],s[u],r,o,u.slice(6),gr.setPaintProperty):mt.deepEqual(a[u],s[u])||r.push({command:gr.setLayerProperty,args:[o,u,s[u]]}))}else r.push({command:gr.removeLayer,args:[o]}),l=f[f.lastIndexOf(o)+1],r.push({command:gr.addLayer,args:[s,l]})}(o,e.layers,r)}catch(t){console.warn("Unable to compute style diff:",t),r=[{command:gr.setStyle,args:[e]}]}return r}(this.serialize(),t).filter(function(t){return!(t.command in hi)});if(0===r.length)return!1;var i=r.filter(function(t){return!(t.command in pi)});if(0<i.length)throw new Error("Unimplemented: "+i.map(function(t){return t.command}).join(", ")+".");return r.forEach(function(t){"setTransition"!==t.command&&e[t.command].apply(e,t.args)}),this.stylesheet=t,!0},fi.prototype.addImage=function(t,e){if(this.getImage(t))return this.fire(new mt.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(t,e),this.fire(new mt.Event("data",{dataType:"style"}))},fi.prototype.updateImage=function(t,e){this.imageManager.updateImage(t,e)},fi.prototype.getImage=function(t){return this.imageManager.getImage(t)},fi.prototype.removeImage=function(t){if(!this.getImage(t))return this.fire(new mt.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(t),this.fire(new mt.Event("data",{dataType:"style"}))},fi.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},fi.prototype.addSource=function(t,e,r){var i=this;if(void 0===r&&(r={}),this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error("There is already a source with this ID");if(!e.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(e).join(", ")+".");if(!(0<=["vector","raster","geojson","video","image"].indexOf(e.type)&&this._validate(mt.validateStyle.source,"sources."+t,e,null,r))){this.map&&this.map._collectResourceTiming&&(e.collectResourceTiming=!0);var n=this.sourceCaches[t]=new ar(t,e,this.dispatcher);n.style=this,n.setEventedParent(this,function(){return{isSourceLoaded:i.loaded(),source:n.serialize(),sourceId:t}}),n.onAdd(this.map),this._changed=!0}},fi.prototype.removeSource=function(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");for(var e in this._layers)if(this._layers[e].source===t)return this.fire(new mt.ErrorEvent(new Error('Source "'+t+'" cannot be removed while layer "'+e+'" is using it.')));var r=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],r.fire(new mt.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),r.setEventedParent(null),r.clearTiles(),r.onRemove&&r.onRemove(this.map),this._changed=!0},fi.prototype.setGeoJSONSourceData=function(t,e){this._checkLoaded(),this.sourceCaches[t].getSource().setData(e),this._changed=!0},fi.prototype.getSource=function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()},fi.prototype.addLayer=function(t,e,r){void 0===r&&(r={}),this._checkLoaded();var i=t.id;if(this.getLayer(i))this.fire(new mt.ErrorEvent(new Error('Layer with id "'+i+'" already exists on this map')));else{var n;if("custom"===t.type){if(ui(this,mt.validateCustomStyleLayer(t)))return;n=mt.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(i,t.source),t=mt.clone$1(t),t=mt.extend(t,{source:i})),this._validate(mt.validateStyle.layer,"layers."+i,t,{arrayIndex:-1},r))return;n=mt.createStyleLayer(t),this._validateLayer(n),n.setEventedParent(this,{layer:{id:i}})}var o=e?this._order.indexOf(e):this._order.length;if(e&&-1===o)this.fire(new mt.ErrorEvent(new Error('Layer with id "'+e+'" does not exist on this map.')));else{if(this._order.splice(o,0,i),this._layerOrderChanged=!0,this._layers[i]=n,this._removedLayers[i]&&n.source&&"custom"!==n.type){var a=this._removedLayers[i];delete this._removedLayers[i],a.type!==n.type?this._updatedSources[n.source]="clear":(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause())}this._updateLayer(n),n.onAdd&&n.onAdd(this.map)}}},fi.prototype.moveLayer=function(t,e){if(this._checkLoaded(),this._changed=!0,this._layers[t]){if(t!==e){var r=this._order.indexOf(t);this._order.splice(r,1);var i=e?this._order.indexOf(e):this._order.length;e&&-1===i?this.fire(new mt.ErrorEvent(new Error('Layer with id "'+e+'" does not exist on this map.'))):(this._order.splice(i,0,t),this._layerOrderChanged=!0)}}else this.fire(new mt.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be moved.")))},fi.prototype.removeLayer=function(t){this._checkLoaded();var e=this._layers[t];if(e){e.setEventedParent(null);var r=this._order.indexOf(t);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=e,delete this._layers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],e.onRemove&&e.onRemove(this.map)}else this.fire(new mt.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be removed.")))},fi.prototype.getLayer=function(t){return this._layers[t]},fi.prototype.setLayerZoomRange=function(t,e,r){this._checkLoaded();var i=this.getLayer(t);i?i.minzoom===e&&i.maxzoom===r||(null!=e&&(i.minzoom=e),null!=r&&(i.maxzoom=r),this._updateLayer(i)):this.fire(new mt.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot have zoom extent.")))},fi.prototype.setFilter=function(t,e,r){void 0===r&&(r={}),this._checkLoaded();var i=this.getLayer(t);if(i){if(!mt.deepEqual(i.filter,e))return null==e?(i.filter=void 0,void this._updateLayer(i)):void(this._validate(mt.validateStyle.filter,"layers."+i.id+".filter",e,null,r)||(i.filter=mt.clone$1(e),this._updateLayer(i)))}else this.fire(new mt.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be filtered.")))},fi.prototype.getFilter=function(t){return mt.clone$1(this.getLayer(t).filter)},fi.prototype.setLayoutProperty=function(t,e,r,i){void 0===i&&(i={}),this._checkLoaded();var n=this.getLayer(t);n?mt.deepEqual(n.getLayoutProperty(e),r)||(n.setLayoutProperty(e,r,i),this._updateLayer(n)):this.fire(new mt.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},fi.prototype.getLayoutProperty=function(t,e){var r=this.getLayer(t);if(r)return r.getLayoutProperty(e);this.fire(new mt.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style.")))},fi.prototype.setPaintProperty=function(t,e,r,i){void 0===i&&(i={}),this._checkLoaded();var n=this.getLayer(t);n?mt.deepEqual(n.getPaintProperty(e),r)||(n.setPaintProperty(e,r,i)&&this._updateLayer(n),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new mt.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},fi.prototype.getPaintProperty=function(t,e){return this.getLayer(t).getPaintProperty(e)},fi.prototype.setFeatureState=function(t,e){this._checkLoaded();var r=t.source,i=t.sourceLayer,n=this.sourceCaches[r],o=parseInt(t.id,10);if(void 0!==n){var a=n.getSource().type;"geojson"===a&&i?this.fire(new mt.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==a||i?isNaN(o)||o<0?this.fire(new mt.ErrorEvent(new Error("The feature id parameter must be provided and non-negative."))):n.setFeatureState(i,o,e):this.fire(new mt.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new mt.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},fi.prototype.removeFeatureState=function(t,e){this._checkLoaded();var r=t.source,i=this.sourceCaches[r];if(void 0!==i){var n=i.getSource().type,o="vector"===n?t.sourceLayer:void 0,a=parseInt(t.id,10);"vector"!==n||o?void 0!==t.id&&isNaN(a)||a<0?this.fire(new mt.ErrorEvent(new Error("The feature id parameter must be non-negative."))):e&&"string"!=typeof t.id&&"number"!=typeof t.id?this.fire(new mt.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):i.removeFeatureState(o,a,e):this.fire(new mt.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new mt.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},fi.prototype.getFeatureState=function(t){this._checkLoaded();var e=t.source,r=t.sourceLayer,i=this.sourceCaches[e],n=parseInt(t.id,10);if(void 0!==i)if("vector"!==i.getSource().type||r){if(!(isNaN(n)||n<0))return i.getFeatureState(r,n);this.fire(new mt.ErrorEvent(new Error("The feature id parameter must be provided and non-negative.")))}else this.fire(new mt.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));else this.fire(new mt.ErrorEvent(new Error("The source '"+e+"' does not exist in the map's style.")))},fi.prototype.getTransition=function(){return mt.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},fi.prototype.serialize=function(){return mt.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:mt.mapObject(this.sourceCaches,function(t){return t.serialize()}),layers:this._serializeLayers(this._order)},function(t){return void 0!==t})},fi.prototype._updateLayer=function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0},fi.prototype._flattenAndSortRenderedFeatures=function(t){for(var e=this,r=function(t){return"fill-extrusion"===e._layers[t].type},i={},n=[],o=this._order.length-1;0<=o;o--){var a=this._order[o];if(r(a)){i[a]=o;for(var s=0,l=t;s<l.length;s+=1){var u=l[s][a];if(u)for(var c=0,p=u;c<p.length;c+=1){var h=p[c];n.push(h)}}}}n.sort(function(t,e){return e.intersectionZ-t.intersectionZ});for(var d=[],f=this._order.length-1;0<=f;f--){var m=this._order[f];if(r(m))for(var g=n.length-1;0<=g;g--){var y=n[g].feature;if(i[y.layer.id]<f)break;d.push(y),n.pop()}else for(var v=0,_=t;v<_.length;v+=1){var x=_[v][m];if(x)for(var b=0,w=x;b<w.length;b+=1){var S=w[b];d.push(S.feature)}}}return d},fi.prototype.queryRenderedFeatures=function(t,e,r){e&&e.filter&&this._validate(mt.validateStyle.filter,"queryRenderedFeatures.filter",e.filter,null,e);var i={};if(e&&e.layers){if(!Array.isArray(e.layers))return this.fire(new mt.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var n=0,o=e.layers;n<o.length;n+=1){var a=o[n],s=this._layers[a];if(!s)return this.fire(new mt.ErrorEvent(new Error("The layer '"+a+"' does not exist in the map's style and cannot be queried for features."))),[];i[s.source]=!0}}var l=[];for(var u in this.sourceCaches)e.layers&&!i[u]||l.push(J(this.sourceCaches[u],this._layers,t,e,r));return this.placement&&l.push(function(l,o,t,u,e,r){for(var c={},p=e.queryRenderedSymbols(t),i=[],n=0,a=Object.keys(p).map(Number);n<a.length;n+=1){var s=a[n];i.push(r[s])}i.sort(Q);for(var h=function(){var n=f[d],t=n.featureIndex.lookupSymbolFeatures(p[n.bucketInstanceId],n.bucketIndex,n.sourceLayerIndex,u.filter,u.layers,l);for(var e in t){var r=c[e]=c[e]||[],i=t[e];i.sort(function(t,e){var r=n.featureSortOrder;if(r){var i=r.indexOf(t.featureIndex);return r.indexOf(e.featureIndex)-i}return e.featureIndex-t.featureIndex});for(var o=0,a=i;o<a.length;o+=1){var s=a[o];r.push(s)}}},d=0,f=i;d<f.length;d+=1)h();function m(n){c[n].forEach(function(t){var e=t.feature,r=l[n],i=o[r.source].getFeatureState(e.layer["source-layer"],e.id);e.source=e.layer.source,e.layer["source-layer"]&&(e.sourceLayer=e.layer["source-layer"]),e.state=i})}for(var g in c)m(g);return c}(this._layers,this.sourceCaches,t,e,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(l)},fi.prototype.querySourceFeatures=function(t,e){e&&e.filter&&this._validate(mt.validateStyle.filter,"querySourceFeatures.filter",e.filter,null,e);var r=this.sourceCaches[t];return r?function(e,t){for(var r=e.getRenderableIds().map(function(t){return e.getTileByID(t)}),i=[],n={},o=0;o<r.length;o++){var a=r[o],s=a.tileID.canonical.key;n[s]||(n[s]=!0,a.querySourceFeatures(i,t))}return i}(r,e):[]},fi.prototype.addSourceType=function(t,e,r){return fi.getSourceType(t)?r(new Error('A source type called "'+t+'" already exists.')):(fi.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},r):r(null,null))},fi.prototype.getLight=function(){return this.light.getLight()},fi.prototype.setLight=function(t,e){void 0===e&&(e={}),this._checkLoaded();var r=this.light.getLight(),i=!1;for(var n in t)if(!mt.deepEqual(t[n],r[n])){i=!0;break}if(i){var o={now:mt.browser.now(),transition:mt.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,e),this.light.updateTransitions(o)}},fi.prototype._validate=function(t,e,r,i,n){return void 0===n&&(n={}),(!n||!1!==n.validate)&&ui(this,t.call(mt.validateStyle,mt.extend({key:e,style:this.serialize(),value:r,styleSpec:mt.styleSpec},i)))},fi.prototype._remove=function(){for(var t in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),mt.evented.off("pluginAvailable",this._rtlTextPluginCallback),this.sourceCaches)this.sourceCaches[t].clearTiles();this.dispatcher.remove()},fi.prototype._clearSource=function(t){this.sourceCaches[t].clearTiles()},fi.prototype._reloadSource=function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()},fi.prototype._updateSources=function(t){for(var e in this.sourceCaches)this.sourceCaches[e].update(t)},fi.prototype._generateCollisionBoxes=function(){for(var t in this.sourceCaches)this._reloadSource(t)},fi.prototype._updatePlacement=function(t,e,r,i){for(var n=!1,o=!1,a={},s=0,l=this._order;s<l.length;s+=1){var u=l[s],c=this._layers[u];if("symbol"===c.type){if(!a[c.source]){var p=this.sourceCaches[c.source];a[c.source]=p.getRenderableIds(!0).map(function(t){return p.getTileByID(t)}).sort(function(t,e){return e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)})}var h=this.crossTileSymbolIndex.addLayer(c,a[c.source],t.center.lng);n=n||h}}this.crossTileSymbolIndex.pruneUnusedLayers(this._order);var d=this._layerOrderChanged||0===r;if((d||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(mt.browser.now()))&&(this.pauseablePlacement=new ii(t,this._order,d,e,r,i,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,a),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(mt.browser.now()),o=!0),n&&this.pauseablePlacement.placement.setStale()),o||n)for(var f=0,m=this._order;f<m.length;f+=1){var g=m[f],y=this._layers[g];"symbol"===y.type&&this.placement.updateLayerOpacities(y,a[y.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(mt.browser.now())},fi.prototype._releaseSymbolFadeTiles=function(){for(var t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()},fi.prototype.getImages=function(t,e,r){this.imageManager.getImages(e.icons,r)},fi.prototype.getGlyphs=function(t,e,r){this.glyphManager.getGlyphs(e.stacks,r)},fi.prototype.getResource=function(t,e,r){return mt.makeRequest(e,r)},fi);function fi(t,e){var o=this;void 0===e&&(e={}),ci.call(this),this.map=t,this.dispatcher=new I(hr=hr||new pr,this),this.imageManager=new c,this.imageManager.setEventedParent(this),this.glyphManager=new _(t._requestManager,e.localIdeographFontFamily),this.lineAtlas=new b(256,512),this.crossTileSymbolIndex=new li,this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new mt.ZoomHistory,this._loaded=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",mt.getReferrer());var r=this;this._rtlTextPluginCallback=fi.registerForPluginAvailability(function(t){for(var e in r.dispatcher.broadcast("loadRTLTextPlugin",t.pluginURL,t.completionCallback),r.sourceCaches)r.sourceCaches[e].reload()}),this.on("data",function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=o.sourceCaches[t.sourceId];if(e){var r=e.getSource();if(r&&r.vectorLayerIds)for(var i in o._layers){var n=o._layers[i];n.source===r.id&&o._validateLayer(n)}}}})}di.getSourceType=function(t){return K[t]},di.setSourceType=function(t,e){K[t]=e},di.registerForPluginAvailability=mt.registerForPluginAvailability;var mi=mt.createLayout([{name:"a_pos",type:"Int16",components:2}]),gi=ji("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),yi=ji("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),vi=ji("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),_i=ji("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),xi=ji("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),bi=ji("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),wi=ji("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Si=ji("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Ti=ji("uniform float u_overscale_factor;varying float v_placed;varying float v_notUsed;varying float v_radius;varying vec2 v_extrude;varying vec2 v_extrude_scale;void main() {float alpha=0.5;vec4 color=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {color=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {color*=.2;}float extrude_scale_length=length(v_extrude_scale);float extrude_length=length(v_extrude)*extrude_scale_length;float stroke_width=15.0*extrude_scale_length/u_overscale_factor;float radius=v_radius*extrude_scale_length;float distance_to_edge=abs(extrude_length-radius);float opacity_t=smoothstep(-stroke_width,0.0,-distance_to_edge);gl_FragColor=opacity_t*color;}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;varying float v_radius;varying vec2 v_extrude;varying vec2 v_extrude_scale;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);highp float padding_factor=1.2;gl_Position.xy+=a_extrude*u_extrude_scale*padding_factor*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;v_radius=abs(a_extrude.y);v_extrude=a_extrude*padding_factor;v_extrude_scale=u_extrude_scale*u_camera_to_center_distance*collision_perspective_ratio;}"),Ei=ji("uniform highp vec4 u_color;void main() {gl_FragColor=u_color;}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ii=ji("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),Ci=ji("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),ki=ji("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec4 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Ai=ji("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec4 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileZoomRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Pi=ji("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),Mi=ji("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec4 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),Li=ji("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Oi=ji("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Di=ji("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Ri=ji("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),zi=ji("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec4 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileZoomRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x,1.0);float x_b=mod(v_linesofar/pattern_size_b.x,1.0);float y_a=0.5+(v_normal.y*clamp(v_width2.s,0.0,(pattern_size_a.y+2.0)/2.0)/pattern_size_a.y);float y_b=0.5+(v_normal.y*clamp(v_width2.s,0.0,(pattern_size_b.y+2.0)/2.0)/pattern_size_b.y);vec2 pos_a=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,vec2(x_a,y_a));vec2 pos_b=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,vec2(x_b,y_b));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);}"),Ni=ji("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),Bi=ji("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Fi=ji("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size[0],a_size[1],u_size_t)/256.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size[0]/256.0;} else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {size=u_size;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),Ui=ji("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size[0],a_size[1],u_size_t)/256.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size[0]/256.0;} else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {size=u_size;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=vec2(tex.x,tex.y);v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}");function ji(t,e){var r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,s={};return{fragmentSource:t=t.replace(r,function(t,e,r,i,n){return s[n]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_"+n+"\nvarying "+r+" "+i+" "+n+";\n#else\nuniform "+r+" "+i+" u_"+n+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+n+"\n    "+r+" "+i+" "+n+" = u_"+n+";\n#endif\n"}),vertexSource:e=e.replace(r,function(t,e,r,i,n){var o="float"===i?"vec2":"vec4",a=n.match(/color/)?"color":o;return s[n]?"define"===e?"\n#ifndef HAS_UNIFORM_u_"+n+"\nuniform lowp float u_"+n+"_t;\nattribute "+r+" "+o+" a_"+n+";\nvarying "+r+" "+i+" "+n+";\n#else\nuniform "+r+" "+i+" u_"+n+";\n#endif\n":"vec4"==a?"\n#ifndef HAS_UNIFORM_u_"+n+"\n    "+n+" = a_"+n+";\n#else\n    "+r+" "+i+" "+n+" = u_"+n+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+n+"\n    "+n+" = unpack_mix_"+a+"(a_"+n+", u_"+n+"_t);\n#else\n    "+r+" "+i+" "+n+" = u_"+n+";\n#endif\n":"define"===e?"\n#ifndef HAS_UNIFORM_u_"+n+"\nuniform lowp float u_"+n+"_t;\nattribute "+r+" "+o+" a_"+n+";\n#else\nuniform "+r+" "+i+" u_"+n+";\n#endif\n":"vec4"==a?"\n#ifndef HAS_UNIFORM_u_"+n+"\n    "+r+" "+i+" "+n+" = a_"+n+";\n#else\n    "+r+" "+i+" "+n+" = u_"+n+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+n+"\n    "+r+" "+i+" "+n+" = unpack_mix_"+a+"(a_"+n+", u_"+n+"_t);\n#else\n    "+r+" "+i+" "+n+" = u_"+n+";\n#endif\n"})}}function qi(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}var Vi=Object.freeze({prelude:gi,background:yi,backgroundPattern:vi,circle:_i,clippingMask:xi,heatmap:bi,heatmapTexture:wi,collisionBox:Si,collisionCircle:Ti,debug:Ei,fill:Ii,fillOutline:Ci,fillOutlinePattern:ki,fillPattern:Ai,fillExtrusion:Pi,fillExtrusionPattern:Mi,hillshadePrepare:Li,hillshade:Oi,line:Di,lineGradient:Ri,linePattern:zi,lineSDF:Ni,raster:Bi,symbolIcon:Fi,symbolSDF:Ui});function Gi(t,e,r,i,n){var o=t.gl;this.program=o.createProgram();var a=r.defines();n&&a.push("#define OVERDRAW_INSPECTOR;");var s=a.concat(gi.fragmentSource,e.fragmentSource).join("\n"),l=a.concat(gi.vertexSource,e.vertexSource).join("\n"),u=o.createShader(o.FRAGMENT_SHADER);o.shaderSource(u,s),o.compileShader(u),o.attachShader(this.program,u);var c=o.createShader(o.VERTEX_SHADER);o.shaderSource(c,l),o.compileShader(c),o.attachShader(this.program,c);for(var p=r.layoutAttributes||[],h=0;h<p.length;h++)o.bindAttribLocation(this.program,h,p[h].name);o.linkProgram(this.program),this.numAttributes=o.getProgramParameter(this.program,o.ACTIVE_ATTRIBUTES),this.attributes={};for(var d={},f=0;f<this.numAttributes;f++){var m=o.getActiveAttrib(this.program,f);m&&(this.attributes[m.name]=o.getAttribLocation(this.program,m.name))}for(var g=o.getProgramParameter(this.program,o.ACTIVE_UNIFORMS),y=0;y<g;y++){var v=o.getActiveUniform(this.program,y);v&&(d[v.name]=o.getUniformLocation(this.program,v.name))}this.fixedUniforms=i(t,d),this.binderUniforms=r.getUniforms(t,d)}function Zi(t,e,r){var i=1/Br(r,1,e.transform.tileZoom),n=Math.pow(2,r.tileID.overscaledZ),o=r.tileSize*Math.pow(2,e.transform.tileZoom)/n,a=o*(r.tileID.canonical.x+r.tileID.wrap*n),s=o*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[mt.browser.devicePixelRatio,i,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[a>>16,s>>16],u_pixel_coord_lower:[65535&a,65535&s]}}function Hi(t,e,r,i){var n=e.style.light,o=n.properties.get("position"),a=[o.x,o.y,o.z],s=mt.create$1();"viewport"===n.properties.get("anchor")&&mt.fromRotation(s,-e.transform.angle),mt.transformMat3(a,a,s);var l=n.properties.get("color");return{u_matrix:t,u_lightpos:a,u_lightintensity:n.properties.get("intensity"),u_lightcolor:[l.r,l.g,l.b],u_vertical_gradient:+r,u_opacity:i}}function Wi(t){return{u_matrix:t}}function Ki(t,e,r,i){return mt.extend(Wi(t),Zi(r,e,i))}function Xi(t,e,r,i){var n,o,a=t.transform;if("map"===i.paint.get("circle-pitch-alignment")){var s=Br(r,1,a.zoom);n=!0,o=[s,s]}else n=!1,o=a.pixelsToGLUnits;return{u_camera_to_center_distance:a.cameraToCenterDistance,u_scale_with_map:+("map"===i.paint.get("circle-pitch-scale")),u_matrix:t.translatePosMatrix(e.posMatrix,r,i.paint.get("circle-translate"),i.paint.get("circle-translate-anchor")),u_pitch_with_map:+n,u_device_pixel_ratio:mt.browser.devicePixelRatio,u_extrude_scale:o}}function Yi(t,e){return{u_matrix:new mt.UniformMatrix4f(t,e.u_matrix),u_camera_to_center_distance:new mt.Uniform1f(t,e.u_camera_to_center_distance),u_pixels_to_tile_units:new mt.Uniform1f(t,e.u_pixels_to_tile_units),u_extrude_scale:new mt.Uniform2f(t,e.u_extrude_scale),u_overscale_factor:new mt.Uniform1f(t,e.u_overscale_factor)}}function Ji(t){return{u_matrix:t}}qi.prototype.bind=function(t,e,r,i,n,o,a,s){this.context=t;for(var l=this.boundPaintVertexBuffers.length!==i.length,u=0;!l&&u<i.length;u++)this.boundPaintVertexBuffers[u]!==i[u]&&(l=!0);var c=!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==r||l||this.boundIndexBuffer!==n||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==a||this.boundDynamicVertexBuffer2!==s;!t.extVertexArrayObject||c?this.freshBind(e,r,i,n,o,a,s):(t.bindVertexArrayOES.set(this.vao),a&&a.bind(),n&&n.dynamicDraw&&n.bind(),s&&s.bind())},qi.prototype.freshBind=function(t,e,r,i,n,o,a){var s,l=t.numAttributes,u=this.context,c=u.gl;if(u.extVertexArrayObject)this.vao&&this.destroy(),this.vao=u.extVertexArrayObject.createVertexArrayOES(),u.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=i,this.boundVertexOffset=n,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a;else{s=u.currentNumAttributes||0;for(var p=l;p<s;p++)c.disableVertexAttribArray(p)}e.enableAttributes(c,t);for(var h=0,d=r;h<d.length;h+=1)d[h].enableAttributes(c,t);o&&o.enableAttributes(c,t),a&&a.enableAttributes(c,t),e.bind(),e.setVertexAttribPointers(c,t,n);for(var f=0,m=r;f<m.length;f+=1){var g=m[f];g.bind(),g.setVertexAttribPointers(c,t,n)}o&&(o.bind(),o.setVertexAttribPointers(c,t,n)),i&&i.bind(),a&&(a.bind(),a.setVertexAttribPointers(c,t,n)),u.currentNumAttributes=l},qi.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)},Gi.prototype.draw=function(t,e,r,i,n,o,a,s,l,u,c,p,h,d,f,m){var g,y=t.gl;for(var v in t.program.set(this.program),t.setDepthMode(r),t.setStencilMode(i),t.setColorMode(n),t.setCullFace(o),this.fixedUniforms)this.fixedUniforms[v].set(a[v]);d&&d.setUniforms(t,this.binderUniforms,p,{zoom:h});for(var _=((g={})[y.LINES]=2,g[y.TRIANGLES]=3,g[y.LINE_STRIP]=1,g)[e],x=0,b=c.get();x<b.length;x+=1){var w=b[x],S=w.vaos||(w.vaos={});(S[s]||(S[s]=new qi)).bind(t,this,l,d?d.getPaintVertexBuffers():[],u,w.vertexOffset,f,m),y.drawElements(e,w.primitiveLength*_,y.UNSIGNED_SHORT,w.primitiveOffset*_*2)}};var Qi=function(t,e,r){var i=Br(r,1,e.zoom),n=Math.pow(2,e.zoom-r.tileID.overscaledZ),o=r.tileID.overscaleFactor();return{u_matrix:t,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:i,u_extrude_scale:[e.pixelsToGLUnits[0]/(i*n),e.pixelsToGLUnits[1]/(i*n)],u_overscale_factor:o}},$i=function(t,e){return{u_matrix:t,u_color:e}},tn=function(t,e,r){var i=r.paint.get("hillshade-shadow-color"),n=r.paint.get("hillshade-highlight-color"),o=r.paint.get("hillshade-accent-color"),a=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===r.paint.get("hillshade-illumination-anchor")&&(a-=t.transform.angle);var s=!t.options.moving;return{u_matrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped(),s),u_image:0,u_latrange:function(t,e){var r=Math.pow(2,e.canonical.z),i=e.canonical.y;return[new mt.MercatorCoordinate(0,i/r).toLngLat().lat,new mt.MercatorCoordinate(0,(i+1)/r).toLngLat().lat]}(0,e.tileID),u_light:[r.paint.get("hillshade-exaggeration"),a],u_shadow:i,u_highlight:n,u_accent:o}},en=function(t,e,r){var i=e.stride,n=mt.create();return mt.ortho(n,0,mt.EXTENT,-mt.EXTENT,0,0,1),mt.translate(n,n,[0,-mt.EXTENT,0]),{u_matrix:n,u_image:1,u_dimension:[i,i],u_zoom:t.overscaledZ,u_maxzoom:r,u_unpack:e.getUnpackVector()}};function rn(t,e,r){var i=t.transform;return{u_matrix:on(t,e,r),u_ratio:1/Br(e,1,i.zoom),u_device_pixel_ratio:mt.browser.devicePixelRatio,u_units_to_pixels:[1/i.pixelsToGLUnits[0],1/i.pixelsToGLUnits[1]]}}function nn(t,e){return 1/Br(t,1,e.tileZoom)}function on(t,e,r){return t.translatePosMatrix(e.tileID.posMatrix,e,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}function an(t,e,r,i,n){return{u_matrix:t,u_tl_parent:e,u_scale_parent:r,u_buffer_scale:1,u_fade_t:i.mix,u_opacity:i.opacity*n.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:n.paint.get("raster-brightness-min"),u_brightness_high:n.paint.get("raster-brightness-max"),u_saturation_factor:(a=n.paint.get("raster-saturation"),0<a?1-1/(1.001-a):-a),u_contrast_factor:(o=n.paint.get("raster-contrast"),0<o?1/(1-o):1+o),u_spin_weights:function(t){t*=Math.PI/180;var e=Math.sin(t),r=Math.cos(t);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}(n.paint.get("raster-hue-rotate"))};var o,a}function sn(t,e,r,i,n,o,a,s,l,u){var c=n.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:c.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:c.width/c.height,u_fade_change:n.options.fadeDuration?n.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:a,u_coord_matrix:s,u_is_text:+l,u_pitch_with_map:+i,u_texsize:u,u_texture:0}}var ln={fillExtrusion:function(t,e){return{u_matrix:new mt.UniformMatrix4f(t,e.u_matrix),u_lightpos:new mt.Uniform3f(t,e.u_lightpos),u_lightintensity:new mt.Uniform1f(t,e.u_lightintensity),u_lightcolor:new mt.Uniform3f(t,e.u_lightcolor),u_vertical_gradient:new mt.Uniform1f(t,e.u_vertical_gradient),u_opacity:new mt.Uniform1f(t,e.u_opacity)}},fillExtrusionPattern:function(t,e){return{u_matrix:new mt.UniformMatrix4f(t,e.u_matrix),u_lightpos:new mt.Uniform3f(t,e.u_lightpos),u_lightintensity:new mt.Uniform1f(t,e.u_lightintensity),u_lightcolor:new mt.Uniform3f(t,e.u_lightcolor),u_vertical_gradient:new mt.Uniform1f(t,e.u_vertical_gradient),u_height_factor:new mt.Uniform1f(t,e.u_height_factor),u_image:new mt.Uniform1i(t,e.u_image),u_texsize:new mt.Uniform2f(t,e.u_texsize),u_pixel_coord_upper:new mt.Uniform2f(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new mt.Uniform2f(t,e.u_pixel_coord_lower),u_scale:new mt.Uniform4f(t,e.u_scale),u_fade:new mt.Uniform1f(t,e.u_fade),u_opacity:new mt.Uniform1f(t,e.u_opacity)}},fill:function(t,e){return{u_matrix:new mt.UniformMatrix4f(t,e.u_matrix)}},fillPattern:function(t,e){return{u_matrix:new mt.UniformMatrix4f(t,e.u_matrix),u_image:new mt.Uniform1i(t,e.u_image),u_texsize:new mt.Uniform2f(t,e.u_texsize),u_pixel_coord_upper:new mt.Uniform2f(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new mt.Uniform2f(t,e.u_pixel_coord_lower),u_scale:new mt.Uniform4f(t,e.u_scale),u_fade:new mt.Uniform1f(t,e.u_fade)}},fillOutline:function(t,e){return{u_matrix:new mt.UniformMatrix4f(t,e.u_matrix),u_world:new mt.Uniform2f(t,e.u_world)}},fillOutlinePattern:function(t,e){return{u_matrix:new mt.UniformMatrix4f(t,e.u_matrix),u_world:new mt.Uniform2f(t,e.u_world),u_image:new mt.Uniform1i(t,e.u_image),u_texsize:new mt.Uniform2f(t,e.u_texsize),u_pixel_coord_upper:new mt.Uniform2f(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new mt.Uniform2f(t,e.u_pixel_coord_lower),u_scale:new mt.Uniform4f(t,e.u_scale),u_fade:new mt.Uniform1f(t,e.u_fade)}},circle:function(t,e){return{u_camera_to_center_distance:new mt.Uniform1f(t,e.u_camera_to_center_distance),u_scale_with_map:new mt.Uniform1i(t,e.u_scale_with_map),u_pitch_with_map:new mt.Uniform1i(t,e.u_pitch_with_map),u_extrude_scale:new mt.Uniform2f(t,e.u_extrude_scale),u_device_pixel_ratio:new mt.Uniform1f(t,e.u_device_pixel_ratio),u_matrix:new mt.UniformMatrix4f(t,e.u_matrix)}},collisionBox:Yi,collisionCircle:Yi,debug:function(t,e){return{u_color:new mt.UniformColor(t,e.u_color),u_matrix:new mt.UniformMatrix4f(t,e.u_matrix)}},clippingMask:function(t,e){return{u_matrix:new mt.UniformMatrix4f(t,e.u_matrix)}},heatmap:function(t,e){return{u_extrude_scale:new mt.Uniform1f(t,e.u_extrude_scale),u_intensity:new mt.Uniform1f(t,e.u_intensity),u_matrix:new mt.UniformMatrix4f(t,e.u_matrix)}},heatmapTexture:function(t,e){return{u_matrix:new mt.UniformMatrix4f(t,e.u_matrix),u_world:new mt.Uniform2f(t,e.u_world),u_image:new mt.Uniform1i(t,e.u_image),u_color_ramp:new mt.Uniform1i(t,e.u_color_ramp),u_opacity:new mt.Uniform1f(t,e.u_opacity)}},hillshade:function(t,e){return{u_matrix:new mt.UniformMatrix4f(t,e.u_matrix),u_image:new mt.Uniform1i(t,e.u_image),u_latrange:new mt.Uniform2f(t,e.u_latrange),u_light:new mt.Uniform2f(t,e.u_light),u_shadow:new mt.UniformColor(t,e.u_shadow),u_highlight:new mt.UniformColor(t,e.u_highlight),u_accent:new mt.UniformColor(t,e.u_accent)}},hillshadePrepare:function(t,e){return{u_matrix:new mt.UniformMatrix4f(t,e.u_matrix),u_image:new mt.Uniform1i(t,e.u_image),u_dimension:new mt.Uniform2f(t,e.u_dimension),u_zoom:new mt.Uniform1f(t,e.u_zoom),u_maxzoom:new mt.Uniform1f(t,e.u_maxzoom),u_unpack:new mt.Uniform4f(t,e.u_unpack)}},line:function(t,e){return{u_matrix:new mt.UniformMatrix4f(t,e.u_matrix),u_ratio:new mt.Uniform1f(t,e.u_ratio),u_device_pixel_ratio:new mt.Uniform1f(t,e.u_device_pixel_ratio),u_units_to_pixels:new mt.Uniform2f(t,e.u_units_to_pixels)}},lineGradient:function(t,e){return{u_matrix:new mt.UniformMatrix4f(t,e.u_matrix),u_ratio:new mt.Uniform1f(t,e.u_ratio),u_device_pixel_ratio:new mt.Uniform1f(t,e.u_device_pixel_ratio),u_units_to_pixels:new mt.Uniform2f(t,e.u_units_to_pixels),u_image:new mt.Uniform1i(t,e.u_image)}},linePattern:function(t,e){return{u_matrix:new mt.UniformMatrix4f(t,e.u_matrix),u_texsize:new mt.Uniform2f(t,e.u_texsize),u_ratio:new mt.Uniform1f(t,e.u_ratio),u_device_pixel_ratio:new mt.Uniform1f(t,e.u_device_pixel_ratio),u_image:new mt.Uniform1i(t,e.u_image),u_units_to_pixels:new mt.Uniform2f(t,e.u_units_to_pixels),u_scale:new mt.Uniform4f(t,e.u_scale),u_fade:new mt.Uniform1f(t,e.u_fade)}},lineSDF:function(t,e){return{u_matrix:new mt.UniformMatrix4f(t,e.u_matrix),u_ratio:new mt.Uniform1f(t,e.u_ratio),u_device_pixel_ratio:new mt.Uniform1f(t,e.u_device_pixel_ratio),u_units_to_pixels:new mt.Uniform2f(t,e.u_units_to_pixels),u_patternscale_a:new mt.Uniform2f(t,e.u_patternscale_a),u_patternscale_b:new mt.Uniform2f(t,e.u_patternscale_b),u_sdfgamma:new mt.Uniform1f(t,e.u_sdfgamma),u_image:new mt.Uniform1i(t,e.u_image),u_tex_y_a:new mt.Uniform1f(t,e.u_tex_y_a),u_tex_y_b:new mt.Uniform1f(t,e.u_tex_y_b),u_mix:new mt.Uniform1f(t,e.u_mix)}},raster:function(t,e){return{u_matrix:new mt.UniformMatrix4f(t,e.u_matrix),u_tl_parent:new mt.Uniform2f(t,e.u_tl_parent),u_scale_parent:new mt.Uniform1f(t,e.u_scale_parent),u_buffer_scale:new mt.Uniform1f(t,e.u_buffer_scale),u_fade_t:new mt.Uniform1f(t,e.u_fade_t),u_opacity:new mt.Uniform1f(t,e.u_opacity),u_image0:new mt.Uniform1i(t,e.u_image0),u_image1:new mt.Uniform1i(t,e.u_image1),u_brightness_low:new mt.Uniform1f(t,e.u_brightness_low),u_brightness_high:new mt.Uniform1f(t,e.u_brightness_high),u_saturation_factor:new mt.Uniform1f(t,e.u_saturation_factor),u_contrast_factor:new mt.Uniform1f(t,e.u_contrast_factor),u_spin_weights:new mt.Uniform3f(t,e.u_spin_weights)}},symbolIcon:function(t,e){return{u_is_size_zoom_constant:new mt.Uniform1i(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new mt.Uniform1i(t,e.u_is_size_feature_constant),u_size_t:new mt.Uniform1f(t,e.u_size_t),u_size:new mt.Uniform1f(t,e.u_size),u_camera_to_center_distance:new mt.Uniform1f(t,e.u_camera_to_center_distance),u_pitch:new mt.Uniform1f(t,e.u_pitch),u_rotate_symbol:new mt.Uniform1i(t,e.u_rotate_symbol),u_aspect_ratio:new mt.Uniform1f(t,e.u_aspect_ratio),u_fade_change:new mt.Uniform1f(t,e.u_fade_change),u_matrix:new mt.UniformMatrix4f(t,e.u_matrix),u_label_plane_matrix:new mt.UniformMatrix4f(t,e.u_label_plane_matrix),u_coord_matrix:new mt.UniformMatrix4f(t,e.u_coord_matrix),u_is_text:new mt.Uniform1f(t,e.u_is_text),u_pitch_with_map:new mt.Uniform1i(t,e.u_pitch_with_map),u_texsize:new mt.Uniform2f(t,e.u_texsize),u_texture:new mt.Uniform1i(t,e.u_texture)}},symbolSDF:function(t,e){return{u_is_size_zoom_constant:new mt.Uniform1i(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new mt.Uniform1i(t,e.u_is_size_feature_constant),u_size_t:new mt.Uniform1f(t,e.u_size_t),u_size:new mt.Uniform1f(t,e.u_size),u_camera_to_center_distance:new mt.Uniform1f(t,e.u_camera_to_center_distance),u_pitch:new mt.Uniform1f(t,e.u_pitch),u_rotate_symbol:new mt.Uniform1i(t,e.u_rotate_symbol),u_aspect_ratio:new mt.Uniform1f(t,e.u_aspect_ratio),u_fade_change:new mt.Uniform1f(t,e.u_fade_change),u_matrix:new mt.UniformMatrix4f(t,e.u_matrix),u_label_plane_matrix:new mt.UniformMatrix4f(t,e.u_label_plane_matrix),u_coord_matrix:new mt.UniformMatrix4f(t,e.u_coord_matrix),u_is_text:new mt.Uniform1f(t,e.u_is_text),u_pitch_with_map:new mt.Uniform1i(t,e.u_pitch_with_map),u_texsize:new mt.Uniform2f(t,e.u_texsize),u_texture:new mt.Uniform1i(t,e.u_texture),u_gamma_scale:new mt.Uniform1f(t,e.u_gamma_scale),u_device_pixel_ratio:new mt.Uniform1f(t,e.u_device_pixel_ratio),u_is_halo:new mt.Uniform1f(t,e.u_is_halo)}},background:function(t,e){return{u_matrix:new mt.UniformMatrix4f(t,e.u_matrix),u_opacity:new mt.Uniform1f(t,e.u_opacity),u_color:new mt.UniformColor(t,e.u_color)}},backgroundPattern:function(t,e){return{u_matrix:new mt.UniformMatrix4f(t,e.u_matrix),u_opacity:new mt.Uniform1f(t,e.u_opacity),u_image:new mt.Uniform1i(t,e.u_image),u_pattern_tl_a:new mt.Uniform2f(t,e.u_pattern_tl_a),u_pattern_br_a:new mt.Uniform2f(t,e.u_pattern_br_a),u_pattern_tl_b:new mt.Uniform2f(t,e.u_pattern_tl_b),u_pattern_br_b:new mt.Uniform2f(t,e.u_pattern_br_b),u_texsize:new mt.Uniform2f(t,e.u_texsize),u_mix:new mt.Uniform1f(t,e.u_mix),u_pattern_size_a:new mt.Uniform2f(t,e.u_pattern_size_a),u_pattern_size_b:new mt.Uniform2f(t,e.u_pattern_size_b),u_scale_a:new mt.Uniform1f(t,e.u_scale_a),u_scale_b:new mt.Uniform1f(t,e.u_scale_b),u_pixel_coord_upper:new mt.Uniform2f(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new mt.Uniform2f(t,e.u_pixel_coord_lower),u_tile_units_to_pixels:new mt.Uniform1f(t,e.u_tile_units_to_pixels)}}};function un(t,e){for(var r=t.sort(function(t,e){return t.tileID.isLessThan(e.tileID)?-1:e.tileID.isLessThan(t.tileID)?1:0}),i=0;i<r.length;i++){var n={},o=r[i],a=r.slice(i+1);cn(o.tileID.wrapped(),o.tileID,a,new mt.OverscaledTileID(0,o.tileID.wrap+1,0,0,0),n),o.setMask(n,e)}}function cn(t,e,r,i,n){for(var o=0;o<r.length;o++){var a=r[o];if(i.isLessThan(a.tileID))break;if(e.key===a.tileID.key)return;if(a.tileID.isChildOf(e)){for(var s=e.children(1/0),l=0;l<s.length;l++)cn(t,s[l],r.slice(o),i,n);return}}var u=e.overscaledZ-t.overscaledZ,c=new mt.CanonicalTileID(u,e.canonical.x-(t.canonical.x<<u),e.canonical.y-(t.canonical.y<<u));n[c.key]=n[c.key]||c}function pn(t,e,r,i,n,o,a,s){for(var l=t.context,u=l.gl,c=n?t.useProgram("collisionCircle"):t.useProgram("collisionBox"),p=0;p<i.length;p++){var h=i[p],d=e.getTile(h),f=d.getBucket(r);if(f){var m=n?s?f.textCollisionCircle:f.iconCollisionCircle:s?f.textCollisionBox:f.iconCollisionBox;if(m){var g=h.posMatrix;0===o[0]&&0===o[1]||(g=t.translatePosMatrix(h.posMatrix,d,o,a)),c.draw(l,n?u.TRIANGLES:u.LINES,tr.disabled,er.disabled,t.colorModeForRenderPass(),ir.disabled,Qi(g,t.transform,d),r.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,null,t.transform.zoom,null,null,m.collisionVertexBuffer)}}}}function hn(t,e,r,i,n,o,a){pn(t,e,r,i,!1,n,o,a),pn(t,e,r,i,!0,n,o,a)}var dn=mt.identity(new Float32Array(16));function fn(t,e,r,i,n,o,a,s,l,u,c){var p,h,d,f,m,g,y,v,_,x,b=t.text.placedSymbolArray,w=t.text.dynamicLayoutVertexArray,S=t.icon.dynamicLayoutVertexArray,T={};w.clear();for(var E=0;E<b.length;E++){var I=b.get(E),C=t.allowVerticalPlacement&&!I.placedOrientation,k=I.hidden||!I.crossTileID||C?null:i[I.crossTileID];if(k){var A=new mt.Point(I.anchorX,I.anchorY),P=Ir(A,r?s:a),M=.5+o.cameraToCenterDistance/P.signedDistanceFromCamera*.5,L=n.evaluateSizeForFeature(t.textSizeData,u,I)*M/mt.ONE_EM;r&&(L*=t.tilePixelRatio/l);for(var O=k.width,D=k.height,R=(p=k.anchor,h=O,d=D,f=k.textOffset,m=k.textBoxScale,g=L,y=mt.getAnchorAlignment(p),v=-(y.horizontalAlign-.5)*h,_=-(y.verticalAlign-.5)*d,x=mt.evaluateVariableOffset(p,f),new mt.Point((v/m+x[0])*g,(_/m+x[1])*g)),z=r?Ir(A.add(R),a).point:P.point.add(e?R.rotate(-o.angle):R),N=t.allowVerticalPlacement&&I.placedOrientation===mt.WritingMode.vertical?Math.PI/2:0,B=0;B<I.numGlyphs;B++)mt.addDynamicAttributes(w,z,N);c&&0<=I.associatedIconIndex&&(T[I.associatedIconIndex]={shiftedAnchor:z,angle:N})}else Dr(I.numGlyphs,w)}if(c){S.clear();for(var F=t.icon.placedSymbolArray,U=0;U<F.length;U++){var j=F.get(U);if(j.hidden)Dr(j.numGlyphs,S);else{var q=T[U];if(q)for(var V=0;V<j.numGlyphs;V++)mt.addDynamicAttributes(S,q.shiftedAnchor,q.angle);else Dr(j.numGlyphs,S)}}t.icon.dynamicLayoutVertexBuffer.updateData(S)}t.text.dynamicLayoutVertexBuffer.updateData(w)}function mn(t){var e=t.text.placedSymbolArray,r=t.text.dynamicLayoutVertexArray;r.clear();for(var i=0;i<e.length;i++){var n=e.get(i);if(n.hidden||!n.placedOrientation)Dr(n.numGlyphs,r);else for(var o=new mt.Point(n.anchorX,n.anchorY),a=t.allowVerticalPlacement&&n.placedOrientation===mt.WritingMode.vertical?Math.PI/2:0,s=0;s<n.numGlyphs;s++)mt.addDynamicAttributes(r,o,a)}t.text.dynamicLayoutVertexBuffer.updateData(r)}function gn(t,e,r,i,n,o,a,s,l,u,c,p){for(var h,d,f=t.context,m=f.gl,g=t.transform,y="map"===s,v="map"===l,_=y&&"point"!==r.layout.get("symbol-placement"),x=y&&!v&&!_,b=void 0!==r.layout.get("symbol-sort-key").constantOr(1),w=t.depthModeForSublayer(0,tr.ReadOnly),S=r.layout.get("text-variable-anchor"),T=[],E=0,I=i;E<I.length;E+=1){var C=I[E],k=e.getTile(C),A=k.getBucket(r);if(A){var P=n?A.text:A.icon;if(P&&P.segments.get().length){var M=P.programConfigurations.get(r.id),L=n||A.sdfIcons,O=n?A.textSizeData:A.iconSizeData;h||(h=t.useProgram(L?"symbolSDF":"symbolIcon",M),d=mt.evaluateSizeForZoom(O,g.zoom)),f.activeTexture.set(m.TEXTURE0);var D=void 0,R=void 0,z=void 0;if(n)R=k.glyphAtlasTexture,z=m.LINEAR,D=k.glyphAtlasTexture.size;else{var N=1!==r.layout.get("icon-size").constantOr(0)||A.iconsNeedLinear,B=v||0!==g.pitch;R=k.imageAtlasTexture,z=L||t.options.rotating||t.options.zooming||N||B?m.LINEAR:m.NEAREST,D=k.imageAtlasTexture.size}var F=Br(k,1,t.transform.zoom),U=Tr(C.posMatrix,v,y,t.transform,F),j=Er(C.posMatrix,v,y,t.transform,F),q=S&&A.hasTextData(),V="none"!==r.layout.get("icon-text-fit")&&q&&A.hasIconData();_?Cr(A,C.posMatrix,t,n,U,j,v,u):n&&d&&A.allowVerticalPlacement&&!S&&mn(A);var G=t.translatePosMatrix(C.posMatrix,k,o,a),Z=_||n&&S||V?dn:U,H=t.translatePosMatrix(j,k,o,a,!0),W=L&&0!==r.paint.get(n?"text-halo-width":"icon-halo-width").constantOr(1),K={program:h,buffers:P,uniformValues:L?(Q=O.kind,$=d,tt=x,et=v,rt=t,it=G,nt=Z,ot=H,at=n,st=D,lt=!0,ut=rt.transform,mt.extend(sn(Q,$,tt,et,rt,it,nt,ot,at,st),{u_gamma_scale:et?Math.cos(ut._pitch)*ut.cameraToCenterDistance:1,u_device_pixel_ratio:mt.browser.devicePixelRatio,u_is_halo:+lt})):sn(O.kind,d,x,v,t,G,Z,H,n,D),atlasTexture:R,atlasInterpolation:z,isSDF:L,hasHalo:W};if(b)for(var X=0,Y=P.segments.get();X<Y.length;X+=1){var J=Y[X];T.push({segments:new mt.SegmentVector([J]),sortKey:J.sortKey,state:K})}else T.push({segments:P.segments,sortKey:0,state:K})}}}var Q,$,tt,et,rt,it,nt,ot,at,st,lt,ut;b&&T.sort(function(t,e){return t.sortKey-e.sortKey});for(var ct=0,pt=T;ct<pt.length;ct+=1){var ht=pt[ct],dt=ht.state;if(dt.atlasTexture.bind(dt.atlasInterpolation,m.CLAMP_TO_EDGE),dt.isSDF){var ft=dt.uniformValues;dt.hasHalo&&(ft.u_is_halo=1,yn(dt.buffers,ht.segments,r,t,dt.program,w,c,p,ft)),ft.u_is_halo=0}yn(dt.buffers,ht.segments,r,t,dt.program,w,c,p,dt.uniformValues)}}function yn(t,e,r,i,n,o,a,s,l){var u=i.context,c=u.gl;n.draw(u,c.TRIANGLES,o,a,s,ir.disabled,l,r.id,t.layoutVertexBuffer,t.indexBuffer,e,r.paint,i.transform.zoom,t.programConfigurations.get(r.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function vn(t,e,r,i,n,o,a){var s,l,u,c,p,h,d,f,m,g,y=t.context.gl,v=r.paint.get("fill-pattern"),_=v&&v.constantOr(1),x=r.getCrossfadeParameters();s=a?(l=_&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",y.LINES):(l=_?"fillPattern":"fill",y.TRIANGLES);for(var b=0,w=i;b<w.length;b+=1){var S=w[b],T=e.getTile(S);if(!_||T.patternsLoaded()){var E=T.getBucket(r);if(E){var I=E.programConfigurations.get(r.id),C=t.useProgram(l,I);_&&(t.context.activeTexture.set(y.TEXTURE0),T.imageAtlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),I.updatePatternPaintBuffers(x));var k=v.constantOr(null);if(k&&T.imageAtlas){var A=T.imageAtlas,P=A.patternPositions[k.to.toString()],M=A.patternPositions[k.from.toString()];P&&M&&I.setConstantPatternPositions(P,M)}var L=t.translatePosMatrix(S.posMatrix,T,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor"));if(a){c=E.indexBuffer2,p=E.segments2;var O=[y.drawingBufferWidth,y.drawingBufferHeight];u="fillOutlinePattern"===l&&_?(h=L,d=t,f=x,m=T,g=O,mt.extend(Ki(h,d,f,m),{u_world:g})):{u_matrix:L,u_world:O}}else c=E.indexBuffer,p=E.segments,u=_?Ki(L,t,x,T):Wi(L);C.draw(t.context,s,n,t.stencilModeForClipping(S),o,ir.disabled,u,r.id,E.layoutVertexBuffer,c,p,r.paint,t.transform.zoom,I)}}}}function _n(t,e,r,i,n,o,a){for(var s=t.context,l=s.gl,u=r.paint.get("fill-extrusion-pattern"),c=u.constantOr(1),p=r.getCrossfadeParameters(),h=r.paint.get("fill-extrusion-opacity"),d=0,f=i;d<f.length;d+=1){var m=f[d],g=e.getTile(m),y=g.getBucket(r);if(y){var v=y.programConfigurations.get(r.id),_=t.useProgram(c?"fillExtrusionPattern":"fillExtrusion",v);c&&(t.context.activeTexture.set(l.TEXTURE0),g.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),v.updatePatternPaintBuffers(p));var x=u.constantOr(null);if(x&&g.imageAtlas){var b=g.imageAtlas,w=b.patternPositions[x.to.toString()],S=b.patternPositions[x.from.toString()];w&&S&&v.setConstantPatternPositions(w,S)}var T=t.translatePosMatrix(m.posMatrix,g,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),E=r.paint.get("fill-extrusion-vertical-gradient"),I=c?(C=T,k=t,A=E,P=h,M=m,L=p,O=g,mt.extend(Hi(C,k,A,P),Zi(L,k,O),{u_height_factor:-Math.pow(2,M.overscaledZ)/O.tileSize/8})):Hi(T,t,E,h);_.draw(s,s.gl.TRIANGLES,n,o,a,ir.backCCW,I,r.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,r.paint,t.transform.zoom,v)}}var C,k,A,P,M,L,O}function xn(t,e,r,i,n,o){var a=t.context,s=a.gl,l=e.fbo;if(l){var u=t.useProgram("hillshade");a.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,l.colorAttachment.get());var c=tn(t,e,r);e.maskedBoundsBuffer&&e.maskedIndexBuffer&&e.segments?u.draw(a,s.TRIANGLES,i,n,o,ir.disabled,c,r.id,e.maskedBoundsBuffer,e.maskedIndexBuffer,e.segments):u.draw(a,s.TRIANGLES,i,n,o,ir.disabled,c,r.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}function bn(t,e,r,i,n,o,a){var s=t.context,l=s.gl,u=e.dem;if(u&&u.data){var c=u.dim,p=u.stride,h=u.getPixels();if(s.activeTexture.set(l.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||t.getTileTexture(p),e.demTexture){var d=e.demTexture;d.update(h,{premultiply:!1}),d.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else e.demTexture=new mt.Texture(s,h,l.RGBA,{premultiply:!1}),e.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);s.activeTexture.set(l.TEXTURE0);var f=e.fbo;if(!f){var m=new mt.Texture(s,{width:c,height:c,data:null},l.RGBA);m.bind(l.LINEAR,l.CLAMP_TO_EDGE),(f=e.fbo=s.createFramebuffer(c,c)).colorAttachment.set(m.texture)}s.bindFramebuffer.set(f.framebuffer),s.viewport.set([0,0,c,c]),t.useProgram("hillshadePrepare").draw(s,l.TRIANGLES,n,o,a,ir.disabled,en(e.tileID,u,i),r.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),e.needsHillshadePrepare=!1}}function wn(t,e,r,i,n){var o=i.paint.get("raster-fade-duration");if(0<o){var a=mt.browser.now(),s=(a-t.timeAdded)/o,l=e?(a-e.timeAdded)/o:-1,u=r.getSource(),c=n.coveringZoomLevel({tileSize:u.tileSize,roundZoom:u.roundZoom}),p=!e||Math.abs(e.tileID.overscaledZ-c)>Math.abs(t.tileID.overscaledZ-c),h=p&&t.refreshedUponExpiration?1:mt.clamp(p?s:1-l,0,1);return t.refreshedUponExpiration&&1<=s&&(t.refreshedUponExpiration=!1),e?{opacity:1,mix:1-h}:{opacity:h,mix:0}}return{opacity:1,mix:0}}function Sn(t,e,r){var i=t.context,n=i.gl,o=r.posMatrix,a=t.useProgram("debug"),s=tr.disabled,l=er.disabled,u=t.colorModeForRenderPass(),c="$debug";a.draw(i,n.LINE_STRIP,s,l,u,ir.disabled,$i(o,mt.Color.red),c,t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments);for(var p=e.getTileByID(r.key).latestRawTileData,h=p&&p.byteLength||0,d=Math.floor(h/1024),f=e.getTile(r).tileSize,m=512/Math.min(f,512),g=function(t,e,r,i){i=i||1;var n,o,a,s,l,u,c,p,h=[];for(n=0,o=t.length;n<o;n++)if(l=En[t[n]]){for(p=null,a=0,s=l[1].length;a<s;a+=2)p=-1===l[1][a]&&-1===l[1][a+1]?null:(u=e+l[1][a]*i,c=r-l[1][a+1]*i,p&&h.push(p.x,p.y,u,c),{x:u,y:c});e+=l[0]*i}return h}(r.toString()+" "+d+"kb",50,200*m,5*m),y=new mt.StructArrayLayout2i4,v=new mt.StructArrayLayout2ui4,_=0;_<g.length;_+=2)y.emplaceBack(g[_],g[_+1]),v.emplaceBack(_,_+1);for(var x=i.createVertexBuffer(y,mi.members),b=i.createIndexBuffer(v),w=mt.SegmentVector.simpleSegment(0,0,y.length/2,y.length/2),S=mt.EXTENT/(Math.pow(2,t.transform.zoom-r.overscaledZ)*f*m),T=[],E=-1;E<=1;E++)for(var I=-1;I<=1&&(0!==E||0!==I);I++)T.push([E,I]);for(var C=0;C<T.length;C++){var k=T[C];a.draw(i,n.LINES,s,l,u,ir.disabled,$i(mt.translate([],o,[S*k[0],S*k[1],0]),mt.Color.white),c,x,b,w)}a.draw(i,n.LINES,s,l,u,ir.disabled,$i(o,mt.Color.black),c,x,b,w)}function Tn(t,e){this.context=new nr(t),this.transform=e,this._tileTextures={},this.setup(),this.numSublayers=ar.maxUnderzooming+ar.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.depthRboNeedsClear=!0,this.emptyProgramConfiguration=new mt.ProgramConfiguration,this.crossTileSymbolIndex=new li}var En={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]},In={symbol:function(t,e,r,i,n){if("translucent"===t.renderPass){var o=er.disabled,a=t.colorModeForRenderPass();r.layout.get("text-variable-anchor")&&function(t,e,r,i,n,o,a){for(var s=e.transform,l="map"===n,u="map"===o,c=0,p=t;c<p.length;c+=1){var h=p[c],d=i.getTile(h),f=d.getBucket(r);if(f&&f.text&&f.text.segments.get().length){var m=f.textSizeData,g=mt.evaluateSizeForZoom(m,s.zoom),y=Br(d,1,e.transform.zoom),v=Tr(h.posMatrix,u,l,e.transform,y),_="none"!==r.layout.get("icon-text-fit")&&f.hasIconData();if(g){var x=Math.pow(2,s.zoom-d.tileID.overscaledZ);fn(f,l,u,a,mt.symbolSize,s,v,h.posMatrix,x,g,_)}}}}(i,t,r,e,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),n),0!==r.paint.get("icon-opacity").constantOr(1)&&gn(t,e,r,i,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),o,a),0!==r.paint.get("text-opacity").constantOr(1)&&gn(t,e,r,i,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),o,a),e.map.showCollisionBoxes&&(hn(t,e,r,i,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),hn(t,e,r,i,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))}},circle:function(t,e,r,i){if("translucent"===t.renderPass){var n=r.paint.get("circle-opacity"),o=r.paint.get("circle-stroke-width"),a=r.paint.get("circle-stroke-opacity"),s=void 0!==r.layout.get("circle-sort-key").constantOr(1);if(0!==n.constantOr(1)||0!==o.constantOr(1)&&0!==a.constantOr(1)){for(var l=t.context,u=l.gl,c=t.depthModeForSublayer(0,tr.ReadOnly),p=er.disabled,h=t.colorModeForRenderPass(),d=[],f=0;f<i.length;f++){var m=i[f],g=e.getTile(m),y=g.getBucket(r);if(y){var v=y.programConfigurations.get(r.id),_={programConfiguration:v,program:t.useProgram("circle",v),layoutVertexBuffer:y.layoutVertexBuffer,indexBuffer:y.indexBuffer,uniformValues:Xi(t,m,g,r)};if(s)for(var x=0,b=y.segments.get();x<b.length;x+=1){var w=b[x];d.push({segments:new mt.SegmentVector([w]),sortKey:w.sortKey,state:_})}else d.push({segments:y.segments,sortKey:0,state:_})}}s&&d.sort(function(t,e){return t.sortKey-e.sortKey});for(var S=0,T=d;S<T.length;S+=1){var E=T[S],I=E.state,C=I.programConfiguration,k=I.program,A=I.layoutVertexBuffer,P=I.indexBuffer,M=I.uniformValues,L=E.segments;k.draw(l,u.TRIANGLES,c,p,h,ir.disabled,M,r.id,A,P,L,r.paint,t.transform.zoom,C)}}}},heatmap:function(t,e,r,i){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){var n=t.context,o=n.gl,a=t.depthModeForSublayer(0,tr.ReadOnly),s=er.disabled,l=new rr([o.ONE,o.ONE],mt.Color.transparent,[!0,!0,!0,!0]);!function(t,e,r){var i=t.gl;t.activeTexture.set(i.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);var n=r.heatmapFbo;if(n)i.bindTexture(i.TEXTURE_2D,n.colorAttachment.get()),t.bindFramebuffer.set(n.framebuffer);else{var o=i.createTexture();i.bindTexture(i.TEXTURE_2D,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),n=r.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4),function t(e,r,i,n){var o=e.gl;o.texImage2D(o.TEXTURE_2D,0,o.RGBA,r.width/4,r.height/4,0,o.RGBA,e.extTextureHalfFloat?e.extTextureHalfFloat.HALF_FLOAT_OES:o.UNSIGNED_BYTE,null),n.colorAttachment.set(i),e.extTextureHalfFloat&&o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE&&(e.extTextureHalfFloat=null,n.colorAttachment.setDirty(),t(e,r,i,n))}(t,e,o,n)}}(n,t,r),n.clear({color:mt.Color.transparent});for(var u=0;u<i.length;u++){var c=i[u];if(!e.hasRenderableParent(c)){var p=e.getTile(c),h=p.getBucket(r);if(h){var d=h.programConfigurations.get(r.id),f=t.useProgram("heatmap",d),m=t.transform.zoom;f.draw(n,o.TRIANGLES,a,s,l,ir.disabled,(g=c.posMatrix,y=p,v=m,_=r.paint.get("heatmap-intensity"),{u_matrix:g,u_extrude_scale:Br(y,1,v),u_intensity:_}),r.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,r.paint,t.transform.zoom,d)}}}n.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,e){var r=t.context,i=r.gl,n=e.heatmapFbo;if(n){r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,n.colorAttachment.get()),r.activeTexture.set(i.TEXTURE1);var o=e.colorRampTexture;(o=o||(e.colorRampTexture=new mt.Texture(r,e.colorRamp,i.RGBA))).bind(i.LINEAR,i.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(r,i.TRIANGLES,tr.disabled,er.disabled,t.colorModeForRenderPass(),ir.disabled,function(t,e,r,i){var n=mt.create();mt.ortho(n,0,t.width,t.height,0,0,1);var o=t.context.gl;return{u_matrix:n,u_world:[o.drawingBufferWidth,o.drawingBufferHeight],u_image:r,u_color_ramp:i,u_opacity:e.paint.get("heatmap-opacity")}}(t,e,0,1),e.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,e.paint,t.transform.zoom)}}(t,r));var g,y,v,_},line:function(t,e,r,i){if("translucent"===t.renderPass){var n=r.paint.get("line-opacity"),o=r.paint.get("line-width");if(0!==n.constantOr(1)&&0!==o.constantOr(1)){var a=t.depthModeForSublayer(0,tr.ReadOnly),s=t.colorModeForRenderPass(),l=r.paint.get("line-dasharray"),u=r.paint.get("line-pattern"),c=u.constantOr(1),p=r.paint.get("line-gradient"),h=r.getCrossfadeParameters(),d=l?"lineSDF":c?"linePattern":p?"lineGradient":"line",f=t.context,m=f.gl,g=!0;if(p){f.activeTexture.set(m.TEXTURE0);var y=r.gradientTexture;if(!r.gradient)return;(y=y||(r.gradientTexture=new mt.Texture(f,r.gradient,m.RGBA))).bind(m.LINEAR,m.CLAMP_TO_EDGE)}for(var v=0,_=i;v<_.length;v+=1){var x=_[v],b=e.getTile(x);if(!c||b.patternsLoaded()){var w=b.getBucket(r);if(w){var S=w.programConfigurations.get(r.id),T=t.context.program.get(),E=t.useProgram(d,S),I=g||E.program!==T,C=u.constantOr(null);if(C&&b.imageAtlas){var k=b.imageAtlas,A=k.patternPositions[C.to.toString()],P=k.patternPositions[C.from.toString()];A&&P&&S.setConstantPatternPositions(A,P)}var M=l?(q=b,V=r,G=l,Z=h,W=void 0,H=(j=t).transform,W=j.lineAtlas,K=nn(q,H),X="round"===V.layout.get("line-cap"),Y=W.getDash(G.from,X),J=W.getDash(G.to,X),Q=Y.width*Z.fromScale,$=J.width*Z.toScale,mt.extend(rn(j,q,V),{u_patternscale_a:[K/Q,-Y.height/2],u_patternscale_b:[K/$,-J.height/2],u_sdfgamma:W.width/(256*Math.min(Q,$)*mt.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Y.y,u_tex_y_b:J.y,u_mix:Z.t})):c?(z=b,N=r,B=h,F=(R=t).transform,U=nn(z,F),{u_matrix:on(R,z,N),u_texsize:z.imageAtlasTexture.size,u_ratio:1/Br(z,1,F.zoom),u_device_pixel_ratio:mt.browser.devicePixelRatio,u_image:0,u_scale:[mt.browser.devicePixelRatio,U,B.fromScale,B.toScale],u_fade:B.t,u_units_to_pixels:[1/F.pixelsToGLUnits[0],1/F.pixelsToGLUnits[1]]}):p?(L=t,O=b,D=r,mt.extend(rn(L,O,D),{u_image:0})):rn(t,b,r);l&&(I||t.lineAtlas.dirty)?(f.activeTexture.set(m.TEXTURE0),t.lineAtlas.bind(f)):c&&(f.activeTexture.set(m.TEXTURE0),b.imageAtlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE),S.updatePatternPaintBuffers(h)),E.draw(f,m.TRIANGLES,a,t.stencilModeForClipping(x),s,ir.disabled,M,r.id,w.layoutVertexBuffer,w.indexBuffer,w.segments,r.paint,t.transform.zoom,S),g=!1}}}}}var L,O,D,R,z,N,B,F,U,j,q,V,G,Z,H,W,K,X,Y,J,Q,$},fill:function(t,e,r,i){var n=r.paint.get("fill-color"),o=r.paint.get("fill-opacity");if(0!==o.constantOr(1)){var a=t.colorModeForRenderPass(),s=r.paint.get("fill-pattern"),l=t.opaquePassEnabledForLayer()&&!s.constantOr(1)&&1===n.constantOr(mt.Color.transparent).a&&1===o.constantOr(0)?"opaque":"translucent";if(t.renderPass===l){var u=t.depthModeForSublayer(1,"opaque"===t.renderPass?tr.ReadWrite:tr.ReadOnly);vn(t,e,r,i,u,a,!1)}if("translucent"===t.renderPass&&r.paint.get("fill-antialias")){var c=t.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,tr.ReadOnly);vn(t,e,r,i,c,a,!0)}}},"fill-extrusion":function(t,e,r,i){var n=r.paint.get("fill-extrusion-opacity");if(0!==n&&"translucent"===t.renderPass){var o=new tr(t.context.gl.LEQUAL,tr.ReadWrite,t.depthRangeFor3D);if(1!==n||r.paint.get("fill-extrusion-pattern").constantOr(1))_n(t,e,r,i,o,er.disabled,rr.disabled),_n(t,e,r,i,o,t.stencilModeFor3D(),t.colorModeForRenderPass());else{var a=t.colorModeForRenderPass();_n(t,e,r,i,o,er.disabled,a)}}},hillshade:function(t,e,r,i){if("offscreen"===t.renderPass||"translucent"===t.renderPass){for(var n=t.context,o=e.getSource().maxzoom,a=t.depthModeForSublayer(0,tr.ReadOnly),s=er.disabled,l=t.colorModeForRenderPass(),u=0,c=i;u<c.length;u+=1){var p=c[u],h=e.getTile(p);h.needsHillshadePrepare&&"offscreen"===t.renderPass?bn(t,h,r,o,a,s,l):"translucent"===t.renderPass&&xn(t,h,r,a,s,l)}n.viewport.set([0,0,t.width,t.height])}},raster:function(t,e,r,i){if("translucent"===t.renderPass&&0!==r.paint.get("raster-opacity"))for(var n=t.context,o=n.gl,a=e.getSource(),s=t.useProgram("raster"),l=er.disabled,u=t.colorModeForRenderPass(),c=i.length&&i[0].overscaledZ,p=!t.options.moving,h=0,d=i;h<d.length;h+=1){var f=d[h],m=t.depthModeForSublayer(f.overscaledZ-c,1===r.paint.get("raster-opacity")?tr.ReadWrite:tr.ReadOnly,o.LESS),g=e.getTile(f),y=t.transform.calculatePosMatrix(f.toUnwrapped(),p);g.registerFadeDuration(r.paint.get("raster-fade-duration"));var v=e.findLoadedParent(f,0),_=wn(g,v,e,r,t.transform),x=void 0,b=void 0,w="nearest"===r.paint.get("raster-resampling")?o.NEAREST:o.LINEAR;n.activeTexture.set(o.TEXTURE0),g.texture.bind(w,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),n.activeTexture.set(o.TEXTURE1),v?(v.texture.bind(w,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),x=Math.pow(2,v.tileID.overscaledZ-g.tileID.overscaledZ),b=[g.tileID.canonical.x*x%1,g.tileID.canonical.y*x%1]):g.texture.bind(w,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST);var S=an(y,b||[0,0],x||1,_,r);a instanceof B?s.draw(n,o.TRIANGLES,m,l,u,ir.disabled,S,r.id,a.boundsBuffer,t.quadTriangleIndexBuffer,a.boundsSegments):g.maskedBoundsBuffer&&g.maskedIndexBuffer&&g.segments?s.draw(n,o.TRIANGLES,m,l,u,ir.disabled,S,r.id,g.maskedBoundsBuffer,g.maskedIndexBuffer,g.segments,r.paint,t.transform.zoom):s.draw(n,o.TRIANGLES,m,l,u,ir.disabled,S,r.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}},background:function(t,e,r){var i,n,o,a,s,l,u,c,p,h,d,f,m,g,y,v,_,x,b,w=r.paint.get("background-color"),S=r.paint.get("background-opacity");if(0!==S){var T=t.context,E=T.gl,I=t.transform,C=I.tileSize,k=r.paint.get("background-pattern");if(!t.isPatternMissing(k)){var A=!k&&1===w.a&&1===S&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass===A){var P=er.disabled,M=t.depthModeForSublayer(0,"opaque"==A?tr.ReadWrite:tr.ReadOnly),L=t.colorModeForRenderPass(),O=t.useProgram(k?"backgroundPattern":"background"),D=I.coveringTiles({tileSize:C});k&&(T.activeTexture.set(E.TEXTURE0),t.imageManager.bind(t.context));for(var R=r.getCrossfadeParameters(),z=0,N=D;z<N.length;z+=1){var B=N[z],F=t.transform.calculatePosMatrix(B.toUnwrapped()),U=k?(i=F,n=S,o=t,a=k,s={tileID:B,tileSize:C},l=R,b=x=_=v=y=g=m=f=d=h=p=c=u=void 0,mt.extend((u=a,c=l,h=s,d=(p=o).imageManager.getPattern(u.from.toString()),f=p.imageManager.getPattern(u.to.toString()),m=p.imageManager.getPixelSize(),g=m.width,y=m.height,v=Math.pow(2,h.tileID.overscaledZ),_=h.tileSize*Math.pow(2,p.transform.tileZoom)/v,x=_*(h.tileID.canonical.x+h.tileID.wrap*v),b=_*h.tileID.canonical.y,{u_image:0,u_pattern_tl_a:d.tl,u_pattern_br_a:d.br,u_pattern_tl_b:f.tl,u_pattern_br_b:f.br,u_texsize:[g,y],u_mix:c.t,u_pattern_size_a:d.displaySize,u_pattern_size_b:f.displaySize,u_scale_a:c.fromScale,u_scale_b:c.toScale,u_tile_units_to_pixels:1/Br(h,1,p.transform.tileZoom),u_pixel_coord_upper:[x>>16,b>>16],u_pixel_coord_lower:[65535&x,65535&b]}),{u_matrix:i,u_opacity:n})):{u_matrix:F,u_opacity:S,u_color:w};O.draw(T,E.TRIANGLES,M,P,L,ir.disabled,U,r.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}}}},debug:function(t,e,r){for(var i=0;i<r.length;i++)Sn(t,e,r[i])},custom:function(t,e,r){var i=t.context,n=r.implementation;if("offscreen"===t.renderPass){var o=n.prerender;o&&(t.setCustomLayerDefaults(),i.setColorMode(t.colorModeForRenderPass()),o.call(n,i.gl,t.transform.customLayerMatrix()),i.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),i.setColorMode(t.colorModeForRenderPass()),i.setStencilMode(er.disabled);var a="3d"===n.renderingMode?new tr(t.context.gl.LEQUAL,tr.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,tr.ReadOnly);i.setDepthMode(a),n.render(i.gl,t.transform.customLayerMatrix()),i.setDirty(),t.setBaseState(),i.bindFramebuffer.set(null)}}};function Cn(t,e){if(t.y>e.y){var r=t;t=e,e=r}return{x0:t.x,y0:t.y,x1:e.x,y1:e.y,dx:e.x-t.x,dy:e.y-t.y}}function kn(t,e,r,i,n){var o=Math.max(r,Math.floor(e.y0)),a=Math.min(i,Math.ceil(e.y1));if(t.x0===e.x0&&t.y0===e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var l=t.dx/t.dy,u=e.dx/e.dy,c=0<t.dx,p=e.dx<0,h=o;h<a;h++){var d=l*Math.max(0,Math.min(t.dy,h+c-t.y0))+t.x0,f=u*Math.max(0,Math.min(e.dy,h+p-e.y0))+e.x0;n(Math.floor(f),Math.ceil(d),h)}}function An(t,e,r,i,n,o){var a,s=Cn(t,e),l=Cn(e,r),u=Cn(r,t);s.dy>l.dy&&(a=s,s=l,l=a),s.dy>u.dy&&(a=s,s=u,u=a),l.dy>u.dy&&(a=l,l=u,u=a),s.dy&&kn(u,s,i,n,o),l.dy&&kn(u,l,i,n,o)}function Pn(t,e,r){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===r||r,this._minZoom=t||0,this._maxZoom=e||22,this.setMaxBounds(),this.width=0,this.height=0,this._center=new mt.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._posMatrixCache={},this._alignedPosMatrixCache={}}Tn.prototype.resize=function(t,e){var r=this.context.gl;if(this.width=t*mt.browser.devicePixelRatio,this.height=e*mt.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var i=0,n=this.style._order;i<n.length;i+=1){var o=n[i];this.style._layers[o].resize()}this.depthRbo&&(r.deleteRenderbuffer(this.depthRbo),this.depthRbo=null)},Tn.prototype.setup=function(){var t=this.context,e=new mt.StructArrayLayout2i4;e.emplaceBack(0,0),e.emplaceBack(mt.EXTENT,0),e.emplaceBack(0,mt.EXTENT),e.emplaceBack(mt.EXTENT,mt.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(e,mi.members),this.tileExtentSegments=mt.SegmentVector.simpleSegment(0,0,4,2);var r=new mt.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(mt.EXTENT,0),r.emplaceBack(0,mt.EXTENT),r.emplaceBack(mt.EXTENT,mt.EXTENT),this.debugBuffer=t.createVertexBuffer(r,mi.members),this.debugSegments=mt.SegmentVector.simpleSegment(0,0,4,5);var i=new mt.StructArrayLayout4i8;i.emplaceBack(0,0,0,0),i.emplaceBack(mt.EXTENT,0,mt.EXTENT,0),i.emplaceBack(0,mt.EXTENT,0,mt.EXTENT),i.emplaceBack(mt.EXTENT,mt.EXTENT,mt.EXTENT,mt.EXTENT),this.rasterBoundsBuffer=t.createVertexBuffer(i,mt.rasterBoundsAttributes.members),this.rasterBoundsSegments=mt.SegmentVector.simpleSegment(0,0,4,2);var n=new mt.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(1,0),n.emplaceBack(0,1),n.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(n,mi.members),this.viewportSegments=mt.SegmentVector.simpleSegment(0,0,4,2);var o=new mt.StructArrayLayout1ui2;o.emplaceBack(0),o.emplaceBack(1),o.emplaceBack(3),o.emplaceBack(2),o.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(o);var a=new mt.StructArrayLayout3ui6;a.emplaceBack(0,1,2),a.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(a);var s=this.context.gl;this.stencilClearMode=new er({func:s.ALWAYS,mask:0},0,255,s.ZERO,s.ZERO,s.ZERO)},Tn.prototype.clearStencil=function(){var t=this.context,e=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var r=mt.create();mt.ortho(r,0,this.width,this.height,0,0,1),mt.scale(r,r,[e.drawingBufferWidth,e.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,e.TRIANGLES,tr.disabled,this.stencilClearMode,rr.disabled,ir.disabled,Ji(r),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Tn.prototype._renderTileClippingMasks=function(t,e){if(this.currentStencilSource!==t.source&&t.isTileClipped()&&e&&e.length){this.currentStencilSource=t.source;var r=this.context,i=r.gl;256<this.nextStencilID+e.length&&this.clearStencil(),r.setColorMode(rr.disabled),r.setDepthMode(tr.disabled);var n=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var o=0,a=e;o<a.length;o+=1){var s=a[o],l=this._tileClippingMaskIDs[s.key]=this.nextStencilID++;n.draw(r,i.TRIANGLES,tr.disabled,new er({func:i.ALWAYS,mask:0},l,255,i.KEEP,i.KEEP,i.REPLACE),rr.disabled,ir.disabled,Ji(s.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Tn.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,256<this.nextStencilID+1&&this.clearStencil();var t=this.nextStencilID++,e=this.context.gl;return new er({func:e.NOTEQUAL,mask:255},t,255,e.KEEP,e.KEEP,e.REPLACE)},Tn.prototype.stencilModeForClipping=function(t){var e=this.context.gl;return new er({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)},Tn.prototype.colorModeForRenderPass=function(){var t=this.context.gl;return this._showOverdrawInspector?new rr([t.CONSTANT_COLOR,t.ONE],new mt.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?rr.unblended:rr.alphaBlended},Tn.prototype.depthModeForSublayer=function(t,e,r){if(!this.opaquePassEnabledForLayer())return tr.disabled;var i=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new tr(r||this.context.gl.LEQUAL,e,[i,i])},Tn.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Tn.prototype.render=function(t,e){this.style=t,this.options=e,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(mt.browser.now()),this.imageManager.beginFrame();var r=this.style._order,i=this.style.sourceCaches;for(var n in i){var o=i[n];o.used&&o.prepare(this.context)}var a={},s={},l={};for(var u in i){var c=i[u];a[u]=c.getVisibleCoordinates(),s[u]=a[u].slice().reverse(),l[u]=c.getVisibleCoordinates(!0).reverse()}for(var p in i){var h=i[p],d=h.getSource();if("raster"===d.type||"raster-dem"===d.type){for(var f=[],m=0,g=a[p];m<g.length;m+=1){var y=g[m];f.push(h.getTile(y))}un(f,this.context)}}this.opaquePassCutoff=1/0;for(var v=0;v<r.length;v++){var _=r[v];if(this.style._layers[_].is3D()){this.opaquePassCutoff=v;break}}this.renderPass="offscreen",this.depthRboNeedsClear=!0;for(var x=0,b=r;x<b.length;x+=1){var w=b[x],S=this.style._layers[w];if(S.hasOffscreenPass()&&!S.isHidden(this.transform.zoom)){var T=s[S.source];"custom"!==S.type&&!T.length||this.renderLayer(this,i[S.source],S,T)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:e.showOverdrawInspector?mt.Color.black:mt.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=e.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=r.length-1;0<=this.currentLayer;this.currentLayer--){var E=this.style._layers[r[this.currentLayer]],I=i[E.source],C=a[E.source];this._renderTileClippingMasks(E,C),this.renderLayer(this,I,E,C)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){var k=this.style._layers[r[this.currentLayer]],A=i[k.source],P=("symbol"===k.type?l:s)[k.source];this._renderTileClippingMasks(k,a[k.source]),this.renderLayer(this,A,k,P)}if(this.options.showTileBoundaries)for(var M in i){In.debug(this,i[M],a[M]);break}this.context.setDefault()},Tn.prototype.setupOffscreenDepthRenderbuffer=function(){var t=this.context;this.depthRbo||(this.depthRbo=t.createRenderbuffer(t.gl.DEPTH_COMPONENT16,this.width,this.height))},Tn.prototype.renderLayer=function(t,e,r,i){r.isHidden(this.transform.zoom)||"background"!==r.type&&"custom"!==r.type&&!i.length||(this.id=r.id,In[r.type](t,e,r,i,this.style.placement.variableOffsets))},Tn.prototype.translatePosMatrix=function(t,e,r,i,n){if(!r[0]&&!r[1])return t;var o=n?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(o){var a=Math.sin(o),s=Math.cos(o);r=[r[0]*s-r[1]*a,r[0]*a+r[1]*s]}var l=[n?r[0]:Br(e,r[0],this.transform.zoom),n?r[1]:Br(e,r[1],this.transform.zoom),0],u=new Float32Array(16);return mt.translate(u,t,l),u},Tn.prototype.saveTileTexture=function(t){var e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]},Tn.prototype.getTileTexture=function(t){var e=this._tileTextures[t];return e&&0<e.length?e.pop():null},Tn.prototype.isPatternMissing=function(t){if(!t)return!1;var e=this.imageManager.getPattern(t.from.toString()),r=this.imageManager.getPattern(t.to.toString());return!e||!r},Tn.prototype.useProgram=function(t,e){void 0===e&&(e=this.emptyProgramConfiguration),this.cache=this.cache||{};var r=""+t+(e.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[r]||(this.cache[r]=new Gi(this.context,Vi[t],e,ln[t],this._showOverdrawInspector)),this.cache[r]},Tn.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Tn.prototype.setBaseState=function(){var t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)};var Mn={minZoom:{configurable:!0},maxZoom:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerPoint:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};function Ln(){var t,e,r,i;mt.bindAll(["_onHashChange","_updateHash"],this),this._updateHash=(t=this._updateHashUnthrottled.bind(this),e=!1,r=null,i=function(){r=null,e&&(t(),r=setTimeout(i,300),e=!1)},function(){return e=!0,r||i(),r})}function On(t){this._map=t,this._el=t.getCanvasContainer(),this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,mt.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)}Pn.prototype.clone=function(){var t=new Pn(this._minZoom,this._maxZoom,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._calcMatrices(),t},Mn.minZoom.get=function(){return this._minZoom},Mn.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},Mn.maxZoom.get=function(){return this._maxZoom},Mn.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},Mn.renderWorldCopies.get=function(){return this._renderWorldCopies},Mn.renderWorldCopies.set=function(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t},Mn.worldSize.get=function(){return this.tileSize*this.scale},Mn.centerPoint.get=function(){return this.size._div(2)},Mn.size.get=function(){return new mt.Point(this.width,this.height)},Mn.bearing.get=function(){return-this.angle/Math.PI*180},Mn.bearing.set=function(t){var e=-mt.wrap(t,-180,180)*Math.PI/180;this.angle!==e&&(this._unmodified=!1,this.angle=e,this._calcMatrices(),this.rotationMatrix=mt.create$2(),mt.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Mn.pitch.get=function(){return this._pitch/Math.PI*180},Mn.pitch.set=function(t){var e=mt.clamp(t,0,60)/180*Math.PI;this._pitch!==e&&(this._unmodified=!1,this._pitch=e,this._calcMatrices())},Mn.fov.get=function(){return this._fov/Math.PI*180},Mn.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},Mn.zoom.get=function(){return this._zoom},Mn.zoom.set=function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())},Mn.center.get=function(){return this._center},Mn.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},Pn.prototype.coveringZoomLevel=function(t){return(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize))},Pn.prototype.getVisibleUnwrappedCoordinates=function(t){var e=[new mt.UnwrappedTileID(0,t)];if(this._renderWorldCopies)for(var r=this.pointCoordinate(new mt.Point(0,0)),i=this.pointCoordinate(new mt.Point(this.width,0)),n=this.pointCoordinate(new mt.Point(this.width,this.height)),o=this.pointCoordinate(new mt.Point(0,this.height)),a=Math.floor(Math.min(r.x,i.x,n.x,o.x)),s=Math.floor(Math.max(r.x,i.x,n.x,o.x)),l=a-1;l<=s+1;l++)0!==l&&e.push(new mt.UnwrappedTileID(l,t));return e},Pn.prototype.coveringTiles=function(t){var e=this.coveringZoomLevel(t),r=e;if(void 0!==t.minzoom&&e<t.minzoom)return[];void 0!==t.maxzoom&&e>t.maxzoom&&(e=t.maxzoom);var i=mt.MercatorCoordinate.fromLngLat(this.center),n=Math.pow(2,e),o=new mt.Point(n*i.x-.5,n*i.y-.5);return function(s,t,l,u){void 0===u&&(u=!0);var c=1<<s,p={};function e(t,e,r){var i,n,o,a;if(0<=r&&r<=c)for(i=t;i<e;i++)n=Math.floor(i/c),o=(i%c+c)%c,0!==n&&!0!==u||(a=new mt.OverscaledTileID(l,n,s,o,r),p[a.key]=a)}var r=t.map(function(t){return new mt.Point(t.x,t.y)._mult(c)});return An(r[0],r[1],r[2],0,c,e),An(r[2],r[3],r[0],0,c,e),Object.keys(p).map(function(t){return p[t]})}(e,[this.pointCoordinate(new mt.Point(0,0)),this.pointCoordinate(new mt.Point(this.width,0)),this.pointCoordinate(new mt.Point(this.width,this.height)),this.pointCoordinate(new mt.Point(0,this.height))],t.reparseOverscaled?r:e,this._renderWorldCopies).sort(function(t,e){return o.dist(t.canonical)-o.dist(e.canonical)})},Pn.prototype.resize=function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()},Mn.unmodified.get=function(){return this._unmodified},Pn.prototype.zoomScale=function(t){return Math.pow(2,t)},Pn.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},Pn.prototype.project=function(t){var e=mt.clamp(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new mt.Point(mt.mercatorXfromLng(t.lng)*this.worldSize,mt.mercatorYfromLat(e)*this.worldSize)},Pn.prototype.unproject=function(t){return new mt.MercatorCoordinate(t.x/this.worldSize,t.y/this.worldSize).toLngLat()},Mn.point.get=function(){return this.project(this.center)},Pn.prototype.setLocationAtPoint=function(t,e){var r=this.pointCoordinate(e),i=this.pointCoordinate(this.centerPoint),n=this.locationCoordinate(t),o=new mt.MercatorCoordinate(n.x-(r.x-i.x),n.y-(r.y-i.y));this.center=this.coordinateLocation(o),this._renderWorldCopies&&(this.center=this.center.wrap())},Pn.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},Pn.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},Pn.prototype.locationCoordinate=function(t){return mt.MercatorCoordinate.fromLngLat(t)},Pn.prototype.coordinateLocation=function(t){return t.toLngLat()},Pn.prototype.pointCoordinate=function(t){var e=[t.x,t.y,0,1],r=[t.x,t.y,1,1];mt.transformMat4(e,e,this.pixelMatrixInverse),mt.transformMat4(r,r,this.pixelMatrixInverse);var i=e[3],n=r[3],o=e[0]/i,a=r[0]/n,s=e[1]/i,l=r[1]/n,u=e[2]/i,c=r[2]/n,p=u==c?0:(0-u)/(c-u);return new mt.MercatorCoordinate(mt.number(o,a,p)/this.worldSize,mt.number(s,l,p)/this.worldSize)},Pn.prototype.coordinatePoint=function(t){var e=[t.x*this.worldSize,t.y*this.worldSize,0,1];return mt.transformMat4(e,e,this.pixelMatrix),new mt.Point(e[0]/e[3],e[1]/e[3])},Pn.prototype.getBounds=function(){return(new mt.LngLatBounds).extend(this.pointLocation(new mt.Point(0,0))).extend(this.pointLocation(new mt.Point(this.width,0))).extend(this.pointLocation(new mt.Point(this.width,this.height))).extend(this.pointLocation(new mt.Point(0,this.height)))},Pn.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new mt.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Pn.prototype.setMaxBounds=function(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Pn.prototype.calculatePosMatrix=function(t,e){void 0===e&&(e=!1);var r=t.key,i=e?this._alignedPosMatrixCache:this._posMatrixCache;if(i[r])return i[r];var n=t.canonical,o=this.worldSize/this.zoomScale(n.z),a=n.x+Math.pow(2,n.z)*t.wrap,s=mt.identity(new Float64Array(16));return mt.translate(s,s,[a*o,n.y*o,0]),mt.scale(s,s,[o/mt.EXTENT,o/mt.EXTENT,1]),mt.multiply(s,e?this.alignedProjMatrix:this.projMatrix,s),i[r]=new Float32Array(s),i[r]},Pn.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Pn.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var t,e,r,i,n=-90,o=90,a=-180,s=180,l=this.size,u=this._unmodified;if(this.latRange){var c=this.latRange;n=mt.mercatorYfromLat(c[1])*this.worldSize,t=(o=mt.mercatorYfromLat(c[0])*this.worldSize)-n<l.y?l.y/(o-n):0}if(this.lngRange){var p=this.lngRange;a=mt.mercatorXfromLng(p[0])*this.worldSize,e=(s=mt.mercatorXfromLng(p[1])*this.worldSize)-a<l.x?l.x/(s-a):0}var h=this.point,d=Math.max(e||0,t||0);if(d)return this.center=this.unproject(new mt.Point(e?(s+a)/2:h.x,t?(o+n)/2:h.y)),this.zoom+=this.scaleZoom(d),this._unmodified=u,void(this._constraining=!1);if(this.latRange){var f=h.y,m=l.y/2;f-m<n&&(i=n+m),o<f+m&&(i=o-m)}if(this.lngRange){var g=h.x,y=l.x/2;g-y<a&&(r=a+y),s<g+y&&(r=s-y)}void 0===r&&void 0===i||(this.center=this.unproject(new mt.Point(void 0!==r?r:h.x,void 0!==i?i:h.y))),this._unmodified=u,this._constraining=!1}},Pn.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var t=this._fov/2,e=Math.PI/2+this._pitch,r=Math.sin(t)*this.cameraToCenterDistance/Math.sin(Math.PI-e-t),i=this.point,n=i.x,o=i.y,a=1.01*(Math.cos(Math.PI/2-this._pitch)*r+this.cameraToCenterDistance),s=this.height/50,l=new Float64Array(16);mt.perspective(l,this._fov,this.width/this.height,s,a),mt.scale(l,l,[1,-1,1]),mt.translate(l,l,[0,0,-this.cameraToCenterDistance]),mt.rotateX(l,l,this._pitch),mt.rotateZ(l,l,this.angle),mt.translate(l,l,[-n,-o,0]),this.mercatorMatrix=mt.scale([],l,[this.worldSize,this.worldSize,this.worldSize]),mt.scale(l,l,[1,1,mt.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=l;var u=this.width%2/2,c=this.height%2/2,p=Math.cos(this.angle),h=Math.sin(this.angle),d=n-Math.round(n)+p*u+h*c,f=o-Math.round(o)+p*c+h*u,m=new Float64Array(l);if(mt.translate(m,m,[.5<d?d-1:d,.5<f?f-1:f,0]),this.alignedProjMatrix=m,l=mt.create(),mt.scale(l,l,[this.width/2,-this.height/2,1]),mt.translate(l,l,[1,-1,0]),this.labelPlaneMatrix=l,l=mt.create(),mt.scale(l,l,[1,-1,1]),mt.translate(l,l,[-1,-1,0]),mt.scale(l,l,[2/this.width,2/this.height,1]),this.glCoordMatrix=l,this.pixelMatrix=mt.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(l=mt.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=l,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Pn.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var t=this.pointCoordinate(new mt.Point(0,0)),e=[t.x*this.worldSize,t.y*this.worldSize,0,1];return mt.transformMat4(e,e,this.pixelMatrix)[3]/this.cameraToCenterDistance},Pn.prototype.getCameraPoint=function(){var t=this._pitch,e=Math.tan(t)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new mt.Point(0,e))},Pn.prototype.getCameraQueryGeometry=function(t){var e=this.getCameraPoint();if(1===t.length)return[t[0],e];for(var r=e.x,i=e.y,n=e.x,o=e.y,a=0,s=t;a<s.length;a+=1){var l=s[a];r=Math.min(r,l.x),i=Math.min(i,l.y),n=Math.max(n,l.x),o=Math.max(o,l.y)}return[new mt.Point(r,i),new mt.Point(n,i),new mt.Point(n,o),new mt.Point(r,o),new mt.Point(r,i)]},Object.defineProperties(Pn.prototype,Mn),Ln.prototype.addTo=function(t){return this._map=t,mt.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Ln.prototype.remove=function(){return mt.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Ln.prototype.getHashString=function(t){var e=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,i=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),n=Math.pow(10,i),o=Math.round(e.lng*n)/n,a=Math.round(e.lat*n)/n,s=this._map.getBearing(),l=this._map.getPitch(),u="";return u+=t?"#/"+o+"/"+a+"/"+r:"#"+r+"/"+a+"/"+o,(s||l)&&(u+="/"+Math.round(10*s)/10),l&&(u+="/"+Math.round(l)),u},Ln.prototype._onHashChange=function(){var t=mt.window.location.hash.replace("#","").split("/");return 3<=t.length&&(this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:+(t[3]||0),pitch:+(t[4]||0)}),!0)},Ln.prototype._updateHashUnthrottled=function(){var t=this.getHashString();try{mt.window.history.replaceState(mt.window.history.state,"",t)}catch(t){}};var Dn=function(a){function t(t,e,r,i){void 0===i&&(i={});var n=v.mousePos(e.getCanvasContainer(),r),o=e.unproject(n);a.call(this,t,mt.extend({point:n,lngLat:o,originalEvent:r},i)),this._defaultPrevented=!1,this.target=e}a&&(t.__proto__=a);var e={defaultPrevented:{configurable:!0}};return((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.preventDefault=function(){this._defaultPrevented=!0},e.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(t.prototype,e),t}(mt.Event),Rn=function(s){function t(t,e,r){var i=v.touchPos(e.getCanvasContainer(),r),n=i.map(function(t){return e.unproject(t)}),o=i.reduce(function(t,e,r,i){return t.add(e.div(i.length))},new mt.Point(0,0)),a=e.unproject(o);s.call(this,t,{points:i,point:o,lngLats:n,lngLat:a,originalEvent:r}),this._defaultPrevented=!1}s&&(t.__proto__=s);var e={defaultPrevented:{configurable:!0}};return((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.preventDefault=function(){this._defaultPrevented=!0},e.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(t.prototype,e),t}(mt.Event),zn=function(i){function t(t,e,r){i.call(this,t,{originalEvent:r}),this._defaultPrevented=!1}i&&(t.__proto__=i);var e={defaultPrevented:{configurable:!0}};return((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.preventDefault=function(){this._defaultPrevented=!0},e.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(t.prototype,e),t}(mt.Event);function Nn(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1,mt.bindAll(["_onMouseMove","_onMouseUp","_onKeyDown"],this)}function Bn(t,e){this._map=t,this._el=e.element||t.getCanvasContainer(),this._state="disabled",this._button=e.button||"right",this._bearingSnap=e.bearingSnap||0,this._pitchWithRotate=!1!==e.pitchWithRotate,mt.bindAll(["onMouseDown","_onMouseMove","_onMouseUp","_onBlur","_onDragFrame"],this)}On.prototype.setZoomRate=function(t){this._defaultZoomRate=t},On.prototype.setWheelZoomRate=function(t){this._wheelZoomRate=t},On.prototype.isEnabled=function(){return!!this._enabled},On.prototype.isActive=function(){return!!this._active},On.prototype.isZooming=function(){return!!this._zooming},On.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},On.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},On.prototype.onWheel=function(t){if(this.isEnabled()){var e=t.deltaMode===mt.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY,r=mt.browser.now(),i=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==e&&e%4.000244140625==0?this._type="wheel":0!==e&&Math.abs(e)<4?this._type="trackpad":400<i?(this._type=null,this._lastValue=e,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(i*e)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,e+=this._lastValue)),t.shiftKey&&e&&(e/=4),this._type&&(this._lastWheelEvent=t,this._delta-=e,this.isActive()||this._start(t)),t.preventDefault()}},On.prototype._onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this._start(t)},On.prototype._start=function(t){if(this._delta){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0,this._map.fire(new mt.Event("movestart",{originalEvent:t})),this._map.fire(new mt.Event("zoomstart",{originalEvent:t}))),this._finishTimeout&&clearTimeout(this._finishTimeout);var e=v.mousePos(this._el,t);this._around=mt.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(e)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame))}},On.prototype._onScrollFrame=function(){var t=this;if(this._frameId=null,this.isActive()){var e=this._map.transform;if(0!==this._delta){var r="wheel"===this._type&&4.000244140625<Math.abs(this._delta)?this._wheelZoomRate:this._defaultZoomRate,i=2/(1+Math.exp(-Math.abs(this._delta*r)));this._delta<0&&0!==i&&(i=1/i);var n="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(n*i))),"wheel"===this._type&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var o="number"==typeof this._targetZoom?this._targetZoom:e.zoom,a=this._startZoom,s=this._easing,l=!1;if("wheel"===this._type&&a&&s){var u=Math.min((mt.browser.now()-this._lastWheelEventTime)/200,1),c=s(u);e.zoom=mt.number(a,o,c),u<1?this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame)):l=!0}else e.zoom=o,l=!0;e.setLocationAtPoint(this._around,this._aroundPoint),this._map.fire(new mt.Event("move",{originalEvent:this._lastWheelEvent})),this._map.fire(new mt.Event("zoom",{originalEvent:this._lastWheelEvent})),l&&(this._active=!1,this._finishTimeout=setTimeout(function(){t._zooming=!1,t._map.fire(new mt.Event("zoomend",{originalEvent:t._lastWheelEvent})),t._map.fire(new mt.Event("moveend",{originalEvent:t._lastWheelEvent})),delete t._targetZoom},200))}},On.prototype._smoothOutEasing=function(t){var e=mt.ease;if(this._prevEase){var r=this._prevEase,i=(mt.browser.now()-r.start)/r.duration,n=r.easing(.01+i)-r.easing(i),o=.27/Math.sqrt(n*n+1e-4)*.01,a=Math.sqrt(.0729-o*o);e=mt.bezier(o,a,.25,1)}return this._prevEase={start:mt.browser.now(),duration:t,easing:e},e},Nn.prototype.isEnabled=function(){return!!this._enabled},Nn.prototype.isActive=function(){return!!this._active},Nn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Nn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Nn.prototype.onMouseDown=function(t){this.isEnabled()&&t.shiftKey&&0===t.button&&(mt.window.document.addEventListener("mousemove",this._onMouseMove,!1),mt.window.document.addEventListener("keydown",this._onKeyDown,!1),mt.window.document.addEventListener("mouseup",this._onMouseUp,!1),v.disableDrag(),this._startPos=this._lastPos=v.mousePos(this._el,t),this._active=!0)},Nn.prototype._onMouseMove=function(t){var e=v.mousePos(this._el,t);if(!(this._lastPos.equals(e)||!this._box&&e.dist(this._startPos)<this._clickTolerance)){var r=this._startPos;this._lastPos=e,this._box||(this._box=v.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var i=Math.min(r.x,e.x),n=Math.max(r.x,e.x),o=Math.min(r.y,e.y),a=Math.max(r.y,e.y);v.setTransform(this._box,"translate("+i+"px,"+o+"px)"),this._box.style.width=n-i+"px",this._box.style.height=a-o+"px"}},Nn.prototype._onMouseUp=function(t){if(0===t.button){var e=this._startPos,r=v.mousePos(this._el,t);this._finish(),v.suppressClick(),e.x===r.x&&e.y===r.y?this._fireEvent("boxzoomcancel",t):this._map.fitScreenCoordinates(e,r,this._map.getBearing(),{linear:!0}).fire(new mt.Event("boxzoomend",{originalEvent:t}))}},Nn.prototype._onKeyDown=function(t){27===t.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",t))},Nn.prototype._finish=function(){this._active=!1,mt.window.document.removeEventListener("mousemove",this._onMouseMove,!1),mt.window.document.removeEventListener("keydown",this._onKeyDown,!1),mt.window.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(v.remove(this._box),this._box=null),v.enableDrag(),delete this._startPos,delete this._lastPos},Nn.prototype._fireEvent=function(t,e){return this._map.fire(new mt.Event(t,{originalEvent:e}))};var Fn=mt.bezier(0,0,.25,1);function Un(t,e){this._map=t,this._el=t.getCanvasContainer(),this._state="disabled",this._clickTolerance=e.clickTolerance||1,mt.bindAll(["_onMove","_onMouseUp","_onTouchEnd","_onBlur","_onDragFrame"],this)}Bn.prototype.isEnabled=function(){return"disabled"!==this._state},Bn.prototype.isActive=function(){return"active"===this._state},Bn.prototype.enable=function(){this.isEnabled()||(this._state="enabled")},Bn.prototype.disable=function(){if(this.isEnabled())switch(this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend"),this._pitchWithRotate&&this._fireEvent("pitchend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},Bn.prototype.onMouseDown=function(t){if("enabled"===this._state){var e="touchstart"===t.type;if(e)this._startTime=Date.now();else if("right"===this._button){if(this._eventButton=v.mouseButton(t),this._eventButton!==(t.ctrlKey?0:2))return}else{if(t.ctrlKey||0!==v.mouseButton(t))return;this._eventButton=0}v.disableDrag(),e?(mt.window.document.addEventListener("touchmove",this._onMouseMove,{capture:!0}),mt.window.document.addEventListener("touchend",this._onMouseUp)):(mt.window.document.addEventListener("mousemove",this._onMouseMove,{capture:!0}),mt.window.document.addEventListener("mouseup",this._onMouseUp)),mt.window.addEventListener("blur",this._onBlur),this._state="pending",this._inertia=[[mt.browser.now(),this._map.getBearing()]],this._startPos=this._prevPos=this._lastPos=v.mousePos(this._el,t),this._center=this._map.transform.centerPoint,t.preventDefault()}},Bn.prototype._onMouseMove=function(t){var e=v.mousePos(this._el,t);this._lastPos.equals(e)||(this._lastMoveEvent=t,this._lastPos=e,"pending"===this._state&&(this._state="active",this._fireEvent("rotatestart",t),this._fireEvent("movestart",t),this._pitchWithRotate&&this._fireEvent("pitchstart",t)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},Bn.prototype._onDragFrame=function(){this._frameId=null;var t=this._lastMoveEvent;if(t){var e=this._map.transform,r=this._prevPos,i=this._lastPos,n=.8*(r.x-i.x),o=-.5*(r.y-i.y),a=e.bearing-n,s=e.pitch-o,l=this._inertia,u=l[l.length-1];this._drainInertiaBuffer(),l.push([mt.browser.now(),this._map._normalizeBearing(a,u[1])]),e.bearing=a,this._pitchWithRotate&&(this._fireEvent("pitch",t),e.pitch=s),this._fireEvent("rotate",t),this._fireEvent("move",t),delete this._lastMoveEvent,this._prevPos=this._lastPos}},Bn.prototype._onMouseUp=function(t){if("touchend"===t.type&&this._startPos===this._lastPos&&Date.now()-this._startTime<300&&this._el.click(),v.mouseButton(t)===this._eventButton)switch(this._state){case"active":this._state="enabled",v.suppressClick(),this._unbind(),this._deactivate(),this._inertialRotate(t);break;case"pending":this._state="enabled",this._unbind()}},Bn.prototype._onBlur=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend",t),this._pitchWithRotate&&this._fireEvent("pitchend",t),this._fireEvent("moveend",t);break;case"pending":this._state="enabled",this._unbind()}},Bn.prototype._unbind=function(){mt.window.document.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),mt.window.document.removeEventListener("mouseup",this._onMouseUp),mt.window.document.removeEventListener("touchmove",this._onMouseMove,{capture:!0}),mt.window.document.removeEventListener("touchend",this._onMouseUp),mt.window.removeEventListener("blur",this._onBlur),v.enableDrag()},Bn.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._prevPos,delete this._lastPos},Bn.prototype._inertialRotate=function(t){var e=this;function r(){Math.abs(n)<e._bearingSnap?i.resetNorth({noMoveStart:!0},{originalEvent:t}):e._fireEvent("moveend",t),e._pitchWithRotate&&e._fireEvent("pitchend",t)}this._fireEvent("rotateend",t),this._drainInertiaBuffer();var i=this._map,n=i.getBearing(),o=this._inertia;if(o.length<2)r();else{var a=o[0],s=o[o.length-1],l=o[o.length-2],u=i._normalizeBearing(n,l[1]),c=s[1]-a[1],p=c<0?-1:1,h=(s[0]-a[0])/1e3;if(0!=c&&0!=h){var d=Math.abs(.25/h*c);180<d&&(d=180);var f=d/180;u+=p*d*(f/2),Math.abs(i._normalizeBearing(u,0))<this._bearingSnap&&(u=i._normalizeBearing(0,u)),i.rotateTo(u,{duration:1e3*f,easing:Fn,noMoveStart:!0},{originalEvent:t})}else r()}},Bn.prototype._fireEvent=function(t,e){return this._map.fire(new mt.Event(t,e?{originalEvent:e}:{}))},Bn.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=mt.browser.now();0<t.length&&160<e-t[0][0];)t.shift()};var jn=mt.bezier(0,0,.3,1);function qn(t){this._map=t,this._el=t.getCanvasContainer(),mt.bindAll(["_onKeyDown"],this)}function Vn(t){return t*(2-t)}function Gn(t){this._map=t,mt.bindAll(["_onDblClick","_onZoomEnd"],this)}function Zn(t){this._map=t,this._el=t.getCanvasContainer(),mt.bindAll(["_onMove","_onEnd","_onTouchFrame"],this)}Un.prototype.isEnabled=function(){return"disabled"!==this._state},Un.prototype.isActive=function(){return"active"===this._state},Un.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._state="enabled")},Un.prototype.disable=function(){if(this.isEnabled())switch(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("dragend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},Un.prototype.onMouseDown=function(t){"enabled"===this._state&&(t.ctrlKey||0!==v.mouseButton(t)||(v.addEventListener(mt.window.document,"mousemove",this._onMove,{capture:!0}),v.addEventListener(mt.window.document,"mouseup",this._onMouseUp),this._start(t)))},Un.prototype.onTouchStart=function(t){this.isEnabled()&&(t.touches&&1<t.touches.length&&("pending"===this._state||"active"===this._state)||(v.addEventListener(mt.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),v.addEventListener(mt.window.document,"touchend",this._onTouchEnd),this._start(t)))},Un.prototype._start=function(t){mt.window.addEventListener("blur",this._onBlur),this._state="pending",this._startPos=this._mouseDownPos=this._prevPos=this._lastPos=v.mousePos(this._el,t),this._startTouch=this._lastTouch=mt.window.TouchEvent&&t instanceof mt.window.TouchEvent?v.touchPos(this._el,t):null,this._inertia=[[mt.browser.now(),this._startPos]]},Un.prototype._touchesMatch=function(t,r){return!(!t||!r||t.length!==r.length)&&t.every(function(t,e){return r[e]===t})},Un.prototype._onMove=function(t){t.preventDefault();var e=mt.window.TouchEvent&&t instanceof mt.window.TouchEvent?v.touchPos(this._el,t):null,r=v.mousePos(this._el,t);(e?this._touchesMatch(this._lastTouch,e):this._lastPos.equals(r))||"pending"===this._state&&r.dist(this._mouseDownPos)<this._clickTolerance||(this._lastMoveEvent=t,this._lastPos=r,this._lastTouch=e,this._drainInertiaBuffer(),this._inertia.push([mt.browser.now(),this._lastPos]),"pending"===this._state&&(this._state="active",this._shouldStart=!0),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},Un.prototype._onDragFrame=function(){this._frameId=null;var t=this._lastMoveEvent;if(t)if(this._map.touchZoomRotate.isActive())this._abort(t);else if(this._shouldStart&&(this._fireEvent("dragstart",t),this._fireEvent("movestart",t),this._shouldStart=!1),this.isActive()){var e=this._map.transform;e.setLocationAtPoint(e.pointLocation(this._prevPos),this._lastPos),this._fireEvent("drag",t),this._fireEvent("move",t),this._prevPos=this._lastPos,delete this._lastMoveEvent}},Un.prototype._onMouseUp=function(t){if(0===v.mouseButton(t))switch(this._state){case"active":this._state="enabled",v.suppressClick(),this._unbind(),this._deactivate(),this._inertialPan(t);break;case"pending":this._state="enabled",this._unbind()}},Un.prototype._onTouchEnd=function(t){if(t.touches&&0!==t.touches.length)switch(this._state){case"pending":case"active":break;case"enabled":this.onTouchStart(t)}else switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._inertialPan(t);break;case"pending":this._state="enabled",this._unbind();break;case"enabled":this._unbind()}},Un.prototype._abort=function(t){switch(this._state){case"active":this._state="enabled",this._shouldStart||(this._fireEvent("dragend",t),this._fireEvent("moveend",t)),this._unbind(),this._deactivate(),mt.window.TouchEvent&&t instanceof mt.window.TouchEvent&&1<t.touches.length&&v.addEventListener(mt.window.document,"touchend",this._onTouchEnd);break;case"pending":this._state="enabled",this._unbind();break;case"enabled":this._unbind()}},Un.prototype._onBlur=function(t){this._abort(t)},Un.prototype._unbind=function(){v.removeEventListener(mt.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),v.removeEventListener(mt.window.document,"touchend",this._onTouchEnd),v.removeEventListener(mt.window.document,"mousemove",this._onMove,{capture:!0}),v.removeEventListener(mt.window.document,"mouseup",this._onMouseUp),v.removeEventListener(mt.window,"blur",this._onBlur)},Un.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._prevPos,delete this._mouseDownPos,delete this._lastPos,delete this._startTouch,delete this._lastTouch,delete this._shouldStart},Un.prototype._inertialPan=function(t){this._fireEvent("dragend",t),this._drainInertiaBuffer();var e=this._inertia;if(e.length<2)this._fireEvent("moveend",t);else{var r=e[e.length-1],i=e[0],n=r[1].sub(i[1]),o=(r[0]-i[0])/1e3;if(0==o||r[1].equals(i[1]))this._fireEvent("moveend",t);else{var a=n.mult(.3/o),s=a.mag();1400<s&&(s=1400,a._unit()._mult(s));var l=s/750,u=a.mult(-l/2);this._map.panBy(u,{duration:1e3*l,easing:jn,noMoveStart:!0},{originalEvent:t})}}},Un.prototype._fireEvent=function(t,e){return this._map.fire(new mt.Event(t,e?{originalEvent:e}:{}))},Un.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=mt.browser.now();0<t.length&&160<e-t[0][0];)t.shift()},qn.prototype.isEnabled=function(){return!!this._enabled},qn.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},qn.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},qn.prototype._onKeyDown=function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=0,r=0,i=0,n=0,o=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?r=-1:(t.preventDefault(),n=-1);break;case 39:t.shiftKey?r=1:(t.preventDefault(),n=1);break;case 38:t.shiftKey?i=1:(t.preventDefault(),o=-1);break;case 40:t.shiftKey?i=-1:(o=1,t.preventDefault());break;default:return}var a=this._map,s=a.getZoom(),l={duration:300,delayEndEvents:500,easing:Vn,zoom:e?Math.round(s)+e*(t.shiftKey?2:1):s,bearing:a.getBearing()+15*r,pitch:a.getPitch()+10*i,offset:[100*-n,100*-o],center:a.getCenter()};a.easeTo(l,{originalEvent:t})}},Gn.prototype.isEnabled=function(){return!!this._enabled},Gn.prototype.isActive=function(){return!!this._active},Gn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Gn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Gn.prototype.onTouchStart=function(t){var e=this;if(this.isEnabled()&&!(1<t.points.length))if(this._tapped){var r=t.points[0],i=this._tappedPoint;if(i&&i.dist(r)<=30){t.originalEvent.preventDefault();var n=function(){e._tapped&&e._zoom(t),e._map.off("touchcancel",o),e._resetTapped()},o=function(){e._map.off("touchend",n),e._resetTapped()};this._map.once("touchend",n),this._map.once("touchcancel",o)}else this._resetTapped()}else this._tappedPoint=t.points[0],this._tapped=setTimeout(function(){e._tapped=null,e._tappedPoint=null},300)},Gn.prototype._resetTapped=function(){clearTimeout(this._tapped),this._tapped=null,this._tappedPoint=null},Gn.prototype.onDblClick=function(t){this.isEnabled()&&(t.originalEvent.preventDefault(),this._zoom(t))},Gn.prototype._zoom=function(t){this._active=!0,this._map.on("zoomend",this._onZoomEnd),this._map.zoomTo(this._map.getZoom()+(t.originalEvent.shiftKey?-1:1),{around:t.lngLat},t)},Gn.prototype._onZoomEnd=function(){this._active=!1,this._map.off("zoomend",this._onZoomEnd)};var Hn=mt.bezier(0,0,.15,1);function Wn(t){void 0===t&&(t={}),this.options=t,mt.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)}Zn.prototype.isEnabled=function(){return!!this._enabled},Zn.prototype.enable=function(t){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around)},Zn.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._enabled=!1)},Zn.prototype.disableRotation=function(){this._rotationDisabled=!0},Zn.prototype.enableRotation=function(){this._rotationDisabled=!1},Zn.prototype.isActive=function(){return this.isEnabled()&&!!this._gestureIntent},Zn.prototype.onStart=function(t){if(this.isEnabled()&&2===t.touches.length){var e=v.mousePos(this._el,t.touches[0]),r=v.mousePos(this._el,t.touches[1]),i=e.add(r).div(2);this._startVec=e.sub(r),this._startAround=this._map.transform.pointLocation(i),this._gestureIntent=void 0,this._inertia=[],v.addEventListener(mt.window.document,"touchmove",this._onMove,{passive:!1}),v.addEventListener(mt.window.document,"touchend",this._onEnd)}},Zn.prototype._getTouchEventData=function(t){var e=v.mousePos(this._el,t.touches[0]),r=v.mousePos(this._el,t.touches[1]),i=e.sub(r);return{vec:i,center:e.add(r).div(2),scale:i.mag()/this._startVec.mag(),bearing:this._rotationDisabled?0:180*i.angleWith(this._startVec)/Math.PI}},Zn.prototype._onMove=function(t){if(2===t.touches.length){var e=this._getTouchEventData(t),r=e.vec,i=e.scale,n=e.bearing;if(!this._gestureIntent){var o=this._rotationDisabled&&1!==i||.15<Math.abs(1-i);10<Math.abs(n)?this._gestureIntent="rotate":o&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._map.fire(new mt.Event(this._gestureIntent+"start",{originalEvent:t})),this._map.fire(new mt.Event("movestart",{originalEvent:t})),this._startVec=r)}this._lastTouchEvent=t,this._frameId||(this._frameId=this._map._requestRenderFrame(this._onTouchFrame)),t.preventDefault()}},Zn.prototype._onTouchFrame=function(){this._frameId=null;var t=this._gestureIntent;if(t){var e=this._map.transform;this._startScale||(this._startScale=e.scale,this._startBearing=e.bearing);var r=this._getTouchEventData(this._lastTouchEvent),i=r.center,n=r.bearing,o=r.scale,a=e.pointLocation(i),s=e.locationPoint(a);"rotate"===t&&(e.bearing=this._startBearing+n),e.zoom=e.scaleZoom(this._startScale*o),e.setLocationAtPoint(this._startAround,s),this._map.fire(new mt.Event(t,{originalEvent:this._lastTouchEvent})),this._map.fire(new mt.Event("move",{originalEvent:this._lastTouchEvent})),this._drainInertiaBuffer(),this._inertia.push([mt.browser.now(),o,i])}},Zn.prototype._onEnd=function(t){v.removeEventListener(mt.window.document,"touchmove",this._onMove,{passive:!1}),v.removeEventListener(mt.window.document,"touchend",this._onEnd);var e=this._gestureIntent,r=this._startScale;if(this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._gestureIntent,delete this._startScale,delete this._startBearing,delete this._lastTouchEvent,e){this._map.fire(new mt.Event(e+"end",{originalEvent:t})),this._drainInertiaBuffer();var i=this._inertia,n=this._map;if(i.length<2)n.snapToNorth({},{originalEvent:t});else{var o=i[i.length-1],a=i[0],s=n.transform.scaleZoom(r*o[1]),l=n.transform.scaleZoom(r*a[1]),u=s-l,c=(o[0]-a[0])/1e3,p=o[2];if(0!=c&&s!==l){var h=.15*u/c;2.5<Math.abs(h)&&(h=0<h?2.5:-2.5);var d=1e3*Math.abs(h/(12*.15)),f=s+h*d/2e3;f<0&&(f=0),n.easeTo({zoom:f,duration:d,easing:Hn,around:this._aroundCenter?n.getCenter():n.unproject(p),noMoveStart:!0},{originalEvent:t})}else n.snapToNorth({},{originalEvent:t})}}},Zn.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=mt.browser.now();2<t.length&&160<e-t[0][0];)t.shift()};var Kn,Xn={scrollZoom:On,boxZoom:Nn,dragRotate:Bn,dragPan:Un,keyboard:qn,doubleClickZoom:Gn,touchZoomRotate:Zn},Yn=((Kn=mt.Evented)&&(Jn.__proto__=Kn),((Jn.prototype=Object.create(Kn&&Kn.prototype)).constructor=Jn).prototype.getCenter=function(){return new mt.LngLat(this.transform.center.lng,this.transform.center.lat)},Jn.prototype.setCenter=function(t,e){return this.jumpTo({center:t},e)},Jn.prototype.panBy=function(t,e,r){return t=mt.Point.convert(t).mult(-1),this.panTo(this.transform.center,mt.extend({offset:t},e),r)},Jn.prototype.panTo=function(t,e,r){return this.easeTo(mt.extend({center:t},e),r)},Jn.prototype.getZoom=function(){return this.transform.zoom},Jn.prototype.setZoom=function(t,e){return this.jumpTo({zoom:t},e),this},Jn.prototype.zoomTo=function(t,e,r){return this.easeTo(mt.extend({zoom:t},e),r)},Jn.prototype.zoomIn=function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},Jn.prototype.zoomOut=function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},Jn.prototype.getBearing=function(){return this.transform.bearing},Jn.prototype.setBearing=function(t,e){return this.jumpTo({bearing:t},e),this},Jn.prototype.rotateTo=function(t,e,r){return this.easeTo(mt.extend({bearing:t},e),r)},Jn.prototype.resetNorth=function(t,e){return this.rotateTo(0,mt.extend({duration:1e3},t),e),this},Jn.prototype.resetNorthPitch=function(t,e){return this.easeTo(mt.extend({bearing:0,pitch:0,duration:1e3},t),e),this},Jn.prototype.snapToNorth=function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this},Jn.prototype.getPitch=function(){return this.transform.pitch},Jn.prototype.setPitch=function(t,e){return this.jumpTo({pitch:t},e),this},Jn.prototype.cameraForBounds=function(t,e){return t=mt.LngLatBounds.convert(t),this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),0,e)},Jn.prototype._cameraForBoxAndBearing=function(t,e,r,i){if("number"==typeof(i=mt.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){var n=i.padding;i.padding={top:n,bottom:n,right:n,left:n}}if(mt.deepEqual(Object.keys(i.padding).sort(function(t,e){return t<e?-1:e<t?1:0}),["bottom","left","right","top"])){var o=this.transform,a=o.project(mt.LngLat.convert(t)),s=o.project(mt.LngLat.convert(e)),l=a.rotate(-r*Math.PI/180),u=s.rotate(-r*Math.PI/180),c=new mt.Point(Math.max(l.x,u.x),Math.max(l.y,u.y)),p=new mt.Point(Math.min(l.x,u.x),Math.min(l.y,u.y)),h=c.sub(p),d=(o.width-i.padding.left-i.padding.right)/h.x,f=(o.height-i.padding.top-i.padding.bottom)/h.y;if(!(f<0||d<0)){var m=Math.min(o.scaleZoom(o.scale*Math.min(d,f)),i.maxZoom),g=mt.Point.convert(i.offset),y=(i.padding.left-i.padding.right)/2,v=(i.padding.top-i.padding.bottom)/2,_=new mt.Point(g.x+y,g.y+v).mult(o.scale/o.zoomScale(m));return{center:o.unproject(a.add(s).div(2).sub(_)),zoom:m,bearing:r}}mt.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}else mt.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'")},Jn.prototype.fitBounds=function(t,e,r){return this._fitInternal(this.cameraForBounds(t,e),e,r)},Jn.prototype.fitScreenCoordinates=function(t,e,r,i,n){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(mt.Point.convert(t)),this.transform.pointLocation(mt.Point.convert(e)),r,i),i,n)},Jn.prototype._fitInternal=function(t,e,r){return t?(e=mt.extend(t,e)).linear?this.easeTo(e,r):this.flyTo(e,r):this},Jn.prototype.jumpTo=function(t,e){this.stop();var r=this.transform,i=!1,n=!1,o=!1;return"zoom"in t&&r.zoom!==+t.zoom&&(i=!0,r.zoom=+t.zoom),void 0!==t.center&&(r.center=mt.LngLat.convert(t.center)),"bearing"in t&&r.bearing!==+t.bearing&&(n=!0,r.bearing=+t.bearing),"pitch"in t&&r.pitch!==+t.pitch&&(o=!0,r.pitch=+t.pitch),this.fire(new mt.Event("movestart",e)).fire(new mt.Event("move",e)),i&&this.fire(new mt.Event("zoomstart",e)).fire(new mt.Event("zoom",e)).fire(new mt.Event("zoomend",e)),n&&this.fire(new mt.Event("rotatestart",e)).fire(new mt.Event("rotate",e)).fire(new mt.Event("rotateend",e)),o&&this.fire(new mt.Event("pitchstart",e)).fire(new mt.Event("pitch",e)).fire(new mt.Event("pitchend",e)),this.fire(new mt.Event("moveend",e))},Jn.prototype.easeTo=function(t,o){var a=this;this.stop(),!1!==(t=mt.extend({offset:[0,0],duration:500,easing:mt.ease},t)).animate&&!mt.browser.prefersReducedMotion||(t.duration=0);var s=this.transform,l=this.getZoom(),u=this.getBearing(),c=this.getPitch(),p="zoom"in t?+t.zoom:l,h="bearing"in t?this._normalizeBearing(t.bearing,u):u,d="pitch"in t?+t.pitch:c,f=s.centerPoint.add(mt.Point.convert(t.offset)),e=s.pointLocation(f),r=mt.LngLat.convert(t.center||e);this._normalizeCenter(r);var m,g,y=s.project(e),v=s.project(r).sub(y),_=s.zoomScale(p-l);return t.around&&(m=mt.LngLat.convert(t.around),g=s.locationPoint(m)),this._zooming=p!==l,this._rotating=u!==h,this._pitching=d!==c,this._prepareEase(o,t.noMoveStart),clearTimeout(this._easeEndTimeoutID),this._ease(function(t){if(a._zooming&&(s.zoom=mt.number(l,p,t)),a._rotating&&(s.bearing=mt.number(u,h,t)),a._pitching&&(s.pitch=mt.number(c,d,t)),m)s.setLocationAtPoint(m,g);else{var e=s.zoomScale(s.zoom-l),r=l<p?Math.min(2,_):Math.max(.5,_),i=Math.pow(r,1-t),n=s.unproject(y.add(v.mult(t*i)).mult(e));s.setLocationAtPoint(s.renderWorldCopies?n.wrap():n,f)}a._fireMoveEvents(o)},function(){t.delayEndEvents?a._easeEndTimeoutID=setTimeout(function(){return a._afterEase(o)},t.delayEndEvents):a._afterEase(o)},t),this},Jn.prototype._prepareEase=function(t,e){this._moving=!0,e||this.fire(new mt.Event("movestart",t)),this._zooming&&this.fire(new mt.Event("zoomstart",t)),this._rotating&&this.fire(new mt.Event("rotatestart",t)),this._pitching&&this.fire(new mt.Event("pitchstart",t))},Jn.prototype._fireMoveEvents=function(t){this.fire(new mt.Event("move",t)),this._zooming&&this.fire(new mt.Event("zoom",t)),this._rotating&&this.fire(new mt.Event("rotate",t)),this._pitching&&this.fire(new mt.Event("pitch",t))},Jn.prototype._afterEase=function(t){var e=this._zooming,r=this._rotating,i=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,e&&this.fire(new mt.Event("zoomend",t)),r&&this.fire(new mt.Event("rotateend",t)),i&&this.fire(new mt.Event("pitchend",t)),this.fire(new mt.Event("moveend",t))},Jn.prototype.flyTo=function(t,n){var o=this;if(mt.browser.prefersReducedMotion){var e=mt.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(e,n)}this.stop(),t=mt.extend({offset:[0,0],speed:1.2,curve:1.42,easing:mt.ease},t);var a=this.transform,s=this.getZoom(),l=this.getBearing(),u=this.getPitch(),c="zoom"in t?mt.clamp(+t.zoom,a.minZoom,a.maxZoom):s,p="bearing"in t?this._normalizeBearing(t.bearing,l):l,h="pitch"in t?+t.pitch:u,r=a.zoomScale(c-s),d=a.centerPoint.add(mt.Point.convert(t.offset)),i=a.pointLocation(d),f=mt.LngLat.convert(t.center||i);this._normalizeCenter(f);var m=a.project(i),g=a.project(f).sub(m),y=t.curve,v=Math.max(a.width,a.height),_=v/r,x=g.mag();if("minZoom"in t){var b=mt.clamp(Math.min(t.minZoom,s,c),a.minZoom,a.maxZoom),w=v/a.zoomScale(b-s);y=Math.sqrt(w/x*2)}var S=y*y;function T(t){var e=(_*_-v*v+(t?-1:1)*S*S*x*x)/(2*(t?_:v)*S*x);return Math.log(Math.sqrt(e*e+1)-e)}function E(t){return(Math.exp(t)-Math.exp(-t))/2}function I(t){return(Math.exp(t)+Math.exp(-t))/2}var C=T(0),k=function(t){return I(C)/I(C+y*t)},A=function(t){return v*((I(C)*(E(e=C+y*t)/I(e))-E(C))/S)/x;var e},P=(T(1)-C)/y;if(Math.abs(x)<1e-6||!isFinite(P)){if(Math.abs(v-_)<1e-6)return this.easeTo(t,n);var M=_<v?-1:1;P=Math.abs(Math.log(_/v))/y,A=function(){return 0},k=function(t){return Math.exp(M*y*t)}}if("duration"in t)t.duration=+t.duration;else{var L="screenSpeed"in t?+t.screenSpeed/y:+t.speed;t.duration=1e3*P/L}return t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=l!==p,this._pitching=h!==u,this._prepareEase(n,!1),this._ease(function(t){var e=t*P,r=1/k(e);a.zoom=1===t?c:s+a.scaleZoom(r),o._rotating&&(a.bearing=mt.number(l,p,t)),o._pitching&&(a.pitch=mt.number(u,h,t));var i=1===t?f:a.unproject(m.add(g.mult(A(e))).mult(r));a.setLocationAtPoint(a.renderWorldCopies?i.wrap():i,d),o._fireMoveEvents(n)},function(){return o._afterEase(n)},t),this},Jn.prototype.isEasing=function(){return!!this._easeFrameId},Jn.prototype.stop=function(){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var t=this._onEaseEnd;delete this._onEaseEnd,t.call(this)}return this},Jn.prototype._ease=function(t,e,r){!1===r.animate||0===r.duration?(t(1),e()):(this._easeStart=mt.browser.now(),this._easeOptions=r,this._onEaseFrame=t,this._onEaseEnd=e,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},Jn.prototype._renderFrameCallback=function(){var t=Math.min((mt.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},Jn.prototype._normalizeBearing=function(t,e){t=mt.wrap(t,-180,180);var r=Math.abs(t-e);return Math.abs(t-360-e)<r&&(t-=360),Math.abs(t+360-e)<r&&(t+=360),t},Jn.prototype._normalizeCenter=function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var r=t.lng-e.center.lng;t.lng+=180<r?-360:r<-180?360:0}},Jn);function Jn(t,e){Kn.call(this),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=e.bearingSnap,mt.bindAll(["_renderFrameCallback"],this)}function Qn(){mt.bindAll(["_updateLogo"],this),mt.bindAll(["_updateCompact"],this)}function $n(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}Wn.prototype.getDefaultPosition=function(){return"bottom-right"},Wn.prototype.onAdd=function(t){var e=this.options&&this.options.compact;return this._map=t,this._container=v.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=v.create("div","mapboxgl-ctrl-attrib-inner",this._container),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Wn.prototype.onRemove=function(){v.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0},Wn.prototype._updateEditLink=function(){var t=this._editLink;t=t||(this._editLink=this._container.querySelector(".mapbox-improve-map"));var i=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||mt.config.ACCESS_TOKEN}];if(t){var e=i.reduce(function(t,e,r){return e.value&&(t+=e.key+"="+e.value+(r<i.length-1?"&":"")),t},"?");t.href=mt.config.FEEDBACK_URL+"/"+e+(this._map._hash?this._map._hash.getHashString(!0):""),t.rel="noopener nofollow"}},Wn.prototype._updateData=function(t){!t||"metadata"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())},Wn.prototype._updateAttributions=function(){if(this._map.style){var i=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=i.concat(this.options.customAttribution.map(function(t){return"string"!=typeof t?"":t})):"string"==typeof this.options.customAttribution&&i.push(this.options.customAttribution)),this._map.style.stylesheet){var t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}var e=this._map.style.sourceCaches;for(var r in e){var n=e[r];if(n.used){var o=n.getSource();o.attribution&&i.indexOf(o.attribution)<0&&i.push(o.attribution)}}i.sort(function(t,e){return t.length-e.length});var a=(i=i.filter(function(t,e){for(var r=e+1;r<i.length;r++)if(0<=i[r].indexOf(t))return!1;return!0})).join(" | ");a!==this._attribHTML&&(this._attribHTML=a,i.length?(this._innerContainer.innerHTML=a,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Wn.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")},Qn.prototype.onAdd=function(t){this._map=t,this._container=v.create("div","mapboxgl-ctrl");var e=v.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://www.mapbox.com/",e.setAttribute("aria-label","Mapbox logo"),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Qn.prototype.onRemove=function(){v.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Qn.prototype.getDefaultPosition=function(){return"bottom-left"},Qn.prototype._updateLogo=function(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},Qn.prototype._logoRequired=function(){if(this._map.style){var t=this._map.style.sourceCaches;for(var e in t)if(t[e].getSource().mapbox_logo)return!0;return!1}},Qn.prototype._updateCompact=function(){var t=this._container.children;if(t.length){var e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}},$n.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},$n.prototype.remove=function(t){for(var e=this._currentlyRunning,r=0,i=e?this._queue.concat(e):this._queue;r<i.length;r+=1){var n=i[r];if(n.id===t)return void(n.cancelled=!0)}},$n.prototype.run=function(){var t=this._currentlyRunning=this._queue;this._queue=[];for(var e=0,r=t;e<r.length;e+=1){var i=r[e];if(!i.cancelled&&(i.callback(),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},$n.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var to=mt.window.HTMLImageElement,eo=mt.window.HTMLElement,ro={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,clickTolerance:3,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},io=function(s){function t(t){var e=this;if(null!=(t=mt.extend({},ro,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than minZoom");var r=new Pn(t.minZoom,t.maxZoom,t.renderWorldCopies);if(s.call(this,r,t),this._interactive=t.interactive,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._crossSourceCollisions=t.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=t.collectResourceTiming,this._renderTaskQueue=new $n,this._controls=[],this._mapId=mt.uniqueId(),this._requestManager=new mt.RequestManager(t.transformRequest,t.accessToken),"string"==typeof t.container){if(this._container=mt.window.document.getElementById(t.container),!this._container)throw new Error("Container '"+t.container+"' not found.")}else{if(!(t.container instanceof eo))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(t.maxBounds&&this.setMaxBounds(t.maxBounds),mt.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return e._update(!1)}),this.on("moveend",function(){return e._update(!1)}),this.on("zoom",function(){return e._update(!0)}),void 0!==mt.window&&(mt.window.addEventListener("online",this._onWindowOnline,!1),mt.window.addEventListener("resize",this._onWindowResize,!1)),function(r,i){var n=r.getCanvasContainer(),o=null,a=!1,s=null;for(var t in Xn)r[t]=new Xn[t](r,i),i.interactive&&i[t]&&r[t].enable(i[t]);v.addEventListener(n,"mouseout",function(t){r.fire(new Dn("mouseout",r,t))}),v.addEventListener(n,"mousedown",function(t){a=!0,s=v.mousePos(n,t);var e=new Dn("mousedown",r,t);r.fire(e),e.defaultPrevented||(i.interactive&&!r.doubleClickZoom.isActive()&&r.stop(),r.boxZoom.onMouseDown(t),r.boxZoom.isActive()||r.dragPan.isActive()||r.dragRotate.onMouseDown(t),r.boxZoom.isActive()||r.dragRotate.isActive()||r.dragPan.onMouseDown(t))}),v.addEventListener(n,"mouseup",function(t){var e=r.dragRotate.isActive();o&&!e&&r.fire(new Dn("contextmenu",r,o)),o=null,a=!1,r.fire(new Dn("mouseup",r,t))}),v.addEventListener(n,"mousemove",function(t){if(!r.dragPan.isActive()&&!r.dragRotate.isActive()){for(var e=t.target;e&&e!==n;)e=e.parentNode;e===n&&r.fire(new Dn("mousemove",r,t))}}),v.addEventListener(n,"mouseover",function(t){for(var e=t.target;e&&e!==n;)e=e.parentNode;e===n&&r.fire(new Dn("mouseover",r,t))}),v.addEventListener(n,"touchstart",function(t){var e=new Rn("touchstart",r,t);r.fire(e),e.defaultPrevented||(i.interactive&&r.stop(),r.boxZoom.isActive()||r.dragRotate.isActive()||r.dragPan.onTouchStart(t),r.touchZoomRotate.onStart(t),r.doubleClickZoom.onTouchStart(e))},{passive:!1}),v.addEventListener(n,"touchmove",function(t){r.fire(new Rn("touchmove",r,t))},{passive:!1}),v.addEventListener(n,"touchend",function(t){r.fire(new Rn("touchend",r,t))}),v.addEventListener(n,"touchcancel",function(t){r.fire(new Rn("touchcancel",r,t))}),v.addEventListener(n,"click",function(t){var e=v.mousePos(n,t);(!s||e.equals(s)||e.dist(s)<i.clickTolerance)&&r.fire(new Dn("click",r,t))}),v.addEventListener(n,"dblclick",function(t){var e=new Dn("dblclick",r,t);r.fire(e),e.defaultPrevented||r.doubleClickZoom.onDblClick(e)}),v.addEventListener(n,"contextmenu",function(t){var e=r.dragRotate.isActive();a||e?a&&(o=t):r.fire(new Dn("contextmenu",r,t)),(r.dragRotate.isEnabled()||r.listens("contextmenu"))&&t.preventDefault()}),v.addEventListener(n,"wheel",function(t){i.interactive&&r.stop();var e=new zn("wheel",r,t);r.fire(e),e.defaultPrevented||r.scrollZoom.onWheel(t)},{passive:!1})}(this,t),this._hash=t.hash&&(new Ln).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,mt.extend({},t.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=t.localIdeographFontFamily,t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new Wn({customAttribution:t.customAttribution})),this.addControl(new Qn,t.logoPosition),this.on("style.load",function(){e.transform.unmodified&&e.jumpTo(e.style.stylesheet)}),this.on("data",function(t){e._update("style"===t.dataType),e.fire(new mt.Event(t.dataType+"data",t))}),this.on("dataloading",function(t){e.fire(new mt.Event(t.dataType+"dataloading",t))})}s&&(t.__proto__=s);var e={showTileBoundaries:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype._getMapId=function(){return this._mapId},t.prototype.addControl=function(t,e){if(void 0===e&&t.getDefaultPosition&&(e=t.getDefaultPosition()),void 0===e&&(e="top-right"),!t||!t.onAdd)return this.fire(new mt.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var r=t.onAdd(this);this._controls.push(t);var i=this._controlPositions[e];return-1!==e.indexOf("bottom")?i.insertBefore(r,i.firstChild):i.appendChild(r),this},t.prototype.removeControl=function(t){if(!t||!t.onRemove)return this.fire(new mt.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var e=this._controls.indexOf(t);return-1<e&&this._controls.splice(e,1),t.onRemove(this),this},t.prototype.resize=function(t){var e=this._containerDimensions(),r=e[0],i=e[1];return this._resizeCanvas(r,i),this.transform.resize(r,i),this.painter.resize(r,i),this.fire(new mt.Event("movestart",t)).fire(new mt.Event("move",t)).fire(new mt.Event("resize",t)).fire(new mt.Event("moveend",t)),this},t.prototype.getBounds=function(){return this.transform.getBounds()},t.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},t.prototype.setMaxBounds=function(t){return this.transform.setMaxBounds(mt.LngLatBounds.convert(t)),this._update()},t.prototype.setMinZoom=function(t){if(0<=(t=null==t?0:t)&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between 0 and the current maxZoom, inclusive")},t.prototype.getMinZoom=function(){return this.transform.minZoom},t.prototype.setMaxZoom=function(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},t.prototype.getMaxZoom=function(){return this.transform.maxZoom},t.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},t.prototype.setRenderWorldCopies=function(t){return this.transform.renderWorldCopies=t,this._update()},t.prototype.project=function(t){return this.transform.locationPoint(mt.LngLat.convert(t))},t.prototype.unproject=function(t){return this.transform.pointLocation(mt.Point.convert(t))},t.prototype.isMoving=function(){return this._moving||this.dragPan.isActive()||this.dragRotate.isActive()||this.scrollZoom.isActive()},t.prototype.isZooming=function(){return this._zooming||this.scrollZoom.isZooming()},t.prototype.isRotating=function(){return this._rotating||this.dragRotate.isActive()},t.prototype.on=function(i,n,o){var a=this;if(void 0===o)return s.prototype.on.call(this,i,n);var t=function(){var t;if("mouseenter"===i||"mouseover"===i){var r=!1;return{layer:n,listener:o,delegates:{mousemove:function(t){var e=a.getLayer(n)?a.queryRenderedFeatures(t.point,{layers:[n]}):[];e.length?r||(r=!0,o.call(a,new Dn(i,a,t.originalEvent,{features:e}))):r=!1},mouseout:function(){r=!1}}}}if("mouseleave"!==i&&"mouseout"!==i)return{layer:n,listener:o,delegates:(t={},t[i]=function(t){var e=a.getLayer(n)?a.queryRenderedFeatures(t.point,{layers:[n]}):[];e.length&&(t.features=e,o.call(a,t),delete t.features)},t)};var e=!1;return{layer:n,listener:o,delegates:{mousemove:function(t){(a.getLayer(n)?a.queryRenderedFeatures(t.point,{layers:[n]}):[]).length?e=!0:e&&(e=!1,o.call(a,new Dn(i,a,t.originalEvent)))},mouseout:function(t){e&&(e=!1,o.call(a,new Dn(i,a,t.originalEvent)))}}}}();for(var e in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[i]=this._delegatedListeners[i]||[],this._delegatedListeners[i].push(t),t.delegates)this.on(e,t.delegates[e]);return this},t.prototype.off=function(t,e,r){if(void 0===r)return s.prototype.off.call(this,t,e);if(this._delegatedListeners&&this._delegatedListeners[t])for(var i=this._delegatedListeners[t],n=0;n<i.length;n++){var o=i[n];if(o.layer===e&&o.listener===r){for(var a in o.delegates)this.off(a,o.delegates[a]);return i.splice(n,1),this}}return this},t.prototype.queryRenderedFeatures=function(t,e){if(!this.style)return[];var r;if(void 0!==e||void 0===t||t instanceof mt.Point||Array.isArray(t)||(e=t,t=void 0),e=e||{},(t=t||[[0,0],[this.transform.width,this.transform.height]])instanceof mt.Point||"number"==typeof t[0])r=[mt.Point.convert(t)];else{var i=mt.Point.convert(t[0]),n=mt.Point.convert(t[1]);r=[i,new mt.Point(n.x,i.y),n,new mt.Point(i.x,n.y),i]}return this.style.queryRenderedFeatures(r,e,this.transform)},t.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},t.prototype.setStyle=function(t,e){return!1!==(e=mt.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},e)).diff&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&t?(this._diffStyle(t,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(t,e))},t.prototype._updateStyle=function(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove()),t?(this.style=new di(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t)):delete this.style,this},t.prototype._diffStyle=function(t,r){var i=this;if("string"==typeof t){var e=this._requestManager.normalizeStyleURL(t),n=this._requestManager.transformRequest(e,mt.ResourceType.Style);mt.getJSON(n,function(t,e){t?i.fire(new mt.ErrorEvent(t)):e&&i._updateDiff(e,r)})}else"object"==typeof t&&this._updateDiff(t,r)},t.prototype._updateDiff=function(e,r){try{this.style.setState(e)&&this._update(!0)}catch(t){mt.warnOnce("Unable to perform style diff: "+(t.message||t.error||t)+".  Rebuilding the style from scratch."),this._updateStyle(e,r)}},t.prototype.getStyle=function(){if(this.style)return this.style.serialize()},t.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():mt.warnOnce("There is no style added to the map.")},t.prototype.addSource=function(t,e){return this.style.addSource(t,e),this._update(!0)},t.prototype.isSourceLoaded=function(t){var e=this.style&&this.style.sourceCaches[t];if(void 0!==e)return e.loaded();this.fire(new mt.ErrorEvent(new Error("There is no source with ID '"+t+"'")))},t.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var r=t[e]._tiles;for(var i in r){var n=r[i];if("loaded"!==n.state&&"errored"!==n.state)return!1}}return!0},t.prototype.addSourceType=function(t,e,r){return this.style.addSourceType(t,e,r)},t.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0)},t.prototype.getSource=function(t){return this.style.getSource(t)},t.prototype.addImage=function(t,e,r){void 0===r&&(r={});var i=r.pixelRatio;void 0===i&&(i=1);var n=r.sdf;if(void 0===n&&(n=!1),e instanceof to){var o=mt.browser.getImageData(e),a=o.width,s=o.height,l=o.data;this.style.addImage(t,{data:new mt.RGBAImage({width:a,height:s},l),pixelRatio:i,sdf:n,version:0})}else{if(void 0===e.width||void 0===e.height)return this.fire(new mt.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var u=e.width,c=e.height,p=e.data,h=e;this.style.addImage(t,{data:new mt.RGBAImage({width:u,height:c},new Uint8Array(p)),pixelRatio:i,sdf:n,version:0,userImage:h}),h.onAdd&&h.onAdd(this,t)}},t.prototype.updateImage=function(t,e){var r=this.style.getImage(t);if(!r)return this.fire(new mt.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var i=e instanceof to?mt.browser.getImageData(e):e,n=i.width,o=i.height,a=i.data;if(void 0===n||void 0===o)return this.fire(new mt.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(n!==r.data.width||o!==r.data.height)return this.fire(new mt.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));var s=!(e instanceof to);r.data.replace(a,s),this.style.updateImage(t,r)},t.prototype.hasImage=function(t){return t?!!this.style.getImage(t):(this.fire(new mt.ErrorEvent(new Error("Missing required image id"))),!1)},t.prototype.removeImage=function(t){this.style.removeImage(t)},t.prototype.loadImage=function(t,e){mt.getImage(this._requestManager.transformRequest(t,mt.ResourceType.Image),e)},t.prototype.listImages=function(){return this.style.listImages()},t.prototype.addLayer=function(t,e){return this.style.addLayer(t,e),this._update(!0)},t.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0)},t.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0)},t.prototype.getLayer=function(t){return this.style.getLayer(t)},t.prototype.setLayerZoomRange=function(t,e,r){return this.style.setLayerZoomRange(t,e,r),this._update(!0)},t.prototype.setFilter=function(t,e,r){return void 0===r&&(r={}),this.style.setFilter(t,e,r),this._update(!0)},t.prototype.getFilter=function(t){return this.style.getFilter(t)},t.prototype.setPaintProperty=function(t,e,r,i){return void 0===i&&(i={}),this.style.setPaintProperty(t,e,r,i),this._update(!0)},t.prototype.getPaintProperty=function(t,e){return this.style.getPaintProperty(t,e)},t.prototype.setLayoutProperty=function(t,e,r,i){return void 0===i&&(i={}),this.style.setLayoutProperty(t,e,r,i),this._update(!0)},t.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},t.prototype.setLight=function(t,e){return void 0===e&&(e={}),this.style.setLight(t,e),this._update(!0)},t.prototype.getLight=function(){return this.style.getLight()},t.prototype.setFeatureState=function(t,e){return this.style.setFeatureState(t,e),this._update()},t.prototype.removeFeatureState=function(t,e){return this.style.removeFeatureState(t,e),this._update()},t.prototype.getFeatureState=function(t){return this.style.getFeatureState(t)},t.prototype.getContainer=function(){return this._container},t.prototype.getCanvasContainer=function(){return this._canvasContainer},t.prototype.getCanvas=function(){return this._canvas},t.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]},t.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==mt.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&mt.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},t.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=v.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();var e=this._canvasContainer=v.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=v.create("canvas","mapboxgl-canvas",e),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var r=this._containerDimensions();this._resizeCanvas(r[0],r[1]);var i=this._controlContainer=v.create("div","mapboxgl-control-container",t),n=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(t){n[t]=v.create("div","mapboxgl-ctrl-"+t,i)})},t.prototype._resizeCanvas=function(t,e){var r=mt.window.devicePixelRatio||1;this._canvas.width=r*t,this._canvas.height=r*e,this._canvas.style.width=t+"px",this._canvas.style.height=e+"px"},t.prototype._setupPainter=function(){var t=mt.extend({},r.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),e=this._canvas.getContext("webgl",t)||this._canvas.getContext("experimental-webgl",t);e?(this.painter=new Tn(e,this.transform),mt.webpSupported.testSupport(e)):this.fire(new mt.ErrorEvent(new Error("Failed to initialize WebGL")))},t.prototype._contextLost=function(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new mt.Event("webglcontextlost",{originalEvent:t}))},t.prototype._contextRestored=function(t){this._setupPainter(),this.resize(),this._update(),this.fire(new mt.Event("webglcontextrestored",{originalEvent:t}))},t.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},t.prototype._update=function(t){return this.style&&(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint()),this},t.prototype._requestRenderFrame=function(t){return this._update(),this._renderTaskQueue.add(t)},t.prototype._cancelRenderFrame=function(t){this._renderTaskQueue.remove(t)},t.prototype._render=function(){this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run();var t=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var e=this.transform.zoom,r=mt.browser.now();this.style.zoomHistory.update(e,r);var i=new mt.EvaluationParameters(e,{now:r,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),n=i.crossFadingFactor();1===n&&n===this._crossFadingFactor||(t=!0,this._crossFadingFactor=n),this.style.update(i)}return this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration}),this.fire(new mt.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new mt.Event("load"))),this.style&&(this.style.hasTransitions()||t)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this._sourcesDirty||this._repaint||this._styleDirty||this._placementDirty?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new mt.Event("idle")),this},t.prototype.remove=function(){this._hash&&this._hash.remove();for(var t=0,e=this._controls;t<e.length;t+=1)e[t].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.setStyle(null),void 0!==mt.window&&(mt.window.removeEventListener("resize",this._onWindowResize,!1),mt.window.removeEventListener("online",this._onWindowOnline,!1));var r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),no(this._canvasContainer),no(this._controlContainer),no(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this.fire(new mt.Event("remove"))},t.prototype.triggerRepaint=function(){var t=this;this.style&&!this._frame&&(this._frame=mt.browser.frame(function(){t._frame=null,t._render()}))},t.prototype._onWindowOnline=function(){this._update()},t.prototype._onWindowResize=function(t){this._trackResize&&this.resize({originalEvent:t})._update()},e.showTileBoundaries.get=function(){return!!this._showTileBoundaries},e.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},e.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},e.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&((this._showCollisionBoxes=t)?this.style._generateCollisionBoxes():this._update())},e.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},e.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},e.repaint.get=function(){return!!this._repaint},e.repaint.set=function(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())},e.vertices.get=function(){return!!this._vertices},e.vertices.set=function(t){this._vertices=t,this._update()},t.prototype._setCacheLimits=function(t,e){mt.setCacheLimits(t,e)},e.version.get=function(){return mt.version},Object.defineProperties(t.prototype,e),t}(Yn);function no(t){t.parentNode&&t.parentNode.removeChild(t)}function oo(t){var e=this;this.options=mt.extend({},ao,t),this._container=v.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this.options.showZoom&&(mt.bindAll(["_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom in",function(t){return e._map.zoomIn({},{originalEvent:t})}),this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out","Zoom out",function(t){return e._map.zoomOut({},{originalEvent:t})})),this.options.showCompass&&(mt.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset bearing to north",function(t){e.options.visualizePitch?e._map.resetNorthPitch({},{originalEvent:t}):e._map.resetNorth({},{originalEvent:t})}),this._compassArrow=v.create("span","mapboxgl-ctrl-compass-arrow",this._compass))}var ao={showCompass:!0,showZoom:!0,visualizePitch:!1};function so(t,e,r){if(t=new mt.LngLat(t.lng,t.lat),e){var i=new mt.LngLat(t.lng-360,t.lat),n=new mt.LngLat(t.lng+360,t.lat),o=r.locationPoint(t).distSqr(e);r.locationPoint(i).distSqr(e)<o?t=i:r.locationPoint(n).distSqr(e)<o&&(t=n)}for(;180<Math.abs(t.lng-r.center.lng);){var a=r.locationPoint(t);if(0<=a.x&&0<=a.y&&a.x<=r.width&&a.y<=r.height)break;t.lng>r.center.lng?t.lng-=360:t.lng+=360}return t}oo.prototype._updateZoomButtons=function(){var t=this._map.getZoom();t===this._map.getMaxZoom()?this._zoomInButton.classList.add("mapboxgl-ctrl-icon-disabled"):this._zoomInButton.classList.remove("mapboxgl-ctrl-icon-disabled"),t===this._map.getMinZoom()?this._zoomOutButton.classList.add("mapboxgl-ctrl-icon-disabled"):this._zoomOutButton.classList.remove("mapboxgl-ctrl-icon-disabled")},oo.prototype._rotateCompassArrow=function(){var t=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=t},oo.prototype.onAdd=function(t){return this._map=t,this.options.showZoom&&(this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Bn(t,{button:"left",element:this._compass}),v.addEventListener(this._compass,"mousedown",this._handler.onMouseDown),v.addEventListener(this._compass,"touchstart",this._handler.onMouseDown,{passive:!1}),this._handler.enable()),this._container},oo.prototype.onRemove=function(){v.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),v.removeEventListener(this._compass,"mousedown",this._handler.onMouseDown),v.removeEventListener(this._compass,"touchstart",this._handler.onMouseDown,{passive:!1}),this._handler.disable(),delete this._handler),delete this._map},oo.prototype._createButton=function(t,e,r){var i=v.create("button",t,this._container);return i.type="button",i.title=e,i.setAttribute("aria-label",e),i.addEventListener("click",r),i};var lo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function uo(t,e,r){var i=t.classList;for(var n in lo)i.remove("mapboxgl-"+r+"-anchor-"+n);i.add("mapboxgl-"+r+"-anchor-"+e)}var co,po,ho=((po=mt.Evented)&&(mo.__proto__=po),((mo.prototype=Object.create(po&&po.prototype)).constructor=mo).prototype.addTo=function(t){return this.remove(),(this._map=t).getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},mo.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),v.remove(this._element),this._popup&&this._popup.remove(),this},mo.prototype.getLngLat=function(){return this._lngLat},mo.prototype.setLngLat=function(t){return this._lngLat=mt.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},mo.prototype.getElement=function(){return this._element},mo.prototype.setPopup=function(t){if(this._popup&&(this._popup.remove(),this._popup=null),t){if(!("offset"in t.options)){var e=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[e,-1*(24.6+e)],"bottom-right":[-e,-1*(24.6+e)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat)}return this},mo.prototype._onMapClick=function(t){var e=t.originalEvent.target,r=this._element;this._popup&&(e===r||r.contains(e))&&this.togglePopup()},mo.prototype.getPopup=function(){return this._popup},mo.prototype.togglePopup=function(){var t=this._popup;return t&&(t.isOpen()?t.remove():t.addTo(this._map)),this},mo.prototype._update=function(t){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=so(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset),t&&"moveend"!==t.type||(this._pos=this._pos.round()),v.setTransform(this._element,lo[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px)"))},mo.prototype.getOffset=function(){return this._offset},mo.prototype.setOffset=function(t){return this._offset=mt.Point.convert(t),this._update(),this},mo.prototype._onMove=function(t){this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new mt.Event("dragstart"))),this.fire(new mt.Event("drag"))},mo.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new mt.Event("dragend")),this._state="inactive"},mo.prototype._addDragHandler=function(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},mo.prototype.setDraggable=function(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},mo.prototype.isDraggable=function(){return this._draggable},mo),fo={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0};function mo(t,e){if(po.call(this),(t instanceof mt.window.HTMLElement||e)&&(t=mt.extend({element:t},e)),mt.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._draggable=t&&t.draggable||!1,this._state="inactive",t&&t.element)this._element=t.element,this._offset=mt.Point.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=v.create("div");var r=v.createNS("http://www.w3.org/2000/svg","svg");r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height","41px"),r.setAttributeNS(null,"width","27px"),r.setAttributeNS(null,"viewBox","0 0 27 41");var i=v.createNS("http://www.w3.org/2000/svg","g");i.setAttributeNS(null,"stroke","none"),i.setAttributeNS(null,"stroke-width","1"),i.setAttributeNS(null,"fill","none"),i.setAttributeNS(null,"fill-rule","evenodd");var n=v.createNS("http://www.w3.org/2000/svg","g");n.setAttributeNS(null,"fill-rule","nonzero");var o=v.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"transform","translate(3.0, 29.0)"),o.setAttributeNS(null,"fill","#000000");for(var a=0,s=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];a<s.length;a+=1){var l=s[a],u=v.createNS("http://www.w3.org/2000/svg","ellipse");u.setAttributeNS(null,"opacity","0.04"),u.setAttributeNS(null,"cx","10.5"),u.setAttributeNS(null,"cy","5.80029008"),u.setAttributeNS(null,"rx",l.rx),u.setAttributeNS(null,"ry",l.ry),o.appendChild(u)}var c=v.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"fill",this._color);var p=v.createNS("http://www.w3.org/2000/svg","path");p.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),c.appendChild(p);var h=v.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"opacity","0.25"),h.setAttributeNS(null,"fill","#000000");var d=v.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),h.appendChild(d);var f=v.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"transform","translate(6.0, 7.0)"),f.setAttributeNS(null,"fill","#FFFFFF");var m=v.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(8.0, 8.0)");var g=v.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");var y=v.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#FFFFFF"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962"),m.appendChild(g),m.appendChild(y),n.appendChild(o),n.appendChild(c),n.appendChild(h),n.appendChild(f),n.appendChild(m),r.appendChild(n),this._element.appendChild(r),this._offset=mt.Point.convert(t&&t.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(t){t.preventDefault()}),uo(this._element,this._anchor,"marker"),this._popup=null}function go(t){this.options=mt.extend({},_o,t),mt.bindAll(["_onMove","setUnit"],this)}var yo,vo=((yo=mt.Evented)&&(xo.__proto__=yo),((xo.prototype=Object.create(yo&&yo.prototype)).constructor=xo).prototype.onAdd=function(t){var e;return this._map=t,this._container=v.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),e=this._setupUI,void 0!==co?e(co):void 0!==mt.window.navigator.permissions?mt.window.navigator.permissions.query({name:"geolocation"}).then(function(t){co="denied"!==t.state,e(co)}):(co=!!mt.window.navigator.geolocation,e(co)),this._container},xo.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(mt.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),v.remove(this._container),this._map=void 0},xo.prototype._onSuccess=function(t){if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new mt.Event("geolocate",t)),this._finish()},xo.prototype._updateCamera=function(t){var e=new mt.LngLat(t.coords.longitude,t.coords.latitude),r=t.coords.accuracy,i=this._map.getBearing(),n=mt.extend({bearing:i},this.options.fitBoundsOptions);this._map.fitBounds(e.toBounds(r),n,{geolocateSource:!0})},xo.prototype._updateMarker=function(t){t?this._userLocationDotMarker.setLngLat([t.coords.longitude,t.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},xo.prototype._onError=function(t){if(this.options.trackUserLocation)if(1===t.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new mt.Event("error",t)),this._finish()},xo.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},xo.prototype._setupUI=function(t){var r=this;!1!==t?(this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this._geolocateButton=v.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.title="Find my location",this._geolocateButton.setAttribute("aria-label","Find my location"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=v.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new ho(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(t){var e=t.originalEvent&&"resize"===t.originalEvent.type;t.geolocateSource||"ACTIVE_LOCK"!==r._watchState||e||(r._watchState="BACKGROUND",r._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),r._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),r.fire(new mt.Event("trackuserlocationend")))})):mt.warnOnce("Geolocation support is not available, the GeolocateControl will not be visible.")},xo.prototype.trigger=function(){if(!this._setup)return mt.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new mt.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new mt.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new mt.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._geolocationWatchID=mt.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else mt.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},xo.prototype._clearWatch=function(){mt.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},xo),_o={maxWidth:100,unit:"metric"};function xo(t){yo.call(this),this.options=mt.extend({},fo,t),mt.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker"],this)}function bo(t,e,r){var i,n,o,a,s,l,u=r&&r.maxWidth||100,c=t._container.clientHeight/2,p=(i=t.unproject([0,c]),n=t.unproject([u,c]),o=Math.PI/180,a=i.lat*o,s=n.lat*o,l=Math.sin(a)*Math.sin(s)+Math.cos(a)*Math.cos(s)*Math.cos((n.lng-i.lng)*o),6371e3*Math.acos(Math.min(l,1)));if(r&&"imperial"===r.unit){var h=3.2808*p;5280<h?wo(e,u,h/5280,"mi"):wo(e,u,h,"ft")}else r&&"nautical"===r.unit?wo(e,u,p/1852,"nm"):wo(e,u,p,"m")}function wo(t,e,r,i){var n,o,a,s,l,u=(n=r,(o=Math.pow(10,(""+Math.floor(n)).length-1))*(a=10<=(a=n/o)?10:5<=a?5:3<=a?3:2<=a?2:1<=a?1:(s=a,l=Math.pow(10,Math.ceil(-Math.log(s)/Math.LN10)),Math.round(s*l)/l))),c=u/r;"m"===i&&1e3<=u&&(u/=1e3,i="km"),t.style.width=e*c+"px",t.innerHTML=u+i}function So(t){this._fullscreen=!1,t&&t.container&&(t.container instanceof mt.window.HTMLElement?this._container=t.container:mt.warnOnce("Full screen control 'container' must be a DOM element.")),mt.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in mt.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in mt.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in mt.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in mt.window.document&&(this._fullscreenchange="MSFullscreenChange"),this._className="mapboxgl-ctrl"}go.prototype.getDefaultPosition=function(){return"bottom-left"},go.prototype._onMove=function(){bo(this._map,this._container,this.options)},go.prototype.onAdd=function(t){return this._map=t,this._container=v.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},go.prototype.onRemove=function(){v.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},go.prototype.setUnit=function(t){this.options.unit=t,bo(this._map,this._container,this.options)},So.prototype.onAdd=function(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=v.create("div",this._className+" mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",mt.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},So.prototype.onRemove=function(){v.remove(this._controlContainer),this._map=null,mt.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},So.prototype._checkFullscreenSupport=function(){return!!(mt.window.document.fullscreenEnabled||mt.window.document.mozFullScreenEnabled||mt.window.document.msFullscreenEnabled||mt.window.document.webkitFullscreenEnabled)},So.prototype._setupUI=function(){(this._fullscreenButton=v.create("button",this._className+"-icon "+this._className+"-fullscreen",this._controlContainer)).type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),mt.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},So.prototype._updateTitle=function(){var t=this._isFullscreen()?"Exit fullscreen":"Enter fullscreen";this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t},So.prototype._isFullscreen=function(){return this._fullscreen},So.prototype._changeIcon=function(){(mt.window.document.fullscreenElement||mt.window.document.mozFullScreenElement||mt.window.document.webkitFullscreenElement||mt.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"),this._updateTitle())},So.prototype._onClickFullscreen=function(){this._isFullscreen()?mt.window.document.exitFullscreen?mt.window.document.exitFullscreen():mt.window.document.mozCancelFullScreen?mt.window.document.mozCancelFullScreen():mt.window.document.msExitFullscreen?mt.window.document.msExitFullscreen():mt.window.document.webkitCancelFullScreen&&mt.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var To,Eo={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Io=((To=mt.Evented)&&(Co.__proto__=To),((Co.prototype=Object.create(To&&To.prototype)).constructor=Co).prototype.addTo=function(t){var e=this;return this._map=t,this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",function(t){e._update(t.point)}),this._map.on("mouseup",function(t){e._update(t.point)}),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new mt.Event("open")),this},Co.prototype.isOpen=function(){return!!this._map},Co.prototype.remove=function(){return this._content&&v.remove(this._content),this._container&&(v.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),this._map.off("remove",this.remove),this._map.off("mousemove"),delete this._map),this.fire(new mt.Event("close")),this},Co.prototype.getLngLat=function(){return this._lngLat},Co.prototype.setLngLat=function(t){return this._lngLat=mt.LngLat.convert(t),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove"),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},Co.prototype.trackPointer=function(){var e=this;return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",function(t){e._update(t.point)}),this._map.on("drag",function(t){e._update(t.point)}),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},Co.prototype.getElement=function(){return this._container},Co.prototype.setText=function(t){return this.setDOMContent(mt.window.document.createTextNode(t))},Co.prototype.setHTML=function(t){var e,r=mt.window.document.createDocumentFragment(),i=mt.window.document.createElement("body");for(i.innerHTML=t;e=i.firstChild;)r.appendChild(e);return this.setDOMContent(r)},Co.prototype.getMaxWidth=function(){return this._container.style.maxWidth},Co.prototype.setMaxWidth=function(t){return this.options.maxWidth=t,this._update(),this},Co.prototype.setDOMContent=function(t){return this._createContent(),this._content.appendChild(t),this._update(),this},Co.prototype._createContent=function(){this._content&&v.remove(this._content),this._content=v.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=v.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},Co.prototype._update=function(t){var e=this,r=this._lngLat||this._trackPointer;if(this._map&&r&&this._content&&(this._container||(this._container=v.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=v.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(t){return e._container.classList.add(t)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=so(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||t)){var i=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat),n=this.options.anchor,o=function t(e){if(e){if("number"==typeof e){var r=Math.round(Math.sqrt(.5*Math.pow(e,2)));return{center:new mt.Point(0,0),top:new mt.Point(0,e),"top-left":new mt.Point(r,r),"top-right":new mt.Point(-r,r),bottom:new mt.Point(0,-e),"bottom-left":new mt.Point(r,-r),"bottom-right":new mt.Point(-r,-r),left:new mt.Point(e,0),right:new mt.Point(-e,0)}}if(e instanceof mt.Point||Array.isArray(e)){var i=mt.Point.convert(e);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:mt.Point.convert(e.center||[0,0]),top:mt.Point.convert(e.top||[0,0]),"top-left":mt.Point.convert(e["top-left"]||[0,0]),"top-right":mt.Point.convert(e["top-right"]||[0,0]),bottom:mt.Point.convert(e.bottom||[0,0]),"bottom-left":mt.Point.convert(e["bottom-left"]||[0,0]),"bottom-right":mt.Point.convert(e["bottom-right"]||[0,0]),left:mt.Point.convert(e.left||[0,0]),right:mt.Point.convert(e.right||[0,0])}}return t(new mt.Point(0,0))}(this.options.offset);if(!n){var a,s=this._container.offsetWidth,l=this._container.offsetHeight;a=i.y+o.bottom.y<l?["top"]:i.y>this._map.transform.height-l?["bottom"]:[],i.x<s/2?a.push("left"):i.x>this._map.transform.width-s/2&&a.push("right"),n=0===a.length?"bottom":a.join("-")}var u=i.add(o[n]).round();v.setTransform(this._container,lo[n]+" translate("+u.x+"px,"+u.y+"px)"),uo(this._container,n,"popup")}},Co.prototype._onClickClose=function(){this.remove()},Co);function Co(t){To.call(this),this.options=mt.extend(Object.create(Eo),t),mt.bindAll(["_update","_onClickClose","remove"],this)}var ko={version:mt.version,supported:r,setRTLTextPlugin:mt.setRTLTextPlugin,Map:io,NavigationControl:oo,GeolocateControl:vo,AttributionControl:Wn,ScaleControl:go,FullscreenControl:So,Popup:Io,Marker:ho,Style:di,LngLat:mt.LngLat,LngLatBounds:mt.LngLatBounds,Point:mt.Point,MercatorCoordinate:mt.MercatorCoordinate,Evented:mt.Evented,config:mt.config,get accessToken(){return mt.config.ACCESS_TOKEN},set accessToken(t){mt.config.ACCESS_TOKEN=t},get baseApiUrl(){return mt.config.API_URL},set baseApiUrl(t){mt.config.API_URL=t},get workerCount(){return pr.workerCount},set workerCount(t){pr.workerCount=t},get maxParallelImageRequests(){return mt.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){mt.config.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage:function(t){mt.clearTileCache(t)},workerUrl:""};return ko}),a)}),r=(h.Map,h.setRTLTextPlugin),i=(h.supported,h.Marker),n="atlas.microsoft.com",o="atlas.microsoft.com",a="styles/definitions/2019-10-16.json",s="e96cb745-c6f5-409c-a775-c4313e468c1d",l="https://login.microsoftonline.com/",u="Authorization",c="Bearer ",d="{azMapsDomain}",f="Map-Agent",m="x-ms-client-id",g="Ms-Am-Request-Origin",y="MapControl",v="https://atlas.microsoft.com/",_="Session-Id",x=function(t,e){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function b(t,e){function r(){this.constructor=t}x(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var w=function(){return(w=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function S(o,a,s,l){return new(s=s||Promise)(function(t,e){function r(t){try{n(l.next(t))}catch(t){e(t)}}function i(t){try{n(l.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(r,i)}n((l=l.apply(o,a||[])).next())})}function T(r,i){var n,o,a,t,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(a=2&e[0]?o.return:e[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,e[1])).done)return a;switch(o=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){s.label=e[1];break}if(6===e[0]&&s.label<a[1]){s.label=a[1],a=e;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(e);break}a[2]&&s.ops.pop(),s.trys.pop();continue}e=i.call(r,s)}catch(t){e=[6,t],o=0}finally{n=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}var E=(I.prototype.merge=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var i=0,n=e;i<n.length;i++){var o=n[i];if(o)for(var a in o)o.hasOwnProperty(a)&&this.hasOwnProperty(a)&&(void 0!==o[a]&&null!=o[a]?this[a]instanceof I?this[a].merge(o[a]):this[a]=o[a]:(t=t||new(Object.getPrototypeOf(this).constructor),this[a]=t[a]))}return this},I);function I(){}var C,k=(b(A,C=E),A);function A(){var t=null!==C&&C.apply(this,arguments)||this;return t.domain=void 0,t.headers={},t.path="",t.protocol="https",t.queryParams={},t.subdomain="",t}var P=(M.prototype.get=function(){return fetch(this.toString(),{method:"GET",mode:"cors",headers:new Headers(this.options.headers)}).then(function(t){if(t.ok)return t.json();throw new Error("HTTP "+t.status+": "+t.statusText)})},M.prototype.toString=function(){var t=Object.entries(this.options.queryParams).map(function(t){return t[0]+"="+t[1]}).join("&"),e=[];return M.protoRegEx.test(this.options.domain)||(e.push(this.options.protocol+"://"),e.push(this.options.subdomain?this.options.subdomain+".":"")),e.push(this.options.domain),e.push(this.options.path?"/"+this.options.path:""),e.push(t?"?"+t:""),e.join("")},M.protoRegEx=new RegExp(/^\w+:\/\//),M);function M(t){this.options=(new k).merge(t)}var L,O="2.0.20",D=(R.getFullVersion=function(){return O},R.getEndpointVersion=function(){var t=O.indexOf(".");return-1===(t=O.indexOf(".",t+1))?O:O.substring(0,t)},R);function R(){}(L=p.ControlPosition||(p.ControlPosition={})).TopLeft="top-left",L.TopRight="top-right",L.BottomLeft="bottom-left",L.BottomRight="bottom-right",L.NonFixed="non-fixed";var z,N=(b(B,z=E),B);function B(){var t=null!==z&&z.apply(this,arguments)||this;return t.position=p.ControlPosition.NonFixed,t}var F={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},U=e(function(t){var a=Array.prototype.concat,s=Array.prototype.slice,e=t.exports=function(t){for(var e,r=[],i=0,n=t.length;i<n;i++){var o=t[i];(e=o)&&"string"!=typeof e&&(e instanceof Array||Array.isArray(e)||0<=e.length&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))?r=a.call(r,s.call(o)):r.push(o)}return r};e.wrap=function(t){return function(){return t(e(arguments))}}}),j=e(function(t){var e={};for(var r in F)F.hasOwnProperty(r)&&(e[F[r]]=r);var i=t.exports={to:{},get:{}};function a(t,e,r){return Math.min(Math.max(e,t),r)}function n(t){var e=t.toString(16).toUpperCase();return e.length<2?"0"+e:e}i.get=function(t){var e,r;switch(t.substring(0,3).toLowerCase()){case"hsl":e=i.get.hsl(t),r="hsl";break;case"hwb":e=i.get.hwb(t),r="hwb";break;default:e=i.get.rgb(t),r="rgb"}return e?{model:r,value:e}:null},i.get.rgb=function(t){if(!t)return null;var e,r,i,n=[0,0,0,1];if(e=t.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(i=e[2],e=e[1],r=0;r<3;r++){var o=2*r;n[r]=parseInt(e.slice(o,2+o),16)}i&&(n[3]=Math.round(parseInt(i,16)/255*100)/100)}else if(e=t.match(/^#([a-f0-9]{3,4})$/i)){for(i=(e=e[1])[3],r=0;r<3;r++)n[r]=parseInt(e[r]+e[r],16);i&&(n[3]=Math.round(parseInt(i+i,16)/255*100)/100)}else if(e=t.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(r=0;r<3;r++)n[r]=parseInt(e[r+1],0);e[4]&&(n[3]=parseFloat(e[4]))}else{if(!(e=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(e=t.match(/(\D+)/))?"transparent"===e[1]?[0,0,0,0]:(n=F[e[1]])?(n[3]=1,n):null:null;for(r=0;r<3;r++)n[r]=Math.round(2.55*parseFloat(e[r+1]));e[4]&&(n[3]=parseFloat(e[4]))}for(r=0;r<3;r++)n[r]=a(n[r],0,255);return n[3]=a(n[3],0,1),n},i.get.hsl=function(t){if(!t)return null;var e=t.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(e){var r=parseFloat(e[4]);return[(parseFloat(e[1])+360)%360,a(parseFloat(e[2]),0,100),a(parseFloat(e[3]),0,100),a(isNaN(r)?1:r,0,1)]}return null},i.get.hwb=function(t){if(!t)return null;var e=t.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(e){var r=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,a(parseFloat(e[2]),0,100),a(parseFloat(e[3]),0,100),a(isNaN(r)?1:r,0,1)]}return null},i.to.hex=function(){var t=U(arguments);return"#"+n(t[0])+n(t[1])+n(t[2])+(t[3]<1?n(Math.round(255*t[3])):"")},i.to.rgb=function(){var t=U(arguments);return t.length<4||1===t[3]?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"},i.to.rgb.percent=function(){var t=U(arguments),e=Math.round(t[0]/255*100),r=Math.round(t[1]/255*100),i=Math.round(t[2]/255*100);return t.length<4||1===t[3]?"rgb("+e+"%, "+r+"%, "+i+"%)":"rgba("+e+"%, "+r+"%, "+i+"%, "+t[3]+")"},i.to.hsl=function(){var t=U(arguments);return t.length<4||1===t[3]?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"},i.to.hwb=function(){var t=U(arguments),e="";return 4<=t.length&&1!==t[3]&&(e=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+e+")"},i.to.keyword=function(t){return e[t.slice(0,3)]}}),q=(j.to,j.get,e(function(t){var u={};for(var e in F)F.hasOwnProperty(e)&&(u[F[e]]=e);var a=t.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var r in a)if(a.hasOwnProperty(r)){if(!("channels"in a[r]))throw new Error("missing channels property: "+r);if(!("labels"in a[r]))throw new Error("missing channel labels property: "+r);if(a[r].labels.length!==a[r].channels)throw new Error("channel and label counts mismatch: "+r);var i=a[r].channels,n=a[r].labels;delete a[r].channels,delete a[r].labels,Object.defineProperty(a[r],"channels",{value:i}),Object.defineProperty(a[r],"labels",{value:n})}a.rgb.hsl=function(t){var e,r,i=t[0]/255,n=t[1]/255,o=t[2]/255,a=Math.min(i,n,o),s=Math.max(i,n,o),l=s-a;return s===a?e=0:i===s?e=(n-o)/l:n===s?e=2+(o-i)/l:o===s&&(e=4+(i-n)/l),(e=Math.min(60*e,360))<0&&(e+=360),r=(a+s)/2,[e,100*(s===a?0:r<=.5?l/(s+a):l/(2-s-a)),100*r]},a.rgb.hsv=function(t){function e(t){return(c-t)/6/p+.5}var r,i,n,o,a,s=t[0]/255,l=t[1]/255,u=t[2]/255,c=Math.max(s,l,u),p=c-Math.min(s,l,u);return 0==p?o=a=0:(a=p/c,r=e(s),i=e(l),n=e(u),s===c?o=n-i:l===c?o=1/3+r-n:u===c&&(o=2/3+i-r),o<0?o+=1:1<o&&(o-=1)),[360*o,100*a,100*c]},a.rgb.hwb=function(t){var e=t[0],r=t[1],i=t[2];return[a.rgb.hsl(t)[0],100*(1/255*Math.min(e,Math.min(r,i))),100*(i=1-1/255*Math.max(e,Math.max(r,i)))]},a.rgb.cmyk=function(t){var e,r=t[0]/255,i=t[1]/255,n=t[2]/255;return[100*((1-r-(e=Math.min(1-r,1-i,1-n)))/(1-e)||0),100*((1-i-e)/(1-e)||0),100*((1-n-e)/(1-e)||0),100*e]},a.rgb.keyword=function(t){var e=u[t];if(e)return e;var r,i,n,o=1/0;for(var a in F)if(F.hasOwnProperty(a)){var s=F[a],l=(i=t,n=s,Math.pow(i[0]-n[0],2)+Math.pow(i[1]-n[1],2)+Math.pow(i[2]-n[2],2));l<o&&(o=l,r=a)}return r},a.keyword.rgb=function(t){return F[t]},a.rgb.xyz=function(t){var e=t[0]/255,r=t[1]/255,i=t[2]/255;return[100*(.4124*(e=.04045<e?Math.pow((e+.055)/1.055,2.4):e/12.92)+.3576*(r=.04045<r?Math.pow((r+.055)/1.055,2.4):r/12.92)+.1805*(i=.04045<i?Math.pow((i+.055)/1.055,2.4):i/12.92)),100*(.2126*e+.7152*r+.0722*i),100*(.0193*e+.1192*r+.9505*i)]},a.rgb.lab=function(t){var e=a.rgb.xyz(t),r=e[0],i=e[1],n=e[2];return i/=100,n/=108.883,r=.008856<(r/=95.047)?Math.pow(r,1/3):7.787*r+16/116,[116*(i=.008856<i?Math.pow(i,1/3):7.787*i+16/116)-16,500*(r-i),200*(i-(n=.008856<n?Math.pow(n,1/3):7.787*n+16/116))]},a.hsl.rgb=function(t){var e,r,i,n,o,a=t[0]/360,s=t[1]/100,l=t[2]/100;if(0==s)return[o=255*l,o,o];e=2*l-(r=l<.5?l*(1+s):l+s-l*s),n=[0,0,0];for(var u=0;u<3;u++)(i=a+1/3*-(u-1))<0&&i++,1<i&&i--,o=6*i<1?e+6*(r-e)*i:2*i<1?r:3*i<2?e+(r-e)*(2/3-i)*6:e,n[u]=255*o;return n},a.hsl.hsv=function(t){var e=t[0],r=t[1]/100,i=t[2]/100,n=r,o=Math.max(i,.01);return r*=(i*=2)<=1?i:2-i,n*=o<=1?o:2-o,[e,100*(0===i?2*n/(o+n):2*r/(i+r)),100*((i+r)/2)]},a.hsv.rgb=function(t){var e=t[0]/60,r=t[1]/100,i=t[2]/100,n=Math.floor(e)%6,o=e-Math.floor(e),a=255*i*(1-r),s=255*i*(1-r*o),l=255*i*(1-r*(1-o));switch(i*=255,n){case 0:return[i,l,a];case 1:return[s,i,a];case 2:return[a,i,l];case 3:return[a,s,i];case 4:return[l,a,i];case 5:return[i,a,s]}},a.hsv.hsl=function(t){var e,r,i,n=t[0],o=t[1]/100,a=t[2]/100,s=Math.max(a,.01);return i=(2-o)*a,r=o*s,[n,100*(r=(r/=(e=(2-o)*s)<=1?e:2-e)||0),100*(i/=2)]},a.hwb.rgb=function(t){var e,r,i,n,o,a,s,l=t[0]/360,u=t[1]/100,c=t[2]/100,p=u+c;switch(1<p&&(u/=p,c/=p),i=6*l-(e=Math.floor(6*l)),0!=(1&e)&&(i=1-i),n=u+i*((r=1-c)-u),e){default:case 6:case 0:o=r,a=n,s=u;break;case 1:o=n,a=r,s=u;break;case 2:o=u,a=r,s=n;break;case 3:o=u,a=n,s=r;break;case 4:o=n,a=u,s=r;break;case 5:o=r,a=u,s=n}return[255*o,255*a,255*s]},a.cmyk.rgb=function(t){var e=t[0]/100,r=t[1]/100,i=t[2]/100,n=t[3]/100;return[255*(1-Math.min(1,e*(1-n)+n)),255*(1-Math.min(1,r*(1-n)+n)),255*(1-Math.min(1,i*(1-n)+n))]},a.xyz.rgb=function(t){var e,r,i,n=t[0]/100,o=t[1]/100,a=t[2]/100;return r=-.9689*n+1.8758*o+.0415*a,i=.0557*n+-.204*o+1.057*a,e=.0031308<(e=3.2406*n+-1.5372*o+-.4986*a)?1.055*Math.pow(e,1/2.4)-.055:12.92*e,r=.0031308<r?1.055*Math.pow(r,1/2.4)-.055:12.92*r,i=.0031308<i?1.055*Math.pow(i,1/2.4)-.055:12.92*i,[255*(e=Math.min(Math.max(0,e),1)),255*(r=Math.min(Math.max(0,r),1)),255*(i=Math.min(Math.max(0,i),1))]},a.xyz.lab=function(t){var e=t[0],r=t[1],i=t[2];return r/=100,i/=108.883,e=.008856<(e/=95.047)?Math.pow(e,1/3):7.787*e+16/116,[116*(r=.008856<r?Math.pow(r,1/3):7.787*r+16/116)-16,500*(e-r),200*(r-(i=.008856<i?Math.pow(i,1/3):7.787*i+16/116))]},a.lab.xyz=function(t){var e,r,i,n=t[0];e=t[1]/500+(r=(n+16)/116),i=r-t[2]/200;var o=Math.pow(r,3),a=Math.pow(e,3),s=Math.pow(i,3);return r=.008856<o?o:(r-16/116)/7.787,e=.008856<a?a:(e-16/116)/7.787,i=.008856<s?s:(i-16/116)/7.787,[e*=95.047,r*=100,i*=108.883]},a.lab.lch=function(t){var e,r=t[0],i=t[1],n=t[2];return(e=360*Math.atan2(n,i)/2/Math.PI)<0&&(e+=360),[r,Math.sqrt(i*i+n*n),e]},a.lch.lab=function(t){var e,r=t[0],i=t[1];return e=t[2]/360*2*Math.PI,[r,i*Math.cos(e),i*Math.sin(e)]},a.rgb.ansi16=function(t){var e=t[0],r=t[1],i=t[2],n=1 in arguments?arguments[1]:a.rgb.hsv(t)[2];if(0===(n=Math.round(n/50)))return 30;var o=30+(Math.round(i/255)<<2|Math.round(r/255)<<1|Math.round(e/255));return 2===n&&(o+=60),o},a.hsv.ansi16=function(t){return a.rgb.ansi16(a.hsv.rgb(t),t[2])},a.rgb.ansi256=function(t){var e=t[0],r=t[1],i=t[2];return e===r&&r===i?e<8?16:248<e?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(r/255*5)+Math.round(i/255*5)},a.ansi16.rgb=function(t){var e=t%10;if(0===e||7===e)return 50<t&&(e+=3.5),[e=e/10.5*255,e,e];var r=.5*(1+~~(50<t));return[(1&e)*r*255,(e>>1&1)*r*255,(e>>2&1)*r*255]},a.ansi256.rgb=function(t){if(232<=t){var e=10*(t-232)+8;return[e,e,e]}var r;return t-=16,[Math.floor(t/36)/5*255,Math.floor((r=t%36)/6)/5*255,r%6/5*255]},a.rgb.hex=function(t){var e=(((255&Math.round(t[0]))<<16)+((255&Math.round(t[1]))<<8)+(255&Math.round(t[2]))).toString(16).toUpperCase();return"000000".substring(e.length)+e},a.hex.rgb=function(t){var e=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];var r=e[0];3===e[0].length&&(r=r.split("").map(function(t){return t+t}).join(""));var i=parseInt(r,16);return[i>>16&255,i>>8&255,255&i]},a.rgb.hcg=function(t){var e,r=t[0]/255,i=t[1]/255,n=t[2]/255,o=Math.max(Math.max(r,i),n),a=Math.min(Math.min(r,i),n),s=o-a;return e=s<=0?0:o===r?(i-n)/s%6:o===i?2+(n-r)/s:4+(r-i)/s+4,e/=6,[360*(e%=1),100*s,100*(s<1?a/(1-s):0)]},a.hsl.hcg=function(t){var e=t[1]/100,r=t[2]/100,i=1,n=0;return(i=r<.5?2*e*r:2*e*(1-r))<1&&(n=(r-.5*i)/(1-i)),[t[0],100*i,100*n]},a.hsv.hcg=function(t){var e=t[1]/100,r=t[2]/100,i=e*r,n=0;return i<1&&(n=(r-i)/(1-i)),[t[0],100*i,100*n]},a.hcg.rgb=function(t){var e=t[0]/360,r=t[1]/100,i=t[2]/100;if(0==r)return[255*i,255*i,255*i];var n,o=[0,0,0],a=e%1*6,s=a%1,l=1-s;switch(Math.floor(a)){case 0:o[0]=1,o[1]=s,o[2]=0;break;case 1:o[0]=l,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=s;break;case 3:o[0]=0,o[1]=l,o[2]=1;break;case 4:o[0]=s,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=l}return n=(1-r)*i,[255*(r*o[0]+n),255*(r*o[1]+n),255*(r*o[2]+n)]},a.hcg.hsv=function(t){var e=t[1]/100,r=e+t[2]/100*(1-e),i=0;return 0<r&&(i=e/r),[t[0],100*i,100*r]},a.hcg.hsl=function(t){var e=t[1]/100,r=t[2]/100*(1-e)+.5*e,i=0;return 0<r&&r<.5?i=e/(2*r):.5<=r&&r<1&&(i=e/(2*(1-r))),[t[0],100*i,100*r]},a.hcg.hwb=function(t){var e=t[1]/100,r=e+t[2]/100*(1-e);return[t[0],100*(r-e),100*(1-r)]},a.hwb.hcg=function(t){var e=t[1]/100,r=1-t[2]/100,i=r-e,n=0;return i<1&&(n=(r-i)/(1-i)),[t[0],100*i,100*n]},a.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]},a.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]},a.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]},a.gray.hsl=a.gray.hsv=function(t){return[0,0,t[0]]},a.gray.hwb=function(t){return[0,100,t[0]]},a.gray.cmyk=function(t){return[0,0,0,t[0]]},a.gray.lab=function(t){return[t[0],0,0]},a.gray.hex=function(t){var e=255&Math.round(t[0]/100*255),r=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(r.length)+r},a.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]}}));q.rgb,q.hsl,q.hsv,q.hwb,q.cmyk,q.xyz,q.lab,q.lch,q.hex,q.keyword,q.ansi16,q.ansi256,q.hcg,q.apple,q.gray;function V(t){var e=function(){for(var t={},e=Object.keys(q),r=e.length,i=0;i<r;i++)t[e[i]]={distance:-1,parent:null};return t}(),r=[t];for(e[t].distance=0;r.length;)for(var i=r.pop(),n=Object.keys(q[i]),o=n.length,a=0;a<o;a++){var s=n[a],l=e[s];-1===l.distance&&(l.distance=e[i].distance+1,l.parent=i,r.unshift(s))}return e}function G(e,r){return function(t){return r(e(t))}}function Z(t,e){for(var r=[e[t].parent,t],i=q[e[t].parent][t],n=e[t].parent;e[n].parent;)r.unshift(e[n].parent),i=G(q[e[n].parent][n],i),n=e[n].parent;return i.conversion=r,i}var H={};Object.keys(q).forEach(function(r){H[r]={},Object.defineProperty(H[r],"channels",{value:q[r].channels}),Object.defineProperty(H[r],"labels",{value:q[r].labels});var i=function(t){for(var e=V(t),r={},i=Object.keys(e),n=i.length,o=0;o<n;o++){var a=i[o];null!==e[a].parent&&(r[a]=Z(a,e))}return r}(r);Object.keys(i).forEach(function(t){var e=i[t];H[r][t]=function(n){function t(t){if(null==t)return t;1<arguments.length&&(t=Array.prototype.slice.call(arguments));var e=n(t);if("object"==typeof e)for(var r=e.length,i=0;i<r;i++)e[i]=Math.round(e[i]);return e}return"conversion"in n&&(t.conversion=n.conversion),t}(e),H[r][t].raw=function(e){function t(t){return null==t?t:(1<arguments.length&&(t=Array.prototype.slice.call(arguments)),e(t))}return"conversion"in e&&(t.conversion=e.conversion),t}(e)})});var W=H,K=[].slice,X=["keyword","gray","hex"],Y={};Object.keys(W).forEach(function(t){Y[K.call(W[t].labels).sort().join("")]=t});var J={};function Q(t,e){if(!(this instanceof Q))return new Q(t,e);if(e&&e in X&&(e=null),e&&!(e in W))throw new Error("Unknown model: "+e);var r,i;if(null==t)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(t instanceof Q)this.model=t.model,this.color=t.color.slice(),this.valpha=t.valpha;else if("string"==typeof t){var n=j.get(t);if(null===n)throw new Error("Unable to parse color from string: "+t);this.model=n.model,i=W[this.model].channels,this.color=n.value.slice(0,i),this.valpha="number"==typeof n.value[i]?n.value[i]:1}else if(t.length){this.model=e||"rgb",i=W[this.model].channels;var o=K.call(t,0,i);this.color=et(o,i),this.valpha="number"==typeof t[i]?t[i]:1}else if("number"==typeof t)t&=16777215,this.model="rgb",this.color=[t>>16&255,t>>8&255,255&t],this.valpha=1;else{this.valpha=1;var a=Object.keys(t);"alpha"in t&&(a.splice(a.indexOf("alpha"),1),this.valpha="number"==typeof t.alpha?t.alpha:0);var s=a.sort().join("");if(!(s in Y))throw new Error("Unable to parse color from object: "+JSON.stringify(t));this.model=Y[s];var l=W[this.model].labels,u=[];for(r=0;r<l.length;r++)u.push(t[l[r]]);this.color=et(u)}if(J[this.model])for(i=W[this.model].channels,r=0;r<i;r++){var c=J[this.model][r];c&&(this.color[r]=c(this.color[r]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function $(r,i,n){return(r=Array.isArray(r)?r:[r]).forEach(function(t){(J[t]||(J[t]=[]))[i]=n}),r=r[0],function(t){var e;return arguments.length?(n&&(t=n(t)),(e=this[r]()).color[i]=t):(e=this[r]().color[i],n&&(e=n(e))),e}}function tt(e){return function(t){return Math.max(0,Math.min(e,t))}}function et(t,e){for(var r=0;r<e;r++)"number"!=typeof t[r]&&(t[r]=0);return t}Q.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(t){var e=this.model in j.to?this:this.rgb(),r=1===(e=e.round("number"==typeof t?t:1)).valpha?e.color:e.color.concat(this.valpha);return j.to[e.model](r)},percentString:function(t){var e=this.rgb().round("number"==typeof t?t:1),r=1===e.valpha?e.color:e.color.concat(this.valpha);return j.to.rgb.percent(r)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var t={},e=W[this.model].channels,r=W[this.model].labels,i=0;i<e;i++)t[r[i]]=this.color[i];return 1!==this.valpha&&(t.alpha=this.valpha),t},unitArray:function(){var t=this.rgb().color;return t[0]/=255,t[1]/=255,t[2]/=255,1!==this.valpha&&t.push(this.valpha),t},unitObject:function(){var t=this.rgb().object();return t.r/=255,t.g/=255,t.b/=255,1!==this.valpha&&(t.alpha=this.valpha),t},round:function(t){return t=Math.max(t||0,0),new Q(this.color.map(function(e){return function(t){return function(t,e){return Number(t.toFixed(e))}(t,e)}}(t)).concat(this.valpha),this.model)},alpha:function(t){return arguments.length?new Q(this.color.concat(Math.max(0,Math.min(1,t))),this.model):this.valpha},red:$("rgb",0,tt(255)),green:$("rgb",1,tt(255)),blue:$("rgb",2,tt(255)),hue:$(["hsl","hsv","hsl","hwb","hcg"],0,function(t){return(t%360+360)%360}),saturationl:$("hsl",1,tt(100)),lightness:$("hsl",2,tt(100)),saturationv:$("hsv",1,tt(100)),value:$("hsv",2,tt(100)),chroma:$("hcg",1,tt(100)),gray:$("hcg",2,tt(100)),white:$("hwb",1,tt(100)),wblack:$("hwb",2,tt(100)),cyan:$("cmyk",0,tt(100)),magenta:$("cmyk",1,tt(100)),yellow:$("cmyk",2,tt(100)),black:$("cmyk",3,tt(100)),x:$("xyz",0,tt(100)),y:$("xyz",1,tt(100)),z:$("xyz",2,tt(100)),l:$("lab",0,tt(100)),a:$("lab",1),b:$("lab",2),keyword:function(t){return arguments.length?new Q(t):W[this.model].keyword(this.color)},hex:function(t){return arguments.length?new Q(t):j.to.hex(this.rgb().round().color)},rgbNumber:function(){var t=this.rgb().color;return(255&t[0])<<16|(255&t[1])<<8|255&t[2]},luminosity:function(){for(var t=this.rgb().color,e=[],r=0;r<t.length;r++){var i=t[r]/255;e[r]=i<=.03928?i/12.92:Math.pow((.055+i)/1.055,2.4)}return.2126*e[0]+.7152*e[1]+.0722*e[2]},contrast:function(t){var e=this.luminosity(),r=t.luminosity();return r<e?(e+.05)/(r+.05):(r+.05)/(e+.05)},level:function(t){var e=this.contrast(t);return 7.1<=e?"AAA":4.5<=e?"AA":""},isDark:function(){var t=this.rgb().color;return(299*t[0]+587*t[1]+114*t[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var t=this.rgb(),e=0;e<3;e++)t.color[e]=255-t.color[e];return t},lighten:function(t){var e=this.hsl();return e.color[2]+=e.color[2]*t,e},darken:function(t){var e=this.hsl();return e.color[2]-=e.color[2]*t,e},saturate:function(t){var e=this.hsl();return e.color[1]+=e.color[1]*t,e},desaturate:function(t){var e=this.hsl();return e.color[1]-=e.color[1]*t,e},whiten:function(t){var e=this.hwb();return e.color[1]+=e.color[1]*t,e},blacken:function(t){var e=this.hwb();return e.color[2]+=e.color[2]*t,e},grayscale:function(){var t=this.rgb().color,e=.3*t[0]+.59*t[1]+.11*t[2];return Q.rgb(e,e,e)},fade:function(t){return this.alpha(this.valpha-this.valpha*t)},opaquer:function(t){return this.alpha(this.valpha+this.valpha*t)},rotate:function(t){var e=this.hsl(),r=e.color[0];return r=(r=(r+t)%360)<0?360+r:r,e.color[0]=r,e},mix:function(t,e){if(!t||!t.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof t);var r=t.rgb(),i=this.rgb(),n=void 0===e?.5:e,o=2*n-1,a=r.alpha()-i.alpha(),s=(1+(o*a==-1?o:(o+a)/(1+o*a)))/2,l=1-s;return Q.rgb(s*r.red()+l*i.red(),s*r.green()+l*i.green(),s*r.blue()+l*i.blue(),r.alpha()*n+i.alpha()*(1-n))}},Object.keys(W).forEach(function(e){if(-1===X.indexOf(e)){var r=W[e].channels;Q.prototype[e]=function(){if(this.model===e)return new Q(this);if(arguments.length)return new Q(arguments,e);var t="number"==typeof arguments[r]?r:this.valpha;return new Q(function(t){return Array.isArray(t)?t:[t]}(W[this.model][e].raw(this.color)).concat(t),e)},Q[e]=function(t){return"number"==typeof t&&(t=et(K.call(arguments),r)),new Q(t,e)}}});var rt,it=Q;(rt=p.ControlStyle||(p.ControlStyle={})).light="light",rt.dark="dark",rt.auto="auto";var nt=(ot.prototype.onRemove=function(){this._container&&(this._container.remove(),delete this._container),this._map&&(this._map.events.remove("styledata",this._onStyleChange),delete this._map),this._observer&&(this._observer.disconnect(),delete this._observer),delete this._theme},ot.prototype.buildContainer=function(t,e,r,i){var n=this;return this._map=t,this._container=document.createElement(i||"div"),this._container.classList.add("azure-maps-control-container"),"string"==typeof r&&this._container.setAttribute("aria-label",r),e.toLowerCase()===p.ControlStyle.auto?this._map.styles.initialize().then(function(){n._onStyleChange(),n._map.events.add("styledata",n._onStyleChange)}):this._container.classList.add(e),this._container},ot.prototype._setTheme=function(t){this._theme!==t&&(this._container.classList.remove(this._theme),this._container.classList.add(t),this._theme=t)},ot);function ot(){var e=this;this._onStyleChange=function(){if(e._map.getStyle().style.toLowerCase().startsWith("blank"))e._observer||(e._onBackgroundChange(),e._observer=new MutationObserver(e._onBackgroundChange),e._observer.observe(e._map.getMapContainer(),{attributes:!0,attributeFilter:["style"]}));else{e._observer&&(e._observer.disconnect(),delete e._observer);var t=e._map.styles.getTheme(e._map.getStyle());e._setTheme(t)}},this._onBackgroundChange=function(){try{var t=.5<it(e._map.getMapContainer().style.backgroundColor).luminosity()?p.ControlStyle.light:p.ControlStyle.dark;e._setTheme(t)}catch(t){e._setTheme(p.ControlStyle.light)}}}var at,st=(b(lt,at=E),lt);function lt(){var t=null!==at&&at.apply(this,arguments)||this;return t.rotationDegreesDelta=15,t.style=p.ControlStyle.light,t}var ut,ct=(b(pt,ut=nt),pt.prototype.onAdd=function(t,e){var r=this,i=this.buildContainer(t,this.options.style,"Rotation Control"),n=this.constructRotationButton(t),o=this.constructRightRotationButton(t),a=this.constructLeftRotationButton(t);return i.addEventListener("mouseover",function(){r.hasMouse=!0,i.classList.add("in-use"),o.classList.remove("hidden-accessible-element"),a.classList.remove("hidden-accessible-element")}),i.addEventListener("focusin",function(){i.classList.add("in-use"),o.classList.remove("hidden-accessible-element"),a.classList.remove("hidden-accessible-element")}),i.addEventListener("mouseleave",function(){r.hasMouse=!1,i.classList.remove("in-use"),o.classList.add("hidden-accessible-element"),a.classList.add("hidden-accessible-element")}),i.addEventListener("focusout",function(t){r.hasMouse||t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(i.classList.remove("in-use"),o.classList.add("hidden-accessible-element"),a.classList.add("hidden-accessible-element"))}),e&&pt.InvertOrderPositions.includes(e.position)?(i.appendChild(o),i.appendChild(a),i.appendChild(n)):(i.appendChild(n),i.appendChild(a),i.appendChild(o)),i},pt.prototype.constructRotationButton=function(t){var e=document.createElement("button");e.classList.add("azure-maps-control-button"),e.classList.add("rotation"),e.setAttribute("title","Reset to Default Rotation"),e.setAttribute("alt","Reset to Default Rotation"),e.setAttribute("type","button");var r=document.createElement("div");return e.appendChild(r),e.addEventListener("click",function(){t.setCamera({bearing:pt.DefaultRotation},!0)}),t.events.add("rotate",function(t){r.style.transform="rotate("+-t.map.getCamera().bearing+"deg)"}),e},pt.prototype.constructRightRotationButton=function(t){var e=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("rotation-right"),r.classList.add("hidden-accessible-element"),r.setAttribute("title","Rotate Right"),r.setAttribute("alt","Rotate Right"),r.setAttribute("type","button"),r.addEventListener("click",function(){t.setCamera({bearing:t.getCamera().bearing+e.options.rotationDegreesDelta,duration:pt.RotationDuration,type:"ease"},!0)}),r},pt.prototype.constructLeftRotationButton=function(t){var e=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("rotation-left"),r.classList.add("hidden-accessible-element"),r.setAttribute("title","Rotate Left"),r.setAttribute("alt","Rotate Left"),r.setAttribute("type","button"),r.addEventListener("click",function(){t.setCamera({bearing:t.getCamera().bearing-e.options.rotationDegreesDelta,duration:pt.RotationDuration,type:"ease"},!0)}),r},pt.DefaultRotation=0,pt.RotationDuration=100,pt.InvertOrderPositions=[p.ControlPosition.BottomRight,p.ControlPosition.TopRight],pt);function pt(t){var e=ut.call(this)||this;return e.hasMouse=!1,e.options=(new st).merge(t),e}var ht,dt=(b(ft,ht=E),ft);function ft(){var t=null!==ht&&ht.apply(this,arguments)||this;return t.pitchDegreesDelta=10,t.style=p.ControlStyle.light,t}var mt,gt=(b(yt,mt=nt),yt.prototype.onAdd=function(t,e){var r=this,i=this.buildContainer(t,this.options.style,"Pitch Control"),n=this.constructPitchButton(t),o=this.constructPitchIncrementButton(t),a=this.constructPitchDecrementButton(t);return i.addEventListener("mouseover",function(){r.hasMouse=!0,i.classList.add("in-use"),o.classList.remove("hidden-accessible-element"),a.classList.remove("hidden-accessible-element")}),i.addEventListener("focusin",function(){i.classList.add("in-use"),o.classList.remove("hidden-accessible-element"),a.classList.remove("hidden-accessible-element")}),i.addEventListener("mouseleave",function(){r.hasMouse=!1,i.classList.remove("in-use"),o.classList.add("hidden-accessible-element"),a.classList.add("hidden-accessible-element")}),i.addEventListener("focusout",function(t){r.hasMouse||t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(i.classList.remove("in-use"),o.classList.add("hidden-accessible-element"),a.classList.add("hidden-accessible-element"))}),e&&yt.INVERT_ORDER_POSITIONS.includes(e.position)?(i.appendChild(a),i.appendChild(o),i.appendChild(n)):(i.appendChild(n),i.appendChild(o),i.appendChild(a)),i},yt.prototype.constructPitchButton=function(t){var e=document.createElement("button");return e.classList.add("azure-maps-control-button"),e.classList.add("pitch"),e.setAttribute("title","Reset to Default Pitch"),e.setAttribute("alt","Reset to Default Pitch"),e.setAttribute("type","button"),e.addEventListener("click",function(){t.setCamera({pitch:yt.DEFAULT_PITCH},!0)}),e},yt.prototype.constructPitchDecrementButton=function(t){var e=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("pitch-down"),r.classList.add("hidden-accessible-element"),r.setAttribute("title","Decrease Pitch"),r.setAttribute("alt","Decrease Pitch"),r.setAttribute("type","button"),r.addEventListener("click",function(){t.setCamera({pitch:t.getCamera().pitch-e.options.pitchDegreesDelta,duration:yt.PITCH_DURATION_MS,type:"ease"},!0)}),r},yt.prototype.constructPitchIncrementButton=function(t){var e=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("pitch-up"),r.classList.add("hidden-accessible-element"),r.setAttribute("title","Increase Pitch"),r.setAttribute("alt","Increase Pitch"),r.setAttribute("type","button"),r.addEventListener("click",function(){t.setCamera({pitch:t.getCamera().pitch+e.options.pitchDegreesDelta,duration:yt.PITCH_DURATION_MS,type:"ease"},!0)}),r},yt.PITCH_DURATION_MS=100,yt.DEFAULT_PITCH=0,yt.INVERT_ORDER_POSITIONS=[p.ControlPosition.BottomRight,p.ControlPosition.TopRight],yt);function yt(t){var e=mt.call(this)||this;return e.hasMouse=!1,e.options=(new dt).merge(t),e}function vt(){this.__data__=[],this.size=0}var _t=function(t,e){return t===e||t!=t&&e!=e};var xt=function(t,e){for(var r=t.length;r--;)if(_t(t[r][0],e))return r;return-1},bt=Array.prototype.splice;function wt(t){var e=this.__data__,r=xt(e,t);return!(r<0)&&(r==e.length-1?e.pop():bt.call(e,r,1),--this.size,!0)}function St(t){var e=this.__data__,r=xt(e,t);return r<0?void 0:e[r][1]}function Tt(t){return-1<xt(this.__data__,t)}function Et(t,e){var r=this.__data__,i=xt(r,t);return i<0?(++this.size,r.push([t,e])):r[i][1]=e,this}function It(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}It.prototype.clear=vt,It.prototype.delete=wt,It.prototype.get=St,It.prototype.has=Tt,It.prototype.set=Et;var Ct=It;function kt(){this.__data__=new Ct,this.size=0}function At(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function Pt(t){return this.__data__.get(t)}function Mt(t){return this.__data__.has(t)}var Lt="object"==typeof t&&t&&t.Object===Object&&t,Ot="object"==typeof self&&self&&self.Object===Object&&self,Dt=Lt||Ot||Function("return this")(),Rt=Dt.Symbol,zt=Object.prototype,Nt=zt.hasOwnProperty,Bt=zt.toString,Ft=Rt?Rt.toStringTag:void 0;var Ut=function(t){var e=Nt.call(t,Ft),r=t[Ft];try{var i=!(t[Ft]=void 0)}catch(t){}var n=Bt.call(t);return i&&(e?t[Ft]=r:delete t[Ft]),n},jt=Object.prototype.toString;var qt=function(t){return jt.call(t)},Vt=Rt?Rt.toStringTag:void 0;var Gt=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Vt&&Vt in Object(t)?Ut(t):qt(t)};var Zt=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};var Ht,Wt=function(t){if(!Zt(t))return!1;var e=Gt(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},Kt=Dt["__core-js_shared__"],Xt=(Ht=/[^.]+$/.exec(Kt&&Kt.keys&&Kt.keys.IE_PROTO||""))?"Symbol(src)_1."+Ht:"";var Yt=function(t){return!!Xt&&Xt in t},Jt=Function.prototype.toString;var Qt=function(t){if(null!=t){try{return Jt.call(t)}catch(t){}try{return t+""}catch(t){}}return""},$t=/^\[object .+?Constructor\]$/,te=Function.prototype,ee=Object.prototype,re=te.toString,ie=ee.hasOwnProperty,ne=RegExp("^"+re.call(ie).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var oe=function(t){return!(!Zt(t)||Yt(t))&&(Wt(t)?ne:$t).test(Qt(t))};var ae=function(t,e){return null==t?void 0:t[e]};var se=function(t,e){var r=ae(t,e);return oe(r)?r:void 0},le=se(Dt,"Map"),ue=se(Object,"create");function ce(){this.__data__=ue?ue(null):{},this.size=0}function pe(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var he=Object.prototype.hasOwnProperty;function de(t){var e=this.__data__;if(ue){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return he.call(e,t)?e[t]:void 0}var fe=Object.prototype.hasOwnProperty;function me(t){var e=this.__data__;return ue?void 0!==e[t]:fe.call(e,t)}function ge(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=ue&&void 0===e?"__lodash_hash_undefined__":e,this}function ye(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}ye.prototype.clear=ce,ye.prototype.delete=pe,ye.prototype.get=de,ye.prototype.has=me,ye.prototype.set=ge;var ve=ye;var _e=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var xe=function(t,e){var r=t.__data__;return _e(e)?r["string"==typeof e?"string":"hash"]:r.map};function be(t){var e=xe(this,t).delete(t);return this.size-=e?1:0,e}function we(t){return xe(this,t).get(t)}function Se(t){return xe(this,t).has(t)}function Te(t,e){var r=xe(this,t),i=r.size;return r.set(t,e),this.size+=r.size==i?0:1,this}function Ee(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}Ee.prototype.clear=function(){this.size=0,this.__data__={hash:new ve,map:new(le||Ct),string:new ve}},Ee.prototype.delete=be,Ee.prototype.get=we,Ee.prototype.has=Se,Ee.prototype.set=Te;var Ie=Ee;function Ce(t,e){var r=this.__data__;if(r instanceof Ct){var i=r.__data__;if(!le||i.length<199)return i.push([t,e]),this.size=++r.size,this;r=this.__data__=new Ie(i)}return r.set(t,e),this.size=r.size,this}function ke(t){var e=this.__data__=new Ct(t);this.size=e.size}ke.prototype.clear=kt,ke.prototype.delete=At,ke.prototype.get=Pt,ke.prototype.has=Mt,ke.prototype.set=Ce;var Ae=ke;var Pe=function(t,e){for(var r=-1,i=null==t?0:t.length;++r<i&&!1!==e(t[r],r,t););return t},Me=function(){try{var t=se(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var Le=function(t,e,r){"__proto__"==e&&Me?Me(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r},Oe=Object.prototype.hasOwnProperty;var De=function(t,e,r){var i=t[e];Oe.call(t,e)&&_t(i,r)&&(void 0!==r||e in t)||Le(t,e,r)};var Re=function(t,e,r,i){var n=!r;r=r||{};for(var o=-1,a=e.length;++o<a;){var s=e[o],l=i?i(r[s],t[s],s,r,t):void 0;void 0===l&&(l=t[s]),n?Le(r,s,l):De(r,s,l)}return r};var ze=function(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i};var Ne=function(t){return null!=t&&"object"==typeof t};var Be=function(t){return Ne(t)&&"[object Arguments]"==Gt(t)},Fe=Object.prototype,Ue=Fe.hasOwnProperty,je=Fe.propertyIsEnumerable,qe=Be(function(){return arguments}())?Be:function(t){return Ne(t)&&Ue.call(t,"callee")&&!je.call(t,"callee")},Ve=Array.isArray;function Ge(){return!1}var Ze=e(function(t,e){var r=e&&!e.nodeType&&e,i=r&&t&&!t.nodeType&&t,n=i&&i.exports===r?Dt.Buffer:void 0,o=(n?n.isBuffer:void 0)||Ge;t.exports=o}),He=/^(?:0|[1-9]\d*)$/;var We=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&He.test(t))&&-1<t&&t%1==0&&t<e};var Ke=function(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=9007199254740991},Xe={};Xe["[object Float32Array]"]=Xe["[object Float64Array]"]=Xe["[object Int8Array]"]=Xe["[object Int16Array]"]=Xe["[object Int32Array]"]=Xe["[object Uint8Array]"]=Xe["[object Uint8ClampedArray]"]=Xe["[object Uint16Array]"]=Xe["[object Uint32Array]"]=!0,Xe["[object Arguments]"]=Xe["[object Array]"]=Xe["[object ArrayBuffer]"]=Xe["[object Boolean]"]=Xe["[object DataView]"]=Xe["[object Date]"]=Xe["[object Error]"]=Xe["[object Function]"]=Xe["[object Map]"]=Xe["[object Number]"]=Xe["[object Object]"]=Xe["[object RegExp]"]=Xe["[object Set]"]=Xe["[object String]"]=Xe["[object WeakMap]"]=!1;function Ye(t){return Ne(t)&&Ke(t.length)&&!!Xe[Gt(t)]}var Je=function(e){return function(t){return e(t)}},Qe=e(function(t,e){var r=e&&!e.nodeType&&e,i=r&&t&&!t.nodeType&&t,n=i&&i.exports===r&&Lt.process,o=function(){try{var t=i&&i.require&&i.require("util").types;return t||n&&n.binding&&n.binding("util")}catch(t){}}();t.exports=o}),$e=Qe&&Qe.isTypedArray,tr=$e?Je($e):Ye,er=Object.prototype.hasOwnProperty;var rr=function(t,e){var r=Ve(t),i=!r&&qe(t),n=!r&&!i&&Ze(t),o=!r&&!i&&!n&&tr(t),a=r||i||n||o,s=a?ze(t.length,String):[],l=s.length;for(var u in t)!e&&!er.call(t,u)||a&&("length"==u||n&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||We(u,l))||s.push(u);return s},ir=Object.prototype;var nr=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||ir)};var or=function(e,r){return function(t){return e(r(t))}},ar=or(Object.keys,Object),sr=Object.prototype.hasOwnProperty;var lr=function(t){if(!nr(t))return ar(t);var e=[];for(var r in Object(t))sr.call(t,r)&&"constructor"!=r&&e.push(r);return e};var ur=function(t){return null!=t&&Ke(t.length)&&!Wt(t)};var cr=function(t){return ur(t)?rr(t):lr(t)};var pr=function(t,e){return t&&Re(e,cr(e),t)};var hr=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e},dr=Object.prototype.hasOwnProperty;var fr=function(t){if(!Zt(t))return hr(t);var e=nr(t),r=[];for(var i in t)("constructor"!=i||!e&&dr.call(t,i))&&r.push(i);return r};var mr=function(t){return ur(t)?rr(t,!0):fr(t)};var gr=function(t,e){return t&&Re(e,mr(e),t)},yr=e(function(t,e){var r=e&&!e.nodeType&&e,i=r&&t&&!t.nodeType&&t,n=i&&i.exports===r?Dt.Buffer:void 0,o=n?n.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var r=t.length,i=o?o(r):new t.constructor(r);return t.copy(i),i}});var vr=function(t,e){var r=-1,i=t.length;for(e=e||Array(i);++r<i;)e[r]=t[r];return e};var _r=function(t,e){for(var r=-1,i=null==t?0:t.length,n=0,o=[];++r<i;){var a=t[r];e(a,r,t)&&(o[n++]=a)}return o};function xr(){return[]}var br=Object.prototype.propertyIsEnumerable,wr=Object.getOwnPropertySymbols,Sr=wr?function(e){return null==e?[]:(e=Object(e),_r(wr(e),function(t){return br.call(e,t)}))}:xr;var Tr=function(t,e){return Re(t,Sr(t),e)};var Er=function(t,e){for(var r=-1,i=e.length,n=t.length;++r<i;)t[n+r]=e[r];return t},Ir=or(Object.getPrototypeOf,Object),Cr=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Er(e,Sr(t)),t=Ir(t);return e}:xr;var kr=function(t,e){return Re(t,Cr(t),e)};var Ar=function(t,e,r){var i=e(t);return Ve(t)?i:Er(i,r(t))};var Pr=function(t){return Ar(t,cr,Sr)};var Mr=function(t){return Ar(t,mr,Cr)},Lr=se(Dt,"DataView"),Or=se(Dt,"Promise"),Dr=se(Dt,"Set"),Rr=se(Dt,"WeakMap"),zr="[object Map]",Nr="[object Promise]",Br="[object Set]",Fr="[object WeakMap]",Ur="[object DataView]",jr=Qt(Lr),qr=Qt(le),Vr=Qt(Or),Gr=Qt(Dr),Zr=Qt(Rr),Hr=Gt;(Lr&&Hr(new Lr(new ArrayBuffer(1)))!=Ur||le&&Hr(new le)!=zr||Or&&Hr(Or.resolve())!=Nr||Dr&&Hr(new Dr)!=Br||Rr&&Hr(new Rr)!=Fr)&&(Hr=function(t){var e=Gt(t),r="[object Object]"==e?t.constructor:void 0,i=r?Qt(r):"";if(i)switch(i){case jr:return Ur;case qr:return zr;case Vr:return Nr;case Gr:return Br;case Zr:return Fr}return e});var Wr=Hr,Kr=Object.prototype.hasOwnProperty;var Xr=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&Kr.call(t,"index")&&(r.index=t.index,r.input=t.input),r},Yr=Dt.Uint8Array;var Jr=function(t){var e=new t.constructor(t.byteLength);return new Yr(e).set(new Yr(t)),e};var Qr=function(t,e){var r=e?Jr(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)},$r=/\w*$/;var ti=function(t){var e=new t.constructor(t.source,$r.exec(t));return e.lastIndex=t.lastIndex,e},ei=Rt?Rt.prototype:void 0,ri=ei?ei.valueOf:void 0;var ii=function(t){return ri?Object(ri.call(t)):{}};var ni=function(t,e){var r=e?Jr(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)};var oi=function(t,e,r){var i=t.constructor;switch(e){case"[object ArrayBuffer]":return Jr(t);case"[object Boolean]":case"[object Date]":return new i(+t);case"[object DataView]":return Qr(t,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return ni(t,r);case"[object Map]":return new i;case"[object Number]":case"[object String]":return new i(t);case"[object RegExp]":return ti(t);case"[object Set]":return new i;case"[object Symbol]":return ii(t)}},ai=Object.create;function si(){}var li=function(t){if(!Zt(t))return{};if(ai)return ai(t);si.prototype=t;var e=new si;return si.prototype=void 0,e};var ui=function(t){return"function"!=typeof t.constructor||nr(t)?{}:li(Ir(t))};function ci(t){return Ne(t)&&"[object Map]"==Wr(t)}var pi=Qe&&Qe.isMap,hi=pi?Je(pi):ci;function di(t){return Ne(t)&&"[object Set]"==Wr(t)}var fi=Qe&&Qe.isSet,mi=fi?Je(fi):di,gi=1,yi=2,vi=4,_i="[object Arguments]",xi="[object Function]",bi="[object GeneratorFunction]",wi="[object Object]",Si={};Si[_i]=Si["[object Array]"]=Si["[object ArrayBuffer]"]=Si["[object DataView]"]=Si["[object Boolean]"]=Si["[object Date]"]=Si["[object Float32Array]"]=Si["[object Float64Array]"]=Si["[object Int8Array]"]=Si["[object Int16Array]"]=Si["[object Int32Array]"]=Si["[object Map]"]=Si["[object Number]"]=Si[wi]=Si["[object RegExp]"]=Si["[object Set]"]=Si["[object String]"]=Si["[object Symbol]"]=Si["[object Uint8Array]"]=Si["[object Uint8ClampedArray]"]=Si["[object Uint16Array]"]=Si["[object Uint32Array]"]=!0,Si["[object Error]"]=Si[xi]=Si["[object WeakMap]"]=!1;var Ti=function r(i,n,o,t,e,a){var s,l=n&gi,u=n&yi,c=n&vi;if(o&&(s=e?o(i,t,e,a):o(i)),void 0!==s)return s;if(!Zt(i))return i;var p=Ve(i);if(p){if(s=Xr(i),!l)return vr(i,s)}else{var h=Wr(i),d=h==xi||h==bi;if(Ze(i))return yr(i,l);if(h==wi||h==_i||d&&!e){if(s=u||d?{}:ui(i),!l)return u?kr(i,gr(s,i)):Tr(i,pr(s,i))}else{if(!Si[h])return e?i:{};s=oi(i,h,l)}}var f=(a=a||new Ae).get(i);if(f)return f;a.set(i,s),mi(i)?i.forEach(function(t){s.add(r(t,n,o,t,i,a))}):hi(i)&&i.forEach(function(t,e){s.set(e,r(t,n,o,e,i,a))});var m=c?u?Mr:Pr:u?keysIn:cr,g=p?void 0:m(i);return Pe(g||i,function(t,e){g&&(t=i[e=t]),De(s,e,r(t,n,o,e,i,a))}),s};var Ei,Ii=function(t){return Ti(t,5)},Ci=Map,ki=(b(Ai,Ei=E),Ai);function Ai(){var t=null!==Ei&&Ei.apply(this,arguments)||this;return t.layout="icons",t.mapStyles=["road","grayscale_light","grayscale_dark","night","road_shaded_relief"],t.style=p.ControlStyle.light,t}var Pi,Mi=(b(Li,Pi=nt),Li.prototype.onAdd=function(t,e){this.map=t;var r=this.buildContainer(t,this.options.style,"Map Style Control"),i=this.buildStyleOpsGrid(r),n=this.buildCurrStyleBtn(r,i);return e&&Li.InvertOrderPositions.includes(e.position)?(r.appendChild(i),r.appendChild(n)):(r.appendChild(n),r.appendChild(i)),r},Li.prototype.onRemove=function(){Pi.prototype.onRemove.call(this),this.map.events.remove("styledata",this.onStyleChange)},Li.prototype.buildSelectStyleBtn=function(t,e,r,i){var n=this,o=document.createElement("button");o.setAttribute("title",r),o.setAttribute("alt",r),o.setAttribute("type","button");var a=new Image(28,28);return a.src=i,a.alt=r,o.appendChild(a),"icons"===this.options.layout?o.classList.add(Li.Css.button):o.appendChild(document.createTextNode(r)),o.addEventListener("click",function(){n.map.setStyle({style:r}),n.setStyleOpsVisible(t,e,!1)}),o},Li.prototype.buildCurrStyleBtn=function(t,e){var r=this,i=document.createElement("button");i.classList.add(Li.Css.button),i.classList.add(Li.Css.currentStyle),i.setAttribute("title","Select Style"),i.setAttribute("alt","Select Style"),i.setAttribute("type","button"),this.currStyleImage=new Image(28,28),i.appendChild(this.currStyleImage);var n=document.createElement("div");return n.classList.add("icon"),i.appendChild(n),i.addEventListener("click",function(){r.setStyleOpsVisible(t,e,!t.classList.contains(Li.Css.inUse))}),i},Li.prototype.buildStyleOpsGrid=function(a){var s=this,l=document.createElement("div");return l.classList.add(Li.Css.styleOptions),l.classList.add(this.options.layout),l.setAttribute("aria-label","Style Options"),l.style.display="none",this.map.styles.initialize().then(function(){for(var t=s.map.styles.getDef(),e=s.map.getStyle().style,r=0,i=t.styles;r<i.length;r++){var n=i[r],o=new P({domain:t.domain,path:n.iconPath}).toString();s.styleIcons.set(n.name,o),n.name===e&&(s.currStyleImage.src=o,s.currStyleImage.alt=n.name)}"all"===s.options.mapStyles?s.styleIcons.forEach(function(t,e){var r=s.buildSelectStyleBtn(a,l,e,t);l.appendChild(r)}):s.options.mapStyles.filter(function(t){return s.styleIcons.has(t)}).forEach(function(t){var e=s.styleIcons.get(t),r=s.buildSelectStyleBtn(a,l,t,e);l.appendChild(r)}),s.map.events.add("styledata",s.onStyleChange)}),l},Li.prototype.setStyleOpsVisible=function(t,e,r){r?(t.classList.add(Li.Css.inUse),e.style.display=""):(t.classList.remove(Li.Css.inUse),e.style.display="none")},Li.InvertOrderPositions=[p.ControlPosition.TopRight,p.ControlPosition.BottomRight],Li.Css={button:"azure-maps-control-button",currentStyle:"curr-style",inUse:"in-use",styleOptions:"style-options"},Li);function Li(t){var e=Pi.call(this)||this;return e.styleIcons=new Ci,e.onStyleChange=function(){var t=e.map.getStyle().style;e.styleIcons.has(t)&&(e.currStyleImage.src=e.styleIcons.get(t),e.currStyleImage.alt=t)},e.options=(new ki).merge(Ii(t)),e}var Oi,Di=(b(Ri,Oi=E),Ri);function Ri(){var t=null!==Oi&&Oi.apply(this,arguments)||this;return t.zoomDelta=1,t.style=p.ControlStyle.light,t}var zi,Ni=(b(Bi,zi=nt),Bi.prototype.onAdd=function(t){var e=this.buildContainer(t,this.options.style,"Zoom Control");e.style.flexDirection="column";var r=this.constructZoomInButton(t),i=this.constructZoomOutButton(t);return e.appendChild(r),e.appendChild(i),e},Bi.prototype.constructZoomInButton=function(t){var e=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("zoom-in"),r.setAttribute("title","Zoom In"),r.setAttribute("alt","Zoom In"),r.setAttribute("type","button"),r.addEventListener("click",function(){t.setCamera({zoom:t.getCamera().zoom+e.options.zoomDelta,duration:Bi.ZOOM_DURATION_MS,type:"ease"},!0)}),r},Bi.prototype.constructZoomOutButton=function(t){var e=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("zoom-out"),r.setAttribute("title","Zoom Out"),r.setAttribute("alt","Zoom Out"),r.setAttribute("type","button"),r.addEventListener("click",function(){t.setCamera({zoom:t.getCamera().zoom-e.options.zoomDelta,duration:Bi.ZOOM_DURATION_MS,type:"ease"},!0)}),r},Bi.ZOOM_DURATION_MS=200,Bi);function Bi(t){var e=zi.call(this)||this;return e.options=(new Di).merge(t),e}var Fi=Object.freeze({PitchControl:gt,CompassControl:ct,ZoomControl:Ni,StyleControl:Mi});function Ui(t){return this.__data__.has(t)}function ji(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new Ie;++e<r;)this.add(t[e])}ji.prototype.add=ji.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},ji.prototype.has=Ui;var qi=ji;var Vi=function(t,e){for(var r=-1,i=null==t?0:t.length;++r<i;)if(e(t[r],r,t))return!0;return!1};var Gi=function(t,e){return t.has(e)};var Zi=function(t,e,r,i,n,o){var a=1&r,s=t.length,l=e.length;if(s!=l&&!(a&&s<l))return!1;var u=o.get(t);if(u&&o.get(e))return u==e;var c=-1,p=!0,h=2&r?new qi:void 0;for(o.set(t,e),o.set(e,t);++c<s;){var d=t[c],f=e[c];if(i)var m=a?i(f,d,c,e,t,o):i(d,f,c,t,e,o);if(void 0!==m){if(m)continue;p=!1;break}if(h){if(!Vi(e,function(t,e){if(!Gi(h,e)&&(d===t||n(d,t,r,i,o)))return h.push(e)})){p=!1;break}}else if(d!==f&&!n(d,f,r,i,o)){p=!1;break}}return o.delete(t),o.delete(e),p};function Hi(t){var r=-1,i=Array(t.size);return t.forEach(function(t,e){i[++r]=[e,t]}),i}function Wi(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var Ki=Rt?Rt.prototype:void 0,Xi=Ki?Ki.valueOf:void 0;var Yi=function(t,e,r,i,n,o,a){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!o(new Yr(t),new Yr(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return _t(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var s=Hi;case"[object Set]":var l=1&i;if(s=s||Wi,t.size!=e.size&&!l)return!1;var u=a.get(t);if(u)return u==e;i|=2,a.set(t,e);var c=Zi(s(t),s(e),i,n,o,a);return a.delete(t),c;case"[object Symbol]":if(Xi)return Xi.call(t)==Xi.call(e)}return!1},Ji=Object.prototype.hasOwnProperty;var Qi=function(t,e,r,i,n,o){var a=1&r,s=Pr(t),l=s.length;if(l!=Pr(e).length&&!a)return!1;for(var u=l;u--;){var c=s[u];if(!(a?c in e:Ji.call(e,c)))return!1}var p=o.get(t);if(p&&o.get(e))return p==e;var h=!0;o.set(t,e),o.set(e,t);for(var d=a;++u<l;){var f=t[c=s[u]],m=e[c];if(i)var g=a?i(m,f,c,e,t,o):i(f,m,c,t,e,o);if(!(void 0===g?f===m||n(f,m,r,i,o):g)){h=!1;break}d=d||"constructor"==c}if(h&&!d){var y=t.constructor,v=e.constructor;y!=v&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof v&&v instanceof v)&&(h=!1)}return o.delete(t),o.delete(e),h},$i="[object Arguments]",tn="[object Array]",en="[object Object]",rn=Object.prototype.hasOwnProperty;var nn=function(t,e,r,i,n,o){var a=Ve(t),s=Ve(e),l=a?tn:Wr(t),u=s?tn:Wr(e),c=(l=l==$i?en:l)==en,p=(u=u==$i?en:u)==en,h=l==u;if(h&&Ze(t)){if(!Ze(e))return!1;c=!(a=!0)}if(h&&!c)return o=o||new Ae,a||tr(t)?Zi(t,e,r,i,n,o):Yi(t,e,l,r,i,n,o);if(!(1&r)){var d=c&&rn.call(t,"__wrapped__"),f=p&&rn.call(e,"__wrapped__");if(d||f)return n(d?t.value():t,f?e.value():e,r,i,o=o||new Ae)}return h&&(o=o||new Ae,Qi(t,e,r,i,n,o))};var on=function t(e,r,i,n,o){return e===r||(null==e||null==r||!Ne(e)&&!Ne(r)?e!=e&&r!=r:nn(e,r,i,n,t,o))};var an,sn=function(t,e){return on(t,e)},ln=(an=Object.freeze({default:{}}))&&an.default||an,un=e(function(t){!function(){var n,o,a,s=0,e=[];for(l.BUFFER_SIZE=512,l.bin=r,l.test=function(t){if("string"==typeof t)return/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/.test(t)},o=0;o<256;o++)e[o]=(o+256).toString(16).substr(1);function r(){var t=function(t){var e,r,i;if(void 0!==a){if(void 0===n||l.BUFFER_SIZE<s+t)if(s=0,a.getRandomValues)n=new Uint8Array(l.BUFFER_SIZE),a.getRandomValues(n);else{if(!a.randomBytes)throw new Error("Non-standard crypto library");n=a.randomBytes(l.BUFFER_SIZE)}return n.slice(s,s+=t)}for(e=[],o=0;o<t;o++)e.push((r=0,i=255,Math.floor(Math.random()*(i-r))+r));return e}(16);return t[6]=15&t[6]|64,t[8]=63&t[8]|128,t}function l(){var t=r();return e[t[0]]+e[t[1]]+e[t[2]]+e[t[3]]+"-"+e[t[4]]+e[t[5]]+"-"+e[t[6]]+e[t[7]]+"-"+e[t[8]]+e[t[9]]+"-"+e[t[10]]+e[t[11]]+e[t[12]]+e[t[13]]+e[t[14]]+e[t[15]]}"undefined"!=typeof crypto?a=crypto:"undefined"!=typeof window&&void 0!==window.msCrypto&&(a=window.msCrypto),a=a||ln,t.exports=l}()}),cn=(pn.TYPE="Feature",pn);function pn(t,e,r){this.type="Feature",this.type=pn.TYPE,this.properties=e||{},this.id=r,this.geometry=t}var hn,dn=(b(fn,hn=Array),fn.fromData=function(r){var i=NaN,n=NaN,o=new Set(["y"]),a=new Set(["x"]);return Object.keys(r).forEach(function(t){var e=t.toLowerCase();isNaN(i)&&o.has(e)&&"number"==typeof r[t]?i=r[t]:isNaN(n)&&a.has(e)&&"number"==typeof r[t]&&(n=r[t])}),isNaN(i)||isNaN(n)?null:new fn(i,n)},fn.getX=function(t){return 0<t.length?t[0]:NaN},fn.getY=function(t){return 1<t.length?t[1]:NaN},fn.getDestination=function(t,e,r){return new fn(fn.getX(t)+r*Math.cos((90-e)*Math.PI/180),fn.getY(t)+r*Math.sin((90-e)*Math.PI/180))},fn.getDistance=function(t,e){var r=fn.getX(t)-fn.getX(e),i=fn.getY(t)-fn.getY(e);return Math.sqrt(r*r+i*i)},fn.getHeading=function(t,e){var r=fn.getX(e)-fn.getX(t),i=fn.getY(t)-fn.getY(e);return 180*(2.5*Math.PI-Math.atan2(i,r))/Math.PI%360},fn);function fn(t,e){return hn.call(this,t,e)||this}var mn=(gn.TYPE="Point",gn);function gn(t){this.type="Point",this.type=gn.TYPE,this.coordinates=t}var yn,vn,_n,xn,bn,wn,Sn,Tn,En,In,Cn=6378137,kn=Math.PI/180,An=180/Math.PI,Pn=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function Mn(t){return t*kn}function Ln(t){return t*An}function On(t,e,r){return Math.min(Math.max(t,e),r)}function Dn(t,e){var r=Mn(e[1]-t[1]),i=Mn(e[0]-t[0]),n=Math.pow(Math.sin(r/2),2)+Math.cos(Mn(t[1]))*Math.cos(Mn(e[1]))*Math.pow(Math.sin(i/2),2),o=2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n));return Math.round(Cn*o*100)/100}function Rn(t){if(t)switch(t.toLowerCase()){case"feet":case"foot":case"ft":return _n.feet;case"kilometers":case"kilometer":case"kilometres":case"kilometre":case"km":case"kms":return _n.kilometers;case"miles":case"mile":case"mi":return _n.miles;case"nauticalmiles":case"nauticalmile":case"nms":case"nm":return _n.nauticalMiles;case"yards":case"yard":case"yds":case"yrd":case"yrds":return _n.yards;case"meters":case"metres":case"m":default:return _n.meters}return _n.meters}function zn(t){if(t)switch(t.toLowerCase()){case"milespersecondsquared":case"milepersecondsquared":case"mi/s^2":case"mi/s2":return En.milesPerSecondSquared;case"kilometerspersecondsquared":case"kilometrespersecondsquared":case"kilometerpersecondsquared":case"kilometrepersecondsquared":case"km/s^2":case"km/s2":return En.kilometersPerSecondSquared;case"knotspersecond":case"knotpersecond":case"knts/s":case"kn/s":case"kt/s":return En.knotsPerSecond;case"standardgravity":case"g":return En.standardGravity;case"feetpersecondsquared":case"footpersecondsquared":case"ft/s^2":case"ft/s2":return En.feetPerSecondSquared;case"yardspersecondsquared":case"yardpersecondsquared":case"yds/s^2":case"yds/s2":case"yd/s^2":case"yd/s2":return En.yardsPerSecondSquared;case"milesperhoursecond":case"mileperhoursecond":case"milesperhourseconds":case"mileperhourseconds":case"mi/h/s":return En.milesPerHourSecond;case"kilometersperhoursecond":case"kilometrespersoursecond":case"kilometerperhoursecond":case"kilometrepersoursecond":case"kilometersperhourssecond":case"kilometrespersourssecond":case"kilometerperhourssecond":case"kilometrepersourssecond":case"kmhs":case"km/h/s":return En.kilometersPerHourSecond;case"meterspersecondsquared":case"metrespersecondsquared":case"meterpersecondsquared":case"metrepersecondsquared":case"m/s^2":case"m/s2":default:return En.metersPerSecondSquared}return En.metersPerSecondSquared}function Nn(t){if(t)switch(t){case"acres":case"ac":return yn.acres;case"hectares":case"ha":return yn.hectares;case"squareFeet":case"ft^2":case"ft2":return yn.squareFeet;case"squareYards":case"squareYard":case"yds^2":case"yds2":case"yd^2":case"yd2":return yn.squareYards;case"squareKilometers":case"squareKilometres":case"squareKilometer":case"squareKilometre":case"km^2":case"km2":return yn.squareKilometers;case"squareMiles":case"squareMile":case"mi^2":case"mi2":return yn.squareMiles;case"squareMeters":case"squareMetres":case"squareMeter":case"squareMetre":case"m^2":case"m2":default:return yn.squareMeters}return yn.squareMeters}function Bn(t){if(t)switch(t.toLowerCase()){case"feetpersecond":case"footsecond":case"ftps":case"ft/s":return Sn.feetPerSecond;case"milesperhour":case"mileperhour":case"mph":case"mi/hr":case"mi/h":return Sn.milesPerHour;case"knots":case"knot":case"knts":case"knt":case"kn":case"kt":return Sn.knots;case"mach":case"m":return Sn.mach;case"kilometersperhour":case"kilometresperhour":case"kmperhour":case"kmph":case"km/hr":case"km/h":return Sn.kilometersPerHour;case"meterspersecond":case"metrespersecond":case"mps":case"ms":case"m/s":default:return Sn.metersPerSecond}return Sn.metersPerSecond}function Fn(t){if(t)switch(t.toLowerCase()){case"milliseconds":case"ms":return bn.ms;case"minutes":case"minute":case"mins":case"min":return bn.minutes;case"hours":case"hour":case"hr":case"h":return bn.hours;case"days":case"day":case"d":return bn.days;case"seconds":case"second":case"secs":case"sec":case"s":default:return bn.seconds}return bn.seconds}function Un(t){var e=0;if(t&&0<t.length){e=Math.abs(jn(t[0]));for(var r=1,i=t.length;r<i;r++)e-=Math.abs(jn(t[r]))}return e}function jn(t){var e=0;if(3<=t.length){for(var r=void 0,i=void 0,n=0,o=t.length;n<o;n++)e+=(Mn(t[n===o-2?(r=o-2,i=o-1,0):n===o-1?(r=o-1,i=0,1):(i=(r=n)+1,n+2)][0])-Mn(t[r][0]))*Math.sin(Mn(t[i][1]));e=e*Cn*Cn/2}return e}function qn(t,e,r){return(t[0]-r[0])*(e[1]-r[1])-(t[1]-r[1])*(e[0]-r[0])}function Vn(t,e,r){if(2<=r.length){for(var i=1/0,n=void 0,o=null,a=no(r,22),s=void 0,l=0,u=a.length-1;l<u;l++)s=Gn(e,a[l],a[l+1]),(n=dn.getDistance(e,s))<i&&(i=n,o=s);if(o){var c=io([o],22)[0];return new cn(new mn(c),{distance:Kn(t,c)})}}else if(1===r.length)return new cn(new mn(r[0]),{distance:Kn(t,r[0])});return null}function Gn(t,e,r){if(e[0]===r[0]&&e[1]===r[1])return e;var i=t[0]-e[0],n=t[1]-e[1],o=r[0]-e[0],a=r[1]-e[1],s=(o*i+a*n)/(o*o+a*a);return s<0?e:1<s?r:[e[0]+o*s,e[1]+a*s]}function Zn(t,e){if(!isNaN(t)&&"number"==typeof e&&0<=e){var r=void 0;r=e<Pn.length?Pn[e]:Math.pow(10,e),t=Math.round(t*r)/r}return t}function Hn(t,e,r,i){switch(Rn(e)){case _n.meters:t/=1e3;break;case _n.feet:t/=3280.8399;break;case _n.miles:t/=.62137119;break;case _n.yards:t/=1093.6133;break;case _n.nauticalMiles:t/=.5399568;break;case _n.kilometers:}switch(Rn(r)){case _n.meters:t*=1e3;break;case _n.feet:t*=3280.8399;break;case _n.miles:t*=.62137119;break;case _n.yards:t*=1093.6133;break;case _n.nauticalMiles:t*=.5399568;break;case _n.kilometers:}if("number"==typeof i&&0<=i){var n=Math.pow(10,i);t=Math.round(t*n)/n}return t}function Wn(t,e,r,i){i=i||"meters",t=mo(t);var n=Xn(i),o=Mn(t[1]),a=Mn(t[0]),s=Mn(e),l=r/n,u=Math.asin(Math.sin(o)*Math.cos(l)+Math.cos(o)*Math.sin(l)*Math.cos(s)),c=a+Math.atan2(Math.sin(s)*Math.sin(l)*Math.cos(o),Math.cos(l)-Math.sin(o)*Math.sin(u)),p=On(to(Ln(u)),-85,85);return[eo(Ln(c)),p]}function Kn(t,e,r){var i=Dn(t=mo(t),e=mo(e));return"meters"===r?i:Hn(i,"meters",r||"meters")}function Xn(t){var e=Rn(t);return Hn(Cn,_n.meters,e)}function Yn(t,e){if(t=mo(t),e=mo(e),t&&2<=t.length&&e&&2<=e.length){var r=Mn(t[1]),i=Mn(e[1]),n=Mn(e[0]-t[0]),o=Math.sin(n)*Math.cos(i),a=Math.cos(r)*Math.sin(i)-Math.sin(r)*Math.cos(i)*Math.cos(n);return(Ln(Math.atan2(o,a))+360)%360}return NaN}function Jn(t,e){var r,i=0;Array.isArray(t)?r=t:t.type&&"LineString"===t.type&&(r=t.coordinates);for(var n=0,o=r.length-1;n<o;n++)i+=Dn(r[n],r[n+1]);return Hn(i,"meters",e||"meters")}function Qn(t,e,r){r=r||"meters";var i,n,o=0;if(Array.isArray(t)?n=t:t.type&&"LineString"===t.type&&(n=t.coordinates),2<=n.length){for(var a=n.length,s=1;s<a;s++){if(e<=o+(i=Kn(n[s-1],n[s],r))){var l=Yn(n[s-1],n[s]);return Wn(n[s-1],l,e-o,r)}o+=i}return o<=e?n[a-1]:n[0]}return null}function $n(t,e,r,i,n){i=i||"meters",n=n||0,t=mo(t);for(var o=[],a=360/r,s=0;s<=r;s++)o.push(Wn(t,(s*a+n)%360,e,i));return o}function to(t){return 90<t?180<(t=(t+90)%360)?90-(t-180):t-90:t<-90?(t=(t-90)%360)<-180?-90-(t+180):t+90:t}function eo(t){return 180<t?(t+180)%360-180:t<-180?(t-180)%360+180:t}function ro(t,e,r){if(0===r)return Object.assign({},t);e=mo(e);for(var i,n,o=[],a=0,s=t.length;a<s;a++)i=Kn(e,t[a]),n=Yn(e,t[a]),o.push(Wn(e,n+r,i));return o}function io(t,e){for(var r,i,n=512*Math.pow(2,e),o=[],a=0,s=t.length;a<s;a++)r=t[a][0]/n-.5,i=.5-t[a][1]/n,o.push([360*r,90-360*Math.atan(Math.exp(2*-i*Math.PI))/Math.PI]);return o}function no(t,e){for(var r,i,n,o=512*Math.pow(2,e),a=[],s=0,l=t.length;s<l;s++)n=Math.sin(t[s][1]*Math.PI/180),r=(t[s][0]+180)/360,i=.5-Math.log((1+n)/(1-n))/(4*Math.PI),a.push([Math.round(r*o),Math.round(i*o)]);return a}function oo(t,e,r,i){switch(zn(e)){case En.kilometersPerHourSecond:t/=3.6;break;case En.milesPerHourSecond:t/=2.236936292054;break;case En.knotsPerSecond:t/=1.943844492441;break;case En.standardGravity:t/=.1019716212978;break;case En.kilometersPerSecondSquared:t/=.001;break;case En.milesPerSecondSquared:t/=.000621371192;break;case En.feetPerSecondSquared:t/=3.280839895012;break;case En.yardsPerSecondSquared:t/=1.093613298338;break;case En.metersPerSecondSquared:}switch(zn(r)){case En.kilometersPerHourSecond:t*=3.6;break;case En.milesPerHourSecond:t*=2.236936292054;break;case En.knotsPerSecond:t*=1.943844492441;break;case En.standardGravity:t*=.1019716212978;break;case En.kilometersPerSecondSquared:t*=.001;break;case En.milesPerSecondSquared:t*=.000621371192;break;case En.feetPerSecondSquared:t*=3.280839895012;break;case En.yardsPerSecondSquared:t*=1.093613298338;break;case En.metersPerSecondSquared:}return Zn(t,i)}function ao(t,e,r,i){switch(Nn(e)){case yn.acres:t*=4046.8564224;break;case yn.hectares:t*=1e4;break;case yn.squareFeet:t*=.09290304;break;case yn.squareKilometers:t*=1e6;break;case yn.squareMiles:t*=259e4;break;case yn.squareYards:t*=.83612736;break;case yn.squareMeters:}switch(Nn(r)){case yn.acres:t/=4046.8564224;break;case yn.hectares:t/=1e4;break;case yn.squareFeet:t/=.09290304;break;case yn.squareKilometers:t/=1e6;break;case yn.squareMiles:t/=259e4;break;case yn.squareYards:t/=.83612736;break;case yn.squareMeters:}return Zn(t,i)}function so(t,e,r,i){switch(Bn(e)){case Sn.feetPerSecond:t*=1.09728;break;case Sn.milesPerHour:t*=1.6093;break;case Sn.knots:t*=1.852;break;case Sn.metersPerSecond:t*=3.6;break;case Sn.mach:t*=1234.8;break;case Sn.kilometersPerHour:}switch(Bn(r)){case Sn.feetPerSecond:t/=1.09728;break;case Sn.milesPerHour:t/=1.6093;break;case Sn.knots:t/=1.852;break;case Sn.metersPerSecond:t/=3.6;break;case Sn.mach:t/=1234.8;break;case Sn.kilometersPerHour:}return Zn(t,i)}function lo(t,e,r,i){switch(Fn(e)){case bn.ms:t/=1e3;break;case bn.hours:t*=3600;break;case bn.minutes:t*=60;break;case bn.days:t*=86400;break;case bn.seconds:}switch(Fn(r)){case bn.ms:t*=1e3;break;case bn.hours:t/=3600;break;case bn.minutes:t/=60;break;case bn.days:t/=86400;break;case bn.seconds:}return Zn(t,i)}function uo(t,e,r,i,n,o,a,s){var l=Hn(e,n,_n.meters),u=lo(r,o,bn.seconds);return oo(2*(l-so(t,i,Sn.metersPerSecond)*u)/(u*u),En.metersPerSecondSquared,a,s)}function co(t,e,r,i,n,o,a){var s=so(t,i,Sn.metersPerSecond);return oo((so(e,i,Sn.metersPerSecond)-s)/lo(r,n,bn.seconds),En.metersPerSecondSquared,o,a)}function po(t,e,r,i){var n=ho(t),o=ho(e);return null!=n&&null!=o?lo(o.getTime()-n.getTime(),bn.ms,r,i):NaN}function ho(t){if("[object Date]"===Object.prototype.toString.call(t))return t;if("string"==typeof t){var e=Date.parse(t);if(!isNaN(e))return new Date(e);if(0<=t.indexOf("Date(")){var r=0;return r=0<(t=t.replace("/Date(","").replace(")/","")).indexOf("+")?parseInt(t.substr(0,t.indexOf("+")),10):0<t.indexOf("-")?parseInt(t.substr(0,t.indexOf("-")),10):parseInt(t,10),new Date(r)}}else if("number"==typeof t)return new Date(t);return null}function fo(t){var e=[],r=null,i=null;if(Array.isArray(t)&&0<t.length)if(Array.isArray(t[0])&&"number"==typeof t[0][0])e=t;else for(var n=t.length,o=0;o<n;o++)e=e.concat(fo(t[o]));else if(t.type)switch(t.type){case"Point":e=[t.coordinates];break;case"LineString":e=t.coordinates;break;case"Polygon":r=t.coordinates;break;case"MultiPoint":e=t.coordinates;break;case"MultiLineString":r=t.coordinates;break;case"MultiPolygon":i=t.coordinates;break;case"Feature":var a=t;e=Po._isCircle(a)?Po._getCirclePositions(a):fo(a.geometry);break;case"FeatureCollection":e=fo(t.features);break;case"GeometryCollection":e=fo(t.geometries)}else if(t instanceof Po)return fo(t.toJson());if(r)for(n=r.length,o=0;o<n;o++)e=e.concat(r[o]);else if(i){var s=i.length;for(o=0;o<s;o++)for(var l=i[o].length,u=0;u<l;u++)e=e.concat(i[o][u])}return e}function mo(t){if(Array.isArray(t)&&"number"==typeof t[0])return t;if(t.type){if("Point"===t.type)return t.coordinates;if("Feature"===t.type&&"Point"===t.geometry.type)return t.geometry.coordinates}else if(t instanceof Po&&"Point"===t.getType())return t.getCoordinates();return null}function go(t,e,r){r=r||"meters";var i,n,o=0;if(Array.isArray(t)?n=t:t.type&&"LineString"===t.type&&(n=t.coordinates),2<=n.length){for(var a=n.length,s=1;s<a;s++){if(e<=o+(i=Kn(n[s-1],n[s],r))){var l=Yn(n[s-1],n[s]),u=Wn(n[s-1],l,e-o,r);return new cn(new mn(u),{heading:l})}o+=i}return o<=e?new cn(new mn(n[a-1]),{heading:Yn(n[a-2],n[a-1])}):new cn(new mn(n[0]),{heading:Yn(n[0],n[1])})}return null}function yo(t,e,r,i){var n,o=mo(t),a=no([o],22)[0],s=null,l=1/0;switch((e=e instanceof Po?e.toJson():e).type){case"Feature":return yo(t,e.geometry,r);case"Point":n=[[e.coordinates]];break;case"MultiPoint":for(var u=void 0,c=e.coordinates,p=0,h=c.length;p<h;p++)(u=Kn(o,c[p]))<l&&(l=u,s=new cn(new mn(c[p]),{distance:u}));break;case"LineString":n=[e.coordinates];break;case"Polygon":case"MultiLineString":n=e.coordinates;break;case"MultiPolygon":var d=e.coordinates;if(0<d.length){n=d[0];for(p=1,h=d.length;p<h;p++)n=n.concat(d[p])}}if(n){var f=void 0;for(p=0,h=n.length;p<h;p++)(f=Vn(o,a,n[p]))&&f.properties.distance<l&&(l=f.properties.distance,s=f)}return s&&(s.properties.distance=Hn(s.properties.distance,"meters",r,i)),s}(vn=yn=yn||{}).squareMeters="squareMeters",vn.acres="acres",vn.hectares="hectares",vn.squareFeet="squareFeet",vn.squareKilometers="squareKilometers",vn.squareMiles="squareMiles",vn.squareYards="squareYards",(xn=_n=_n||{}).meters="meters",xn.kilometers="kilometers",xn.feet="feet",xn.miles="miles",xn.nauticalMiles="nauticalMiles",xn.yards="yards",(wn=bn=bn||{}).seconds="seconds",wn.hours="hours",wn.ms="ms",wn.minutes="minutes",wn.days="days",(Tn=Sn=Sn||{}).metersPerSecond="metersPerSecond",Tn.kilometersPerHour="kilometersPerHour",Tn.feetPerSecond="feetPerSecond",Tn.milesPerHour="milesPerHour",Tn.knots="knots",Tn.mach="mach",(In=En=En||{}).milesPerSecondSquared="milesPerSecondSquared",In.kilometersPerSecondSquared="kilometersPerSecondSquared",In.knotsPerSecond="knotsPerSecond",In.standardGravity="standardGravity",In.feetPerSecondSquared="feetPerSecondSquared",In.yardsPerSecondSquared="yardsPerSecondSquared",In.milesPerHourSecond="milesPerHourSecond",In.kilometersPerHourSecond="kilometersPerHourSecond",In.metersPerSecondSquared="metersPerSecondSquared";var vo,_o=(b(xo,vo=Array),xo.fromPosition=function(t){return 2===t.length?new xo(t[0],t[1]):2<t.length?new xo(t[0],t[1],t[2]):null},xo.areEqual=function(t,e,r){if(void 0===r&&(r=6),t&&2<=t.length&&e&&2<=e.length){var i=Math.pow(10,r),n=to(t[1]),o=to(e[1]),a=eo(t[0]),s=eo(e[0]);if(0!=Math.round((n-o)*i)/i)return!1;var l=Math.round((a-s)*i)/i;return 0==l||360==l}return!1},xo.fromLatLng=function(n,t,e){var r=[];if("number"==typeof n)r.push(n),"number"==typeof t&&r.push(t),"number"==typeof e&&r.push(e);else if(Array.isArray(n))2<=n.length&&"number"==typeof n[0]&&"number"==typeof n[1]&&(3<=n.length&&"number"==typeof n[2]?r.push(n[0],n[1],n[2]):r.push(n[0],n[1]));else if("object"==typeof n){var o=["lat","latitude","y"],a=["lng","longitude","lon","x"],s=["elv","elevation","alt","altitude","z"],l=NaN,u=NaN,c=NaN;Object.keys(n).forEach(function(t,e,r){var i=t.toLowerCase();isNaN(l)&&0<=o.indexOf(i)&&"number"==typeof n[t]?l=n[t]:isNaN(u)&&0<=a.indexOf(i)&&"number"==typeof n[t]?u=n[t]:isNaN(c)&&0<=s.indexOf(i)&&"number"==typeof n[t]&&(c=n[t])}),isNaN(l)||isNaN(u)||(r.push(u,l),isNaN(c)||r.push(c))}return 2<=r.length?r:null},xo.fromLatLngs=function(t){var e=[];if(Array.isArray(t))for(var r=0,i=t.length;r<i;r++){var n=xo.fromLatLng(t[r]);n&&e.push(n)}return e},xo._getDimensions=function(t){for(var e=0;Array.isArray(t);)t=t[0],e++;return"number"==typeof t&&e--,e},xo);function xo(t,e,r){return r?vo.call(this,t,e,r)||this:vo.call(this,t,e)||this}var bo=(wo.TYPE="Polygon",wo);function wo(t,e){this.type="Polygon",this.type=wo.TYPE,1===_o._getDimensions(t)?this.coordinates=[t]:this.coordinates=t,this.bbox=e}var So=(To.prototype._addEventListener=function(t,e,r){this.listeners.has(t)||this.listeners.set(t,new Ci),this.listeners.get(t).set(e,r)},To.prototype._removeEventListener=function(t,e){this.listeners.has(t)&&this.listeners.get(t).delete(e)},To.prototype._invokeEvent=function(r,i){var n=this;this.listeners.has(r)&&this.listeners.get(r).forEach(function(t,e){t&&n._removeEventListener(r,e);try{e(i)}catch(t){console.error(t)}})},To);function To(){this.listeners=new Ci}var Eo=Object.freeze({EventEmitter:So}),Io=(Co.prototype.toTarget=function(t,e){return this.transformArray(t,this.M,e)},Co.prototype.toSource=function(t,e){return this.transformArray(t,this.inverseM,e)},Co.prototype.transformArray=function(t,e,r){if(t&&Array.isArray(t)&&Array.isArray(t[0])){for(var i=[],n=0,o=t;n<o.length;n++){var a=o[n];i.push(this.transform(a,e,r))}return i}return null},Co.prototype.transform=function(t,e,r){var i=t[0]*e[0][3]+t[1]*e[1][3]+e[2][3],n=t[0]*e[0][4]+t[1]*e[1][4]+e[2][4];return"number"==typeof r&&0<=r?[Zn(i,r),Zn(n,r)]:[Zn(i,6),Zn(n,6)]},Co._calculateAffineTransform=function(t,e){if(t.length!==e.length||t.length<1)throw new Error("Error: source and target arrays must have the same length.");var r=Math.min(t[0].length,e[0].length),i=r+1;if(t.length<r)throw new Error("Erorr: At least "+r+" reference points required.");for(var n=[],o=[],a=0;a<i;a++){o[a]=[];for(var s=0;s<i;s++){s<r&&(n[s]=0);for(var l=o[a][s]=0;l<t.length;l++)s<r&&(n[s]+=a<r?t[l][a]*e[l][s]:e[l][s]),o[a][s]+=r<=a&&r<=s?1:r<=a?t[l][s]:r<=s?t[l][a]:t[l][a]*t[l][s]}o[a]=o[a].concat(n)}if(!this._gaussJordanElimination(o))throw new Error("Error: Singular matrix. Points are likely coplanar.");return o},Co._gaussJordanElimination=function(t){for(var e,r,i=t.length,n=2*i-1,o=0;o<i;o++){for(var a=o,s=o+1;s<i;s++)Math.abs(t[s][o])>Math.abs(t[a][o])&&(a=s);if(r=t[a],t[a]=t[o],t[o]=r,Math.abs(t[o][o])<=1e-10)return!1;for(var l=o+1;l<i;l++){e=t[l][o]/t[o][o];for(var u=o;u<n;u++)t[l][u]-=t[o][u]*e}}for(o=i-1;-1<o;o--){for(e=t[o][o],s=0;s<o;s++)for(var c=n-1;o-1<c;c--)t[s][c]-=t[o][c]*t[s][o]/e;t[o][o]/=e;for(var p=i;p<n;p++)t[o][p]/=e}return!0},Co);function Co(t,e){this.M=Co._calculateAffineTransform(t,e),this.inverseM=Co._calculateAffineTransform(e,t)}var ko,Ao=Object.freeze({AffineTransform:Io,_precision:Zn,get AreaUnits(){return yn},get DistanceUnits(){return _n},get TimeUnits(){return bn},get SpeedUnits(){return Sn},get AccelerationUnits(){return En},boundingBoxToPolygon:function(t){var e=eo(Oo.getWest(t)),r=eo(Oo.getEast(t)),i=to(Oo.getNorth(t)),n=to(Oo.getSouth(t)),o=Oo.getCenter(t),a=[[e,i],[e,n],[o[0],n],[r,n],[r,i],[o[0],i],[e,i]];return new bo([a])},convertDistance:Hn,getCardinalSpline:function(t,e,r,i){var n;if(!t||t.length<=2)return n;"number"!=typeof e&&(e=.5),("number"!=typeof r||r<=0)&&(r=15);var o=t.length;n=t.slice(0),i?(_o.areEqual(n[0],n[o-1])&&(n.pop(),o--),n.unshift(t[o-1]),n.push(t[0]),n.push(t[1]),o++):(n.unshift(t[0]),n.push(t[o-1]));var a,s,l,u=[];u.push([1,0,0,0]);for(var c=1;c<r-1;c++)l=(a=c/r)*(s=a*a),u.push([2*l-3*s+1,-2*l+3*s,l-2*s+a,l-s]);u.push([0,1,0,0]);var p,h,d,f,m,g,y,v=[];for(c=1;c<o;c++)for(h=e*(n[c+1][0]-n[c-1][0]),d=e*(n[c+1][1]-n[c-1][1]),f=e*(n[c+2][0]-n[c][0]),m=e*(n[c+2][1]-n[c][1]),a=0;a<r;a++)y=(p=u[a])[0]*n[c][0]+p[1]*n[c+1][0]+p[2]*h+p[3]*f,g=On(g=p[0]*n[c][1]+p[1]*n[c+1][1]+p[2]*d+p[3]*m,-85,85),v.push([y,g]);return v},getDestination:Wn,getDistanceTo:Kn,getEarthRadius:Xn,getGeodesicPath:function(t,e){var r;(!e||e<=0)&&(e=15),Array.isArray(t)?r=t:t.type&&"LineString"===t.type&&(r=t.coordinates);for(var i=r.length-1,n=[],o=0;o<i;o++)for(var a=Mn(r[o][1]),s=Mn(r[o][0]),l=Mn(r[o+1][1]),u=Mn(r[o+1][0]),c=2*Math.asin(Math.sqrt(Math.pow(Math.sin((a-l)/2),2)+Math.cos(a)*Math.cos(l)*Math.pow(Math.sin((s-u)/2),2))),p=0;p<=e;p++){var h=p/e,d=Math.sin((1-h)*c)/Math.sin(c),f=Math.sin(h*c)/Math.sin(c),m=d*Math.cos(a)*Math.cos(s)+f*Math.cos(l)*Math.cos(u),g=d*Math.cos(a)*Math.sin(s)+f*Math.cos(l)*Math.sin(u),y=d*Math.sin(a)+f*Math.sin(l),v=Math.atan2(y,Math.sqrt(Math.pow(m,2)+Math.pow(g,2))),_=Math.atan2(g,m);v=On(Ln(v),-85,85),_=Ln(_),n.push([_,v])}return n},getHeading:Yn,getLengthOfPath:Jn,getPositionAlongPath:Qn,getRegularPolygonPath:$n,interpolate:function(t,e,r){r=void 0===r?.5:r;var i=Kn(t=mo(t),e=mo(e),"kilometers");return Wn(t,Yn(t,e),i*r,"kilometers")},normalizeLatitude:to,normalizeLongitude:eo,rotatePositions:ro,getPixelHeading:function(t,e){var r=no([t=mo(t),e=mo(e)],21),i=r[0],n=r[1],o=n[0]-i[0],a=i[1]-n[1];return(2.5*Math.PI-Math.atan2(a,o))*An%360},mercatorPixelsToPositions:io,mercatorPositionsToPixels:no,convertAcceleration:oo,convertArea:ao,convertSpeed:so,convertTimespan:lo,getAcceleration:uo,getAccelerationFromSpeeds:co,getAccelerationFromFeatures:function(t,e,r,i,n,o,a){if("string"==typeof r&&"Feature"===t.type&&"Point"===t.geometry.type&&"Feature"===e.type&&"Point"===e.geometry.type){var s=po(t.properties[r],e.properties[r],bn.seconds);if(!isNaN(s)){var l=0;if(i&&"string"==typeof i){var u=t.properties[i],c=e.properties[i];if("number"==typeof u&&(l=u,"number"==typeof c))return co(u,c,s,n,bn.seconds,o,a)}return uo(l,Kn(t.geometry.coordinates,e.geometry.coordinates,_n.meters),s,n,_n.meters,bn.seconds,o,a)}}return NaN},getArea:function t(e,r,i){if(e){var n=0;switch((e=e instanceof Po?e.toJson():e).type){case"Feature":var o=e;if(o.geometry)return t(o.geometry,r,i);break;case"Polygon":var a=e;a.coordinates&&(n=Un(a.coordinates));break;case"MultiPolygon":var s=e;if(s.coordinates)for(var l=0,u=s.coordinates.length;l<u;l++)n+=Un(s.coordinates[l])}return ao(n,yn.squareMeters,r,i)}return 0},getSpeed:function(t,e,r,i,n,o){var a=mo(t),s=mo(e);if(a&&s){var l=lo(r,i,bn.seconds);return so(Kn(a,s,_n.meters)/l,Sn.metersPerSecond,n,o)}return 0},getSpeedFromFeatures:function(t,e,r,i,n){if("string"==typeof r&&"Feature"===t.type&&"Point"===t.geometry.type&&"Feature"===e.type&&"Point"===e.geometry.type){var o=this.getTimespan(t.properties[r],e.properties[r],bn.seconds);if(!isNaN(o)){var a=this.getDistanceTo(t.geometry.coordinates,e.geometry.coordinates,_n.meters);return this.convertSpeed(a/o,Sn.metersPerSecond,i,n)}}return NaN},getTimespan:po,getTravelDistance:function(t,e,r,i,n,o,a,s){e=this.convertTimespan(e,n,bn.seconds);var l=(r=this.convertSpeed(r,o,Sn.metersPerSecond))*e;return"number"==typeof i&&(l+=.5*this.convertAcceleration(i,a,En.metersPerSecondSquared)*e*e),this.convertDistance(l,_n.meters,t,s)},parseTimestamp:ho,getConvexHull:function(t){var e=fo(t).map(function(t){return[eo(t[0]),to(t[1])]});e.sort(function(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]});for(var r=[],i=0,n=e;i<n.length;i++){for(var o=n[i];2<=r.length&&qn(r[r.length-2],r[r.length-1],o)<=0;)r.pop();r.push(o)}for(var a=[],s=e.length-1;0<=s;s--){for(;2<=a.length&&qn(a[a.length-2],a[a.length-1],e[s])<=0;)a.pop();a.push(e[s])}return new bo([r.concat(a)])},getPositions:fo,getPosition:mo,getPositionsAlongPath:function(t,e){if(e<2)return[];for(var r=[],i=Jn(t,_n.meters)/(e-1),n=0;n<e;n++){var o=Qn(t,i*n,_n.meters);null!=o&&r.push(o)}return r},getPointWithHeadingAlongPath:go,getPointsWithHeadingsAlongPath:function(t,e){if(e<=0)return[];for(var r=[],i=Jn(t,_n.meters)/(e-1),n=0;n<e;n++){var o=go(t,i*n,_n.meters);null!=o&&r.push(o)}return r},getClosestPointOnGeometry:yo}),Po=(b(Mo,ko=So),Mo.prototype.addProperty=function(t,e){sn(this.data.properties[t],e)||(this.data.properties[t]=Ii(e),"subType"!==t&&"radius"!==t||this._handleCircle(),this.dataSource&&this.dataSource._updateSource(),this._invokeEvent("shapechanged",this))},Mo.prototype.getBounds=function(){var t,e=this.getCoordinates(),r=this.getType();if("Point"===r)if(this.circlePolygon){var i=this.circlePolygon.geometry.coordinates;t=Oo.fromPositions(i[0])}else t=new Oo(i=e,i);else if("MultiPoint"===r||"LineString"===r)i=e,t=Oo.fromPositions(i);else if("Polygon"===r)i=e,t=Oo.fromPositions(i[0]);else if("MultiLineString"===r)for(var n=0,o=i=e;n<o.length;n++){var a=o[n];t=Oo.merge(t,Oo.fromPositions(a))}else if("MultiPolygon"===r)for(var s=0,l=i=e;s<l.length;s++){var u=l[s];t=Oo.merge(t,Oo.fromPositions(u[0]))}return t},Mo.prototype.getCoordinates=function(){return Ii(this.data.geometry.coordinates)},Mo.prototype.getCircleCoordinates=function(){return this.circlePolygon?Ii(this.circlePolygon.geometry.coordinates[0]):null},Mo.prototype.getId=function(){return this.data.id},Mo.prototype.getProperties=function(){return Ii(this.data.properties)},Mo.prototype.getType=function(){return this.data.geometry.type},Mo.prototype.isCircle=function(){return Mo._isCircle(this.data)},Mo.prototype.isRectangle=function(){return Mo._isRectangle(this.data)},Mo.prototype.setCoordinates=function(t){var e;e="Polygon"===this.getType()&&1===_o._getDimensions(t)?[t]:t,sn(this.data.geometry.coordinates,e)||(this.data.geometry.coordinates=Ii(e),this._handleCircle(),this.dataSource&&this.dataSource._updateSource(),this._invokeEvent("shapechanged",this))},Mo.prototype.setProperties=function(t){t[Mo._shapeIdPropName]=this.data.id,sn(this.data.properties,t)||(this.data.properties=Ii(t),this._handleCircle(),this.dataSource&&this.dataSource._updateSource(),this._invokeEvent("shapechanged",this))},Mo.prototype.toJson=function(){return JSON.parse(JSON.stringify(this.data))},Mo.prototype._toJson=function(){return this.circlePolygon||this.data},Mo.prototype._setDataSource=function(t){void 0===t||null==t?delete this.dataSource:this.dataSource=t},Mo.prototype._handleCircle=function(){if(this.isCircle()){var t=Mo._getCirclePositions(this.data);this.circlePolygon=new cn(new bo([t]),this.data.properties,this.data.id),this.data.properties.subType="Circle"}else delete this.circlePolygon},Mo._isCircle=function(t){return"Point"===t.geometry.type&&t.geometry.coordinates&&"string"==typeof t.properties.subType&&"circle"===t.properties.subType.toLowerCase()&&"number"==typeof t.properties.radius},Mo._isRectangle=function(t){if("Polygon"===t.geometry.type&&t.geometry.coordinates&&"string"==typeof t.properties.subType&&"rectangle"===t.properties.subType.toLowerCase()){var e=t.geometry.coordinates;if(1===e.length){var r=e[0];if(5===r.length)return r[0][0]===r[4][0]&&r[0][1]===r[4][1];if(4===r.length)return!0}}return!1},Mo._getCirclePositions=function(t){return $n(t.geometry.coordinates,t.properties.radius,72,"meters")},Mo._shapeIdPropName="_azureMapsShapeId",Mo);function Mo(t,e,r){var i,n=ko.call(this)||this;if("Feature"===t.type){var o=t;i=Ii(o.geometry),r=o.properties?Ii(o.properties):{},e=null==o.id||""===o.id?un():o.id}else i=Ii(t),e=null==e||""===e?un():e,r=r?Ii(r):{};return r[Mo._shapeIdPropName]=e,n.data=new cn(i,r,e),n._handleCircle(),n}var Lo,Oo=(b(Do,Lo=Array),Do.fromBoundingBox=function(t){return new Do([Do.getWest(t),Do.getSouth(t),Do.getEast(t),Do.getNorth(t)])},Do.fromDimensions=function(t,e,r){var i=t[0],n=t[1],o=Math.min(Math.max(n+r/2,-85.5),85.5),a=Math.min(Math.max(n-r/2,-85.5),85.5),s=eo(i+e/2);return new Do([eo(i-e/2),a,s,o])},Do.fromEdges=function(t,e,r,i){return new Do([t,e,r,i])},Do.containsPosition=function(t,e){var r=Do.getCenter(t),i=Math.abs(r[1]-e[1]),n=Math.abs(r[0]-e[0]);180<n&&(n=360-n);var o=Do.getHeight(t),a=Do.getWidth(t);return i<=o/2+1e-8&&n<=a/2+1e-8},Do.crossesAntimeridian=function(t){return eo(Do.getEast(t))-eo(Do.getWest(t))<0},Do.getCenter=function(t){var e=eo(Do.getEast(t)),r=eo(Do.getWest(t));return e<r&&(e+=360),[eo((r+e)/2),to((to(Do.getSouth(t))+to(Do.getNorth(t)))/2)]},Do.getHeight=function(t){var e=to(Do.getNorth(t))-to(Do.getSouth(t));return isNaN(e)?0:e},Do.getWidth=function(t){var e=eo(Do.getEast(t))-eo(Do.getWest(t));return isNaN(e)?0:e<0?e+=360:e},Do.getSouthWest=function(t){var e=this.getSouth(t),r=this.getWest(t);return isNaN(e)||isNaN(r)?null:[r,e]},Do.getNorthEast=function(t){var e=this.getNorth(t),r=this.getEast(t);return isNaN(e)||isNaN(r)?null:[r,e]},Do.getNorthWest=function(t){var e=this.getNorth(t),r=this.getWest(t);return isNaN(e)||isNaN(r)?null:[r,e]},Do.getSouthEast=function(t){var e=this.getSouth(t),r=this.getEast(t);return isNaN(e)||isNaN(r)?null:[r,e]},Do.getSouth=function(t){return t&&4<=t.length?Number(t[1]):NaN},Do.getWest=function(t){return t&&4<=t.length?Number(t[0]):NaN},Do.getNorth=function(t){if(t){if(4===t.length)return Number(t[3]);if(6===t.length)return Number(t[4])}return NaN},Do.getEast=function(t){if(t){if(4===t.length)return Number(t[2]);if(6===t.length)return Number(t[3])}return NaN},Do.intersect=function(t,e){var r=Do.getCenter(t),i=Do.getCenter(e),n=Math.abs(r[1]-i[1]),o=Math.abs(r[0]-i[0]);180<o&&(o=360-o);var a=Do.getHeight(t),s=Do.getWidth(t),l=Do.getHeight(e),u=Do.getWidth(e);return n<=a/2+l/2&&o<=s/2+u/2},Do.merge=function(t,e){var r=t&&4===t.length,i=e&&4===e.length;if(r&&!i)return t;if(i&&!r)return e;if(!r&&!i)return null;var n=Math.max(to(Do.getNorth(t)),to(Do.getNorth(e))),o=Math.min(to(Do.getSouth(t)),to(Do.getSouth(e))),a=[t,e],s=[],l=0;for(l=0;l<a.length;l++){var u=a[l],c=eo(Do.getWest(u)),p=eo(Do.getEast(u));Do.crossesAntimeridian(u)?(s.push([c,180]),s.push([-180,p])):s.push([c,p])}s.sort(function(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]});var h=[],d=s[0];for(l=1;l<s.length;){var f=s[l];d[1]>=f[0]?d[1]=Math.max(d[1],f[1]):(h.push(d),d=f),l++}h.push(d);var m=h.length,g=h[0][0]+360-h[m-1][1],y=[h[m-1][1],h[0][0]];for(l=1;l<m;l++){var v=h[l][0]-h[l-1][1];g<v&&(g=v,y=[h[l-1][1],h[l][0]])}return new Do([y[1],o],[y[0],n])},Do.fromPositions=function(t){for(var e,r=NaN,i=NaN,n=NaN,o=NaN,a=t.length,s=new Array(a),l=0;a--;)if((e=t[a])&&2<=e.length){var u=to(e[1]);r=isNaN(r)?u:Math.max(r,u),i=isNaN(i)?u:Math.min(i,u),s[l++]=eo(e[0])}if(l){s.length=l,s.sort(function(t,e){return t-e});var c=s[0]+360-s[l-1],p=0;for(a=1;a<l;a++){var h=s[a]-s[a-1];c<h&&(c=h,p=a)}n=s[p],o=s[(p||l)-1]}return isNaN(n)||isNaN(i)||isNaN(o)||isNaN(r)?null:new Do([n,i,o,r])},Do.fromLatLngs=function(t){return Do.fromPositions(_o.fromLatLngs(t))},Do.fromData=function(t){var e,r=null;if(Array.isArray(t)&&0<t.length){for(var i=0,n=t;i<n.length;i++){var o=n[i];null!=(e=Do.fromData(o))&&(r=null===r?e:Do.merge(r,e))}return r}if(t instanceof Po)return t.getBounds();if(t.type){var a=t;if(a.bbox&&4===a.bbox.length)return a.bbox;switch(a.type){case"FeatureCollection":return Do.fromData(a.features);case"Feature":return Po._isCircle(a)?Do.fromPositions(Po._getCirclePositions(a)):Do.fromData(a.geometry);case"GeometryCollection":return Do.fromData(a.geometries);case"Point":var s=a.coordinates;if(s&&2<=s.length)return[s[0],s[1],s[0],s[1]];break;case"LineString":case"MultiPoint":return Do.fromPositions(a.coordinates);case"Polygon":case"MultiLineString":var l=a.coordinates;if(l&&0<l.length){for(var u=0,c=l.length;u<c;u++)null!=(e=Do.fromPositions(l[u]))&&(r=null===r?e:Do.merge(r,e));if(null!=r)return r}break;case"MultiPolygon":var p=a.coordinates;if(p&&0<p.length){for(u=0,c=p.length;u<c;u++)for(var h=0,d=p[u].length;h<d;h++)null!=(e=Do.fromPositions(p[u][h]))&&(r=null===r?e:Do.merge(r,e));return r}}}return null},Do.splitOnAntimeridian=function(t){var e=[];if(Do.crossesAntimeridian(t)){var r=void 0,i=void 0,n=eo(Do.getWest(t)),o=eo(Do.getEast(t)),a=to(Do.getNorth(t)),s=to(Do.getSouth(t));i=6<=t.length?(r=new Do([n,s,t[2],180,a,t[5]]),new Do([-180,s,t[2],o,a,t[5]])):(r=new Do([n,s,180,a]),new Do([-180,s,o,a])),e.push(r,i)}else e.push(new Do(t));return e},Do);function Do(t,e){var r=this;if(t&&e){var i=t;r=i[2]&&e[2]?Lo.call(this,i[0],i[1],i[2]||0,e[0],e[1],e[2]||0)||this:Lo.call(this,i[0],i[1],e[0],e[1])||this}else if(t){var n=t;n&&(4===n.length?r=Lo.call(this,n[0],n[1],n[2],n[3])||this:6<=n.length&&(r=Lo.call(this,n[0],n[1],n[2],n[3],n[4],n[5])||this))}return r}var Ro=(zo.TYPE="FeatureCollection",zo);function zo(t){this.type="FeatureCollection",this.type=zo.TYPE,this.features=t}var No=(Bo.TYPE="GeometryCollection",Bo);function Bo(t){this.type="GeometryCollection",this.type=Bo.TYPE,this.geometries=t}var Fo=(Uo.TYPE="LineString",Uo);function Uo(t,e){this.type="LineString",this.type=Uo.TYPE,this.coordinates=t,this.bbox=e}var jo=(qo.TYPE="MultiLineString",qo);function qo(t,e){this.type="MultiLineString",this.type=qo.TYPE,this.coordinates=t,this.bbox=e}var Vo=(Go.TYPE="MultiPoint",Go);function Go(t,e){this.type="MultiPoint",this.type=Go.TYPE,this.coordinates=t,this.bbox=e}var Zo=(Ho.TYPE="MultiPolygon",Ho);function Ho(t,e){this.type="MultiPolygon",this.type=Ho.TYPE,this.coordinates=t,this.bbox=e}var Wo=Object.freeze({Feature:cn,FeatureCollection:Ro,LineString:Fo,Point:mn,Polygon:bo,Position:_o,BoundingBox:Oo,MultiLineString:jo,MultiPoint:Vo,MultiPolygon:Zo,GeometryCollection:No});var Ko,Xo=function(t,e){return Ti(t,5,e="function"==typeof e?e:void 0)},Yo=(b(Jo,Ko=E),Jo);function Jo(){var t=null!==Ko&&Ko.apply(this,arguments)||this;return t.maxZoom=18,t.cluster=!1,t.clusterRadius=50,t.clusterMaxZoom=void 0,t.clusterProperties=void 0,t.lineMetrics=!1,t.tolerance=.375,t}var Qo,$o=(b(ta,Qo=So),ta.prototype.getId=function(){return this.id},ta.prototype._setMap=function(t){if(null==t||void 0===t){var e=this.map;delete this.map,this._invokeEvent("sourceremoved",this),e&&e.events.invoke("sourceremoved",this)}else this.map=t,this._invokeEvent("sourceadded",this),this.map.events.invoke("sourceadded",this)},ta);function ta(t){var e=Qo.call(this)||this;return e.id=t||un(),e}var ea,ra=(b(ia,ea=$o),ia.prototype.add=function(t,e){this._addNoUpdate(t,e),this._updateSource()},ia.prototype.clear=function(){this._clearNoUpdate(),this._updateSource()},ia.prototype.dispose=function(){this.options=null,this.shapes=null,this.shapesMap=null,this.map=null},ia.prototype.getClusterExpansionZoom=function(e){var n=this;return new Promise(function(r,i){if(n.map){var t=n.map._getMap().getSource(n.getId());t&&"geojson"===t.type&&t.getClusterExpansionZoom(e,function(t,e){t?i(t):"number"!=typeof e||r(e)})}else i("The DataSource hasn't been added to a map.")})},ia.prototype.getClusterChildren=function(e){var n=this;return new Promise(function(r,i){if(n.map){var t=n.map._getMap().getSource(n.getId());t&&"geojson"===t.type&&t.getClusterChildren(e,function(t,e){t?i(t):e&&r(n.map.sources._mapFeaturesToShapes(e,!1,n))})}else i("The DataSource hasn't been added to a map.")})},ia.prototype.getClusterLeaves=function(e,n,o){var a=this;return new Promise(function(r,i){if(a.map){var t=a.map._getMap().getSource(a.getId());t&&"geojson"===t.type&&t.getClusterLeaves(e,n,o,function(t,e){t?i(t):e&&r(a.map.sources._mapFeaturesToShapes(e,!1,a))})}else i("The DataSource hasn't been added to a map.")})},ia.prototype.getOptions=function(){return Ii(this.options)},ia.prototype.getShapes=function(){return Array.from(this.shapes)},ia.prototype.importDataFromUrl=function(t){var e=this;return fetch(t,{method:"GET",mode:"cors"}).then(function(t){if(t.ok)return t.json();throw new Error("HTTP "+t.status+": "+t.statusText)}).then(function(t){e.add(t)})},ia.prototype.getShapeById=function(t){return this.shapes[this.shapesMap.get(t)]||null},ia.prototype.remove=function(t){for(var e=0,r=Array.isArray(t)?t:[t];e<r.length;e++){var i=r[e];"number"==typeof i?this._removeByIndex(i):this._removeById(i)}this._updateSource()},ia.prototype.removeById=function(t){for(var e=0,r=Array.isArray(t)?t:[t];e<r.length;e++){var i=r[e];this._removeById(i)}this._updateSource()},ia.prototype.setOptions=function(t){var e=(new Yo).merge(this.options,Ii(t));sn(this.options,e)||(this._invokeEvent("datasourceupdated",this),this.options=e,this.map&&this.map._rebuildStyle())},ia.prototype.setShapes=function(t){this._clearNoUpdate(),this.add(t)},ia.prototype.toJson=function(){return new Ro(this.shapes.map(function(t){return t.toJson()}))},ia.prototype._toJson=function(){return new Ro(this.shapes.map(function(t){return t._toJson()}))},ia.prototype._buildSource=function(){var t={type:"geojson",data:this._toJson(),maxzoom:this.options.maxZoom,cluster:this.options.cluster,clusterRadius:this.options.clusterRadius,tolerance:this.options.tolerance,lineMetrics:this.options.lineMetrics,clusterProperties:this.options.clusterProperties};return"number"==typeof this.options.clusterMaxZoom&&(t.clusterMaxZoom=this.options.clusterMaxZoom),t},ia.prototype._addNoUpdate=function(t,e){var r;if(t instanceof Po)this._addToSources(t,e),r=[t];else if(Array.isArray(t))r=t.map(function(t){return t instanceof Po?t:new Po(t)}),this._addToSources(r,e);else if("FeatureCollection"===t.type)r=t.features.map(function(t){return new Po(t)}),this._addToSources(r,e);else if("GeometryCollection"===t.type)r=t.geometries.map(function(t){return new Po(t)}),this._addToSources(r,e);else{var i=new Po(t);this._addToSources(i,e),r=[i]}this._invokeEvent("dataadded",r)},ia.prototype._clearNoUpdate=function(){var t=this.shapes;this.shapes=[],this.shapesMap=new Ci,t&&0<t.length&&this._invokeEvent("dataremoved",t)},ia.prototype._updateSource=function(){var t=this;void 0===this.requestId&&(this.requestId=requestAnimationFrame(function(){t._updateMboxSource(),t.requestId=void 0}))},ia.prototype._addToSources=function(t,e){if(t=Array.isArray(t)?t:[t],"number"!=typeof e)for(var r=0,i=t;r<i.length;r++){var n=i[r];this.shapes.push(n),this.shapesMap.set(n.getId(),this.shapes.length-1)}else for(var o=t.length-1;0<=o;o--)this.shapes.splice(e,0,t[o]),this._updateShapesMap(e);for(var a=0,s=t;a<s.length;a++)(n=s[a])._setDataSource(this)},ia.prototype._removeById=function(t){var e,r=t instanceof Po?t.getId():"string"==typeof t||"number"==typeof t?t:t.id;(e=this.shapes[this.shapesMap.get(r)])._setDataSource(null),this.shapes.splice(this.shapesMap.get(r),1),this._updateShapesMap(this.shapesMap.get(r)),this.shapesMap.delete(r),this._invokeEvent("dataremoved",[e])},ia.prototype._removeByIndex=function(t){var e;if(t>=this.shapes.length)throw new Error("The specified remove index '"+t+"' is greater than the maximum possible index '"+(this.shapes.length-1)+"'");e=this.shapes[t],this.shapesMap.delete(e.getId()),e._setDataSource(null),this.shapes.splice(t,1),this._updateShapesMap(t),this._invokeEvent("dataremoved",[e])},ia.prototype._updateShapesMap=function(t){for(var e=t;e<this.shapes.length;e++)this.shapesMap.set(this.shapes[e].getId(),e)},ia.prototype._updateMboxSource=function(){if(this.map&&this.map._getMap()){var t=this.map._getMap().getSource(this.getId());t&&"geojson"===t.type&&t.setData(this._toJson())}},ia);function ia(t,e){var r=ea.call(this,t)||this;return r.requestId=void 0,r.options=(new Yo).merge(Ii(e)),r.shapes=[],r.shapesMap=new Ci,r}var na,oa=(b(aa,na=E),aa);function aa(){var t=null!==na&&na.apply(this,arguments)||this;return t.bounds=void 0,t.minZoom=0,t.maxZoom=22,t.isTMS=!1,t.tiles=void 0,t.tileSize=512,t.url=void 0,t}var sa,la=(b(ua,sa=$o),ua.prototype.getOptions=function(){return Ii(this.options)},ua.prototype.getShape=function(t,e){return this.map._getMap().querySourceFeatures(this.getId(),{sourceLayer:t,filter:e})},ua.prototype._buildSource=function(){var t={type:"vector"};return this.options.bounds&&(t.bounds=this.options.bounds),this.options.tiles?(t.tiles=this.options.tiles,t.minzoom=this.options.minZoom,t.maxzoom=this.options.maxZoom):this.options.url&&(t.url=this.options.url),this.options.isTMS&&(t.scheme="tms"),this.options.tileSize&&(t.tileSize=this.options.tileSize),t},ua);function ua(t,e){var r=sa.call(this,t)||this;return r.options=(new oa).merge(Ii(e)),r}var ca,pa=Object.freeze({Source:$o,DataSource:ra,VectorTileSource:la}),ha=(b(da,ca=So),da.prototype.getId=function(){return this.id},da.prototype.getMap=function(){return this.map||null},da.prototype.onAdd=function(t){this.map=t,this._invokeEvent("layeradded",this),this.map.events.invoke("layeradded",this)},da.prototype.onRemove=function(){var t=this.map;delete this.map,this._invokeEvent("layerremoved",this),t&&t.events.invoke("layerremoved",this)},da._isMBoxEvent=function(t){return!this.LayerEvents.hasOwnProperty(t)},da.prototype._updateBaseProperties=function(t,e){this._updateFilter(t.filter,e.filter),this._updateZoomRange(t.minZoom,e.minZoom,t.maxZoom,e.maxZoom),this._updateLayoutProperty("visibility",t.visible,e.visible,t.visible?"visible":"none")},da.prototype._updateFilter=function(t,e){sn(t,e)||this.map._getMap().setFilter(this.id,t)},da.prototype._updatePaintProperty=function(t,e,r,i){sn(e,r)||this.map._getMap().setPaintProperty(this.id,t,i||e)},da.prototype._updateLayoutProperty=function(t,e,r,i){sn(e,r)||this.map._getMap().setLayoutProperty(this.id,t,i||e)},da.prototype._updateZoomRange=function(t,e,r,i){t===e&&i===r||this.map._getMap().setLayerZoomRange(this.id,t,r)},da.LayerEvents={layeradded:void 0,layerremoved:void 0},da);function da(t){var e=ca.call(this)||this;return e.id=t||un(),e}var fa,ma=(b(ga,fa=E),ga._cloneCustomizer=function(t){if(t instanceof $o)return t},ga);function ga(){var t=null!==fa&&fa.apply(this,arguments)||this;return t.filter=void 0,t.minZoom=0,t.maxZoom=24,t.visible=!0,t}var ya,va=(b(_a,ya=ma),_a);function _a(){var t=null!==ya&&ya.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.color="#1A73AA",t.blur=0,t.opacity=1,t.strokeColor="#FFFFFF",t.strokeOpacity=1,t.strokeWidth=2,t.pitchAlignment="viewport",t.radius=8,t}var xa,ba=(b(wa,xa=ha),wa.prototype.getOptions=function(){return Xo(this.options,va._cloneCustomizer)},wa.prototype.getSource=function(){return this.options.source},wa.prototype.setOptions=function(t){var e=(new va).merge(this.options,Xo(t,va._cloneCustomizer));if(this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("circle-blur",e.blur,this.options.blur),this._updatePaintProperty("circle-color",e.color,this.options.color),this._updatePaintProperty("circle-opacity",e.opacity,this.options.opacity),this._updatePaintProperty("circle-radius",e.radius,this.options.radius),this._updatePaintProperty("circle-stroke-color",e.strokeColor,this.options.strokeColor),this._updatePaintProperty("circle-stroke-opacity",e.strokeOpacity,this.options.strokeOpacity),this._updatePaintProperty("circle-stroke-width",e.strokeWidth,this.options.strokeWidth),this._updatePaintProperty("circle-pitch-alignment",e.pitchAlignment,this.options.pitchAlignment)}this.options=e},wa.prototype._buildLayers=function(){var t={id:this.id,type:"circle",source:this.options.source instanceof $o?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:{"circle-color":this.options.color,"circle-blur":this.options.blur,"circle-opacity":this.options.opacity,"circle-stroke-color":this.options.strokeColor,"circle-stroke-opacity":this.options.strokeOpacity,"circle-stroke-width":this.options.strokeWidth,"circle-pitch-alignment":this.options.pitchAlignment,"circle-radius":this.options.radius},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(t.filter=this.options.filter),this.options.sourceLayer&&(t["source-layer"]=this.options.sourceLayer),[t]},wa.prototype._getLayerIds=function(){return[this.id]},wa.prototype._getSourceIds=function(){var t=new Set;return this.options.source instanceof $o?t.add(this.options.source.getId()):t.add(this.options.source),t},wa);function wa(t,e,r){var i=xa.call(this,e)||this;return i.options=(new va).merge(Xo(r,va._cloneCustomizer)),i.options.source=t||i.options.source,i}var Sa,Ta=(b(Ea,Sa=ma),Ea._cloneCustomizer=function(t){if(t instanceof $o)return t},Ea);function Ea(){var t=null!==Sa&&Sa.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.color=["interpolate",["linear"],["heatmap-density"],0,"rgba(0,0, 255,0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],t.intensity=1,t.opacity=1,t.radius=30,t.weight=1,t}var Ia,Ca=(b(ka,Ia=ha),ka.prototype.getOptions=function(){return Xo(this.options,Ta._cloneCustomizer)},ka.prototype.getSource=function(){return this.options.source},ka.prototype.setOptions=function(t){var e=(new Ta).merge(this.options,Xo(t,Ta._cloneCustomizer));if(this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("heatmap-color",e.color,this.options.color),this._updatePaintProperty("heatmap-intensity",e.intensity,this.options.intensity),this._updatePaintProperty("heatmap-opacity",e.opacity,this.options.opacity),this._updatePaintProperty("heatmap-radius",e.radius,this.options.radius),this._updatePaintProperty("heatmap-weight",e.weight,this.options.weight)}this.options=e},ka.prototype._buildLayers=function(){var t={id:this.id,type:"heatmap",source:this.options.source instanceof $o?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:{"heatmap-color":this.options.color,"heatmap-intensity":this.options.intensity,"heatmap-opacity":this.options.opacity,"heatmap-radius":this.options.radius,"heatmap-weight":this.options.weight},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(t.filter=this.options.filter),this.options.sourceLayer&&(t["source-layer"]=this.options.sourceLayer),[t]},ka.prototype._getLayerIds=function(){return[this.id]},ka.prototype._getSourceIds=function(){var t=new Set;return this.options.source instanceof $o?t.add(this.options.source.getId()):t.add(this.options.source),t},ka);function ka(t,e,r){var i=Ia.call(this,e)||this;return i.options=(new Ta).merge(Xo(r,Ta._cloneCustomizer)),i.options.source=t||i.options.source,i}var Aa,Pa=(b(Ma,Aa=ma),Ma);function Ma(){var t=null!==Aa&&Aa.apply(this,arguments)||this;return t.contrast=0,t.fadeDuration=300,t.hueRotation=0,t.maxBrightness=1,t.minBrightness=0,t.opacity=1,t.saturation=0,t}var La,Oa=(b(Da,La=Pa),Da._cloneCustomizer=function(t){if(t instanceof $o)return t},Da);function Da(){var t=null!==La&&La.apply(this,arguments)||this;return t.url=void 0,t.coordinates=void 0,t}var Ra,za=(b(Na,Ra=ha),Na.prototype._getSourceIds=function(){var t=new Set;return t.add(this._getSourceId()),t},Na);function Na(){return null!==Ra&&Ra.apply(this,arguments)||this}var Ba,Fa=(b(Ua,Ba=za),Ua.prototype.getOptions=function(){return Xo(this.options,Oa._cloneCustomizer)},Ua.prototype.setOptions=function(t){var e=(new Oa).merge(this.options,Xo(t,Oa._cloneCustomizer)),r="string"==typeof t.url&&t.url!==this.getOptions().url,i=void 0!==t.coordinates&&t.coordinates!==this.getOptions().coordinates;if(this.map){this._updateBaseProperties(e,this.options),this._updatePaintProperty("raster-contrast",e.contrast,this.options.contrast),this._updatePaintProperty("raster-fade-duration",e.fadeDuration,this.options.fadeDuration),this._updatePaintProperty("raster-hue-rotate",e.hueRotation,this.options.hueRotation),this._updatePaintProperty("raster-brightness-max",e.maxBrightness,this.options.maxBrightness),this._updatePaintProperty("raster-opacity",e.opacity,this.options.opacity),this._updatePaintProperty("raster-saturation",e.saturation,this.options.saturation);var n=this.map._getMap().getSource(this._getSourceId());n&&n.updateImage(e)}this.options=e,r?this.reloadImage():i&&this.updateTransform()},Ua.prototype.getPositions=function(e){return this.transform.then(function(t){return t.toTarget(e)})},Ua.prototype.getPixels=function(e){return this.transform.then(function(t){return t.toSource(e)})},Ua.getCoordinatesFromRefPoints=function(t,e,r,i){return new Io(r,i).toTarget([[0,0],[t,0],[t,e],[0,e]])},Ua.getCoordinatesFromEdges=function(t,e,r,i,n){"number"!=typeof n&&(n=0);var o=[Math.min(i,r),e,Math.max(i,r),t],a=Oo.getCenter(o);return ro([Oo.getNorthWest(o),Oo.getNorthEast(o),Oo.getSouthEast(o),Oo.getSouthWest(o)],a,n)},Ua.prototype._buildLayers=function(){var t={id:this.id,type:"raster",source:this._getSourceId(),layout:{visibility:this.options.visible?"visible":"none"},paint:{"raster-opacity":this.options.opacity,"raster-hue-rotate":this.options.hueRotation,"raster-brightness-min":this.options.minBrightness,"raster-brightness-max":this.options.maxBrightness,"raster-saturation":this.options.saturation,"raster-contrast":this.options.contrast,"raster-fade-duration":this.options.fadeDuration},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(t.filter=this.options.filter),[t]},Ua.prototype._getLayerIds=function(){return[this.id]},Ua.prototype._buildSource=function(){return{type:"image",url:this.options.url,coordinates:this.options.coordinates}},Ua.prototype._getSourceId=function(){return this.getId()+"-ImageSource"},Ua.prototype.reloadImage=function(){var r=this;this.options.url&&(this.transform=new Promise(function(e,t){r.img.onload=function(){var t=[[0,0],[r.img.width,0],[r.img.width,r.img.height],[0,r.img.height]];e(new Io(t,r.options.coordinates)),r.isLoading=!1},r.img.onerror=r.img.onabort=function(){t("Failed to load image")},r.isLoading=!0,r.img.src=r.options.url}))},Ua.prototype.updateTransform=function(){if(!this.isLoading){var t=[[0,0],[this.img.width,0],[this.img.width,this.img.height],[0,this.img.height]];this.transform=Promise.resolve(new Io(t,this.options.coordinates))}},Ua);function Ua(t,e){var r=Ba.call(this,e)||this;return r.isLoading=!1,r.options=(new Oa).merge(Xo(t,Oa._cloneCustomizer)),r.img=new Image,r.reloadImage(),r}var ja,qa=(b(Va,ja=ma),Va);function Va(){var t=null!==ja&&ja.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.lineCap="round",t.lineJoin="round",t.blur=0,t.strokeColor="#1E90FF",t.strokeDashArray=void 0,t.strokeGradient=void 0,t.offset=0,t.strokeOpacity=1,t.translate=new dn(0,0),t.translateAnchor="map",t.strokeWidth=2,t}var Ga,Za=(b(Ha,Ga=ha),Ha.prototype.getOptions=function(){return Xo(this.options,qa._cloneCustomizer)},Ha.prototype.getSource=function(){return this.options.source},Ha.prototype.setOptions=function(t){var e=(new qa).merge(this.options,Xo(t,qa._cloneCustomizer));if(this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("line-blur",e.blur,this.options.blur),this._updateLayoutProperty("line-cap",e.lineCap,this.options.lineCap),this._updateLayoutProperty("line-join",e.lineJoin,this.options.lineJoin),this._updatePaintProperty("line-offset",e.offset,this.options.offset),this._updatePaintProperty("line-color",e.strokeColor,this.options.strokeColor),this._updatePaintProperty("line-dasharray",e.strokeDashArray,this.options.strokeDashArray),this._updatePaintProperty("line-gradient",e.strokeGradient,this.options.strokeGradient),this._updatePaintProperty("line-opacity",e.strokeOpacity,this.options.strokeOpacity),this._updatePaintProperty("line-width",e.strokeWidth,this.options.strokeWidth),this._updatePaintProperty("line-translate",e.translate,this.options.translate),this._updatePaintProperty("line-translate-anchor",e.translateAnchor,this.options.translateAnchor)}this.options=e},Ha.prototype._buildLayers=function(){return[w(w(w(w({id:this.id,type:"line"},this.options.sourceLayer&&{"source-layer":this.options.sourceLayer}),{source:this.options.source instanceof $o?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none","line-cap":this.options.lineCap,"line-join":this.options.lineJoin},paint:w(w(w({"line-blur":this.options.blur,"line-color":this.options.strokeColor},this.options.strokeDashArray&&{"line-dasharray":this.options.strokeDashArray}),this.options.strokeGradient&&{"line-gradient":this.options.strokeGradient}),{"line-offset":this.options.offset,"line-opacity":this.options.strokeOpacity,"line-translate":this.options.translate,"line-translate-anchor":this.options.translateAnchor,"line-width":this.options.strokeWidth})}),this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},Ha.prototype._getLayerIds=function(){return[this.id]},Ha.prototype._getSourceIds=function(){var t=new Set;return this.options.source instanceof $o?t.add(this.options.source.getId()):t.add(this.options.source),t},Ha);function Ha(t,e,r){var i=Ga.call(this,e)||this;return i.options=(new qa).merge(Xo(r,qa._cloneCustomizer)),i.options.source=t||i.options.source,i}var Wa,Ka=(b(Xa,Wa=ma),Xa);function Xa(){var t=null!==Wa&&Wa.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.base=0,t.fillColor="#1E90FF",t.height=0,t.fillOpacity=1,t.fillPattern=void 0,t.translate=new dn(0,0),t.translateAnchor="map",t.verticalGradient=!0,t}var Ya,Ja=(b(Qa,Ya=ha),Qa.prototype.getOptions=function(){return Xo(this.options,Ka._cloneCustomizer)},Qa.prototype.getSource=function(){return this.options.source},Qa.prototype.setOptions=function(t){var e=(new Ka).merge(this.options,Xo(t,Ka._cloneCustomizer));if(this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("fill-extrusion-base",e.base,this.options.base),this._updatePaintProperty("fill-extrusion-color",e.fillColor,this.options.fillColor),this._updatePaintProperty("fill-extrusion-height",e.height,this.options.height),this._updatePaintProperty("fill-extrusion-opacity",e.fillOpacity,this.options.fillOpacity),this._updatePaintProperty("fill-extrusion-pattern",e.fillPattern,this.options.fillPattern),this._updatePaintProperty("fill-extrusion-translate",e.translate,this.options.translate),this._updatePaintProperty("fill-extrusion-translate-anchor",e.translateAnchor,this.options.translateAnchor),this._updatePaintProperty("fill-extrusion-vertical-gradient",e.verticalGradient,this.options.verticalGradient)}this.options=e},Qa.prototype._buildLayers=function(){return[w(w(w(w({id:this.id,type:"fill-extrusion"},this.options.sourceLayer&&{"source-layer":this.options.sourceLayer}),{source:this.options.source instanceof $o?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:w(w({"fill-extrusion-base":this.options.base,"fill-extrusion-height":this.options.height,"fill-extrusion-opacity":this.options.fillOpacity},this.options.fillPattern?{"fill-extrusion-pattern":this.options.fillPattern}:{"fill-extrusion-color":this.options.fillColor}),{"fill-extrusion-translate":this.options.translate,"fill-extrusion-translate-anchor":this.options.translateAnchor,"fill-extrusion-vertical-gradient":this.options.verticalGradient})}),this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},Qa.prototype._getLayerIds=function(){return[this.id]},Qa.prototype._getSourceIds=function(){var t=new Set;return this.options.source instanceof $o?t.add(this.options.source.getId()):t.add(this.options.source),t},Qa);function Qa(t,e,r){var i=Ya.call(this,e)||this;return i.options=(new Ka).merge(Xo(r,Ka._cloneCustomizer)),i.options.source=t||i.options.source,i}var $a,ts=(b(es,$a=ma),es.prototype.merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=!1,i=!1,n=0,o=t;n<o.length;n++){var a=o[n];a&&(a.hasOwnProperty("fillColor")?i=!(r=!0):a.hasOwnProperty("fillPattern")&&(r=!(i=!0)))}var s=$a.prototype.merge.apply(this,t);return r?s.fillPattern=void 0:i&&(s.fillColor=void 0),s},es);function es(){var t=null!==$a&&$a.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.fillColor="#1E90FF",t.fillOpacity=.5,t.fillPattern=void 0,t}var rs,is=(b(ns,rs=ha),ns.prototype.getOptions=function(){return Xo(this.options,ts._cloneCustomizer)},ns.prototype.getSource=function(){return this.options.source},ns.prototype.setOptions=function(t){var e=(new ts).merge(this.options,Xo(t,ts._cloneCustomizer));if(this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("fill-color",e.fillColor,this.options.fillColor),this._updatePaintProperty("fill-opacity",e.fillOpacity,this.options.fillOpacity),this._updatePaintProperty("fill-pattern",e.fillPattern,this.options.fillPattern)}this.options=e},ns.prototype._buildLayers=function(){var t={id:this.id,type:"fill",source:this.options.source instanceof $o?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:{"fill-opacity":this.options.fillOpacity},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(t.filter=this.options.filter),this.options.sourceLayer&&(t["source-layer"]=this.options.sourceLayer),this.options.fillPattern?t.paint["fill-pattern"]=this.options.fillPattern:t.paint["fill-color"]=this.options.fillColor,[t]},ns.prototype._getLayerIds=function(){return[this.id]},ns.prototype._getSourceIds=function(){var t=new Set;return this.options.source instanceof $o?t.add(this.options.source.getId()):t.add(this.options.source),t},ns);function ns(t,e,r){var i=rs.call(this,e)||this;return i.options=(new ts).merge(Xo(r,ts._cloneCustomizer)),i.options.source=t||i.options.source,i}var os,as=(b(ss,os=E),ss);function ss(){var t=null!==os&&os.apply(this,arguments)||this;return t.allowOverlap=!1,t.anchor="bottom",t.ignorePlacement=!1,t.image="marker-blue",t.offset=new dn(0,0),t.optional=!1,t.pitchAlignment="auto",t.rotation=0,t.rotationAlignment="auto",t.size=1,t.opacity=1,t}var ls,us=(b(cs,ls=E),cs);function cs(){var t=null!==ls&&ls.apply(this,arguments)||this;return t.allowOverlap=!1,t.anchor="center",t.textField=void 0,t.font=["StandardFont-Regular"],t.ignorePlacement=!1,t.offset=new dn(0,0),t.optional=!1,t.pitchAlignment="auto",t.rotation=0,t.rotationAlignment="auto",t.size=16,t.color="#000000",t.haloBlur=0,t.haloColor="rgba(0,0,0,0)",t.haloWidth=0,t.opacity=1,t}var ps,hs=(b(ds,ps=ma),ds);function ds(){var t=null!==ps&&ps.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.iconOptions=new as,t.textOptions=new us,t.placement="point",t.lineSpacing=250,t}var fs,ms=(b(gs,fs=ha),gs.prototype.getOptions=function(){return Xo(this.options,hs._cloneCustomizer)},gs.prototype.getSource=function(){return this.options.source},gs.prototype.setOptions=function(t){var e=(new hs).merge(this.options,Xo(t,hs._cloneCustomizer));if(this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updateLayoutProperty("symbol-spacing",e.lineSpacing,this.options.lineSpacing),this._updateLayoutProperty("symbol-placement",e.placement,this.options.placement),this._updateLayoutProperty("icon-allow-overlap",e.iconOptions.allowOverlap,this.options.iconOptions.allowOverlap),this._updateLayoutProperty("icon-anchor",e.iconOptions.anchor,this.options.iconOptions.anchor),this._updateLayoutProperty("icon-ignore-placement",e.iconOptions.ignorePlacement,this.options.iconOptions.ignorePlacement),this._updateLayoutProperty("icon-image",e.iconOptions.image,this.options.iconOptions.image),this._updateLayoutProperty("icon-offset",e.iconOptions.offset,this.options.iconOptions.offset),this._updatePaintProperty("icon-opacity",e.iconOptions.opacity,this.options.iconOptions.opacity),this._updateLayoutProperty("icon-optional",e.iconOptions.optional,this.options.iconOptions.optional),this._updateLayoutProperty("icon-pitch-alignment",e.iconOptions.pitchAlignment,this.options.iconOptions.pitchAlignment),this._updateLayoutProperty("icon-rotate",e.iconOptions.rotation,this.options.iconOptions.rotation),this._updateLayoutProperty("icon-rotation-alignment",e.iconOptions.rotationAlignment,this.options.iconOptions.rotationAlignment),this._updateLayoutProperty("icon-size",e.iconOptions.size,this.options.iconOptions.size),this._updateLayoutProperty("text-allow-overlap",e.textOptions.allowOverlap,this.options.textOptions.allowOverlap),this._updateLayoutProperty("text-anchor",e.textOptions.anchor,this.options.textOptions.anchor),this._updatePaintProperty("text-color",e.textOptions.color,this.options.textOptions.color),this._updateLayoutProperty("text-font",e.textOptions.font,this.options.textOptions.font),this._updateLayoutProperty("text-ignore-placement",e.textOptions.ignorePlacement,this.options.textOptions.ignorePlacement),this._updatePaintProperty("text-halo-blur",e.textOptions.haloBlur,this.options.textOptions.haloBlur),this._updatePaintProperty("text-halo-color",e.textOptions.haloColor,this.options.textOptions.haloColor),this._updatePaintProperty("text-halo-width",e.textOptions.haloWidth,this.options.textOptions.haloWidth),this._updateLayoutProperty("text-offset",e.textOptions.offset,this.options.textOptions.offset),this._updatePaintProperty("text-opacity",e.textOptions.opacity,this.options.textOptions.opacity),this._updateLayoutProperty("text-optional",e.textOptions.optional,this.options.textOptions.optional),this._updateLayoutProperty("text-pitch-alignment",e.textOptions.pitchAlignment,this.options.textOptions.pitchAlignment),this._updateLayoutProperty("text-rotate",e.textOptions.rotation,this.options.textOptions.rotation),this._updateLayoutProperty("text-rotation-alignment",e.textOptions.rotationAlignment,this.options.textOptions.rotationAlignment),this._updateLayoutProperty("text-size",e.textOptions.size,this.options.textOptions.size),this._updateLayoutProperty("text-field",e.textOptions.textField,this.options.textOptions.textField)}this.options=e},gs.prototype._buildLayers=function(){return[w(w(w(w({id:this.id,type:"symbol"},this.options.sourceLayer&&{"source-layer":this.options.sourceLayer}),{source:this.options.source instanceof $o?this.options.source.getId():this.options.source,layout:w(w({visibility:this.options.visible?"visible":"none","symbol-placement":this.options.placement,"symbol-spacing":this.options.lineSpacing,"text-allow-overlap":this.options.textOptions.allowOverlap,"text-anchor":this.options.textOptions.anchor},this.options.textOptions.textField&&{"text-field":this.options.textOptions.textField}),{"text-font":this.options.textOptions.font,"text-ignore-placement":this.options.textOptions.ignorePlacement,"text-offset":this.options.textOptions.offset,"text-optional":this.options.textOptions.optional,"text-pitch-alignment":this.options.textOptions.pitchAlignment,"text-rotate":this.options.textOptions.rotation,"text-rotation-alignment":this.options.textOptions.rotationAlignment,"text-size":this.options.textOptions.size,"icon-allow-overlap":this.options.iconOptions.allowOverlap,"icon-anchor":this.options.iconOptions.anchor,"icon-ignore-placement":this.options.iconOptions.ignorePlacement,"icon-image":this.options.iconOptions.image,"icon-offset":this.options.iconOptions.offset,"icon-optional":this.options.iconOptions.optional,"icon-pitch-alignment":this.options.iconOptions.pitchAlignment,"icon-rotate":this.options.iconOptions.rotation,"icon-rotation-alignment":this.options.iconOptions.rotationAlignment,"icon-size":this.options.iconOptions.size}),paint:{"text-color":this.options.textOptions.color,"text-halo-blur":this.options.textOptions.haloBlur,"text-halo-color":this.options.textOptions.haloColor,"text-halo-width":this.options.textOptions.haloWidth,"text-opacity":this.options.textOptions.opacity,"icon-opacity":this.options.iconOptions.opacity}}),this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},gs.prototype._getLayerIds=function(){return[this.id]},gs.prototype._getSourceIds=function(){var t=new Set;return this.options.source instanceof $o?t.add(this.options.source.getId()):t.add(this.options.source),t},gs);function gs(t,e,r){var i=fs.call(this,e)||this;return i.options=(new hs).merge(Xo(r,hs._cloneCustomizer)),i.options.source=t||i.options.source,i}var ys,vs=(b(_s,ys=Pa),_s);function _s(){var t=null!==ys&&ys.apply(this,arguments)||this;return t.bounds=[-180,-85.0511,180,85.0511],t.minSourceZoom=0,t.maxSourceZoom=22,t.tileSize=512,t.isTMS=!1,t.subdomains=void 0,t.tileUrl=void 0,t}var xs,bs=(b(ws,xs=za),ws.prototype.getOptions=function(){return Xo(this.options,vs._cloneCustomizer)},ws.prototype.setOptions=function(t){var e=(new vs).merge(this.options,Xo(t,vs._cloneCustomizer));if(this.map){if(!sn(e.bounds,this.options.bounds)||e.isTMS!==this.options.isTMS||e.maxSourceZoom!==this.options.maxSourceZoom||e.minSourceZoom!==this.options.minSourceZoom||!sn(e.subdomains,this.options.subdomains)||e.tileSize!==this.options.tileSize||e.tileUrl!==this.options.tileUrl)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("raster-contrast",e.contrast,this.options.contrast),this._updatePaintProperty("raster-fade-duration",e.fadeDuration,this.options.fadeDuration),this._updatePaintProperty("raster-hue-rotate",e.hueRotation,this.options.hueRotation),this._updatePaintProperty("raster-brightness-max",e.maxBrightness,this.options.maxBrightness),this._updatePaintProperty("raster-opacity",e.opacity,this.options.opacity),this._updatePaintProperty("raster-saturation",e.saturation,this.options.saturation)}this.options=e},ws.prototype._setOptionsNoUpdate=function(t){this.options=(new vs).merge(this.options,Xo(t,vs._cloneCustomizer))},ws.prototype._buildLayers=function(){return[w(w({id:this.id,type:"raster",source:this._getSourceId(),layout:{visibility:this.options.visible?"visible":"none"},paint:{"raster-contrast":this.options.contrast,"raster-fade-duration":this.options.fadeDuration,"raster-hue-rotate":this.options.hueRotation,"raster-brightness-max":this.options.maxBrightness,"raster-brightness-min":this.options.minBrightness,"raster-opacity":this.options.opacity,"raster-saturation":this.options.saturation}},this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},ws.prototype._getLayerIds=function(){return[this.id]},ws.prototype._buildSource=function(){var t;if(this.options.tileUrl){if(-1===this.options.tileUrl.indexOf("{"))return{type:"raster",url:this.options.tileUrl};if(-1!==this.options.tileUrl.indexOf("{subdomain}")){if(!(this.options.subdomains&&0<this.options.subdomains.length))throw new Error("The {subdomain} placeholder was included in the tileUrl but no subdomains were specified");for(var e=[],r=0,i=this.options.subdomains;r<i.length;r++){var n=i[r];e.push(this.options.tileUrl.replace(/{subdomain}/g,n))}t=e}else t=[this.options.tileUrl]}return w({type:"raster",bounds:this.options.bounds,maxzoom:this.options.maxSourceZoom,minzoom:this.options.minSourceZoom,scheme:this.options.isTMS?"tms":"xyz",tileSize:this.options.tileSize},t&&{tiles:t})},ws.prototype._getSourceId=function(){return this.getId()+"-RasterSource"},ws);function ws(t,e){var r=xs.call(this,e)||this;return t&&r.setOptions(t),r}var Ss=Object.freeze({BubbleLayer:ba,Layer:ha,LineLayer:Za,PolygonExtrusionLayer:Ja,PolygonLayer:is,SymbolLayer:ms,TileLayer:bs,HeatMapLayer:Ca,ImageLayer:Fa}),Ts=(Es.convertHtmlString=function(t){if("string"!=typeof t)return t;var e=document.createElement("div");return e.innerHTML=t,e},Es);function Es(){}var Is=Function.prototype,Cs=Object.prototype,ks=Is.toString,As=Cs.hasOwnProperty,Ps=ks.call(Object);var Ms=function(t){if(!Ne(t)||"[object Object]"!=Gt(t))return!1;var e=Ir(t);if(null===e)return!0;var r=As.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&ks.call(r)==Ps};var Ls,Os=function(t){return Ne(t)&&1===t.nodeType&&!Ms(t)},Ds=(b(Rs,Ls=E),Rs._cloneCustomizer=function(t){if(Os(t))return t},Rs);function Rs(){var t=null!==Ls&&Ls.apply(this,arguments)||this;return t.anchor="none",t.draggable=!1,t.closeButton=!0,t.content=document.createElement("span"),t.fillColor="#FFFFFF",t.pixelOffset=new dn(0,0),t.position=new _o(0,0),t.showPointer=!0,t}var zs,Ns=(b(Bs,zs=So),Bs.prototype.setPopupOptions=function(t){this.setOptions(t)},Bs.prototype.setOptions=function(t){var e=(new Ds).merge(this.options,Xo(t,Ds._cloneCustomizer));e.content!==this.options.content?(this.htmlContent.remove(),this.htmlContent=this._createHtmlContent(e),this.contentDiv.prepend(this.htmlContent)):e.draggable!==this.options.draggable&&this._setDraggable(this.htmlContent,e.draggable),e.closeButton&&!this.closeBtn?(this.closeBtn=this._createCloseButton(),this.contentDiv.appendChild(this.closeBtn)):!e.closeButton&&this.closeBtn&&(this.contentDiv.removeChild(this.closeBtn),delete this.closeBtn),e.showPointer&&!this.arrowDiv?(this.arrowDiv=this._createArrowDiv(),this.containerDiv.appendChild(this.arrowDiv)):!e.showPointer&&this.arrowDiv&&(this.containerDiv.removeChild(this.arrowDiv),delete this.arrowDiv),e.fillColor!==this.options.fillColor&&(this.containerDiv.style.borderColor=e.fillColor,this.contentDiv.style.backgroundColor=e.fillColor),this.marker&&(e.anchor!==this.options.anchor?"none"===this.options.anchor?(this.autoAnchor!==e.anchor&&this._replaceMarker(this.map,e),this.map.events.remove("move",this._onMove),delete this.autoAnchor):(this._replaceMarker(this.map,e),"none"===e.anchor&&this.map.events.add("move",this._onMove)):(sn(e.position,this.options.position)||this.marker.setLngLat(e.position),sn(e.pixelOffset,this.options.pixelOffset)||this.marker.setOffset(e.pixelOffset))),this.options=e},Bs.prototype.getPopupOptions=function(){return this.getOptions()},Bs.prototype.getOptions=function(){return Xo(this.options,Ds._cloneCustomizer)},Bs.prototype._dragToPixel=function(t){this.dragging||(this.dragging=!0,this.contentDiv.style.pointerEvents="none",this._invokeEvent("dragstart",{type:"dragstart",target:this}));var e=[t[0]+this.dragOffset[0],t[1]+this.dragOffset[1]],r=this.map.pixelsToPositions([e])[0];this.options.position=r,this.marker.setLngLat(this.options.position),this._invokeEvent("drag",{type:"drag",target:this})},Bs.prototype._onUp=function(){this.dragging&&(this.contentDiv.style.pointerEvents="",this._invokeEvent("dragend",{type:"dragend",target:this}),"none"===this.options.anchor&&this._onMove()),delete this.dragOffset,delete this.dragging},Bs.prototype._createContainerDiv=function(t){var e=this,r=document.createElement("div");r.classList.add(Bs.Css.container),r.classList.add(Bs.Css.hidden),r.style.borderColor=t.fillColor;var i=!1;return r.addEventListener("keydown",function(t){"Tab"!==t.key&&"Escape"!==t.key&&"Esc"!==t.key||(i=!0)}),r.addEventListener("keyup",function(t){"Tab"!==t.key&&"Escape"!==t.key&&"Esc"!==t.key||(i=!1)}),r.addEventListener("focusin",function(t){e.map&&!e.isOpen()&&(e.open(e.map),t.target instanceof HTMLElement&&t.target.focus())}),r.addEventListener("focusout",function(t){i&&t.relatedTarget instanceof Node&&!r.contains(t.relatedTarget)&&(i=!1,e.isOpen()&&e.close())}),r},Bs.prototype._createContentDiv=function(t){var e=document.createElement("div");return e.classList.add(Bs.Css.content),e.style.backgroundColor=t.fillColor,e.setAttribute("role","dialog"),e.setAttribute("aria-label","Map Information Window"),e.setAttribute("tabindex","0"),this.htmlContent=this._createHtmlContent(t),e.appendChild(this.htmlContent),e},Bs.prototype._createArrowDiv=function(){var t=document.createElement("div");return t.classList.add(Bs.Css.arrow),t},Bs.prototype._createCloseButton=function(){var t=document.createElement("button");return t.addEventListener("click",this.close),t.classList.add(Bs.Css.close),t.setAttribute("aria-label","close"),t.setAttribute("title","close"),t.setAttribute("tabindex","0"),t.innerHTML="&times;",t},Bs.prototype._createHtmlContent=function(t){var e=Ts.convertHtmlString(t.content);return t.draggable&&this._setDraggable(e,t.draggable),e},Bs.prototype._createMarker=function(t,e){var r=this.marker?this.marker.getLngLat():t.position;return"none"===t.anchor?(this.autoAnchor=e||"bottom",this.containerDiv.classList.add(this.autoAnchor),new i({anchor:this.autoAnchor,element:this.containerDiv,offset:t.pixelOffset}).setLngLat(r)):(this.containerDiv.classList.add(t.anchor),new i({anchor:t.anchor,element:this.containerDiv,offset:t.pixelOffset}).setLngLat(r))},Bs.prototype._getAutoAnchor=function(t,e){var r,i,n=this.containerDiv.offsetWidth,o=this.containerDiv.offsetHeight;if(this.marker){var a=t._getMap().project(this.marker.getLngLat());r=a.x,i=a.y}else{var s=t.positionsToPixels([e.position])[0];r=s[0],i=s[1]}var l=[];return i<o?l.push("top"):i>t.getCanvas().offsetHeight-o&&l.push("bottom"),r<n/2?l.push("left"):r>t.getCanvas().offsetWidth-n/2&&l.push("right"),0<l.length?l.join("-"):"bottom"},Bs.prototype._replaceMarker=function(t,e,r){var i=this.containerDiv.nextElementSibling;this.marker.remove(),this.containerDiv.classList.remove(this.autoAnchor||this.options.anchor),this.marker=this._createMarker(e,r),this.marker.addTo(t._getMap()),t.popups._getCollectionDiv().insertBefore(this.containerDiv,i||null)},Bs.prototype._setDraggable=function(t,e){e?(t.addEventListener("mousedown",this._onDown),t.addEventListener("touchstart",this._onDown),t.addEventListener("dragstart",this._onDragStart)):(t.removeEventListener("mousedown",this._onDown),t.removeEventListener("touchstart",this._onDown),t.removeEventListener("dragstart",this._onDragStart))},Bs.Css={arrow:"popup-arrow",close:"popup-close",container:"popup-container",content:"popup-content-container",hidden:"hidden-accessible-element"},Bs);function Bs(t){var r=zs.call(this)||this;return r.attach=function(t){r.map!==t&&(r.map&&r.remove(),r.map=t,r.marker=r._createMarker(r.options),r.marker.addTo(r.map._getMap()),r.map.popups._getCollectionDiv().appendChild(r.containerDiv),r.map.popups.add(r))},r.open=function(t){if(!t&&!r.map)throw new Error("Must specify a map to open on or attach to a map in advance");r.attach(t||r.map),r.containerDiv.classList.remove(Bs.Css.hidden),r.map.events.add("move",r._onMove),r._onMove(),r._invokeEvent("open",{target:r,type:"open"})},r.close=function(){r.map&&r.map.events.remove("move",r._onMove),r.containerDiv.classList.add(Bs.Css.hidden),r._invokeEvent("close",{target:r,type:"close"})},r.remove=function(){r.map&&(r.marker.remove(),r.containerDiv.classList.remove(r.autoAnchor||r.options.anchor),r.map.events.remove("move",r._onMove),r.map.popups.remove(r),delete r.map,delete r.marker,delete r.autoAnchor)},r.isOpen=function(){return r.map&&!r.containerDiv.classList.contains(Bs.Css.hidden)},r._onMove=function(){var t=r._getAutoAnchor(r.map,r.options);t!==r.autoAnchor&&(r._replaceMarker(r.map,r.options,t),r.map.events.add("move",r._onMove))},r._onDown=function(t){r.map.popups._addDraggedPopup(r);var e=r.map.positionsToPixels([r.options.position])[0];"mousedown"===t.type?(t=t,r.dragOffset=[e[0]-t.clientX,e[1]-t.clientY]):"touchstart"===t.type&&(t=t,r.dragOffset=[e[0]-t.touches[0].clientX,e[1]-t.touches[0].clientY])},r._onDragStart=function(t){t.preventDefault()},r.options=(new Ds).merge(Xo(t,Ds._cloneCustomizer)),r.containerDiv=r._createContainerDiv(r.options),r.contentDiv=r._createContentDiv(r.options),r.containerDiv.appendChild(r.contentDiv),r.options.showPointer&&(r.arrowDiv=r._createArrowDiv(),r.containerDiv.appendChild(r.arrowDiv)),r.options.closeButton&&(r.closeBtn=r._createCloseButton(),r.contentDiv.appendChild(r.closeBtn)),r}var Fs,Us=(b(js,Fs=E),js._cloneCustomizer=function(t){if(t instanceof Ns||Os(t))return t},js);function js(){var t=null!==Fs&&Fs.apply(this,arguments)||this;return t.anchor="bottom",t.color="#1A73AA",t.draggable=!1,t.htmlContent='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24.5 36.5" id="marker_'+un()+'" width="24.5" height="36.5" display="block"><path d="M12.25.25a12.2543,12.2543,0,0,0-12,12.4937c0,6.4436,6.4879,12.1093,11.059,22.5641.5493,1.2563,1.3327,1.2563,1.882,0C17.7621,24.8529,24.25,19.1857,24.25,12.7437A12.2543,12.2543,0,0,0,12.25.25Z"   fill="{color}" stroke="{secondaryColor}" stroke-width="0.5"/><text style="font-family: Arial, Helvetica, sans-serif; font-size: 14px; fill: white;" text-anchor="middle" x="12" y="18">{text}</text></svg>',t.pixelOffset=new dn(0,0),t.position=new _o(0,0),t.popup=void 0,t.secondaryColor="white",t.text=void 0,t.visible=!0,t}var qs,Vs=(b(Gs,qs=So),Gs.prototype.getOptions=function(){return Xo(this.options,Us._cloneCustomizer)},Gs.prototype.setOptions=function(t){var e=(new Us).merge(this.options,Xo(t,Us._cloneCustomizer));sn(e.htmlContent,this.options.htmlContent)&&e.anchor===this.options.anchor?("string"!=typeof e.htmlContent||e.color===this.options.color&&e.text===this.options.text&&e.secondaryColor===this.options.secondaryColor||(this.element.innerHTML=this._getSubbedHtmlString(e)),e.draggable!==this.options.draggable&&(this._setDraggable(e.draggable),this.marker.setDraggable(e.draggable)),sn(e.pixelOffset,this.options.pixelOffset)||this.marker.setOffset(e.pixelOffset),sn(e.position,this.options.position)||this.marker.setLngLat(e.position),e.visible!==this.options.visible&&(e.visible?this.element.classList.remove(Gs.hiddenClass):this.element.classList.add(Gs.hiddenClass))):(this.marker.remove(),this._buildMarker(e),this.map&&(this.marker.addTo(this.map._getMap()),this._getCollectionContainer().appendChild(this.element))),this.options=e},Gs.prototype.togglePopup=function(){if(this.options.popup)if(this.options.popup.isOpen())this.options.popup.close();else{if(!this.map)throw new Error("The marker must be added to a map before calling togglePopup().");this.options.popup.setOptions({position:this.options.position}),this.options.popup.open(this.map)}},Gs.prototype._addToMap=function(t,e){this.map&&this.map!==t&&this._removeFromMap(),e&&(this.options.position=Ii(e),this.marker.setLngLat(this.options.position)),this.map!==t&&(this.map=t,this.marker.addTo(t._getMap()),this._getCollectionContainer().appendChild(this.element))},Gs.prototype._removeFromMap=function(){this.map&&(this.marker.remove(),delete this.map)},Gs.prototype._getId=function(){if(this.element)return"string"==typeof this.options.htmlContent?this.element.firstChild.id:this.element.id},Gs.prototype._buildMarker=function(t){if("string"==typeof t.htmlContent){var e=this._getSubbedHtmlString(t);this.element=Ts.convertHtmlString(e)}else this.element=t.htmlContent;this.element.classList.add(Gs.containerClass),t.draggable&&this._setDraggable(!0),t.visible||this.element.classList.add(Gs.hiddenClass),this.marker=new i({element:this.element,offset:t.pixelOffset,draggable:t.draggable,anchor:t.anchor}).setLngLat(t.position),this.marker.on("drag",this._onDrag),this.marker.on("dragstart",this._onDragStart),this.marker.on("dragend",this._onDragEnd),this.element.addEventListener("click",this._bubbleElementEvent),this.element.addEventListener("dblclick",this._bubbleElementEvent),this.element.addEventListener("contextmenu",this._bubbleElementEvent),this.element.addEventListener("keydown",this._bubbleElementEvent),this.element.addEventListener("keypress",this._bubbleElementEvent),this.element.addEventListener("keyup",this._bubbleElementEvent),this.element.addEventListener("mousedown",this._bubbleElementEvent),this.element.addEventListener("mouseenter",this._bubbleElementEvent),this.element.addEventListener("mouseleave",this._bubbleElementEvent),this.element.addEventListener("mousemove",this._bubbleElementEvent),this.element.addEventListener("mouseout",this._bubbleElementEvent),this.element.addEventListener("mouseover",this._bubbleElementEvent),this.element.addEventListener("mouseup",this._bubbleElementEvent)},Gs.prototype._getSubbedHtmlString=function(t){if("string"==typeof t.htmlContent)return t.htmlContent.replace(/{color}/gi,t.color||"").replace(/{secondaryColor}/gi,t.secondaryColor||"").replace(/{text}/gi,t.text||"")},Gs.prototype._getCollectionContainer=function(){var t=this.map.getCanvasContainer().querySelector("."+Gs.collectionContainerClass);return t||((t=document.createElement("div")).classList.add(Gs.collectionContainerClass),this.map.getCanvasContainer().appendChild(t)),t},Gs.prototype._setDraggable=function(t){t?this.element.addEventListener("dragstart",this._onEleDragStart):this.element.removeEventListener("dragstart",this._onEleDragStart)},Gs.collectionContainerClass="marker-collection-container",Gs.hiddenClass="hidden-accessible-element",Gs.containerClass="marker-container",Gs);function Gs(t){var e=qs.call(this)||this;return e._onDrag=function(){var t=e.marker.getLngLat().wrap();e.options.position=new _o(t.lng,t.lat),e._invokeEvent("drag",{type:"drag",target:e})},e._onDragStart=function(){e._invokeEvent("dragstart",{type:"dragstart",target:e})},e._onDragEnd=function(){e._invokeEvent("dragend",{type:"dragend",target:e})},e._bubbleElementEvent=function(t){e._invokeEvent(t.type,{type:t.type,target:e})},e._onEleDragStart=function(t){t.preventDefault()},e.options=(new Us).merge(Xo(t,Us._cloneCustomizer)),e._buildMarker(e.options),e}var Zs=function(t,e,r){(void 0===r||_t(t[e],r))&&(void 0!==r||e in t)||Le(t,e,r)};var Hs=function(l){return function(t,e,r){for(var i=-1,n=Object(t),o=r(t),a=o.length;a--;){var s=o[l?a:++i];if(!1===e(n[s],s,n))break}return t}}();var Ws=function(t){return Ne(t)&&ur(t)};var Ks=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]};var Xs=function(t){return Re(t,mr(t))};var Ys=function(t,e,r,i,n,o,a){var s=Ks(t,r),l=Ks(e,r),u=a.get(l);if(u)Zs(t,r,u);else{var c=o?o(s,l,r+"",t,e,a):void 0,p=void 0===c;if(p){var h=Ve(l),d=!h&&Ze(l),f=!h&&!d&&tr(l);c=l,h||d||f?c=Ve(s)?s:Ws(s)?vr(s):d?yr(l,!(p=!1)):f?ni(l,!(p=!1)):[]:Ms(l)||qe(l)?qe(c=s)?c=Xs(s):Zt(s)&&!Wt(s)||(c=ui(l)):p=!1}p&&(a.set(l,c),n(c,l,i,o,a),a.delete(l)),Zs(t,r,c)}};var Js=function i(n,o,a,s,l){n!==o&&Hs(o,function(t,e){if(l=l||new Ae,Zt(t))Ys(n,o,e,a,i,s,l);else{var r=s?s(Ks(n,e),t,e+"",n,o,l):void 0;void 0===r&&(r=t),Zs(n,e,r)}},mr)};function Qs(t){return t}var $s=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)},tl=Math.max;var el=function(o,a,s){return a=tl(void 0===a?o.length-1:a,0),function(){for(var t=arguments,e=-1,r=tl(t.length-a,0),i=Array(r);++e<r;)i[e]=t[a+e];e=-1;for(var n=Array(a+1);++e<a;)n[e]=t[e];return n[a]=s(i),$s(o,this,n)}};var rl=function(t){return function(){return t}},il=Me?function(t,e){return Me(t,"toString",{configurable:!0,enumerable:!1,value:rl(e),writable:!0})}:Qs,nl=Date.now;var ol=function(r){var i=0,n=0;return function(){var t=nl(),e=16-(t-n);if(n=t,0<e){if(800<=++i)return arguments[0]}else i=0;return r.apply(void 0,arguments)}}(il);var al=function(t,e){return ol(el(t,e,Qs),t+"")};var sl=function(t,e,r){if(!Zt(r))return!1;var i=typeof e;return!!("number"==i?ur(r)&&We(e,r.length):"string"==i&&e in r)&&_t(r[e],t)};var ll=function(s){return al(function(t,e){var r=-1,i=e.length,n=1<i?e[i-1]:void 0,o=2<i?e[2]:void 0;for(n=3<s.length&&"function"==typeof n?(i--,n):void 0,o&&sl(e[0],e[1],o)&&(n=i<3?void 0:n,i=1),t=Object(t);++r<i;){var a=e[r];a&&s(t,a,r,n)}return t})}(function(t,e,r){Js(t,e,r)}),ul=(cl.parse=function(t){var e=(t=t.toLowerCase()).lastIndexOf("-");return-1!==e?{code:t,language:t.substring(0,e),region:t.substring(e+1)}:{code:t,language:t}},cl);function cl(){}var pl={localizationsPath:"locs/mapcontrol/2019-3-12",sensitiveUserRegions:["il","kr","pk","in","cn","ar","bh","eg","jo","sa","kw","om","qa","ma","ae"],locales:{defaultLanguage:{defaultRegion:{code:"NGT",strings:"en/resource.json"}},ar:{defaultRegion:{code:"ar",strings:"ar-SA/resource.json"}},bg:{defaultRegion:{code:"bg-BG",strings:"bg-BG/resource.json"}},cs:{defaultRegion:{code:"cs-CZ",strings:"cs-cz/resource.json"}},da:{defaultRegion:{code:"da-DK",strings:"da-DK/resource.json"}},de:{defaultRegion:{code:"de-DE",strings:"de-de/resource.json"}},el:{defaultRegion:{code:"el-GR",strings:"el-GR/resource.json"}},en:{defaultRegion:{code:"en",strings:"en/resource.json"},us:{code:"en-US",strings:"en/resource.json"}},es:{defaultRegion:{code:"es-ES",strings:"es-es/resource.json"},mx:{code:"es-MX",strings:"es-MX/resource.json"}},fi:{defaultRegion:{code:"fi-FI",strings:"fi-FI/resource.json"}},fr:{defaultRegion:{code:"fr-FR",strings:"fr-fr/resource.json"}},hu:{defaultRegion:{code:"hu-HU",strings:"hu-hu/resource.json"}},id:{defaultRegion:{code:"id-ID",strings:"id-ID/resource.json"}},it:{defaultRegion:{code:"it-IT",strings:"it-it/resource.json"}},ko:{defaultRegion:{code:"ko-KR",strings:"ko-kr/resource.json"}},lt:{defaultRegion:{code:"lt-LT",strings:"lt-LT/resource.json"}},ms:{defaultRegion:{code:"ms-MY",strings:"ms-MY/resource.json"}},nb:{defaultRegion:{code:"nb-NO",strings:"nb-NO/resource.json"}},nl:{defaultRegion:{code:"nl-NL",strings:"nl-nl/resource.json"}},pl:{defaultRegion:{code:"pl-PL",strings:"pl-pl/resource.json"}},pt:{defaultRegion:{code:"pt-PT",strings:"pt-pt/resource.json"},br:{code:"pt-BR",strings:"pt-br/resource.json"}},ru:{defaultRegion:{code:"ru-RU",strings:"ru-ru/resource.json"}},sk:{defaultRegion:{code:"sk-SK",strings:"sk-SK/resource.json"}},sl:{defaultRegion:{code:"sl-SL",strings:"sl-SL/resource.json"}},sv:{defaultRegion:{code:"sv-SE",strings:"sv-se/resource.json"}},th:{defaultRegion:{code:"th-TH",strings:"th-TH/resource.json"}},tr:{defaultRegion:{code:"tr-TR",strings:"tr-tr/resource.json"}},zh:{defaultRegion:{code:"zh-Hant",strings:"zh-tw/resource.json"}},"zh-hant":{defaultRegion:{code:"zh-Hant",strings:"zh-tw/resource.json"}}}},hl=function(){this.Unknown="Unknown",this.Accident="Accident",this.Fog="Fog",this.Danger="Danger",this.Rain="Rain",this.Ice="Ice",this.Jam="Jam",this.LaneClosed="Lane Closed",this.RoadClosed="Road Closed",this.RoadWorks="Road Works",this.Wind="Wind",this.Flood="Flood",this.Detour="Detour"},dl=(fl.getCode=function(t){var e=ul.parse(t);return-1===pl.sensitiveUserRegions.indexOf(e.region)?this.getLocaleData(e).code:t},fl.getStrings=function(t){var e=this.getLocaleData(t);return new P({domain:o,path:pl.localizationsPath+"/"+e.strings}).get().then(function(t){return t},function(){return new hl})},fl.getLocaleData=function(t){if("string"==typeof t&&(t=ul.parse(t)),pl.locales[t.code])return pl.locales[t.code].defaultRegion;var e;if(pl.locales[t.language])e=pl.locales[t.language];else{if(-1!==t.language.indexOf("-"))return this.getLocaleData(t.language);e=pl.locales.defaultLanguage}return t.region&&e[t.region]?e[t.region]:e.defaultRegion},fl);function fl(){}var ml,gl=(yl.getEdgeOrIEVersion=function(){var t=window.navigator.userAgent,e=t.indexOf("MSIE ");if(0<e)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);if(0<t.indexOf("Trident/")){var r=t.indexOf("rv:");return parseInt(t.substring(r+3,t.indexOf(".",r)),10)}var i=t.indexOf("Edge/");return 0<i?parseInt(t.substring(i+5,t.indexOf(".",i)),10):-1},yl.isEdgeOrIE=function(){return-1!==this.getEdgeOrIEVersion()},yl.isIE=function(){var t=this.getEdgeOrIEVersion();return-1!==t&&t<=11},yl);function yl(){}(ml=p.AuthenticationType||(p.AuthenticationType={})).subscriptionKey="subscriptionKey",ml.aad="aad",ml.anonymous="anonymous";var vl,_l,xl=(b(bl,vl=E),bl.prototype.setSubscriptionKey=function(t){this.authType=p.AuthenticationType.subscriptionKey,this.subscriptionKey=t},bl.prototype.setAadProperties=function(t,e,r,i,n){this.authType=p.AuthenticationType.aad,this.authContext=n||this.authContext,this.aadInstance=i||this.aadInstance,this.clientId=t,this.aadAppId=e,this.aadTenant=r},bl.prototype.setTokenCallbackFunction=function(t){this.authType=p.AuthenticationType.anonymous,this.getToken=t},bl.prototype.merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=vl.prototype.merge.apply(this,t);return r.authType===p.AuthenticationType.subscriptionKey?r.authContext=r.aadAppId=r.getToken=void 0:r.authType===p.AuthenticationType.aad?r.subscriptionKey=r.getToken=void 0:r.authType===p.AuthenticationType.anonymous&&(r.subscriptionKey=r.authContext=r.aadAppId=void 0),r},bl);function bl(){var t=null!==vl&&vl.apply(this,arguments)||this;return t.authType=void 0,t.subscriptionKey=void 0,t.clientId=void 0,t.aadAppId=void 0,t.aadTenant=void 0,t.aadInstance=void 0,t.getToken=void 0,t.authContext=void 0,t}var wl="NGT",Sl=un(),Tl=n,El=new xl,Il=!1,Cl=!1,kl=!1,Al=!1,Pl=!1;function Ml(){return Object.assign({},El)}function Ll(){return Tl}function Ol(){return wl}function Dl(){return Sl}function Rl(){return El.authType===p.AuthenticationType.subscriptionKey?El.subscriptionKey:void 0}function zl(){return _l}function Nl(t){return!gl.isIE()&&h.supported({failIfMajorPerformanceCaveat:t})}function Bl(t){El=(new xl).merge(El,t),Pl=!0}function Fl(t){Tl=t,Cl=!0}function Ul(t){wl=dl.getCode(t),kl=!0}function jl(t){Sl=t,Al=!0}function ql(t){El.setSubscriptionKey(t),Pl=!0}function Vl(t){_l=t,Il=!0}function Gl(t,e){if(e=Math.abs(e||1),"string"==typeof t&&ru[t.toLowerCase()]){for(var r=ru[t.toLowerCase()],i=/calc\(([0-9.]+)[px]*\s*\*\s*\{scale\}\)/gi,n=r,o=i.exec(r);o;)n=n.replace(o[0],parseFloat(o[1])*e+""),o=i.exec(r);return n=n.replace("{scale}",e+"")}throw new Error("Invalid templateName.")}function Zl(){return Pl}function Hl(){return Cl}function Wl(){return kl}function Kl(){return Al}function Xl(){return Il}var Yl,Jl,Ql,$l,tu,eu,ru={marker:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(27 * {scale})" height="calc(39 * {scale})" viewBox="-1 -1 26 38"><path d="M12.25.25a12.254 12.254 0 0 0-12 12.494c0 6.444 6.488 12.109 11.059 22.564.549 1.256 1.333 1.256 1.882 0C17.762 24.853 24.25 19.186 24.25 12.744A12.254 12.254 0 0 0 12.25.25Z" style="fill:{color};stroke:{secondaryColor};stroke-width:1"/><text x="12.5" y="17.5" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(39 * {scale})" viewBox="-1 -1 27 38"><path d="M12.25.25a12.254 12.254 0 0 0-12 12.494c0 6.444 6.488 12.109 11.059 22.564.549 1.256 1.333 1.256 1.882 0C17.762 24.853 24.25 19.186 24.25 12.744A12.254 12.254 0 0 0 12.25.25Z" style="fill:{color};stroke:{secondaryColor};stroke-width:2"/><text x="12.5" y="18.5" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-circle":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(39 * {scale})" viewBox="-1 -1 27 38"><path d="M12.25.25a12.254 12.254 0 0 0-12 12.494c0 6.444 6.488 12.109 11.059 22.564.549 1.256 1.333 1.256 1.882 0C17.762 24.853 24.25 19.186 24.25 12.744A12.254 12.254 0 0 0 12.25.25Z" style="fill:{color};stroke:{secondaryColor};stroke-width:1"/><circle cx="12.5" cy="12.5" r="9" fill="{secondaryColor}"/><text x="12" y="17.5" style="font-size:14px;fill:#000;text-anchor:middle">{text}</text></svg>',pin:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(24 * {scale})" height="calc(28 * {scale})" viewBox="0 0 24 28"><path d="m11.988 16.615a5.15 5.15 0 0 1-2.268-.525 4.909 4.909 0 0 1-2.805-4.442 5.019 5.019 0 0 1 5.072-4.936h.012a5.03 5.03 0 0 1 5.085 4.961 4.907 4.907 0 0 1-.549 2.224 5.114 5.114 0 0 1-4.548 2.718zm0-8.06a3.173 3.173 0 0 0-3.226 3.099 3.081 3.081 0 0 0 1.77 2.782 3.299 3.299 0 0 0 4.365-1.386 3.049 3.049 0 0 0 .342-1.381 3.184 3.184 0 0 0-3.239-3.114h-.012z" fill="{secondaryColor}"/><path d="m11.999.922a10.908 10.908 0 0 0-11.076 10.732 10.639 10.639 0 0 0 4.418 8.598l6.658 6.464 6.658-6.463a10.537 10.537 0 0 0 2.198-15.041 11.182 11.182 0 0 0-8.856-4.289zm1.873 14.341a4.221 4.221 0 0 1-5.589-1.789 3.945 3.945 0 0 1-.445-1.8 4.164 4.164 0 0 1 8.323-.037 4.028 4.028 0 0 1-2.289 3.626Z" fill="{color}"/><path d="m11.999 28-7.256-7.044a11.611 11.611 0 0 1-4.743-9.303 11.844 11.844 0 0 1 11.988-11.652.102 .102 0 0 1 .02 0 12.164 12.164 0 0 1 9.577 4.647 11.357 11.357 0 0 1 2.299 8.614 11.521 11.521 0 0 1-4.63 7.695zm-.01-26.157a9.997 9.997 0 0 0-10.143 9.812 9.769 9.769 0 0 0 4.04 7.853l.099.083 6.014 5.838 6.113-5.922a9.7 9.7 0 0 0 3.945-6.505 9.533 9.533 0 0 0-1.933-7.229 10.305 10.305 0 0 0-8.116-3.931h-.021zm.021 14.772a5.11 5.11 0 0 1-4.547-2.718 4.868 4.868 0 0 1 .932-5.743 5.118 5.118 0 0 1 3.58-1.46h.024a5.031 5.031 0 0 1 5.084 4.938 4.92 4.92 0 0 1-2.805 4.457h0a5.152 5.152 0 0 1-2.269.525zm-.011-8.079h-.015a3.277 3.277 0 0 0-2.295.933 3.029 3.029 0 0 0-.587 3.58 3.297 3.297 0 0 0 4.364 1.386h0a3.092 3.092 0 0 0 1.772-2.795 3.185 3.185 0 0 0-3.239-3.105z" fill="{secondaryColor}"/><text x="12" y="17" style="font-size:14px;fill:#000;text-anchor:middle">{text}</text></svg>',"pin-round":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(25 * {scale})" height="calc(25 * {scale})" viewBox="0 0 25 25"><g transform="translate(0 1)"><circle cx="12.25" cy="11.5833" r="11" fill="{color}"/><path d="m12.25 23.583a12 12 0 1 1 12-12 12 12 0 0 1-12 12zm0-22a10 10 0 1 0 10 10 10 10 0 0 0-10-10z" fill="{secondaryColor}"/><circle cx="12.25" cy="11.5833" r="4.2386" fill="{secondaryColor}"/></g><text x="12.5" y="17" style="font-size:14px;fill:#000;text-anchor:middle">{text}</text></svg>',"marker-flat":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(27 * {scale})" height="calc(42.8 * {scale})"  viewBox="0 0 1600 2570"><g fill="{color}"><path d="M691 2419c-409-575-641-1086-683-1504-10-106-10-136 5-224 31-188 105-330 241-458 129-124 270-190 453-214 69-9 113-10 182-1 373 46 655 326 703 698 40 308-120 801-424 1309-134 224-348 535-369 535-4 0-53-63-108-141z"/></g><g fill="rgba(0,0,0,0.15)" style="transform:scale(-1,1);transform-origin:center"><path d="M691 2419c-407-571-639-1083-682-1498-14-139-3-249 37-371 69-208 254-402 459-481 68-27 217-59 271-59h24v160 180 940 635c0 349-2 635-5 635-2 0-49-63-104-141z"/></g><circle cx="800" cy="800" r="600" fill="{secondaryColor}"/><text x="800" y="1100" style="font-size:800px;fill:#000;text-anchor:middle">{text}</text></svg>',"marker-arrow":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(25.47 * {scale})" height="calc(35.18 * {scale})" viewBox="0 0 4330 5980"><g fill="{color}"><path d="m2080 5969c-49-20-93-63-115-113-25-55-1928-5486-1953-5573-40-138 67-282 210-283 36 0 246 73 987 345 518 190 947 345 955 345 8 0 438-155 955-345 615-226 954-345 979-345 87 0 165 47 204 123 46 91 107-95-957 2942-537 1535-986 2805-997 2823-11 18-43 46-72 62-41 24-62 30-111 29-33 0-71-5-85-10z"/></g><g fill="{secondaryColor}"><path d="m2200 1600c-36 10-83 2-484-84-243-53-451-94-461-91-11 4-22 18-25 31-5 19 114 371 436 1292 244 697 448 1273 454 1281 19 24 50 30 71 12z"/><path d="m2200 1600c-36 10-83 2-484-84-243-53-451-94-461-91-11 4-22 18-25 31-5 19 114 371 436 1292 244 697 448 1273 454 1281 19 24 50 30 71 12z" style="transform:scale(-1,1);transform-origin:center"/></g><g fill="rgba(0,0,0,0.2)" ><path d="m2165 685c8 0 438-155 955-345 615-226 954-345 979-345 87 0 165 47 204 123 46 91 107-95-957 2942-537 1535-986 2805-997 2823-11 18-43 46-72 62-41 24-62 30-111 29z"/></g><text x="2165" y="3300" style="font-size:2500px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-ball-pin":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(15.67 * {scale})" height="calc(33.33 * {scale})" viewBox="0 0 235 452"><g transform="translate(-135 10)"><path fill="{secondaryColor}" d="m256 442 0 0c-13 0-18-11-18-24l-6-323c0-13 11-24 24-24h0c13 0 24 11 24 24l-6 323c0 13-5 24-18 24z"/><circle style="fill:{color};stroke-width:10;stroke:{secondaryColor}" cx="256" cy="112" r="111"/><ellipse transform="matrix(0.834 0.5518 -0.5518 0.834 65.7916 -97.18)" fill="rgba(255,255,255,0.3)" cx="194.399" cy="60.749" rx="19.076" ry="32.428"/></g><text x="117.5" y="160" style="font-size:160px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(26.67 * {scale})" height="calc(32.27 * {scale})" viewBox="0 0 2000 2420"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="M845 2152c-22-37-58-95-80-129-22-35-62-99-90-143l-50-80-312 0-313 0 0-900 0-900 900 0 900 0 0 900 0 900-313 0-313 0-34 58c-19 31-38 59-42 60-5 2-8 8-8 12 0 9-69 123-88 145-5 6-11 15-13 21-16 39-77 123-89 124-8 0-33-31-55-68z"/></g><text x="1000" y="1300" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square-cluster":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(33.33 * {scale})" height="calc(38.8 * {scale})" viewBox="0 0 2500 2910"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="m866 2652c-17-31-37-68-46-82-9-14-32-54-51-90-19-36-50-92-70-125l-36-60-332-3-331-2 0-905 0-905 660 0 660 0 0-38c0-71 50-196 102-258 71-85 189-164 244-164 12 0 26-4 29-10 8-13 222-13 230 0 3 6 17 10 30 10 25 0 117 45 154 76 130 107 191 232 191 392 0 155-63 284-190 386-36 29-129 76-150 76-11 0-22 5-25 10-3 6-31 10-61 10l-54 0 0 660 0 660-332 2-332 3-29 50c-17 28-48 84-70 125-22 41-47 86-56 100-9 14-30 51-46 83-17 32-36 57-45 57-8 0-28-25-44-58z"/></g><text x="1650" y="900" style="font-size:1000px;fill:#fff">+</text><text x="1000" y="1800" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square-rounded":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(26.8 * {scale})" height="calc(32.27 * {scale})" viewBox="0 0 2010 2410"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="M856 2155c-20-30-36-59-36-65 0-5-4-10-10-10-5 0-10-5-10-11 0-5-18-37-40-69-22-32-40-64-40-69 0-6-4-11-10-11-5 0-10-5-10-10 0-6-15-33-32-60l-33-50-127 0c-74 0-129-4-133-10-3-5-17-10-30-10-25 0-116-45-155-76-87-69-142-151-178-265-15-46-17-1075-2-1084 5-3 10-17 10-30 0-13 5-27 10-30 6-3 10-13 10-22 0-22 83-135 122-168 57-46 62-50 112-75l50-25 585 0 586 0 63 34c84 46 169 133 212 218l35 68 0 565 0 565-28 59c-32 69-100 157-139 180-15 9-33 22-40 29-23 22-99 57-123 57-13 0-27 5-30 10-4 6-60 10-135 10l-128 0-128 205c-84 136-133 205-144 205-10 0-33-24-54-55z"/></g><text x="1000" y="1300" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square-rounded-cluster":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(33.33 * {scale})" height="calc(32.13 * {scale})" viewBox="0 0 2500 2900"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="m874 2669c-9-18-26-49-37-68-11-20-30-55-43-78-13-24-36-64-51-90-14-27-38-69-52-95l-26-48-142 0c-84 0-144-4-148-10-3-5-17-10-30-10-25 0-118-46-154-76-91-76-136-142-175-254-13-38-16-119-16-554 0-358 3-520 12-545 40-125 106-219 195-278 127-84 116-83 646-83l467 0 0-42c0-46 11-87 45-163 54-121 169-220 306-264 46-14 232-14 278 0 165 53 284 175 340 350 19 61 14 204-10 273-32 91-94 178-169 240-38 31-130 76-155 76-13 0-27 5-30 10-3 6-28 10-56 10l-49 0 0 462c0 446-1 464-21 522-32 91-94 178-169 240-38 31-130 76-155 76-13 0-27 5-30 10-4 6-65 10-149 10-138 0-143 1-154 23-12 23-62 114-112 202-16 28-44 79-63 115-42 77-67 88-93 39z"/></g><text x="1650" y="900" style="font-size:1000px;fill:#fff">+</text><text x="1000" y="1800" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',flag:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(23.5 * {scale})" height="calc(40 * {scale})" viewBox="34 28 198 308"><path style="stroke:{secondaryColor};stroke-width:15;stroke-linecap:round;" d="M42 327l0 -291"/><path style="fill:{color};stroke:{secondaryColor};stroke-width:10;stroke-linejoin:round;" d="M49 50c70 30 104 28 178 2-21 42-21 74 0 116-72 25-101 25-178 0l0-118z"/><text x="130" y="165" style="font-size:100px;fill:#fff;text-anchor:middle">{text}</text></svg>',"flag-triangle":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(27 * {scale})" height="calc(35.33 * {scale})" viewBox="0 0 40.5 53"><g transform="translate(-31 -20)"><path fill="{secondaryColor}" d="M34.7,73.3V48.4l34.6-10.1c0.7-0.2,1.2-0.8,1.2-1.5s-0.4-1.4-1-1.7L33.7,20.5c-0.5-0.2-1.1-0.2-1.6,0.2 c-0.5,0.3-0.7,0.8-0.7,1.4v51.2H34.7z"/><polygon points="34.7,24.5 66,36.5 34.7,45 34.7,10" fill="{color}"/></g><text x="11" y="21" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"rounded-square":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(34 * {scale})" height="calc(34 * {scale})" viewBox="0 0 34 34"><g transform="translate(2 2)"><rect x="0" y="0" rx="8" ry="8" width="30" height="30" style="stroke:{secondaryColor};stroke-width:2;fill:{color}"/></g><text x="17" y="22" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"rounded-square-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(38 * {scale})" height="calc(38 * {scale})" viewBox="0 0 38 38"><g transform="translate(4 4)"><rect x="0" y="0" rx="8" ry="8" width="30" height="30" style="stroke:{secondaryColor};stroke-width:4;fill:{color}"/></g><text x="19" y="24" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',triangle:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(36 * {scale})" height="calc(36 * {scale})" viewBox="0 0 36 36"><g transform="translate(2 2)"><polygon points="16,0 32,32 0,32 16,0" style="stroke:{secondaryColor};stroke-width:2;fill:{color}"/></g><text x="17.5" y="30" style="font-size:12px;fill:#fff;text-anchor:middle">{text}</text></svg>',"triangle-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 40 40"><g transform="translate(4 4)"><polygon points="16,0 32,32 0,32 16,0" style="stroke:{secondaryColor};stroke-width:4;fill:{color}"/></g><text x="19.5" y="32" style="font-size:12px;fill:#fff;text-anchor:middle">{text}</text></svg>',hexagon:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(35 * {scale})" height="calc(40 * {scale})" viewBox="0 0 35 40"><g transform="translate(2 2)"><path d="M31 9 15.5 0 0 9 0 27 15.5 36 31 27 31 9Z" style="stroke:{secondaryColor};stroke-width:2;fill:{color}"/></g><text x="17.5" y="25" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"hexagon-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(39 * {scale})" height="calc(44 * {scale})" viewBox="0 0 39 44"><g transform="translate(4 4)"><path d="M31 9 15.5 0 0 9 0 27 15.5 36 31 27 31 9Z" style="stroke:{secondaryColor};stroke-width:4;fill:{color}"/></g><text x="19.5" y="27" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"hexagon-rounded":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 1100 1100"><g transform="translate(50 50)"><path style="stroke:{secondaryColor};stroke-width:50;fill:{color}" d="M881 210 561 25c-33-19-88-19-121 0L119 210c-33 19-61 67-61 105v370c0 39 27 86 61 105l321 185c33 19 88 19 122 0l321-185c33-19 61-67 61-105V315C942 276 915 229 881 210z"/></g><text x="550" y="700" style="font-size:400px;fill:#fff;text-anchor:middle">{text}</text></svg>',"hexagon-rounded-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 1200 1200"><g transform="translate(100 100)"><path style="stroke:{secondaryColor};stroke-width:100;fill:{color}" d="M881 210 561 25c-33-19-88-19-121 0L119 210c-33 19-61 67-61 105v370c0 39 27 86 61 105l321 185c33 19 88 19 122 0l321-185c33-19 61-67 61-105V315C942 276 915 229 881 210z"/></g><text x="600" y="750" style="font-size:400px;fill:#fff;text-anchor:middle">{text}</text></svg>',"triangle-arrow-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(28 * {scale})" viewBox="0 0 28 28"><g transform="translate(2 2)"><polygon points="12,0 0,24 12,17 24,24" stroke-width="2" stroke="{secondaryColor}" fill="{color}"/></g><text x="14" y="17" style="font-size:8px;fill:#fff;text-anchor:middle">{text}</text></svg>',"triangle-arrow-left":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(28 * {scale})" viewBox="0 0 28 28"><g transform="translate(2 2)"><polygon points="24,12 0,0 7,12 0,24" stroke-width="2" stroke="{secondaryColor}" fill="{color}"/></g><text x="14" y="16.5" style="font-size:8px;fill:#fff;text-anchor:middle">{text}</text></svg>',"arrow-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(12.16 * {scale})" height="calc(30.1 * {scale})" viewBox="0 0 902 364"><g fill="{color}" transform="matrix(0,2.4,-2.4,0,897,-930)"><polygon points="902,222 233,222 233,364 0,182 233,0 233,141 902,141 902,222"/></g><text x="450" y="700" style="font-size:900px;fill:#000;text-anchor:middle">{text}</text></svg>',"arrow-up-thin":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(16 * {scale})" height="calc(33.33 * {scale})" viewBox="0 0 12 25"><g transform="translate(-136.91823 -751.91998)"><path fill="{color}" d="m148.271 760.71c-1.641-.547-3.186-1.47-4.633-2.769l0 18.07-1.675 0 0-18.07c-1.447 1.299-2.986 2.222-4.616 2.769l0-1.231c2.325-1.596 4.006-3.812 5.043-6.65l.838 0c1.037 2.838 2.718 5.055 5.043 6.65l0 1.231z"/></g><text x="6" y="20" style="font-size:10px;fill:#000;text-anchor:middle">{text}</text></svg>',car:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(21.93 * {scale})" height="calc(40.9 * {scale})" viewBox="0 0 6580 12270"><g transform="translate(0 12270) rotate(-90)"><path fill="{secondaryColor}" d="M7045 6566c-42-13-105-44-105-51 0-2 23-105 50-228 28-123 50-230 50-236 0-8-241-11-907-11-855 0-1145 6-1513 30-85 6-189 13-230 15-41 3-133 10-205 15-286 21-430 32-705 50-953 63-1459 18-2335-205-304-77-746-209-799-238-131-72-221-408-285-1062-34-345-42-532-48-1130-16-1557 108-2532 336-2649 32-17 469-149 676-205 409-110 819-191 1205-238 116-14 224-18 540-18 395 1 494 5 1140 50 1124 79 1224 82 2496 78l641-3-53-237c-29-131-52-238-51-239 1-1 31-14 66-29 56-23 76-26 142-23 67 3 83 7 120 33 23 17 50 41 61 55 10 14 51 117 91 230l73 205 674 3 675 2 90-39c98-43 198-72 315-93 122-21 829-18 990 5 321 45 626 143 849 270 293 168 516 378 704 662 266 402 416 893 467 1527 15 174 8 882-9 998-6 41-18 127-27 190-69 502-253 969-523 1325-79 105-262 284-381 374-189 142-355 229-574 300-336 110-526 139-952 148-457 9-685-23-887-124l-47-24-678-6-678-6-64 179c-79 224-92 253-121 284-67 70-177 97-274 66zm-2752-5073c-23-2-64-2-90 0-26 2-7 3 42 3 50 0 71-1 48-3zm395 0c-21-2-55-2-75 0-21 2-4 4 37 4 41 0 58-2 38-4z"/><path fill="{color}" d="M7043 6498c-13-6-23-19-23-28 0-9 23-117 50-240 28-123 50-230 50-237 0-22-2126-13-2465 10-132 10-400 28-595 42-661 47-824 55-1160 62-435 7-656-8-1040-73-415-70-865-183-1447-365-168-53-272-556-325-1569-16-319-16-1311 0-1630 45-872 129-1366 257-1518 22-26 51-39 172-77 557-177 1122-310 1563-369 271-36 351-40 690-40 361 1 463 6 1165 54 1122 78 1288 83 2337 79 460-2 840-7 843-11 4-4-17-117-47-252l-55-245 39-16c76-30 180-8 224 47 10 13 54 124 98 246l79 222 709 0 709 0 47-24c74-37 219-83 322-101 122-22 606-32 802-16 374 29 658 102 933 238 124 62 271 155 361 230l61 51 6 100c19 278 103 497 247 643 88 89 173 136 278 152l70 11 41 131c116 369 159 673 168 1170 10 584-38 984-167 1397l-40 126-70 12c-193 33-348 175-441 405-56 139-89 302-89 445 0 43-3 47-58 91-290 235-644 384-1068 450-191 29-796 39-974 16-135-18-263-54-368-102l-75-35-701 0-701 0-79 223c-82 232-102 267-163 293-38 16-138 17-170 2zm-2023-820c332-15 1155-12 1835 6 308 8 563 12 566 8 4-4 10-21 13-38 7-30 6-31-92-77-518-244-1197-396-2112-474-295-25-1282-25-1579 0-231 20-473 46-479 51-6 7 49 110 93 171 160 226 416 335 855 365 142 10 539 5 900-12zm3304-263c525-111 899-887 934-1935 19-557-37-1023-172-1435-186-563-521-900-896-899-81 0-158 14-525 92-426 91-431 92-540 146-195 96-287 207-306 368-12 104-11 2985 1 3078 22 170 135 291 365 389 49 21 191 55 480 115 226 47 419 87 430 89 45 10 164 6 229-8zm-5570-485c112-43 197-156 216-291 12-83 13-2623 1-2706-23-158-125-273-270-304-44-9-100-1-542 75-272 47-514 91-539 98-266 68-487 424-594 958-56 280-70 548-40 800 56 484 207 878 414 1081 115 114 122 116 702 218 277 49 524 90 550 90 26 1 72-8 102-19zm2111-3440c1023-44 1884-213 2462-486l113-53-7-33c-3-18-8-35-10-37-2-3-236 1-521 7-993 24-1271 26-1708 11-541-18-1128-18-1249-1-377 56-588 181-734 437-32 55-41 79-32 84 12 8 246 32 491 51 356 28 815 36 1195 20z"/></g><text x="3250" y="8250" style="font-size:3000px;fill:#fff;text-anchor:middle">{text}</text></svg>',checker:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(16 * {scale})" height="calc(16 * {scale})" viewBox="0 0 16 16"><pattern id="p" x="0" y="0" width="16" height="16" patternUnits="userSpaceOnUse"><rect fill="{color}" x="0" width="8" height="8" y="0"/><rect fill="{color}" x="8" width="8" height="8" y="8"/></pattern><rect x="0" y="0" width="16" height="16" fill="{secondaryColor}"/><rect x="0" y="0" width="16" height="16" fill="url(#p)"/></svg>',"checker-rotated":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(16 * {scale})" height="calc(16 * {scale})" viewBox="0 0 60 60"><rect width="60" height="60" fill="{secondaryColor}"/><rect width="42.42" height="42.42" transform="translate(30 0) rotate(45)" fill="{color}"/></svg>',"zig-zag":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(15 * {scale})" height="calc(15 * {scale})" viewBox="0 0 120 120"><rect x="0" y="0" width="120" height="120" fill="{secondaryColor}"/><polygon fill="{color}" points="120 120 60 120 90 90 120 60 120 0 120 0 60 60 0 0 0 60 30 90 60 120 120 120"/></svg>',"zig-zag-vertical":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(15 * {scale})" height="calc(15 * {scale})" viewBox="0 0 120 120"><rect x="0" y="0" width="120" height="120" fill="{secondaryColor}"/><polygon fill="{color}" points="120 0 120 60 90 30 60 0 0 0 0 0 60 60 0 120 60 120 90 90 120 60 120 0"/></svg>',"circles-spaced":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 20 20"><defs><pattern id="p" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="2" stroke="none" fill="{color}"/></pattern></defs><rect x="0" y="0" width="20" height="20" fill="{secondaryColor}"/><rect x="0" y="0" width="100" height="100" fill="url(#p)"/></svg>',circles:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(7 * {scale})" height="calc(7 * {scale})" viewBox="0 0 20 20"><defs><pattern id="p" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="6" stroke="none" fill="{color}"/></pattern></defs><rect x="0" y="0" width="20" height="20" fill="{secondaryColor}"/><rect x="0" y="0" width="100" height="100" fill="url(#p)"/></svg>',"diagonal-lines-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(18 * {scale})" height="calc(18 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"diagonal-lines-down":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(18 * {scale})" height="calc(18 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g transform="rotate(90 3 3)" fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"diagonal-stripes-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="40" height="40" fill="{secondaryColor}"/><g fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g></svg>',"diagonal-stripes-down":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="40" height="40" fill="{secondaryColor}"/><g transform="rotate(90 20 20)" fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g></svg>',"grid-lines":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(14 * {scale})" height="calc(14 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g transform="rotate(45 3 3)" fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g><g fill="{color}" transform="rotate(-45 3 3)"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"rotated-grid-lines":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(18 * {scale})" height="calc(18 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g transform="rotate(90 3 3)" fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g><g fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"rotated-grid-stripes":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="40" height="40" fill="{secondaryColor}"/><g transform="rotate(90 20 20)" fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g><g fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g></svg>',"x-fill":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="45.3" height="45.3" fill="{secondaryColor}"/><g fill="{color}"><path d="M0 38.59l2.83-2.83 1.41 1.41L1.41 40H0v-1.41zM0 1.4l2.83 2.83 1.41-1.41L1.41 0H0v1.41zM38.59 40l-2.83-2.83 1.41-1.41L40 38.59V40h-1.41zM40 1.41l-2.83 2.83-1.41-1.41L38.59 0H40v1.41zM20 18.6l2.83-2.83 1.41 1.41L21.41 20l2.83 2.83-1.41 1.41L20 21.41l-2.83 2.83-1.41-1.41L18.59 20l-2.83-2.83 1.41-1.41L20 18.59z"/></g></svg>',dots:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(13 * {scale})" height="calc(13 * {scale})" viewBox="0 0 20 20"><rect x="0" y="0" width="20" height="20" fill="{secondaryColor}"/><g fill="{color}"><circle cx="3" cy="3" r="3"/><circle cx="13" cy="13" r="3"/></g></svg>'};(Jl=Yl=Yl||{})[Jl.LocalStorage=0]="LocalStorage",Jl[Jl.SessionStorage=1]="SessionStorage",($l=Ql=Ql||{})[$l.Default=0]="Default",$l[$l.Required=1]="Required",$l[$l.Array=2]="Array",$l[$l.Hidden=4]="Hidden",(eu=tu=tu||{})[eu.AI=0]="AI",eu[eu.AI_AND_W3C=1]="AI_AND_W3C",eu[eu.W3C=2]="W3C";var iu=2,nu=(ou.isNullOrUndefined=function(t){return null==t},ou.disableCookies=function(){ou._canUseCookies=!1},ou.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(lu,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},ou);function ou(){}var au,su,lu=/[xy]/g,uu=(cu.prototype.addNotificationListener=function(t){this.listeners.push(t)},cu.prototype.removeNotificationListener=function(t){for(var e=this.listeners.indexOf(t);-1<e;)this.listeners.splice(e,1),e=this.listeners.indexOf(t)},cu.prototype.eventsSent=function(e){for(var r=this,t=function(t){i.listeners[t].eventsSent&&setTimeout(function(){return r.listeners[t].eventsSent(e)},0)},i=this,n=0;n<this.listeners.length;++n)t(n)},cu.prototype.eventsDiscarded=function(e,r){for(var i=this,t=function(t){n.listeners[t].eventsDiscarded&&setTimeout(function(){return i.listeners[t].eventsDiscarded(e,r)},0)},n=this,o=0;o<this.listeners.length;++o)t(o)},cu);function cu(){this.listeners=[]}(su=au=au||{})[su.CRITICAL=1]="CRITICAL",su[su.WARNING=2]="WARNING";var pu=0,hu=1,du=2,fu=3,mu=4,gu=5,yu=6,vu=7,_u=8,xu=9,bu=10,wu=11,Su=12,Tu=13,Eu=14,Iu=15,Cu=16,ku=17,Au=18,Pu=19,Mu=20,Lu=22,Ou=23,Du=24,Ru=25,zu=26,Nu=27,Bu=28,Fu=29,Uu=30,ju=31,qu=32,Vu=33,Gu=35,Zu=36,Hu=37,Wu=38,Ku=39,Xu=40,Yu=41,Ju=42,Qu=43,$u=45,tc=46,ec=47,rc=48,ic=49,nc=50,oc=52,ac=54,sc=55,lc=56,uc=57,cc=58,pc=60,hc=61,dc=62,fc=63,mc=64,gc=66,yc=67,vc=68,_c=69,xc=70,bc=71,wc=(Sc.sanitizeDiagnosticText=function(t){return'"'+t.replace(/\"/g,"")+'"'},Sc.dataType="MessageData",Sc.AiNonUserActionablePrefix="AI (Internal): ",Sc.AiUserActionablePrefix="AI: ",Sc);function Sc(t,e,r,i){void 0===r&&(r=!1),this.messageId=t,this.message=(r?Sc.AiUserActionablePrefix:Sc.AiNonUserActionablePrefix)+t;var n=(e?" message:"+Sc.sanitizeDiagnosticText(e):"")+(i?" props:"+Sc.sanitizeDiagnosticText(JSON.stringify(i)):"");this.message+=n}var Tc=(Ec.prototype.throwInternal=function(t,e,r,i,n){void 0===n&&(n=!1);var o=new wc(e,r,n,i);if(this.enableDebugExceptions())throw o;if(void 0!==o&&o&&void 0!==o.message){if(n){var a=+o.messageId;(!this._messageLogged[a]||this.consoleLoggingLevel()>=au.WARNING)&&(this.warnToConsole(o.message),this._messageLogged[a]=!0)}else this.consoleLoggingLevel()>=au.WARNING&&this.warnToConsole(o.message);this.logInternalMessage(t,o)}},Ec.prototype.warnToConsole=function(t){"undefined"!=typeof console&&console&&("function"==typeof console.warn?console.warn(t):"function"==typeof console.log&&console.log(t))},Ec.prototype.resetInternalMessageCount=function(){this._messageCount=0,this._messageLogged={}},Ec.prototype.logInternalMessage=function(t,e){if(!this._areInternalMessagesThrottled()){var r=!0,i=this.AIInternalMessagePrefix+e.messageId;if(this._messageLogged[i]?r=!1:this._messageLogged[i]=!0,r&&(t<=this.telemetryLoggingLevel()&&(this.queue.push(e),this._messageCount++),this._messageCount==this.maxInternalMessageLimit())){var n="Internal events throttle limit per PageView reached for this app.",o=new wc(Ou,n,!1);this.queue.push(o),this.warnToConsole(n)}}},Ec.prototype._areInternalMessagesThrottled=function(){return this._messageCount>=this.maxInternalMessageLimit()},Ec);function Ec(t){this.AIInternalMessagePrefix="AITR_",this.enableDebugExceptions=function(){return!1},this.consoleLoggingLevel=function(){return 0},this.telemetryLoggingLevel=function(){return 1},this.maxInternalMessageLimit=function(){return 25},this.queue=[],this._messageCount=0,this._messageLogged={},nu.isNullOrUndefined(t)||(nu.isNullOrUndefined(t.loggingLevelConsole)||(this.consoleLoggingLevel=function(){return t.loggingLevelConsole}),nu.isNullOrUndefined(t.loggingLevelTelemetry)||(this.telemetryLoggingLevel=function(){return t.loggingLevelTelemetry}),nu.isNullOrUndefined(t.maxMessageLimit)||(this.maxInternalMessageLimit=function(){return t.maxMessageLimit}),nu.isNullOrUndefined(t.enableDebugExceptions)||(this.enableDebugExceptions=function(){return t.enableDebugExceptions}))}var Ic=(Cc.prototype.processTelemetry=function(e){this.channelQueue.forEach(function(t){0<t.length&&t[0].processTelemetry(e)})},Object.defineProperty(Cc.prototype,"ChannelControls",{get:function(){return this.channelQueue},enumerable:!0,configurable:!0}),Cc.prototype.initialize=function(r,i,n){var o=this;if(r.isCookieUseDisabled&&nu.disableCookies(),this.channelQueue=new Array,r.channels){var a=void 0;r.channels.forEach(function(t){if(t&&0<t.length){t=t.sort(function(t,e){return t.priority-e.priority});for(var e=1;e<t.length;e++)t[e-1].setNextPlugin(t[e]);if(t.forEach(function(t){t.priority<500&&(a=t.identifier),t.initialize(r,i,n)}),a)throw Error("Channel has invalid priority"+a);o.channelQueue.push(t)}})}for(var t=new Array,e=0;e<n.length;e++){var s=n[e];500<s.priority&&t.push(s)}if(0<t.length){for(t=t.sort(function(t,e){return t.priority-e.priority}),e=1;e<t.length;e++)t[e-1].setNextPlugin(t[e]);t.forEach(function(t){return t.initialize(r,i,n)}),this.channelQueue.push(t)}},Cc);function Cc(){this.identifier="ChannelControllerPlugin",this.priority=500}var kc=(Ac.prototype.initialize=function(t,e){var r=this;if(this._isInitialized)throw Error("Core should not be initialized more than once");if(!t||nu.isNullOrUndefined(t.instrumentationKey))throw Error("Please provide instrumentation key");this.config=t,this._notificationManager=new uu,this.config.extensions=nu.isNullOrUndefined(this.config.extensions)?[]:this.config.extensions,this.config.extensionConfig=nu.isNullOrUndefined(this.config.extensionConfig)?{}:this.config.extensionConfig,this.config.extensionConfig.NotificationManager=this._notificationManager,this.logger=new Tc(t),(n=this._extensions).push.apply(n,e.concat(this.config.extensions)),this._extensions.forEach(function(t){var e=!0;if((nu.isNullOrUndefined(t)||nu.isNullOrUndefined(t.initialize))&&(e=!1),!e)throw Error("Extensions must provide callback to initialize")}),this._extensions.push(this._channelController),this._extensions=this._extensions.sort(function(t,e){var r=t,i=e,n=typeof r.processTelemetry,o=typeof i.processTelemetry;return"function"==n&&"function"==o?r.priority-i.priority:"function"==n&&"function"!=o?1:"function"!=n&&"function"==o?-1:void 0});var i={};this._extensions.forEach(function(t){var e=t;e&&e.priority&&(nu.isNullOrUndefined(i[e.priority])?i[e.priority]=e.identifier:r.logger.warnToConsole("Two extensions have same priority"+i[e.priority]+", "+e.identifier))});for(var n,o=-1,a=0;a<this._extensions.length-1;a++){var s=this._extensions[a];if(!s||"function"==typeof s.processTelemetry){if(s.priority===this._channelController.priority){o=a+1;break}this._extensions[a].setNextPlugin(this._extensions[a+1])}}if(this._channelController.initialize(this.config,this,this._extensions),this._extensions.forEach(function(t){t&&t.priority<r._channelController.priority&&t.initialize(r.config,r,r._extensions)}),o<this._extensions.length&&this._extensions.splice(o),0===this.getTransmissionControls().length)throw new Error("No channels available");this._isInitialized=!0},Ac.prototype.getTransmissionControls=function(){return this._channelController.ChannelControls},Ac.prototype.track=function(t){if(null===t)throw this._notifyInvalidEvent(t),Error("Invalid telemetry item");t.iKey||(t.iKey=this.config.instrumentationKey),t.time||(t.time=(new Date).toISOString()),nu.isNullOrUndefined(t.ver)&&(t.ver="4.0"),this._validateTelmetryItem(t),0==this._extensions.length&&this._channelController.processTelemetry(t);for(var e=0;e<this._extensions.length;){if(this._extensions[e].processTelemetry){this._extensions[e].processTelemetry(t);break}e++}},Ac.prototype.addNotificationListener=function(t){this._notificationManager.addNotificationListener(t)},Ac.prototype.removeNotificationListener=function(t){this._notificationManager.removeNotificationListener(t)},Ac.prototype.pollInternalLogs=function(r){var i=this,t=this.config.diagnosticLogInterval;return 0<t||(t=1e4),setInterval(function(){var t=i.logger.queue;t.forEach(function(t){var e={name:r||"InternalMessageId: "+t.messageId,iKey:i.config.instrumentationKey,time:(new Date).toISOString(),baseType:wc.dataType,baseData:{message:t.message}};i.track(e)}),t.length=0},t)},Ac.prototype._validateTelmetryItem=function(t){if(nu.isNullOrUndefined(t.name))throw this._notifyInvalidEvent(t),Error("telemetry name required");if(nu.isNullOrUndefined(t.time))throw this._notifyInvalidEvent(t),Error("telemetry timestamp required");if(nu.isNullOrUndefined(t.iKey))throw this._notifyInvalidEvent(t),Error("telemetry instrumentationKey required")},Ac.prototype._notifyInvalidEvent=function(t){this._notificationManager.eventsDiscarded([t],iu)},Ac);function Ac(){this._isInitialized=!1,this._extensions=new Array,this._channelController=new Ic}var Pc=(Mc.requestContextHeader="Request-Context",Mc.requestContextTargetKey="appId",Mc.requestContextAppIdFormat="appId=cid-v1:",Mc.requestIdHeader="Request-Id",Mc.traceParentHeader="traceparent",Mc.sdkContextHeader="Sdk-Context",Mc.sdkContextHeaderAppIdRequest="appId",Mc.requestContextHeaderLowerCase="request-context",Mc);function Mc(){}var Lc=(Oc.sanitizeKeyAndAddUniqueness=function(t,e,r){var i=e.length,n=Oc.sanitizeKey(t,e);if(n.length!==i){for(var o=0,a=n;void 0!==r[a];)o++,a=n.substring(0,Oc.MAX_NAME_LENGTH-3)+Oc.padNumber(o);n=a}return n},Oc.sanitizeKey=function(t,e){var r;return e&&(e=Oc.trim(e.toString())).length>Oc.MAX_NAME_LENGTH&&(r=e.substring(0,Oc.MAX_NAME_LENGTH),t.throwInternal(au.WARNING,uc,"name is too long.  It has been truncated to "+Oc.MAX_NAME_LENGTH+" characters.",{name:e},!0)),r||e},Oc.sanitizeString=function(t,e,r){var i;return void 0===r&&(r=Oc.MAX_STRING_LENGTH),e&&(r=r||Oc.MAX_STRING_LENGTH,(e=Oc.trim(e)).toString().length>r&&(i=e.toString().substring(0,r),t.throwInternal(au.WARNING,hc,"string value is too long. It has been truncated to "+r+" characters.",{value:e},!0))),i||e},Oc.sanitizeUrl=function(t,e){return Oc.sanitizeInput(t,e,Oc.MAX_URL_LENGTH,gc)},Oc.sanitizeMessage=function(t,e){var r;return e&&e.length>Oc.MAX_MESSAGE_LENGTH&&(r=e.substring(0,Oc.MAX_MESSAGE_LENGTH),t.throwInternal(au.WARNING,lc,"message is too long, it has been truncated to "+Oc.MAX_MESSAGE_LENGTH+" characters.",{message:e},!0)),r||e},Oc.sanitizeException=function(t,e){var r;return e&&e.length>Oc.MAX_EXCEPTION_LENGTH&&(r=e.substring(0,Oc.MAX_EXCEPTION_LENGTH),t.throwInternal(au.WARNING,oc,"exception is too long, it has been truncated to "+Oc.MAX_EXCEPTION_LENGTH+" characters.",{exception:e},!0)),r||e},Oc.sanitizeProperties=function(e,t){if(t){var r={};for(var i in t){var n=t[i];if("object"==typeof n&&"undefined"!=typeof JSON)try{n=JSON.stringify(n)}catch(t){e.throwInternal(au.WARNING,ic,"custom property is not valid",{exception:t},!0)}n=Oc.sanitizeString(e,n,Oc.MAX_PROPERTY_LENGTH),r[i=Oc.sanitizeKeyAndAddUniqueness(e,i,r)]=n}t=r}return t},Oc.sanitizeMeasurements=function(t,e){if(e){var r={};for(var i in e){var n=e[i];r[i=Oc.sanitizeKeyAndAddUniqueness(t,i,r)]=n}e=r}return e},Oc.sanitizeId=function(t,e){return e?Oc.sanitizeInput(t,e,Oc.MAX_ID_LENGTH,_c).toString():e},Oc.sanitizeInput=function(t,e,r,i){var n;return e&&(e=Oc.trim(e)).length>r&&(n=e.substring(0,r),t.throwInternal(au.WARNING,i,"input is too long, it has been truncated to "+r+" characters.",{data:e},!0)),n||e},Oc.padNumber=function(t){var e="00"+t;return e.substr(e.length-3)},Oc.trim=function(t){return"string"!=typeof t?t:t.replace(/^\s+|\s+$/g,"")},Oc.MAX_NAME_LENGTH=150,Oc.MAX_ID_LENGTH=128,Oc.MAX_PROPERTY_LENGTH=8192,Oc.MAX_STRING_LENGTH=1024,Oc.MAX_URL_LENGTH=2048,Oc.MAX_MESSAGE_LENGTH=32768,Oc.MAX_EXCEPTION_LENGTH=32768,Oc);function Oc(){}var Dc=(Rc.createDomEvent=function(t){var e=null;return"function"==typeof Event?e=new Event(t):(e=document.createEvent("Event")).initEvent(t,!0,!0),e},Rc.disableStorage=function(){Rc._canUseLocalStorage=!1,Rc._canUseSessionStorage=!1},Rc._getLocalStorageObject=function(){return Rc.canUseLocalStorage()?Rc._getVerifiedStorageObject(Yl.LocalStorage):null},Rc._getVerifiedStorageObject=function(t){var e,r,i=null;try{if("undefined"==typeof window)return null;r=new Date,(i=t===Yl.LocalStorage?window.localStorage:window.sessionStorage).setItem(r,r),e=i.getItem(r)!=r,i.removeItem(r),e&&(i=null)}catch(t){i=null}return i},Rc.isInternalApplicationInsightsEndpoint=function(t){return-1!==Rc._internalEndpoints.indexOf(t.toLowerCase())},Rc.canUseLocalStorage=function(){return void 0===Rc._canUseLocalStorage&&(Rc._canUseLocalStorage=!!Rc._getVerifiedStorageObject(Yl.LocalStorage)),Rc._canUseLocalStorage},Rc.getStorage=function(e,t){var r=Rc._getLocalStorageObject();if(null!==r)try{return r.getItem(t)}catch(t){Rc._canUseLocalStorage=!1,e.throwInternal(au.WARNING,hu,"Browser failed read of local storage. "+Rc.getExceptionName(t),{exception:Rc.dump(t)})}return null},Rc.setStorage=function(e,t,r){var i=Rc._getLocalStorageObject();if(null!==i)try{return i.setItem(t,r),!0}catch(t){Rc._canUseLocalStorage=!1,e.throwInternal(au.WARNING,fu,"Browser failed write to local storage. "+Rc.getExceptionName(t),{exception:Rc.dump(t)})}return!1},Rc.removeStorage=function(e,t){var r=Rc._getLocalStorageObject();if(null!==r)try{return r.removeItem(t),!0}catch(t){Rc._canUseLocalStorage=!1,e.throwInternal(au.WARNING,gu,"Browser failed removal of local storage item. "+Rc.getExceptionName(t),{exception:Rc.dump(t)})}return!1},Rc._getSessionStorageObject=function(){return Rc.canUseSessionStorage()?Rc._getVerifiedStorageObject(Yl.SessionStorage):null},Rc.canUseSessionStorage=function(){return void 0===Rc._canUseSessionStorage&&(Rc._canUseSessionStorage=!!Rc._getVerifiedStorageObject(Yl.SessionStorage)),Rc._canUseSessionStorage},Rc.getSessionStorageKeys=function(){var t=[];if(Rc.canUseSessionStorage())for(var e in window.sessionStorage)t.push(e);return t},Rc.getSessionStorage=function(e,t){var r=Rc._getSessionStorageObject();if(null!==r)try{return r.getItem(t)}catch(t){Rc._canUseSessionStorage=!1,e.throwInternal(au.WARNING,du,"Browser failed read of session storage. "+Rc.getExceptionName(t),{exception:Rc.dump(t)})}return null},Rc.setSessionStorage=function(e,t,r){var i=Rc._getSessionStorageObject();if(null!==i)try{return i.setItem(t,r),!0}catch(t){Rc._canUseSessionStorage=!1,e.throwInternal(au.WARNING,mu,"Browser failed write to session storage. "+Rc.getExceptionName(t),{exception:Rc.dump(t)})}return!1},Rc.removeSessionStorage=function(e,t){var r=Rc._getSessionStorageObject();if(null!==r)try{return r.removeItem(t),!0}catch(t){Rc._canUseSessionStorage=!1,e.throwInternal(au.WARNING,yu,"Browser failed removal of session storage item. "+Rc.getExceptionName(t),{exception:Rc.dump(t)})}return!1},Rc.disableCookies=function(){nu.disableCookies()},Rc.canUseCookies=function(e){if(void 0===nu._canUseCookies){nu._canUseCookies=!1;try{nu._canUseCookies=void 0!==Rc.document.cookie}catch(t){e.throwInternal(au.WARNING,vc,"Cannot access document.cookie - "+Rc.getExceptionName(t),{exception:Rc.dump(t)})}}return nu._canUseCookies},Rc.setCookie=function(t,e,r,i){var n="",o="";i&&(n=";domain="+i),Rc.document.location&&"https:"===Rc.document.location.protocol&&(o=";secure"),Rc.canUseCookies(t)&&(Rc.document.cookie=e+"="+r+n+";path=/"+o)},Rc.stringToBoolOrDefault=function(t,e){return void 0===e&&(e=!1),null==t?e:"true"===t.toString().toLowerCase()},Rc.getCookie=function(t,e){if(Rc.canUseCookies(t)){var r="";if(e&&e.length)for(var i=e+"=",n=Rc.document.cookie.split(";"),o=0;o<n.length;o++){var a=n[o];if((a=Rc.trim(a))&&0===a.indexOf(i)){r=a.substring(i.length,n[o].length);break}}return r}},Rc.deleteCookie=function(t,e){Rc.canUseCookies(t)&&(Rc.document.cookie=e+"=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},Rc.trim=function(t){return"string"!=typeof t?t:t.replace(/^\s+|\s+$/g,"")},Rc.newId=function(){for(var t="",e=1073741824*Math.random();0<e;)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e%64),e=Math.floor(e/64);return t},Rc.random32=function(){return 4294967296*Math.random()|0},Rc.generateW3CId=function(){for(var t,e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r="",i=0;i<4;i++)r+=e[15&(t=Rc.random32())]+e[t>>4&15]+e[t>>8&15]+e[t>>12&15]+e[t>>16&15]+e[t>>20&15]+e[t>>24&15]+e[t>>28&15];var n=e[8+4*Math.random()|0];return r.substr(0,8)+r.substr(9,4)+"4"+r.substr(13,3)+n+r.substr(16,3)+r.substr(19,12)},Rc.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},Rc.isError=function(t){return"[object Error]"===Object.prototype.toString.call(t)},Rc.isDate=function(t){return"[object Date]"===Object.prototype.toString.call(t)},Rc.toISOStringForIE8=function(t){if(Rc.isDate(t)){if(Date.prototype.toISOString)return t.toISOString();var e=function(t){var e=String(t);return 1===e.length&&(e="0"+e),e};return t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}},Rc.getIEVersion=function(t){void 0===t&&(t=null);var e=t?t.toLowerCase():navigator.userAgent.toLowerCase();return-1!=e.indexOf("msie")?parseInt(e.split("msie")[1]):null},Rc.msToTimeSpan=function(t){(isNaN(t)||t<0)&&(t=0);var e=""+(t=Math.round(t))%1e3,r=""+Math.floor(t/1e3)%60,i=""+Math.floor(t/6e4)%60,n=""+Math.floor(t/36e5)%24,o=Math.floor(t/864e5);return e=1===e.length?"00"+e:2===e.length?"0"+e:e,r=r.length<2?"0"+r:r,i=i.length<2?"0"+i:i,(0<o?o+".":"")+(n=n.length<2?"0"+n:n)+":"+i+":"+r+"."+e},Rc.isCrossOriginError=function(t,e,r,i,n){return("Script error."===t||"Script error"===t)&&!n},Rc.dump=function(t){var e=Object.prototype.toString.call(t),r=JSON.stringify(t);return"[object Error]"===e&&(r="{ stack: '"+t.stack+"', message: '"+t.message+"', name: '"+t.name+"'"),e+r},Rc.getExceptionName=function(t){return"[object Error]"===Object.prototype.toString.call(t)?t.name:""},Rc.addEventHandler=function(t,e){if("undefined"==typeof window||!window||"string"!=typeof t||"function"!=typeof e)return!1;var r="on"+t;if(window.addEventListener)window.addEventListener(t,e,!1);else{if(!window.attachEvent)return!1;window.attachEvent(r,e)}return!0},Rc.IsBeaconApiSupported=function(){return"sendBeacon"in navigator&&navigator.sendBeacon},Rc.getExtension=function(t,e){for(var r=null,i=0;!r&&i<t.length;)t[i]&&t[i].identifier===e&&(r=t[i]),i++;return r},Rc.document="undefined"!=typeof document?document:{},Rc._canUseLocalStorage=void 0,Rc._canUseSessionStorage=void 0,Rc._internalEndpoints=["https://dc.services.visualstudio.com/v2/track","https://breeze.aimon.applicationinsights.io/v2/track","https://dc-int.services.visualstudio.com/v2/track"],Rc.NotSpecified="not_specified",Rc);function Rc(){}var zc=(Nc.parseUrl=function(t){return Nc.htmlAnchorElement||(Nc.htmlAnchorElement=Nc.document.createElement?Nc.document.createElement("a"):{host:Nc.parseHost(t)}),Nc.htmlAnchorElement.href=t,Nc.htmlAnchorElement},Nc.getAbsoluteUrl=function(t){var e,r=Nc.parseUrl(t);return r&&(e=r.href),e},Nc.getPathName=function(t){var e,r=Nc.parseUrl(t);return r&&(e=r.pathname),e},Nc.getCompleteUrl=function(t,e){return t?t.toUpperCase()+" "+e:e},Nc.parseHost=function(t){var e=t.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/i);return null!=e&&2<e.length&&"string"==typeof e[2]&&0<e[2].length?e[2]:null},Nc.document="undefined"!=typeof document?document:{},Nc);function Nc(){}var Bc=(Fc.canIncludeCorrelationHeader=function(t,e,r){if(t&&t.disableCorrelationHeaders)return!1;if(!e)return!1;var i=zc.parseUrl(e).host.toLowerCase();if(!(t&&t.enableCorsCorrelation||i===r))return!1;var n,o=t&&t.correlationHeaderDomains;if(o&&(o.forEach(function(t){var e=new RegExp(t.toLowerCase().replace(/\./g,".").replace(/\*/g,".*"));n=n||e.test(i)}),!n))return!1;var a=t&&t.correlationHeaderExcludedDomains;if(!a||0==a.length)return!0;for(var s=0;s<a.length;s++)if(new RegExp(a[s].toLowerCase().replace(/\./g,".").replace(/\*/g,".*")).test(i))return!1;return!0},Fc.getCorrelationContext=function(t){if(t){var e=Fc.getCorrelationContextValue(t,Pc.requestContextTargetKey);if(e&&e!==Fc.correlationIdPrefix)return e}},Fc.getCorrelationContextValue=function(t,e){if(t)for(var r=t.split(","),i=0;i<r.length;++i){var n=r[i].split("=");if(2==n.length&&n[0]==e)return n[1]}},Fc.correlationIdPrefix="cid-v1:",Fc);function Fc(){}var Uc=(jc.ParseDependencyPath=function(t,e,r,i){var n,o=i,a=i;if(e&&0<e.length){var s=zc.parseUrl(e);if(n=s.host,!o)if(null!=s.pathname){var l=0===s.pathname.length?"/":s.pathname;"/"!==l.charAt(0)&&(l="/"+l),a=s.pathname,o=Lc.sanitizeString(t,r?r+" "+l:l)}else o=Lc.sanitizeString(t,e)}else o=n=i;return{target:n,name:o,data:a}},jc);function jc(){}var qc=(Vc.Now="undefined"==typeof window?function(){return(new Date).getTime()}:window.performance&&window.performance.now&&window.performance.timing?function(){return window.performance.now()+window.performance.timing.navigationStart}:function(){return(new Date).getTime()},Vc.GetDuration=function(t,e){var r=null;return 0===t||0===e||nu.isNullOrUndefined(t)||nu.isNullOrUndefined(e)||(r=e-t),r},Vc);function Vc(){}var Gc,Zc="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",Hc="ProcessLegacy",Wc="http.method",Kc=(b(Xc,Gc=function(){}),Xc);function Xc(){return Gc.call(this)||this}var Yc,Jc=(b(Qc,Yc=function(){this.ver=1,this.sampleRate=100,this.tags={}}),Qc);function Qc(t,e,r){var i=Yc.call(this)||this;return i.name=Lc.sanitizeString(t,r)||Dc.NotSpecified,i.data=e,i.time=Dc.toISOStringForIE8(new Date),i.aiDataContract={time:Ql.Required,iKey:Ql.Required,name:Ql.Required,sampleRate:function(){return 100==i.sampleRate?Ql.Hidden:Ql.Required},tags:Ql.Required,data:Ql.Required},i}function $c(){}var tp,ep=(b(rp,tp=$c),rp);function rp(){var t=tp.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}var ip,np=(b(op,ip=ep),op.envelopeType="Microsoft.ApplicationInsights.{0}.Event",op.dataType="EventData",op);function op(t,e,r,i){var n=ip.call(this)||this;return n.aiDataContract={ver:Ql.Required,name:Ql.Required,properties:Ql.Default,measurements:Ql.Default},n.name=Lc.sanitizeString(t,e)||Dc.NotSpecified,n.properties=Lc.sanitizeProperties(t,r),n.measurements=Lc.sanitizeMeasurements(t,i),n}function ap(){}var sp,lp=(b(up,sp=$c),up);function up(){var t=sp.call(this)||this;return t.ver=2,t.exceptions=[],t.properties={},t.measurements={},t}function cp(){this.hasFullStack=!0,this.parsedStack=[]}var pp,hp=(b(dp,pp=lp),dp.CreateFromInterface=function(e,t){var r=t.exceptions&&t.exceptions.map(function(t){return mp.CreateFromInterface(e,t)});return new dp(e,w({},t,{exceptions:r}))},dp.prototype.toInterface=function(){var t=this.exceptions,e=this.properties,r=this.measurements,i=this.severityLevel,n=this.ver,o=this.problemGroup,a=this.id,s=this.isManual;return{ver:n,exceptions:t instanceof Array&&t.map(function(t){return t.toInterface()})||void 0,severityLevel:i,properties:e,measurements:r,problemGroup:o,id:a,isManual:s}},dp.CreateSimpleException=function(t,e,r,i,n,o){return{exceptions:[{hasFullStack:!0,message:t,stack:n,typeName:e}]}},dp.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",dp.dataType="ExceptionData",dp);function dp(t,e,r,i,n,o){var a=pp.call(this)||this;return a.aiDataContract={ver:Ql.Required,exceptions:Ql.Required,severityLevel:Ql.Default,properties:Ql.Default,measurements:Ql.Default},e instanceof Error?(a.exceptions=[new mp(t,e)],a.properties=Lc.sanitizeProperties(t,r),a.measurements=Lc.sanitizeMeasurements(t,i),n&&(a.severityLevel=n),o&&(a.id=o)):(a.exceptions=e.exceptions,a.properties=e.properties,a.measurements=e.measurements,e.severityLevel&&(a.severityLevel=e.severityLevel),e.id&&(a.id=e.id),e.problemGroup&&(a.problemGroup=e.problemGroup),nu.isNullOrUndefined(e.ver)||(a.ver=e.ver),nu.isNullOrUndefined(e.isManual)||(a.isManual=e.isManual)),a}var fp,mp=(b(gp,fp=cp),gp.prototype.toInterface=function(){var t=this.parsedStack instanceof Array&&this.parsedStack.map(function(t){return t.toInterface()});return{id:this.id,outerId:this.outerId,typeName:this.typeName,message:this.message,hasFullStack:this.hasFullStack,stack:this.stack,parsedStack:t||void 0}},gp.CreateFromInterface=function(t,e){var r=e.parsedStack instanceof Array&&e.parsedStack.map(function(t){return vp.CreateFromInterface(t)})||e.parsedStack;return new gp(t,w({},e,{parsedStack:r}))},gp.parseStack=function(t){var e=void 0;if("string"==typeof t){var r=t.split("\n");e=[];for(var i=0,n=0,o=0;o<=r.length;o++){var a=r[o];if(vp.regex.test(a)){var s=new vp(r[o],i++);n+=s.sizeInBytes,e.push(s)}}if(32768<n)for(var l=0,u=e.length-1,c=0,p=l,h=u;l<u;){if(32768<(c+=e[l].sizeInBytes+e[u].sizeInBytes)){var d=h-p+1;e.splice(p,d);break}p=l,h=u,l++,u--}}return e},gp);function gp(t,e){var r=fp.call(this)||this;if(r.aiDataContract={id:Ql.Default,outerId:Ql.Default,typeName:Ql.Required,message:Ql.Required,hasFullStack:Ql.Default,stack:Ql.Default,parsedStack:Ql.Array},e instanceof Error){r.typeName=Lc.sanitizeString(t,e.name)||Dc.NotSpecified,r.message=Lc.sanitizeMessage(t,e.message)||Dc.NotSpecified;var i=e.stack;r.parsedStack=gp.parseStack(i),r.stack=Lc.sanitizeException(t,i),r.hasFullStack=Dc.isArray(r.parsedStack)&&0<r.parsedStack.length}else r.typeName=e.typeName,r.message=e.message,r.stack=e.stack,r.parsedStack=e.parsedStack,r.hasFullStack=e.hasFullStack;return r}var yp,vp=(b(_p,yp=ap),_p.CreateFromInterface=function(t){return new _p(t,null)},_p.prototype.toInterface=function(){return{level:this.level,method:this.method,assembly:this.assembly,fileName:this.fileName,line:this.line}},_p.regex=/^([\s]+at)?(.*?)(\@|\s\(|\s)([^\(\@\n]+):([0-9]+):([0-9]+)(\)?)$/,_p.baseSize=58,_p);function _p(t,e){var r=yp.call(this)||this;if(r.sizeInBytes=0,r.aiDataContract={level:Ql.Required,method:Ql.Required,assembly:Ql.Default,fileName:Ql.Default,line:Ql.Default},"string"==typeof t){var i=t;r.level=e,r.method="<no_method>",r.assembly=Dc.trim(i),r.fileName="",r.line=0;var n=i.match(_p.regex);n&&5<=n.length&&(r.method=Dc.trim(n[2])||r.method,r.fileName=Dc.trim(n[4]),r.line=parseInt(n[5])||0)}else r.level=t.level,r.method=t.method,r.assembly=t.assembly,r.fileName=t.fileName,r.line=t.line,r.sizeInBytes=0;return r.sizeInBytes+=r.method.length,r.sizeInBytes+=r.fileName.length,r.sizeInBytes+=r.assembly.length,r.sizeInBytes+=_p.baseSize,r.sizeInBytes+=r.level.toString().length,r.sizeInBytes+=r.line.toString().length,r}var xp,bp,wp,Sp=(b(Tp,xp=$c),Tp);function Tp(){var t=xp.call(this)||this;return t.ver=2,t.metrics=[],t.properties={},t}(wp=bp=bp||{})[wp.Measurement=0]="Measurement",wp[wp.Aggregation=1]="Aggregation";var Ep,Ip=(b(Cp,Ep=function(){this.kind=bp.Measurement}),Cp);function Cp(){var t=null!==Ep&&Ep.apply(this,arguments)||this;return t.aiDataContract={name:Ql.Required,kind:Ql.Default,value:Ql.Required,count:Ql.Default,min:Ql.Default,max:Ql.Default,stdDev:Ql.Default},t}var kp,Ap=(b(Pp,kp=Sp),Pp.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",Pp.dataType="MetricData",Pp);function Pp(t,e,r,i,n,o,a){var s=kp.call(this)||this;s.aiDataContract={ver:Ql.Required,metrics:Ql.Required,properties:Ql.Default};var l=new Ip;return l.count=0<i?i:void 0,l.max=isNaN(o)||null===o?void 0:o,l.min=isNaN(n)||null===n?void 0:n,l.name=Lc.sanitizeString(t,e)||Dc.NotSpecified,l.value=r,s.metrics=[l],s.properties=Lc.sanitizeProperties(t,a),s}var Mp,Lp=(b(Op,Mp=ep),Op);function Op(){var t=Mp.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}var Dp,Rp=(b(zp,Dp=Lp),zp.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",zp.dataType="PageviewData",zp);function zp(t,e,r,i,n,o,a){var s=Dp.call(this)||this;return s.aiDataContract={ver:Ql.Required,name:Ql.Default,url:Ql.Default,duration:Ql.Default,properties:Ql.Default,measurements:Ql.Default,id:Ql.Default},s.id=Lc.sanitizeId(t,a),s.url=Lc.sanitizeUrl(t,r),s.name=Lc.sanitizeString(t,e)||Dc.NotSpecified,isNaN(i)||(s.duration=Dc.msToTimeSpan(i)),s.properties=Lc.sanitizeProperties(t,n),s.measurements=Lc.sanitizeMeasurements(t,o),s}var Np,Bp=(b(Fp,Np=$c),Fp);function Fp(){var t=Np.call(this)||this;return t.ver=2,t.success=!0,t.properties={},t.measurements={},t}var Up,jp=(b(qp,Up=Bp),qp.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",qp.dataType="RemoteDependencyData",qp);function qp(t,e,r,i,n,o,a,s,l,u,c,p){void 0===l&&(l="Ajax");var h=Up.call(this)||this;h.aiDataContract={id:Ql.Required,ver:Ql.Required,name:Ql.Default,resultCode:Ql.Default,duration:Ql.Default,success:Ql.Default,data:Ql.Default,target:Ql.Default,type:Ql.Default,properties:Ql.Default,measurements:Ql.Default,kind:Ql.Default,value:Ql.Default,count:Ql.Default,min:Ql.Default,max:Ql.Default,stdDev:Ql.Default,dependencyKind:Ql.Default,dependencySource:Ql.Default,commandName:Ql.Default,dependencyTypeName:Ql.Default},h.id=e,h.duration=Dc.msToTimeSpan(n),h.success=o,h.resultCode=a+"",h.type=Lc.sanitizeString(t,l);var d=Uc.ParseDependencyPath(t,r,s,i);return h.data=Lc.sanitizeUrl(t,i)||d.data,h.target=Lc.sanitizeString(t,d.target),u&&(h.target=h.target+" | "+u),h.name=Lc.sanitizeString(t,d.name),h.properties=Lc.sanitizeProperties(t,c),h.measurements=Lc.sanitizeMeasurements(t,p),h}var Vp,Gp=(b(Zp,Vp=$c),Zp);function Zp(){var t=Vp.call(this)||this;return t.ver=2,t.properties={},t}var Hp,Wp=(b(Kp,Hp=Gp),Kp.envelopeType="Microsoft.ApplicationInsights.{0}.Message",Kp.dataType="MessageData",Kp);function Kp(t,e,r,i){var n=Hp.call(this)||this;return n.aiDataContract={ver:Ql.Required,message:Ql.Required,severityLevel:Ql.Default,properties:Ql.Default},e=e||Dc.NotSpecified,n.message=Lc.sanitizeMessage(t,e),n.properties=Lc.sanitizeProperties(t,i),r&&(n.severityLevel=r),n}var Xp,Yp=(b(Jp,Xp=Lp),Jp);function Jp(){var t=Xp.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}var Qp,$p=(b(th,Qp=Yp),th.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",th.dataType="PageviewPerformanceData",th);function th(t,e,r,i,n,o,a){var s=Qp.call(this)||this;return s.aiDataContract={ver:Ql.Required,name:Ql.Default,url:Ql.Default,duration:Ql.Default,perfTotal:Ql.Default,networkConnect:Ql.Default,sentRequest:Ql.Default,receivedResponse:Ql.Default,domProcessing:Ql.Default,properties:Ql.Default,measurements:Ql.Default},s.url=Lc.sanitizeUrl(t,r),s.name=Lc.sanitizeString(t,e)||Dc.NotSpecified,s.properties=Lc.sanitizeProperties(t,n),s.measurements=Lc.sanitizeMeasurements(t,o),a&&(s.domProcessing=a.domProcessing,s.duration=a.duration,s.networkConnect=a.networkConnect,s.perfTotal=a.perfTotal,s.receivedResponse=a.receivedResponse,s.sentRequest=a.sentRequest),s}var eh,rh,ih,nh=(b(oh,eh=Kc),oh);function oh(t,e){var r=eh.call(this)||this;return r.aiDataContract={baseType:Ql.Required,baseData:Ql.Required},r.baseType=t,r.baseData=e,r}(ih=rh=rh||{})[ih.Verbose=0]="Verbose",ih[ih.Information=1]="Information",ih[ih.Warning=2]="Warning",ih[ih.Error=3]="Error",ih[ih.Critical=4]="Critical";var ah=(sh.getConfig=function(t,e,r,i){var n;return void 0===i&&(i=!1),n=r&&t.extensionConfig&&t.extensionConfig[r]&&!nu.isNullOrUndefined(t.extensionConfig[r][e])?t.extensionConfig[r][e]:t[e],nu.isNullOrUndefined(n)?i:n},sh);function sh(){}var lh=function(){this.applicationVersion="ai.application.ver",this.applicationBuild="ai.application.build",this.applicationTypeId="ai.application.typeId",this.applicationId="ai.application.applicationId",this.applicationLayer="ai.application.layer",this.deviceId="ai.device.id",this.deviceIp="ai.device.ip",this.deviceLanguage="ai.device.language",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceFriendlyName="ai.device.friendlyName",this.deviceNetwork="ai.device.network",this.deviceNetworkName="ai.device.networkName",this.deviceOEMName="ai.device.oemName",this.deviceOS="ai.device.os",this.deviceOSVersion="ai.device.osVersion",this.deviceRoleInstance="ai.device.roleInstance",this.deviceRoleName="ai.device.roleName",this.deviceScreenResolution="ai.device.screenResolution",this.deviceType="ai.device.type",this.deviceMachineName="ai.device.machineName",this.deviceVMName="ai.device.vmName",this.deviceBrowser="ai.device.browser",this.deviceBrowserVersion="ai.device.browserVersion",this.locationIp="ai.location.ip",this.locationCountry="ai.location.country",this.locationProvince="ai.location.province",this.locationCity="ai.location.city",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationRootId="ai.operation.rootId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.sessionIsNew="ai.session.isNew",this.userAccountAcquisitionDate="ai.user.accountAcquisitionDate",this.userAccountId="ai.user.accountId",this.userAgent="ai.user.userAgent",this.userId="ai.user.id",this.userStoreRegion="ai.user.storeRegion",this.userAuthUserId="ai.user.authUserId",this.userAnonymousUserAcquisitionDate="ai.user.anonUserAcquisitionDate",this.userAuthenticatedUserAcquisitionDate="ai.user.authUserAcquisitionDate",this.cloudName="ai.cloud.name",this.cloudRole="ai.cloud.role",this.cloudRoleVer="ai.cloud.roleVer",this.cloudRoleInstance="ai.cloud.roleInstance",this.cloudEnvironment="ai.cloud.environment",this.cloudLocation="ai.cloud.location",this.cloudDeploymentUnit="ai.cloud.deploymentUnit",this.internalNodeName="ai.internal.nodeName",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion"},uh=(ch.create=function(t,e,r,i,n,o){if(r=Lc.sanitizeString(i,r)||Dc.NotSpecified,nu.isNullOrUndefined(t)||nu.isNullOrUndefined(e)||nu.isNullOrUndefined(r))throw Error("Input doesn't contain all required fields");var a={name:r,time:(new Date).toISOString(),iKey:"",ext:o||{},tags:[],data:{},baseType:e,baseData:t};if(!nu.isNullOrUndefined(n))for(var s in n)n.hasOwnProperty(s)&&(a.data[s]=n[s]);return a},ch);function ch(){}var ph=(hh.UserExt="user",hh.DeviceExt="device",hh.TraceExt="trace",hh.WebExt="web",hh.AppExt="app",hh.OSExt="os",hh.SessionExt="ses",hh.SDKExt="sdk",hh);function hh(){}var dh=new lh,fh="AppInsightsPropertiesPlugin",mh="AppInsightsChannelPlugin",gh=(yh.prototype.trackPageView=function(e,r){var i=this,n=e.name;!nu.isNullOrUndefined(n)&&"string"==typeof n||(e.name=window.document&&window.document.title||"");var o=e.uri;if(!nu.isNullOrUndefined(o)&&"string"==typeof o||(e.uri=window.location&&window.location.href||""),!this._pageViewPerformanceManager.isPerformanceTimingSupported())return this.appInsights.sendPageViewInternal(e,r),this._channel().forEach(function(t){t.forEach(function(t){return t.flush(!0)})}),void this._logger.throwInternal(au.WARNING,Ru,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");var a=!1,s=void 0,l=this._pageViewPerformanceManager.getPerformanceTiming().navigationStart;s=qc.GetDuration(l,+new Date),this._pageViewPerformanceManager.shouldCollectDuration(s)||(s=void 0);var t=void 0;nu.isNullOrUndefined(r)||nu.isNullOrUndefined(r.duration)||(t=r.duration),!this.overridePageViewDuration&&isNaN(t)||(isNaN(t)&&((r=r||{}).duration=s),this.appInsights.sendPageViewInternal(e,r),this._channel().forEach(function(t){t.forEach(function(t){return t.flush(!0)})}),a=!0),r=r||{};var u=setInterval(function(){try{if(i._pageViewPerformanceManager.isPerformanceTimingDataReady()){clearInterval(u);var t={name:n,uri:o};i._pageViewPerformanceManager.populatePageViewPerformanceEvent(t),t.isValid||a?(a||(r.duration=t.durationMs,i.appInsights.sendPageViewInternal(e,r)),i.pageViewPerformanceSent||(i.appInsights.sendPageViewPerformanceInternal(t,r),i.pageViewPerformanceSent=!0),i._channel().forEach(function(t){t.forEach(function(t){return t.flush(!0)})})):(r.duration=s,i.appInsights.sendPageViewInternal(e,r),i._channel().forEach(function(t){t.forEach(function(t){return t.flush(!0)})}))}else 6e4<qc.GetDuration(l,+new Date)&&(clearInterval(u),a||(r.duration=6e4,i.appInsights.sendPageViewInternal(e,r),i._channel().forEach(function(t){t.forEach(function(t){return t.flush(!0)})})))}catch(t){i._logger.throwInternal(au.CRITICAL,Wu,"trackPageView failed on page load calculation: "+Dc.getExceptionName(t),{exception:Dc.dump(t)})}},100)},yh);function yh(t,e,r,i){this.pageViewPerformanceSent=!1,this.overridePageViewDuration=!1,this.overridePageViewDuration=e,this.appInsights=t,this._pageViewPerformanceManager=i,r&&(this._channel=function(){return r.getTransmissionControls()},this._logger=r.logger)}var vh=(_h.prototype.trackPreviousPageVisit=function(t,e){try{var r=this.restartPageVisitTimer(t,e);r&&this.pageVisitTimeTrackingHandler(r.pageName,r.pageUrl,r.pageVisitTime)}catch(t){this._logger.warnToConsole("Auto track page visit time failed, metric will not be collected: "+Dc.dump(t))}},_h.prototype.restartPageVisitTimer=function(t,e){try{var r=this.stopPageVisitTimer();return this.startPageVisitTimer(t,e),r}catch(t){return this._logger.warnToConsole("Call to restart failed: "+Dc.dump(t)),null}},_h.prototype.startPageVisitTimer=function(t,e){try{if(Dc.canUseSessionStorage()){if(null!=Dc.getSessionStorage(this._logger,this.prevPageVisitDataKeyName))throw new Error("Cannot call startPageVisit consecutively without first calling stopPageVisit");var r=new xh(t,e),i=JSON.stringify(r);Dc.setSessionStorage(this._logger,this.prevPageVisitDataKeyName,i)}}catch(t){this._logger.warnToConsole("Call to start failed: "+Dc.dump(t))}},_h.prototype.stopPageVisitTimer=function(){try{if(Dc.canUseSessionStorage()){var t=Date.now(),e=Dc.getSessionStorage(this._logger,this.prevPageVisitDataKeyName);if(e){var r=JSON.parse(e);return r.pageVisitTime=t-r.pageVisitStartTime,Dc.removeSessionStorage(this._logger,this.prevPageVisitDataKeyName),r}return null}return null}catch(t){return this._logger.warnToConsole("Stop page visit timer failed: "+Dc.dump(t)),null}},_h);function _h(t,e){this.prevPageVisitDataKeyName="prevPageVisitData",this.pageVisitTimeTrackingHandler=e,this._logger=t}var xh=function(t,e){this.pageVisitStartTime=Date.now(),this.pageName=t,this.pageUrl=e},bh=(wh.prototype.populatePageViewPerformanceEvent=function(t){t.isValid=!1;var e=this.getPerformanceTiming();if(e){var r=qc.GetDuration(e.navigationStart,e.loadEventEnd),i=qc.GetDuration(e.navigationStart,e.connectEnd),n=qc.GetDuration(e.requestStart,e.responseStart),o=qc.GetDuration(e.responseStart,e.responseEnd),a=qc.GetDuration(e.responseEnd,e.loadEventEnd);0==r?this._logger.throwInternal(au.WARNING,bu,"error calculating page view performance.",{total:r,network:i,request:n,response:o,dom:a}):this.shouldCollectDuration(r,i,n,o,a)?r<Math.floor(i)+Math.floor(n)+Math.floor(o)+Math.floor(a)?this._logger.throwInternal(au.WARNING,_u,"client performance math error.",{total:r,network:i,request:n,response:o,dom:a}):(t.durationMs=r,t.perfTotal=t.duration=Dc.msToTimeSpan(r),t.networkConnect=Dc.msToTimeSpan(i),t.sentRequest=Dc.msToTimeSpan(n),t.receivedResponse=Dc.msToTimeSpan(o),t.domProcessing=Dc.msToTimeSpan(a),t.isValid=!0):this._logger.throwInternal(au.WARNING,$u,"Invalid page load duration value. Browser perf data won't be sent.",{total:r,network:i,request:n,response:o,dom:a})}},wh.prototype.getPerformanceTiming=function(){return this.isPerformanceTimingSupported()?window.performance.timing:null},wh.prototype.isPerformanceTimingSupported=function(){return"undefined"!=typeof window&&window.performance&&window.performance.timing},wh.prototype.isPerformanceTimingDataReady=function(){var t=window.performance.timing;return 0<t.domainLookupStart&&0<t.navigationStart&&0<t.responseStart&&0<t.requestStart&&0<t.loadEventEnd&&0<t.responseEnd&&0<t.connectEnd&&0<t.domLoading},wh.prototype.shouldCollectDuration=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=["googlebot","adsbot-google","apis-google","mediapartners-google"],i=navigator.userAgent,n=!1;if(i)for(var o=0;o<r.length;o++)n=n||-1!==i.toLowerCase().indexOf(r[o]);if(n)return!1;for(var a=0;a<t.length;a++)if(t[a]>=this.MAX_DURATION_ALLOWED)return!1;return!0},wh);function wh(t){this.MAX_DURATION_ALLOWED=36e5,t&&(this._logger=t.logger)}var Sh="duration",Th=(Eh.getDefaultConfig=function(t){return(t=t||{}).sessionRenewalMs=18e5,t.sessionExpirationMs=864e5,t.disableExceptionTracking=Dc.stringToBoolOrDefault(t.disableExceptionTracking),t.autoTrackPageVisitTime=Dc.stringToBoolOrDefault(t.autoTrackPageVisitTime),t.overridePageViewDuration=Dc.stringToBoolOrDefault(t.overridePageViewDuration),(isNaN(t.samplingPercentage)||t.samplingPercentage<=0||100<=t.samplingPercentage)&&(t.samplingPercentage=100),t.isCookieUseDisabled=Dc.stringToBoolOrDefault(t.isCookieUseDisabled),t.isStorageUseDisabled=Dc.stringToBoolOrDefault(t.isStorageUseDisabled),t.isBrowserLinkTrackingEnabled=Dc.stringToBoolOrDefault(t.isBrowserLinkTrackingEnabled),t.enableAutoRouteTracking=Dc.stringToBoolOrDefault(t.enableAutoRouteTracking),t.namePrefix=t.namePrefix||"",t},Eh.prototype.processTelemetry=function(t){for(var e=!1,r=this._telemetryInitializers.length,i=0;i<r;++i){var n=this._telemetryInitializers[i];if(n)try{if(!1===n.apply(null,[t])){e=!0;break}}catch(t){this._logger.throwInternal(au.CRITICAL,mc,"One of telemetry initializers failed, telemetry item will not be sent: "+Dc.getExceptionName(t),{exception:Dc.dump(t)},!0)}}e||nu.isNullOrUndefined(this._nextPlugin)||this._nextPlugin.processTelemetry(t)},Eh.prototype.setNextPlugin=function(t){this._nextPlugin=t},Eh.prototype.trackEvent=function(t,e){try{var r=uh.create(t,np.dataType,np.envelopeType,this._logger,e);this.core.track(r)}catch(t){this._logger.throwInternal(au.WARNING,Ku,"trackTrace failed, trace will not be collected: "+Dc.getExceptionName(t),{exception:Dc.dump(t)})}},Eh.prototype.startTrackEvent=function(t){try{this._eventTracking.start(t)}catch(t){this._logger.throwInternal(au.CRITICAL,Fu,"startTrackEvent failed, event will not be collected: "+Dc.getExceptionName(t),{exception:Dc.dump(t)})}},Eh.prototype.stopTrackEvent=function(t,e,r){try{this._eventTracking.stop(t,void 0,e)}catch(t){this._logger.throwInternal(au.CRITICAL,Uu,"stopTrackEvent failed, event will not be collected: "+Dc.getExceptionName(t),{exception:Dc.dump(t)})}},Eh.prototype.trackTrace=function(t,e){try{var r=uh.create(t,Wp.dataType,Wp.envelopeType,this._logger,e);this.core.track(r)}catch(t){this._logger.throwInternal(au.WARNING,Ku,"trackTrace failed, trace will not be collected: "+Dc.getExceptionName(t),{exception:Dc.dump(t)})}},Eh.prototype.trackMetric=function(t,e){try{var r=uh.create(t,Ap.dataType,Ap.envelopeType,this._logger,e);this.core.track(r)}catch(t){this._logger.throwInternal(au.CRITICAL,Zu,"trackMetric failed, metric will not be collected: "+Dc.getExceptionName(t),{exception:Dc.dump(t)})}},Eh.prototype.trackPageView=function(t,e){try{var r=t||{};this._pageViewManager.trackPageView(r,w({},r.properties,r.measurements,e)),this.config.autoTrackPageVisitTime&&this._pageVisitTimeManager.trackPreviousPageVisit(r.name,r.uri)}catch(t){this._logger.throwInternal(au.CRITICAL,Hu,"trackPageView failed, page view will not be collected: "+Dc.getExceptionName(t),{exception:Dc.dump(t)})}},Eh.prototype.sendPageViewInternal=function(t,e,r){"undefined"!=typeof document&&(t.refUri=void 0===t.refUri?document.referrer:t.refUri);var i=uh.create(t,Rp.dataType,Rp.envelopeType,this._logger,e,r);this.core.track(i),this._trackAjaxAttempts=0},Eh.prototype.sendPageViewPerformanceInternal=function(t,e,r){var i=uh.create(t,$p.dataType,$p.envelopeType,this._logger,e,r);this.core.track(i)},Eh.prototype.trackPageViewPerformance=function(t,e){try{this._pageViewPerformanceManager.populatePageViewPerformanceEvent(t),this.sendPageViewPerformanceInternal(t,e)}catch(t){this._logger.throwInternal(au.CRITICAL,Hu,"trackPageViewPerformance failed, page view will not be collected: "+Dc.getExceptionName(t),{exception:Dc.dump(t)})}},Eh.prototype.startTrackPage=function(t){try{"string"!=typeof t&&(t=window.document&&window.document.title||""),this._pageTracking.start(t)}catch(t){this._logger.throwInternal(au.CRITICAL,ju,"startTrackPage failed, page view may not be collected: "+Dc.getExceptionName(t),{exception:Dc.dump(t)})}},Eh.prototype.stopTrackPage=function(t,e,r,i){try{"string"!=typeof t&&(t=window.document&&window.document.title||""),"string"!=typeof e&&(e=window.location&&window.location.href||""),this._pageTracking.stop(t,e,r,i),this.config.autoTrackPageVisitTime&&this._pageVisitTimeManager.trackPreviousPageVisit(t,e)}catch(t){this._logger.throwInternal(au.CRITICAL,qu,"stopTrackPage failed, page view will not be collected: "+Dc.getExceptionName(t),{exception:Dc.dump(t)})}},Eh.prototype.sendExceptionInternal=function(t,e,r){var i=new hp(this._logger,t.exception||new Error(Dc.NotSpecified),t.properties,t.measurements,t.severityLevel,t.id).toInterface(),n=uh.create(i,hp.dataType,hp.envelopeType,this._logger,e,r);this.core.track(n)},Eh.prototype.trackException=function(t,e){try{this.sendExceptionInternal(t,e)}catch(t){this._logger.throwInternal(au.CRITICAL,Gu,"trackException failed, exception will not be collected: "+Dc.getExceptionName(t),{exception:Dc.dump(t)})}},Eh.prototype._onerror=function(e){try{var t={url:e&&e.url||document.URL,lineNumber:e.lineNumber,columnNumber:e.columnNumber,message:e.message};if(Dc.isCrossOriginError(e.message,e.url,e.lineNumber,e.columnNumber,e.error))this._sendCORSException(t.url);else{if(!Dc.isError(e.error)){var r="window.onerror@"+t.url+":"+e.lineNumber+":"+(e.columnNumber||0);e.error=new Error(e.message),e.error.stack=r}this.trackException({exception:e.error,severityLevel:rh.Error},t)}}catch(t){var i=e.error?e.error.name+", "+e.error.message:"null";this._logger.throwInternal(au.CRITICAL,wu,"_onError threw exception while logging error, error will not be collected: "+Dc.getExceptionName(t),{exception:Dc.dump(t),errorString:i})}},Eh.prototype.addTelemetryInitializer=function(t){this._telemetryInitializers.push(t)},Eh.prototype._initialize=function(t,e,r){var a=this;if(!this._isInitialized){if(nu.isNullOrUndefined(e))throw Error("Error initializing");this.core=e,this._logger=e.logger,this._globalconfig={instrumentationKey:t.instrumentationKey,endpointUrl:t.endpointUrl||"https://dc.services.visualstudio.com/v2/track"},this.config=t.extensionConfig&&t.extensionConfig[this.identifier]?t.extensionConfig[this.identifier]:{};var i=Eh.getDefaultConfig();if(void 0!==i){for(var n in i)this.config[n]=ah.getConfig(t,n,this.identifier,i[n]);if(this._globalconfig)for(var n in i)void 0===this._globalconfig[n]&&(this._globalconfig[n]=i[n])}this.config.isCookieUseDisabled&&Dc.disableCookies(),this.config.isStorageUseDisabled&&Dc.disableStorage();var o={instrumentationKey:function(){return t.instrumentationKey},accountId:function(){return a.config.accountId||t.accountId},sessionRenewalMs:function(){return a.config.sessionRenewalMs||t.sessionRenewalMs},sessionExpirationMs:function(){return a.config.sessionExpirationMs||t.sessionExpirationMs},sampleRate:function(){return a.config.samplingPercentage||t.samplingPercentage},cookieDomain:function(){return a.config.cookieDomain||t.cookieDomain},sdkExtension:function(){return a.config.sdkExtension||t.sdkExtension},isBrowserLinkTrackingEnabled:function(){return a.config.isBrowserLinkTrackingEnabled||t.isBrowserLinkTrackingEnabled},appId:function(){return a.config.appId||t.appId}};this._pageViewPerformanceManager=new bh(this.core),this._pageViewManager=new gh(this,this.config.overridePageViewDuration,this.core,this._pageViewPerformanceManager),this._pageVisitTimeManager=new vh(this._logger,function(t,e,r){return a.trackPageVisitTime(t,e,r)}),this._telemetryInitializers=[],this._addDefaultTelemetryInitializers(o),this._eventTracking=new Ih(this._logger,"trackEvent"),this._eventTracking.action=function(t,e,r,i){(i=i||{})[Sh]=r.toString(),a.trackEvent({name:t,properties:i})},this._pageTracking=new Ih(this._logger,"trackPageView"),this._pageTracking.action=function(t,e,r,i,n){nu.isNullOrUndefined(i)&&(i={}),i[Sh]=r.toString();var o={name:t,uri:e,properties:i,measurements:n};a.sendPageViewInternal(o)};var s,l,u=this;if(!1===this.config.disableExceptionTracking&&!this.config.autoExceptionInstrumented){var c=window.onerror;window.onerror=function(t,e,r,i,n){var o=c&&c(t,e,r,i,n);return!0!==o&&u._onerror({message:t,url:e,lineNumber:r,columnNumber:i,error:n}),o},this.config.autoExceptionInstrumented=!0}if(!0===this.config.enableAutoRouteTracking&&"object"==typeof history&&"function"==typeof history.pushState&&"function"==typeof history.replaceState&&"object"==typeof window&&"undefined"!=typeof Event){var p=this;r.forEach(function(t){t.identifier===fh&&(a._properties=t)}),history.pushState=(l=history.pushState,function(){var t=l.apply(this,arguments);return window.dispatchEvent(Dc.createDomEvent(p.config.namePrefix+"pushState")),window.dispatchEvent(Dc.createDomEvent(p.config.namePrefix+"locationchange")),t}),history.replaceState=(s=history.replaceState,function(){var t=s.apply(this,arguments);return window.dispatchEvent(Dc.createDomEvent(p.config.namePrefix+"replaceState")),window.dispatchEvent(Dc.createDomEvent(p.config.namePrefix+"locationchange")),t}),window.addEventListener(p.config.namePrefix+"popstate",function(){window.dispatchEvent(Dc.createDomEvent(p.config.namePrefix+"locationchange"))}),window.addEventListener(p.config.namePrefix+"locationchange",function(){p._properties&&p._properties.context&&p._properties.context.telemetryTrace&&(p._properties.context.telemetryTrace.traceID=Dc.generateW3CId(),p._properties.context.telemetryTrace.name=window.location&&window.location.pathname||"_unknown_"),a._currUri&&(a._prevUri=a._currUri),a._currUri=window.location&&window.location.href||"",setTimeout(function(t){p.trackPageView({refUri:t,properties:{duration:0}})}.bind(a,a._prevUri),p.autoRoutePVDelay)})}this._isInitialized=!0}},Eh.prototype.trackPageVisitTime=function(t,e,r){var i={PageName:t,PageUrl:e};this.trackMetric({name:"PageVisitTime",average:r,max:r,min:r,sampleCount:1},i)},Eh.prototype._addDefaultTelemetryInitializers=function(t){if(!t.isBrowserLinkTrackingEnabled()){var i=["/browserLinkSignalR/","/__browserLink/"];this._addTelemetryInitializer(function(t){if(t.baseType===jp.dataType){var e=t.baseData;if(e)for(var r=0;r<i.length;r++)if(e.target&&0<=e.target.indexOf(i[r]))return!1}return!0})}},Eh.prototype._addTelemetryInitializer=function(t){this._telemetryInitializers.push(t)},Eh.prototype._sendCORSException=function(t){var e={message:"Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",url:t,lineNumber:0,columnNumber:0,error:void 0},r=uh.create(e,hp.dataType,hp.envelopeType,this._logger,{url:t});this.core.track(r)},Eh.Version="2.2.2",Eh);function Eh(){this.identifier="ApplicationInsightsAnalytics",this.priority=180,this.autoRoutePVDelay=500,this._isInitialized=!1,this._trackAjaxAttempts=0,this._prevUri="object"==typeof window&&window.location&&window.location.href||"",this.initialize=this._initialize.bind(this)}var Ih=(Ch.prototype.start=function(t){void 0!==this._events[t]&&this._logger.throwInternal(au.WARNING,dc,"start was called more than once for this event without calling stop.",{name:this._name,key:t},!0),this._events[t]=+new Date},Ch.prototype.stop=function(t,e,r,i){var n=this._events[t];if(isNaN(n))this._logger.throwInternal(au.WARNING,fc,"stop was called without a corresponding start.",{name:this._name,key:t},!0);else{var o=+new Date,a=qc.GetDuration(n,o);this.action(t,e,a,r,i)}delete this._events[t],this._events[t]=void 0},Ch);function Ch(t,e){this._name=e,this._events={},this._logger=t}var kh=(Ah.prototype.enqueue=function(t){this._buffer.push(t)},Ah.prototype.count=function(){return this._buffer.length},Ah.prototype.clear=function(){this._buffer.length=0},Ah.prototype.getItems=function(){return this._buffer.slice(0)},Ah.prototype.batchPayloads=function(t){return t&&0<t.length?this._config.emitLineDelimitedJson()?t.join("\n"):"["+t.join(",")+"]":null},Ah.prototype.markAsSent=function(t){this.clear()},Ah.prototype.clearSent=function(t){},Ah);function Ah(t){this._config=t,this._buffer=[]}var Ph=(Mh.prototype.enqueue=function(t){this._buffer.length>=Mh.MAX_BUFFER_SIZE?this._bufferFullMessageSent||(this._logger.throwInternal(au.WARNING,yc,"Maximum buffer size reached: "+this._buffer.length,!0),this._bufferFullMessageSent=!0):(this._buffer.push(t),this.setBuffer(Mh.BUFFER_KEY,this._buffer))},Mh.prototype.count=function(){return this._buffer.length},Mh.prototype.clear=function(){this._buffer.length=0,this.setBuffer(Mh.BUFFER_KEY,[]),this.setBuffer(Mh.SENT_BUFFER_KEY,[]),this._bufferFullMessageSent=!1},Mh.prototype.getItems=function(){return this._buffer.slice(0)},Mh.prototype.batchPayloads=function(t){return t&&0<t.length?this._config.emitLineDelimitedJson()?t.join("\n"):"["+t.join(",")+"]":null},Mh.prototype.markAsSent=function(t){this._buffer=this.removePayloadsFromBuffer(t,this._buffer),this.setBuffer(Mh.BUFFER_KEY,this._buffer);var e=this.getBuffer(Mh.SENT_BUFFER_KEY);e instanceof Array&&t instanceof Array&&((e=e.concat(t)).length>Mh.MAX_BUFFER_SIZE&&(this._logger.throwInternal(au.CRITICAL,yc,"Sent buffer reached its maximum size: "+e.length,!0),e.length=Mh.MAX_BUFFER_SIZE),this.setBuffer(Mh.SENT_BUFFER_KEY,e))},Mh.prototype.clearSent=function(t){var e=this.getBuffer(Mh.SENT_BUFFER_KEY);e=this.removePayloadsFromBuffer(t,e),this.setBuffer(Mh.SENT_BUFFER_KEY,e)},Mh.prototype.removePayloadsFromBuffer=function(t,e){var r=[];for(var i in e){var n=!1;for(var o in t)if(t[o]===e[i]){n=!0;break}n||r.push(e[i])}return r},Mh.prototype.getBuffer=function(t){var e=t;try{e=this._config.namePrefix&&this._config.namePrefix()?this._config.namePrefix()+"_"+e:e;var r=Dc.getSessionStorage(this._logger,e);if(r){var i=JSON.parse(r);if(i)return i}}catch(t){this._logger.throwInternal(au.CRITICAL,Ju," storage key: "+e+", "+Dc.getExceptionName(t),{exception:Dc.dump(t)})}return[]},Mh.prototype.setBuffer=function(t,e){var r=t;try{r=this._config.namePrefix&&this._config.namePrefix()?this._config.namePrefix()+"_"+r:r;var i=JSON.stringify(e);Dc.setSessionStorage(this._logger,r,i)}catch(t){Dc.setSessionStorage(this._logger,r,JSON.stringify([])),this._logger.throwInternal(au.WARNING,Yu," storage key: "+r+", "+Dc.getExceptionName(t)+". Buffer cleared",{exception:Dc.dump(t)})}},Mh.BUFFER_KEY="AI_buffer",Mh.SENT_BUFFER_KEY="AI_sentBuffer",Mh.MAX_BUFFER_SIZE=2e3,Mh);function Mh(t,e){this._bufferFullMessageSent=!1,this._logger=t,this._config=e;var r=this.getBuffer(Mh.BUFFER_KEY),i=this.getBuffer(Mh.SENT_BUFFER_KEY);this._buffer=r.concat(i),this._buffer.length>Mh.MAX_BUFFER_SIZE&&(this._buffer.length=Mh.MAX_BUFFER_SIZE),this.setBuffer(Mh.SENT_BUFFER_KEY,[]),this.setBuffer(Mh.BUFFER_KEY,this._buffer)}var Lh=(Oh.extractProperties=function(t){var e=null;for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];"number"!=typeof i&&((e=e||{})[r]=i)}return e},Oh.extractPropsAndMeasurements=function(t,e,r){if(!nu.isNullOrUndefined(t))for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];"number"==typeof n?r[i]=n:e[i]="string"==typeof n?n:JSON.stringify(n)}},Oh.createEnvelope=function(t,e,r,i){var n=new Jc(t,i,e);n.iKey=r.iKey;var o=r.iKey.replace(/-/g,"");return n.name=n.name.replace("{0}",o),Oh.extractPartAExtensions(r,n),r.tags||(r.tags=[]),n},Oh.extractPartAExtensions=function(r,t){if(t.tags||(t.tags={}),r.ext||(r.ext={}),r.tags||(r.tags=[]),r.ext.user){r.ext.user.authId&&(t.tags[dh.userAuthUserId]=r.ext.user.authId);var e=r.ext.user.id||r.ext.user.localId;e&&(t.tags[dh.userId]=e)}if(r.ext.app&&r.ext.app.sesId&&(t.tags[dh.sessionId]=r.ext.app.sesId),r.ext.device&&((r.ext.device.id||r.ext.device.localId)&&(t.tags[dh.deviceId]=r.ext.device.id||r.ext.device.localId),r.ext.device.deviceClass&&(t.tags[dh.deviceType]=r.ext.device.deviceClass),r.ext.device.ip&&(t.tags[dh.deviceIp]=r.ext.device.ip)),r.ext.web){var i=r.ext.web;i.browserLang&&(t.tags[dh.deviceLanguage]=i.browserLang),i.browserVer&&(t.tags[dh.deviceBrowserVersion]=i.browserVer),i.browser&&(t.tags[dh.deviceBrowser]=i.browser),t.data=t.data||{},t.data.baseData=t.data.baseData||{},t.data.baseData.properties=t.data.baseData.properties||{},i.domain&&(t.data.baseData.properties.domain=i.domain),i.isManual&&(t.data.baseData.properties.isManual=i.isManual.toString()),i.screenRes&&(t.data.baseData.properties.screenRes=i.screenRes),i.userConsent&&(t.data.baseData.properties.userConsent=i.userConsent.toString())}r.ext.device&&r.ext.device.model&&(t.tags[dh.deviceModel]=r.ext.device.model),r.ext.os&&r.ext.os.name&&(t.tags[dh.deviceOS]=r.ext.os.name),r.ext.device&&r.ext.device.deviceType&&(t.tags[dh.deviceType]=r.ext.device.deviceType),r.ext.trace&&(r.ext.trace.parentID&&(t.tags[dh.operationParentId]=r.ext.trace.parentID),r.ext.trace.name&&(t.tags[dh.operationName]=r.ext.trace.name),r.ext.trace.traceID&&(t.tags[dh.operationId]=r.ext.trace.traceID));for(var n={},o=function(t){var e=r.tags[t];Object.keys(e).forEach(function(t){n[t]=e[t]}),r.tags.splice(t,1)},a=r.tags.length-1;0<=a;a--)o(a);for(var s in r.tags)n[s]=r.tags[s];t.tags=w({},t.tags,n),t.tags[dh.internalSdkVersion]||(t.tags[dh.internalSdkVersion]="javascript:"+Oh.Version)},Oh.Version="2.2.2",Oh);function Oh(){}var Dh,Rh=(b(zh,Dh=Lh),zh.prototype.Create=function(t,e){this._logger=t,nu.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(au.CRITICAL,tc,"telemetryItem.baseData cannot be null.");var r=e.baseData.measurements||{},i=e.baseData.properties||{};Lh.extractPropsAndMeasurements(e.data,i,r);var n=e.baseData;if(nu.isNullOrUndefined(n))return t.warnToConsole("Invalid input for dependency data"),null;var o=n.id,a=n.target,s=n.name,l=n.duration,u=n.success,c=n.responseCode,p=n.type,h=n.correlationContext,d=n.properties&&n.properties[Wc]?n.properties[Wc]:"GET",f=new jp(t,o,a,s,l,u,c,d,p,h,i,r),m=new nh(jp.dataType,f);return Lh.createEnvelope(t,jp.envelopeType,e,m)},zh.DependencyEnvelopeCreator=new zh,zh);function zh(){return null!==Dh&&Dh.apply(this,arguments)||this}var Nh,Bh=(b(Fh,Nh=Lh),Fh.prototype.Create=function(t,e){this._logger=t,nu.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(au.CRITICAL,tc,"telemetryItem.baseData cannot be null.");var r={},i={};e.baseType!==np.dataType&&(r.baseTypeSource=e.baseType),e.baseType===np.dataType?(r=e.baseData.properties||{},i=e.baseData.measurements||{}):e.baseData&&Lh.extractPropsAndMeasurements(e.baseData,r,i),Lh.extractPropsAndMeasurements(e.data,r,i);var n=e.baseData.name,o=new np(t,n,r,i),a=new nh(np.dataType,o);return Lh.createEnvelope(t,np.envelopeType,e,a)},Fh.EventEnvelopeCreator=new Fh,Fh);function Fh(){return null!==Nh&&Nh.apply(this,arguments)||this}var Uh,jh=(b(qh,Uh=Lh),qh.prototype.Create=function(t,e){this._logger=t,nu.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(au.CRITICAL,tc,"telemetryItem.baseData cannot be null.");var r=e.baseData,i=hp.CreateFromInterface(t,r),n=new nh(hp.dataType,i);return Lh.createEnvelope(t,hp.envelopeType,e,n)},qh.ExceptionEnvelopeCreator=new qh,qh);function qh(){return null!==Uh&&Uh.apply(this,arguments)||this}var Vh,Gh=(b(Zh,Vh=Lh),Zh.prototype.Create=function(t,e){this._logger=t,nu.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(au.CRITICAL,tc,"telemetryItem.baseData cannot be null.");var r=e.baseData.properties||{},i=Lh.extractProperties(e.data);i=w({},r,i);var n=e.baseData.name,o=e.baseData.average,a=e.baseData.sampleCount,s=e.baseData.min,l=e.baseData.max,u=new Ap(t,n,o,a,s,l,i),c=new nh(Ap.dataType,u);return Lh.createEnvelope(t,Ap.envelopeType,e,c)},Zh.MetricEnvelopeCreator=new Zh,Zh);function Zh(){return null!==Vh&&Vh.apply(this,arguments)||this}var Hh,Wh=(b(Kh,Hh=Lh),Kh.prototype.Create=function(t,e){this._logger=t,nu.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(au.CRITICAL,tc,"telemetryItem.baseData cannot be null.");var r=void 0;nu.isNullOrUndefined(e.baseData)||nu.isNullOrUndefined(e.baseData.properties)||nu.isNullOrUndefined(e.baseData.properties.duration)?nu.isNullOrUndefined(e.data)||nu.isNullOrUndefined(e.data.duration)||(r=e.data.duration,delete e.data.duration):(r=e.baseData.properties.duration,delete e.baseData.properties.duration);var i,n=e.baseData;e.ext&&e.ext.trace&&e.ext.trace.traceID&&(i=e.ext.trace.traceID);var o=n.id||i,a=n.name,s=n.uri,l=n.properties||{},u=n.measurements||{};if(nu.isNullOrUndefined(n.refUri)||(l.refUri=n.refUri),nu.isNullOrUndefined(n.pageType)||(l.pageType=n.pageType),nu.isNullOrUndefined(n.isLoggedIn)||(l.isLoggedIn=n.isLoggedIn.toString()),!nu.isNullOrUndefined(n.properties)){var c=n.properties;for(var p in c)c.hasOwnProperty(p)&&(l[p]=c[p])}Lh.extractPropsAndMeasurements(e.data,l,u);var h=new Rp(t,a,s,r,l,u,o),d=new nh(Rp.dataType,h);return Lh.createEnvelope(t,Rp.envelopeType,e,d)},Kh.PageViewEnvelopeCreator=new Kh,Kh);function Kh(){return null!==Hh&&Hh.apply(this,arguments)||this}var Xh,Yh=(b(Jh,Xh=Lh),Jh.prototype.Create=function(t,e){this._logger=t,nu.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(au.CRITICAL,tc,"telemetryItem.baseData cannot be null.");var r=e.baseData,i=r.name,n=r.uri||r.url,o=r.properties||{},a=r.measurements||{};Lh.extractPropsAndMeasurements(e.data,o,a);var s=new $p(t,i,n,void 0,o,a,r),l=new nh($p.dataType,s);return Lh.createEnvelope(t,$p.envelopeType,e,l)},Jh.PageViewPerformanceEnvelopeCreator=new Jh,Jh);function Jh(){return null!==Xh&&Xh.apply(this,arguments)||this}var Qh,$h=(b(td,Qh=Lh),td.prototype.Create=function(t,e){this._logger=t,nu.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(au.CRITICAL,tc,"telemetryItem.baseData cannot be null.");var r=e.baseData.message,i=e.baseData.severityLevel,n=Lh.extractProperties(e.data),o=w({},n,e.baseData.properties),a=new Wp(t,r,i,o),s=new nh(Wp.dataType,a);return Lh.createEnvelope(t,Wp.envelopeType,e,s)},td.TraceEnvelopeCreator=new td,td);function td(){return null!==Qh&&Qh.apply(this,arguments)||this}var ed=(rd.prototype.serialize=function(t){var e=this._serializeObject(t,"root");return JSON.stringify(e)},rd.prototype._serializeObject=function(t,e){var r="__aiCircularRefCheck",i={};if(!t)return this._logger.throwInternal(au.CRITICAL,rc,"cannot serialize object because it is null or undefined",{name:e},!0),i;if(t[r])return this._logger.throwInternal(au.WARNING,nc,"Circular reference detected while serializing object",{name:e},!0),i;if(!t.aiDataContract){if("measurements"===e)i=this._serializeStringMap(t,"number",e);else if("properties"===e)i=this._serializeStringMap(t,"string",e);else if("tags"===e)i=this._serializeStringMap(t,"string",e);else if(Dc.isArray(t))i=this._serializeArray(t,e);else{this._logger.throwInternal(au.WARNING,ic,"Attempting to serialize an object which does not implement ISerializable",{name:e},!0);try{JSON.stringify(t),i=t}catch(t){this._logger.throwInternal(au.CRITICAL,rc,t&&"function"==typeof t.toString?t.toString():"Error serializing object",null,!0)}}return i}for(var n in t[r]=!0,t.aiDataContract){var o,a=t.aiDataContract[n],s="function"==typeof a?a()&Ql.Required:a&Ql.Required,l="function"==typeof a?a()&Ql.Hidden:a&Ql.Hidden,u=a&Ql.Array,c=void 0!==t[n],p="object"==typeof t[n]&&null!==t[n];!s||c||u?l||void 0!==(o=p?u?this._serializeArray(t[n],n):this._serializeObject(t[n],n):t[n])&&(i[n]=o):this._logger.throwInternal(au.CRITICAL,Du,"Missing required field specification. The field is required but not present on source",{field:n,name:e})}return delete t[r],i},rd.prototype._serializeArray=function(t,e){var r=void 0;if(t)if(Dc.isArray(t)){r=[];for(var i=0;i<t.length;i++){var n=t[i],o=this._serializeObject(n,e+"["+i+"]");r.push(o)}}else this._logger.throwInternal(au.CRITICAL,ac,"This field was specified as an array in the contract but the item is not an array.\r\n",{name:e},!0);return r},rd.prototype._serializeStringMap=function(t,e,r){var i=void 0;if(t)for(var n in i={},t){var o=t[n];if("string"===e)void 0===o?i[n]="undefined":null===o?i[n]="null":o.toString?i[n]=o.toString():i[n]="invalid field: toString() is not defined.";else if("number"===e)if(void 0===o)i[n]="undefined";else if(null===o)i[n]="null";else{var a=parseFloat(o);isNaN(a)?i[n]="NaN":i[n]=a}else i[n]="invalid field: "+r+" is of unknown type.",this._logger.throwInternal(au.CRITICAL,i[n],null,!0)}return i},rd);function rd(t){this._logger=t}function id(){this._onlineStatus=!0;try{"undefined"==typeof window?this.isListening=!1:window&&window.addEventListener?(window.addEventListener("online",this._setOnline.bind(this),!1),window.addEventListener("offline",this._setOffline.bind(this),!1),this.isListening=!0):document&&document.body?(document.body.ononline=this._setOnline.bind(this),document.body.onoffline=this._setOffline.bind(this),this.isListening=!0):document?(document.ononline=this._setOnline.bind(this),document.onoffline=this._setOffline.bind(this),this.isListening=!0):this.isListening=!1}catch(t){this.isListening=!1}}var nd=(id.prototype._setOnline=function(){this._onlineStatus=!0},id.prototype._setOffline=function(){this._onlineStatus=!1},id.prototype.isOnline=function(){return this.isListening?this._onlineStatus:!(navigator&&!nu.isNullOrUndefined(navigator.onLine))||navigator.onLine},id.prototype.isOffline=function(){return!this.isOnline()},id.Offline=new id,id).Offline,od=(ad.prototype.getHashCodeScore=function(t){return this.getHashCode(t)/ad.INT_MAX_VALUE*100},ad.prototype.getHashCode=function(t){if(""==t)return 0;for(;t.length<ad.MIN_INPUT_LENGTH;)t=t.concat(t);for(var e=5381,r=0;r<t.length;++r)e=(e<<5)+e+t.charCodeAt(r),e&=e;return Math.abs(e)},ad.INT_MAX_VALUE=2147483647,ad.MIN_INPUT_LENGTH=8,ad);function ad(){}var sd=(ld.prototype.getSamplingScore=function(t){return t.tags&&t.tags[this.keys.userId]?this.hashCodeGeneragor.getHashCodeScore(t.tags[this.keys.userId]):t.ext&&t.ext.user&&t.ext.user.id?this.hashCodeGeneragor.getHashCodeScore(t.ext.user.id):t.tags&&t.tags[this.keys.operationId]?this.hashCodeGeneragor.getHashCodeScore(t.tags[this.keys.operationId]):t.ext&&t.ext.telemetryTrace&&t.ext.telemetryTrace.traceID?this.hashCodeGeneragor.getHashCodeScore(t.ext.telemetryTrace.traceID):100*Math.random()},ld);function ld(){this.hashCodeGeneragor=new od,this.keys=new lh}var ud=(cd.prototype.isSampledIn=function(t){var e=this.sampleRate;return null==e||100<=e||t.baseType===Ap.dataType||this.samplingScoreGenerator.getSamplingScore(t)<e},cd);function cd(t,e){this.INT_MAX_VALUE=2147483647,nu.isNullOrUndefined(e)?this._logger=new Tc:this._logger=e,(100<t||t<0)&&(this._logger.throwInternal(au.WARNING,cc,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:t},!0),this.sampleRate=100),this.sampleRate=t,this.samplingScoreGenerator=new sd}var pd=(hd.prototype.pause=function(){throw new Error("Method not implemented.")},hd.prototype.resume=function(){throw new Error("Method not implemented.")},hd.prototype.flush=function(){try{this.triggerSend()}catch(t){this._logger.throwInternal(au.CRITICAL,Lu,"flush failed, telemetry will not be collected: "+Dc.getExceptionName(t),{exception:Dc.dump(t)})}},hd.prototype.onunloadFlush=function(){if(!1!==this._config.onunloadDisableBeacon()&&!1!==this._config.isBeaconApiDisabled()||!Dc.IsBeaconApiSupported())this.flush();else try{this.triggerSend(!0,this._beaconSender)}catch(t){this._logger.throwInternal(au.CRITICAL,Mu,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+Dc.getExceptionName(t),{exception:Dc.dump(t)})}},hd.prototype.teardown=function(){throw new Error("Method not implemented.")},hd.prototype.initialize=function(e,t,r){var i=this;this._logger=t.logger,this._serializer=new ed(t.logger),this._consecutiveErrors=0,this._retryAt=null,this._lastSend=0,this._sender=null;var n=hd._getDefaultAppInsightsChannelConfig();function o(t){a._config[t]=function(){return ah.getConfig(e,t,i.identifier,n[t]())}}this._config=hd._getEmptyAppInsightsChannelConfig();var a=this;for(var s in n)o(s);this._buffer=this._config.enableSessionStorageBuffer&&Dc.canUseSessionStorage()?new Ph(this._logger,this._config):new kh(this._config),this._sample=new ud(this._config.samplingPercentage(),this._logger),!this._config.isBeaconApiDisabled()&&Dc.IsBeaconApiSupported()?this._sender=this._beaconSender:"undefined"!=typeof XMLHttpRequest&&("withCredentials"in new XMLHttpRequest?(this._sender=this._xhrSender,this._XMLHttpRequestSupported=!0):"undefined"!=typeof XDomainRequest&&(this._sender=this._xdrSender))},hd.prototype.processTelemetry=function(t){var e=this;try{if(this._config.disableTelemetry())return;if(!t)return void this._logger.throwInternal(au.CRITICAL,vu,"Cannot send empty telemetry");if(t.baseData&&!t.baseType)return void this._logger.throwInternal(au.CRITICAL,xc,"Cannot send telemetry without baseData and baseType");if(t.baseType||(t.baseType="EventData"),!this._sender)return void this._logger.throwInternal(au.CRITICAL,Bu,"Sender was not initialized");if(!this._isSampledIn(t))return void this._logger.throwInternal(au.WARNING,Vu,"Telemetry item was sampled out and not sent",{SampleRate:this._sample.sampleRate});t.tags=t.tags||{},t.tags.sampleRate=this._sample.sampleRate;var r=hd.constructEnvelope(t,this._config.instrumentationKey(),this._logger);if(!r)return void this._logger.throwInternal(au.CRITICAL,ec,"Unable to create an AppInsights envelope");var i=!1;if(t.tags&&t.tags[Hc]&&(t.tags[Hc].forEach(function(t){try{t&&!1===t(r)&&(i=!0,e._logger.warnToConsole("Telemetry processor check returns false"))}catch(t){e._logger.throwInternal(au.CRITICAL,mc,"One of telemetry initializers failed, telemetry item will not be sent: "+Dc.getExceptionName(t),{exception:Dc.dump(t)},!0)}}),delete t.tags[Hc]),i)return;var n=this._serializer.serialize(r),o=this._buffer.getItems(),a=this._buffer.batchPayloads(o);a&&a.length+n.length>this._config.maxBatchSizeInBytes()&&this.triggerSend(),this._buffer.enqueue(n),this._setupTimer()}catch(t){this._logger.throwInternal(au.WARNING,Su,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+Dc.getExceptionName(t),{exception:Dc.dump(t)})}nu.isNullOrUndefined(this._nextPlugin)||this._nextPlugin.processTelemetry(t)},hd.prototype.setNextPlugin=function(t){this._nextPlugin=t},hd.prototype._xhrReadyStateChange=function(t,e,r){if(4===t.readyState){var i=null;this._appId||(i=this._parseResponse(t.responseText||t.response))&&i.appId&&(this._appId=i.appId),(t.status<200||300<=t.status)&&0!==t.status?!this._config.isRetryDisabled()&&this._isRetriable(t.status)?(this._resendPayload(e),this._logger.throwInternal(au.WARNING,Xu,". Response code "+t.status+". Will retry to send "+e.length+" items.")):this._onError(e,this._formatErrorMessageXhr(t)):nd.isOffline()?this._config.isRetryDisabled()||(this._resendPayload(e,10),this._logger.throwInternal(au.WARNING,Xu,". Offline - Response Code: "+t.status+". Offline status: "+nd.isOffline()+". Will retry to send "+e.length+" items.")):206===t.status?(i=i||this._parseResponse(t.responseText||t.response))&&!this._config.isRetryDisabled()?this._onPartialSuccess(e,i):this._onError(e,this._formatErrorMessageXhr(t)):(this._consecutiveErrors=0,this._onSuccess(e,r))}},hd.prototype.triggerSend=function(t,e){void 0===t&&(t=!0);try{if(this._config.disableTelemetry())this._buffer.clear();else{if(0<this._buffer.count()){var r=this._buffer.getItems();e?e.call(this,r,t):this._sender(r,t)}this._lastSend=+new Date}clearTimeout(this._timeoutHandle),this._timeoutHandle=null,this._retryAt=null}catch(t){(!Dc.getIEVersion()||9<Dc.getIEVersion())&&this._logger.throwInternal(au.CRITICAL,Xu,"Telemetry transmission failed, some telemetry will be lost: "+Dc.getExceptionName(t),{exception:Dc.dump(t)})}},hd.prototype._onError=function(t,e,r){this._logger.throwInternal(au.WARNING,zu,"Failed to send telemetry.",{message:e}),this._buffer.clearSent(t)},hd.prototype._onPartialSuccess=function(t,e){for(var r=[],i=[],n=0,o=e.errors.reverse();n<o.length;n++){var a=o[n],s=t.splice(a.index,1)[0];this._isRetriable(a.statusCode)?i.push(s):r.push(s)}0<t.length&&this._onSuccess(t,e.itemsAccepted),0<r.length&&this._onError(r,this._formatErrorMessageXhr(null,["partial success",e.itemsAccepted,"of",e.itemsReceived].join(" "))),0<i.length&&(this._resendPayload(i),this._logger.throwInternal(au.WARNING,Xu,"Partial success. Delivered: "+t.length+", Failed: "+r.length+". Will retry to send "+i.length+" our of "+e.itemsReceived+" items"))},hd.prototype._onSuccess=function(t,e){this._buffer.clearSent(t)},hd.prototype._xdrOnLoad=function(t,e){if(!t||t.responseText+""!="200"&&""!==t.responseText){var r=this._parseResponse(t.responseText);r&&r.itemsReceived&&r.itemsReceived>r.itemsAccepted&&!this._config.isRetryDisabled()?this._onPartialSuccess(e,r):this._onError(e,this._formatErrorMessageXdr(t))}else this._consecutiveErrors=0,this._onSuccess(e,0)},hd.constructEnvelope=function(t,e,r){var i;switch((i=e===t.iKey||nu.isNullOrUndefined(e)?t:w({},t,{iKey:e})).baseType){case np.dataType:return Bh.EventEnvelopeCreator.Create(r,i);case Wp.dataType:return $h.TraceEnvelopeCreator.Create(r,i);case Rp.dataType:return Wh.PageViewEnvelopeCreator.Create(r,i);case $p.dataType:return Yh.PageViewPerformanceEnvelopeCreator.Create(r,i);case hp.dataType:return jh.ExceptionEnvelopeCreator.Create(r,i);case Ap.dataType:return Gh.MetricEnvelopeCreator.Create(r,i);case jp.dataType:return Rh.DependencyEnvelopeCreator.Create(r,i);default:return Bh.EventEnvelopeCreator.Create(r,i)}},hd._getDefaultAppInsightsChannelConfig=function(){return{endpointUrl:function(){return"https://dc.services.visualstudio.com/v2/track"},emitLineDelimitedJson:function(){return!1},maxBatchInterval:function(){return 15e3},maxBatchSizeInBytes:function(){return 102400},disableTelemetry:function(){return!1},enableSessionStorageBuffer:function(){return!0},isRetryDisabled:function(){return!1},isBeaconApiDisabled:function(){return!0},onunloadDisableBeacon:function(){return!1},instrumentationKey:function(){},namePrefix:function(){},samplingPercentage:function(){return 100}}},hd._getEmptyAppInsightsChannelConfig=function(){return{endpointUrl:void 0,emitLineDelimitedJson:void 0,maxBatchInterval:void 0,maxBatchSizeInBytes:void 0,disableTelemetry:void 0,enableSessionStorageBuffer:void 0,isRetryDisabled:void 0,isBeaconApiDisabled:void 0,onunloadDisableBeacon:void 0,instrumentationKey:void 0,namePrefix:void 0,samplingPercentage:void 0}},hd.prototype._isSampledIn=function(t){return this._sample.isSampledIn(t)},hd.prototype._beaconSender=function(t,e){var r=this._config.endpointUrl(),i=this._buffer.batchPayloads(t),n=new Blob([i],{type:"text/plain;charset=UTF-8"});navigator.sendBeacon(r,n)?(this._buffer.markAsSent(t),this._onSuccess(t,t.length)):(this._xhrSender(t,!0),this._logger.throwInternal(au.WARNING,Xu,". Failed to send telemetry with Beacon API, retried with xhrSender."))},hd.prototype._xhrSender=function(e,t){var r=this,i=new XMLHttpRequest;i[Zc]=!0,i.open("POST",this._config.endpointUrl(),t),i.setRequestHeader("Content-type","application/json"),Dc.isInternalApplicationInsightsEndpoint(this._config.endpointUrl())&&i.setRequestHeader(Pc.sdkContextHeader,Pc.sdkContextHeaderAppIdRequest),i.onreadystatechange=function(){return r._xhrReadyStateChange(i,e,e.length)},i.onerror=function(t){return r._onError(e,r._formatErrorMessageXhr(i),t)};var n=this._buffer.batchPayloads(e);i.send(n),this._buffer.markAsSent(e)},hd.prototype._parseResponse=function(e){try{if(e&&""!==e){var t=JSON.parse(e);if(t&&t.itemsReceived&&t.itemsReceived>=t.itemsAccepted&&t.itemsReceived-t.itemsAccepted==t.errors.length)return t}}catch(t){this._logger.throwInternal(au.CRITICAL,Qu,"Cannot parse the response. "+Dc.getExceptionName(t),{response:e})}return null},hd.prototype._resendPayload=function(t,e){if(void 0===e&&(e=1),t&&0!==t.length){this._buffer.clearSent(t),this._consecutiveErrors++;for(var r=0,i=t;r<i.length;r++){var n=i[r];this._buffer.enqueue(n)}this._setRetryTime(e),this._setupTimer()}},hd.prototype._setRetryTime=function(t){var e;if(this._consecutiveErrors<=1)e=10;else{var r=(Math.pow(2,this._consecutiveErrors)-1)/2,i=Math.floor(Math.random()*r*10)+1;i*=t,e=Math.max(Math.min(i,3600),10)}var n=Date.now()+1e3*e;this._retryAt=n},hd.prototype._setupTimer=function(){var t=this;if(!this._timeoutHandle){var e=this._retryAt?Math.max(0,this._retryAt-Date.now()):0,r=Math.max(this._config.maxBatchInterval(),e);this._timeoutHandle=setTimeout(function(){t.triggerSend()},r)}},hd.prototype._isRetriable=function(t){return 408==t||429==t||500==t||503==t},hd.prototype._formatErrorMessageXhr=function(t,e){return t?"XMLHttpRequest,Status:"+t.status+",Response:"+t.responseText||t.response||"":e},hd.prototype._xdrSender=function(e,t){var r=this,i=new XDomainRequest;i.onload=function(){return r._xdrOnLoad(i,e)},i.onerror=function(t){return r._onError(e,r._formatErrorMessageXdr(i),t)};var n=window.location&&window.location.protocol;if(0!==this._config.endpointUrl().lastIndexOf(n,0))return this._logger.throwInternal(au.WARNING,Xu,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),void this._buffer.clear();var o=this._config.endpointUrl().replace(/^(https?:)/,"");i.open("POST",o);var a=this._buffer.batchPayloads(e);i.send(a),this._buffer.markAsSent(e)},hd.prototype._formatErrorMessageXdr=function(t,e){return t?"XDomainRequest,Response:"+t.responseText||"":e},hd);function hd(){this.priority=1001,this.identifier=mh,this._XMLHttpRequestSupported=!1}var dd=function(){},fd=(md.prototype.update=function(){this.automaticSession.id||this.initializeAutomaticSession();var t=qc.Now(),e=t-this.automaticSession.acquisitionDate>this.config.sessionExpirationMs(),r=t-this.automaticSession.renewalDate>this.config.sessionRenewalMs();e||r?this.renew():(!this.cookieUpdatedTimestamp||t-this.cookieUpdatedTimestamp>md.cookieUpdateInterval)&&(this.automaticSession.renewalDate=t,this.setCookie(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate))},md.prototype.backup=function(){this.setStorage(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate)},md.prototype.initializeAutomaticSession=function(){var t=Dc.getCookie(this._logger,this._storageNamePrefix());if(t&&"function"==typeof t.split)this.initializeAutomaticSessionWithData(t);else{var e=Dc.getStorage(this._logger,this._storageNamePrefix());e&&this.initializeAutomaticSessionWithData(e)}this.automaticSession.id||this.renew()},md.prototype.initializeAutomaticSessionWithData=function(t){var e=t.split("|");0<e.length&&(this.automaticSession.id=e[0]);try{if(1<e.length){var r=+e[1];this.automaticSession.acquisitionDate=+new Date(r),this.automaticSession.acquisitionDate=0<this.automaticSession.acquisitionDate?this.automaticSession.acquisitionDate:0}if(2<e.length){var i=+e[2];this.automaticSession.renewalDate=+new Date(i),this.automaticSession.renewalDate=0<this.automaticSession.renewalDate?this.automaticSession.renewalDate:0}}catch(t){this._logger.throwInternal(au.CRITICAL,xu,"Error parsing ai_session cookie, session will be reset: "+Dc.getExceptionName(t),{exception:Dc.dump(t)})}0==this.automaticSession.renewalDate&&this._logger.throwInternal(au.WARNING,Nu,"AI session renewal date is 0, session will be reset.")},md.prototype.renew=function(){var t=qc.Now();this.automaticSession.id=Dc.newId(),this.automaticSession.acquisitionDate=t,this.automaticSession.renewalDate=t,this.setCookie(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate),Dc.canUseLocalStorage()||this._logger.throwInternal(au.WARNING,pu,"Browser does not support local storage. Session durations will be inaccurate.")},md.prototype.setCookie=function(t,e,r){var i=e+this.config.sessionExpirationMs(),n=r+this.config.sessionRenewalMs(),o=new Date,a=[t,e,r];i<n?o.setTime(i):o.setTime(n);var s=this.config.cookieDomain?this.config.cookieDomain():null;Dc.setCookie(this._logger,this._storageNamePrefix(),a.join("|")+";expires="+o.toUTCString(),s),this.cookieUpdatedTimestamp=qc.Now()},md.prototype.setStorage=function(t,e,r){Dc.setStorage(this._logger,this._storageNamePrefix(),[t,e,r].join("|"))},md.acquisitionSpan=864e5,md.renewalSpan=18e5,md.cookieUpdateInterval=6e4,md.cookieNameConst="ai_session",md);function md(t,e){var r=this;nu.isNullOrUndefined(e)?this._logger=new Tc:this._logger=e,"function"!=typeof(t=t||{}).sessionExpirationMs&&(t.sessionExpirationMs=function(){return md.acquisitionSpan}),"function"!=typeof t.sessionRenewalMs&&(t.sessionRenewalMs=function(){return md.renewalSpan}),this.config=t,this._storageNamePrefix=function(){return r.config.namePrefix&&r.config.namePrefix()?md.cookieNameConst+r.config.namePrefix():md.cookieNameConst},this.automaticSession=new dd}var gd=function(){},yd=function(){this.id="browser",this.deviceClass="Browser"},vd=function(t){this.sdkVersion=(t.sdkExtension&&t.sdkExtension()?t.sdkExtension()+"_":"")+"javascript:2.2.2"},_d=(xd.prototype.setAuthenticatedUserContext=function(t,e,r){if(void 0===r&&(r=!1),!this.validateUserInput(t)||e&&!this.validateUserInput(e))this._logger.throwInternal(au.WARNING,pc,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);else{this.authenticatedId=t;var i=this.authenticatedId;e&&(this.accountId=e,i=[this.authenticatedId,this.accountId].join(xd.cookieSeparator)),r&&Dc.setCookie(this._logger,xd.authUserCookieName,encodeURI(i),this.config.cookieDomain())}},xd.prototype.clearAuthenticatedUserContext=function(){this.authenticatedId=null,this.accountId=null,Dc.deleteCookie(this._logger,xd.authUserCookieName)},xd.prototype.validateUserInput=function(t){return!("string"!=typeof t||!t||t.match(/,|;|=| |\|/))},xd.cookieSeparator="|",xd.userCookieName="ai_user",xd.authUserCookieName="ai_authUser",xd);function xd(t,e){this._logger=e;var r=Dc.getCookie(this._logger,xd.userCookieName);if(r){var i=r.split(xd.cookieSeparator);0<i.length&&(this.id=i[0])}if(this.config=t,!this.id){this.id=Dc.newId();var n=new Date,o=Dc.toISOStringForIE8(n);this.accountAcquisitionDate=o,n.setTime(n.getTime()+31536e6);var a=[this.id,o],s=this.config.cookieDomain?this.config.cookieDomain():void 0;Dc.setCookie(this._logger,xd.userCookieName,a.join(xd.cookieSeparator)+";expires="+n.toUTCString(),s);var l=t.namePrefix&&t.namePrefix()?t.namePrefix()+"ai_session":"ai_session";Dc.removeStorage(this._logger,l)}this.accountId=t.accountId?t.accountId():void 0;var u=Dc.getCookie(this._logger,xd.authUserCookieName);if(u){var c=(u=decodeURI(u)).split(xd.cookieSeparator);c[0]&&(this.authenticatedId=c[0]),1<c.length&&c[1]&&(this.accountId=c[1])}}var bd=function(){},wd=function(t,e,r){this.traceID=t||Dc.generateW3CId(),this.parentID=e,this.name=r,window&&window.location&&window.location.pathname&&(this.name=window.location.pathname)},Sd=(Td.prototype.applySessionContext=function(t){var e=this.session||this.sessionManager.automaticSession;e&&"string"==typeof e.id&&(t.ext.app.sesId=e.id),this.session&&("string"==typeof this.session.id?t.ext.app.sesId=this.session.id:t.ext.app.sesId=this.sessionManager.automaticSession.id)},Td.prototype.applyOperatingSystemContxt=function(t){this.os&&this.os.name&&(t.ext.os=this.os)},Td.prototype.applyApplicationContext=function(t){this.application&&("string"==typeof this.application.ver&&(t.tags[dh.applicationVersion]=this.application.ver),"string"==typeof this.application.build&&(t.tags[dh.applicationBuild]=this.application.build))},Td.prototype.applyDeviceContext=function(t){this.device&&("string"==typeof this.device.id&&(t.ext.device.localId=this.device.id),"string"==typeof this.device.ip&&(t.ext.device.ip=this.device.ip),"string"==typeof this.device.model&&(t.ext.device.model=this.device.model),"string"==typeof this.device.deviceClass&&(t.ext.device.deviceClass=this.device.deviceClass))},Td.prototype.applyInternalContext=function(t){this.internal&&("string"==typeof this.internal.agentVersion&&(t.tags[dh.internalAgentVersion]=this.internal.agentVersion),"string"==typeof this.internal.sdkVersion&&(t.tags[dh.internalSdkVersion]=this.internal.sdkVersion))},Td.prototype.applyLocationContext=function(t){this.location&&"string"==typeof this.location.ip&&(t.tags[dh.locationIp]=this.location.ip)},Td.prototype.applyOperationContext=function(t){if(this.telemetryTrace){var e=t.ext.trace||{traceID:void 0,parentID:void 0};"string"==typeof this.telemetryTrace.traceID&&(e.traceID=this.telemetryTrace.traceID),"string"==typeof this.telemetryTrace.name&&(e.name=this.telemetryTrace.name),"string"==typeof this.telemetryTrace.parentID&&(e.parentID=this.telemetryTrace.parentID),t.ext.trace=e}},Td.prototype.applyWebContext=function(t){this.web&&(t.ext.web=t.ext.web||{},t.ext.web=this.web)},Td.prototype.applyUserContext=function(t){this.user&&(t.tags||(t.tags=[]),"string"==typeof this.user.accountId&&(t.tags[dh.userAccountId]=this.user.accountId),"string"==typeof this.user.id&&(t.ext.user.id=this.user.id),"string"==typeof this.user.authenticatedId&&(t.ext.user.authId=this.user.authenticatedId))},Td.prototype.cleanUp=function(t){t.ext[ph.DeviceExt]&&0===Object.keys(t.ext[ph.DeviceExt]).length&&delete t.ext[ph.DeviceExt],t.ext[ph.UserExt]&&0===Object.keys(t.ext[ph.UserExt]).length&&delete t.ext[ph.UserExt],t.ext[ph.WebExt]&&0===Object.keys(t.ext[ph.WebExt]).length&&delete t.ext[ph.WebExt],t.ext[ph.OSExt]&&0===Object.keys(t.ext[ph.OSExt]).length&&delete t.ext[ph.OSExt],t.ext[ph.AppExt]&&0===Object.keys(t.ext[ph.AppExt]).length&&delete t.ext[ph.AppExt],t.ext[ph.TraceExt]&&0===Object.keys(t.ext[ph.TraceExt]).length&&delete t.ext[ph.TraceExt]},Td);function Td(t,e){"undefined"!=typeof window&&(this.sessionManager=new fd(e,t),this.application=new gd,this.device=new yd,this.internal=new vd(e),this.location=new bd,this.user=new _d(e,t),this.telemetryTrace=new wd,this.session=new dd),this.appId=function(){return null}}var Ed=(Id.getDefaultConfig=function(){return{instrumentationKey:function(){},accountId:function(){return null},sessionRenewalMs:function(){return 18e5},samplingPercentage:function(){return 100},sessionExpirationMs:function(){return 864e5},cookieDomain:function(){return null},sdkExtension:function(){return null},isBrowserLinkTrackingEnabled:function(){return!1},appId:function(){return null},namePrefix:function(){}}},Id.prototype.initialize=function(e,t,r){var i=this,n=Id.getDefaultConfig();function o(t){a._extensionConfig[t]=function(){return ah.getConfig(e,t,i.identifier,n[t]())}}this._extensionConfig=this._extensionConfig||Id.getDefaultConfig();var a=this;for(var s in n)o(s);this._logger=t.logger,this.context=new Sd(t.logger,this._extensionConfig),this._breezeChannel=Dc.getExtension(r,mh),this.context.appId=function(){return i._breezeChannel?i._breezeChannel._appId:null}},Id.prototype.processTelemetry=function(t){nu.isNullOrUndefined(t)||(t.name===Rp.envelopeType&&this._logger.resetInternalMessageCount(),this.context.session&&"string"!=typeof this.context.session.id&&this.context.sessionManager.update(),this._processTelemetryInternal(t),nu.isNullOrUndefined(this._nextPlugin)||this._nextPlugin.processTelemetry(t))},Id.prototype.setNextPlugin=function(t){this._nextPlugin=t},Id.prototype._processTelemetryInternal=function(t){t.tags||(t.tags=[]),t.ext||(t.ext={}),t.ext[ph.DeviceExt]=t.ext[ph.DeviceExt]||{},t.ext[ph.WebExt]=t.ext[ph.WebExt]||{},t.ext[ph.UserExt]=t.ext[ph.UserExt]||{},t.ext[ph.OSExt]=t.ext[ph.OSExt]||{},t.ext[ph.AppExt]=t.ext[ph.AppExt]||{},t.ext[ph.TraceExt]=t.ext[ph.TraceExt]||{},this.context.applySessionContext(t),this.context.applyApplicationContext(t),this.context.applyDeviceContext(t),this.context.applyOperationContext(t),this.context.applyUserContext(t),this.context.applyOperatingSystemContxt(t),this.context.applyWebContext(t),this.context.applyLocationContext(t),this.context.applyInternalContext(t),this.context.cleanUp(t)},Id);function Id(){this.priority=110,this.identifier=fh}var Cd=function(){this.openDone=!1,this.setRequestHeaderDone=!1,this.sendDone=!1,this.abortDone=!1,this.onreadystatechangeCallbackAttached=!1},kd=(Ad.prototype.getAbsoluteUrl=function(){return this.requestUrl?zc.getAbsoluteUrl(this.requestUrl):null},Ad.prototype.getPathName=function(){return this.requestUrl?Lc.sanitizeUrl(this._logger,zc.getCompleteUrl(this.method,this.requestUrl)):null},Ad);function Ad(t,e,r){this.completed=!1,this.requestHeadersSize=null,this.requestHeaders=null,this.ttfb=null,this.responseReceivingDuration=null,this.callbackDuration=null,this.ajaxTotalDuration=null,this.aborted=null,this.pageUrl=null,this.requestUrl=null,this.requestSize=0,this.method=null,this.status=null,this.requestSentTime=null,this.responseStartedTime=null,this.responseFinishedTime=null,this.callbackFinishedTime=null,this.endTime=null,this.originalOnreadystatechage=null,this.xhrMonitoringState=new Cd,this.clientFailure=0,this.CalculateMetrics=function(){this.ajaxTotalDuration=Math.round(1e3*qc.GetDuration(this.requestSentTime,this.responseFinishedTime))/1e3},this.traceID=t,this.spanID=e,this._logger=r}var Pd=(Md.AttachEvent=function(t,e,r){var i=!1;return nu.isNullOrUndefined(t)||(nu.isNullOrUndefined(t.attachEvent)?nu.isNullOrUndefined(t.addEventListener)||(t.addEventListener(e,r,!1),i=!0):(t.attachEvent("on"+e,r),i=!0)),i},Md.DetachEvent=function(t,e,r){nu.isNullOrUndefined(t)||(nu.isNullOrUndefined(t.detachEvent)?nu.isNullOrUndefined(t.removeEventListener)||t.removeEventListener(e,r,!1):t.detachEvent("on"+e,r))},Md);function Md(){}var Ld=(Od.isValidTraceId=function(t){return t.match(/^[0-9a-f]{32}$/)&&"00000000000000000000000000000000"!==t},Od.isValidSpanId=function(t){return t.match(/^[0-9a-f]{16}$/)&&"0000000000000000"!==t},Od.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},Od.DEFAULT_TRACE_FLAG="00",Od.DEFAULT_VERSION="00",Od);function Od(t,e){this.traceFlag=Od.DEFAULT_TRACE_FLAG,this.version=Od.DEFAULT_VERSION,t&&Od.isValidTraceId(t)?this.traceId=t:this.traceId=Dc.generateW3CId(),e&&Od.isValidSpanId(e)?this.spanId=e:this.spanId=Dc.generateW3CId().substr(0,16)}var Dd=(Rd.prototype.isMonitoredInstance=function(t,e,r,i){var n=!1,o=!0,a=!1;return void 0!==r?(a=this._fetchInitialized,n="object"==typeof r&&!0===r[Zc]||!!i&&!0===i[Zc]):void 0!==t&&(a=this.initialized,n=!0===t[Zc],o=!0===e||!nu.isNullOrUndefined(t.ajaxData)),a&&o&&!n},Rd.prototype.supportsAjaxMonitoring=function(){var e=!0;(nu.isNullOrUndefined(XMLHttpRequest)||nu.isNullOrUndefined(XMLHttpRequest.prototype)||nu.isNullOrUndefined(XMLHttpRequest.prototype.open)||nu.isNullOrUndefined(XMLHttpRequest.prototype.send)||nu.isNullOrUndefined(XMLHttpRequest.prototype.abort))&&(e=!1);try{" a ".trim()}catch(t){e=!1}return e},Rd.prototype.instrumentOpen=function(){var i=XMLHttpRequest.prototype.open,n=this;XMLHttpRequest.prototype.open=function(t,e,r){try{!n.isMonitoredInstance(this,!0)||this.ajaxData&&this.ajaxData.xhrMonitoringState.openDone||n.openHandler(this,t,e,r)}catch(t){n._core.logger.throwInternal(au.CRITICAL,Iu,"Failed to monitor XMLHttpRequest.open, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Rd.getFailedAjaxDiagnosticsMessage(this),exception:Dc.dump(t)})}return i.apply(this,arguments)}},Rd.prototype.openHandler=function(t,e,r,i){var n=this._context&&this._context.telemetryTrace&&this._context.telemetryTrace.traceID||Dc.generateW3CId(),o=Dc.generateW3CId().substr(0,16),a=new kd(n,o,this._core.logger);a.method=e,a.requestUrl=r,a.xhrMonitoringState.openDone=!0,a.requestHeaders={},t.ajaxData=a,this.attachToOnReadyStateChange(t)},Rd.getFailedAjaxDiagnosticsMessage=function(t){var e="";try{nu.isNullOrUndefined(t)||nu.isNullOrUndefined(t.ajaxData)||nu.isNullOrUndefined(t.ajaxData.requestUrl)||(e+="(url: '"+t.ajaxData.requestUrl+"')")}catch(t){}return e},Rd.prototype.instrumentSend=function(){var e=XMLHttpRequest.prototype.send,r=this;XMLHttpRequest.prototype.send=function(t){try{r.isMonitoredInstance(this)&&!this.ajaxData.xhrMonitoringState.sendDone&&r.sendHandler(this,t)}catch(t){r._core.logger.throwInternal(au.CRITICAL,ku,"Failed to monitor XMLHttpRequest, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Rd.getFailedAjaxDiagnosticsMessage(this),exception:Dc.dump(t)})}return e.apply(this,arguments)}},Rd.prototype.sendHandler=function(t,e){t.ajaxData.requestSentTime=qc.Now(),(t=this.includeCorrelationHeaders(t.ajaxData,void 0,void 0,t)).ajaxData.xhrMonitoringState.sendDone=!0},Rd.prototype.instrumentAbort=function(){var t=XMLHttpRequest.prototype.abort,e=this;XMLHttpRequest.prototype.abort=function(){try{e.isMonitoredInstance(this)&&!this.ajaxData.xhrMonitoringState.abortDone&&(this.ajaxData.aborted=1,this.ajaxData.xhrMonitoringState.abortDone=!0)}catch(t){e._core.logger.throwInternal(au.CRITICAL,Tu,"Failed to monitor XMLHttpRequest.abort, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Rd.getFailedAjaxDiagnosticsMessage(this),exception:Dc.dump(t)})}return t.apply(this,arguments)}},Rd.prototype.instrumentSetRequestHeader=function(){if(this._config.enableRequestHeaderTracking){var r=XMLHttpRequest.prototype.setRequestHeader,i=this;XMLHttpRequest.prototype.setRequestHeader=function(t,e){try{i.isMonitoredInstance(this)&&(this.ajaxData.requestHeaders[t]=e)}catch(t){i._core.logger.throwInternal(au.CRITICAL,bc,"Failed to monitor XMLHttpRequest.setRequestHeader, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Rd.getFailedAjaxDiagnosticsMessage(this),exception:Dc.dump(t)})}return r.apply(this,arguments)}}},Rd.prototype.attachToOnReadyStateChange=function(r){var i=this;r.ajaxData.xhrMonitoringState.onreadystatechangeCallbackAttached=Pd.AttachEvent(r,"readystatechange",function(){try{i.isMonitoredInstance(r)&&4===r.readyState&&i.onAjaxComplete(r)}catch(t){var e=Dc.dump(t);e&&-1!=e.toLowerCase().indexOf("c00c023f")||i._core.logger.throwInternal(au.CRITICAL,Cu,"Failed to monitor XMLHttpRequest 'readystatechange' event handler, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Rd.getFailedAjaxDiagnosticsMessage(r),exception:Dc.dump(t)})}})},Rd.prototype.onAjaxComplete=function(t){if(t.ajaxData.responseFinishedTime=qc.Now(),t.ajaxData.status=t.status,t.ajaxData.CalculateMetrics(),t.ajaxData.ajaxTotalDuration<0)this._core.logger.throwInternal(au.WARNING,Eu,"Failed to calculate the duration of the ajax call, monitoring data for this ajax call won't be sent.",{ajaxDiagnosticsMessage:Rd.getFailedAjaxDiagnosticsMessage(t),requestSentTime:t.ajaxData.requestSentTime,responseFinishedTime:t.ajaxData.responseFinishedTime});else{var e={id:"|"+t.ajaxData.traceID+"."+t.ajaxData.spanID,target:t.ajaxData.getAbsoluteUrl(),name:t.ajaxData.getPathName(),type:"Ajax",duration:t.ajaxData.ajaxTotalDuration,success:200<=+t.ajaxData.status&&+t.ajaxData.status<400,responseCode:+t.ajaxData.status,method:t.ajaxData.method},r=this.getAjaxCorrelationContext(t);if(r&&(e.correlationContext=r),this._config.enableRequestHeaderTracking&&0<Object.keys(t.ajaxData.requestHeaders).length&&(e.properties=e.properties||{},e.properties.requestHeaders={},e.properties.requestHeaders=t.ajaxData.requestHeaders),this._config.enableResponseHeaderTracking){var i=t.getAllResponseHeaders();if(i){var n=i.trim().split(/[\r\n]+/),o={};n.forEach(function(t){var e=t.split(": "),r=e.shift(),i=e.join(": ");o[r]=i}),0<Object.keys(o).length&&(e.properties=e.properties||{},e.properties.responseHeaders={},e.properties.responseHeaders=o)}}this.trackDependencyDataInternal(e),t.ajaxData=null}},Rd.prototype.getAjaxCorrelationContext=function(e){try{var t=e.getAllResponseHeaders();if(null!==t&&-1!==t.toLowerCase().indexOf(Pc.requestContextHeaderLowerCase)){var r=e.getResponseHeader(Pc.requestContextHeader);return Bc.getCorrelationContext(r)}}catch(t){this._core.logger.throwInternal(au.WARNING,Au,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{ajaxDiagnosticsMessage:Rd.getFailedAjaxDiagnosticsMessage(e),exception:Dc.dump(t)})}},Rd.prototype.trackDependencyDataInternal=function(t,e,r){if(-1===this._config.maxAjaxCallsPerView||this._trackAjaxAttempts<this._config.maxAjaxCallsPerView){var i=uh.create(t,jp.dataType,jp.envelopeType,this._core.logger,e,r);this._core.track(i)}else this._trackAjaxAttempts===this._config.maxAjaxCallsPerView&&this._core.logger.throwInternal(au.CRITICAL,sc,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++this._trackAjaxAttempts},Rd.prototype.trackDependencyData=function(t,e){this.trackDependencyDataInternal(t,e)},Rd.prototype.processTelemetry=function(t){this._nextPlugin&&this._nextPlugin.processTelemetry&&this._nextPlugin.processTelemetry(t)},Rd.prototype.setNextPlugin=function(t){t&&(this._nextPlugin=t)},Rd.prototype.instrumentFetch=function(){if(this.supportsFetch()&&!this._fetchInitialized){var i=window.fetch,n=this;window.fetch=function(e,t){var r;if(n.isFetchInstrumented(e)&&n.isMonitoredInstance(void 0,void 0,e,t))try{r=n.createFetchRecord(e,t),t=n.includeCorrelationHeaders(r,e,t)}catch(t){n._core.logger.throwInternal(au.CRITICAL,Iu,"Failed to monitor Window.fetch, monitoring data for this fetch call may be incorrect.",{ajaxDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(e),exception:Dc.dump(t)})}return i(e,t).then(function(t){return n.onFetchComplete(t,r),t}).catch(function(t){throw n.onFetchFailed(e,r,t),t})},this._fetchInitialized=!0}},Rd.prototype.isFetchInstrumented=function(t){return this._fetchInitialized&&!0!==t[Zc]},Rd.prototype.supportsFetch=function(){var t=!0;return(!window||nu.isNullOrUndefined(window.Request)||nu.isNullOrUndefined(window.Request.prototype)||nu.isNullOrUndefined(window.fetch))&&(t=!1),t},Rd.prototype.createFetchRecord=function(t,e){var r=this._context&&this._context.telemetryTrace&&this._context.telemetryTrace.traceID||Dc.generateW3CId(),i=Dc.generateW3CId().substr(0,16),n=new kd(r,i,this._core.logger);return n.requestSentTime=qc.Now(),t instanceof Request?n.requestUrl=t?t.url:"":n.requestUrl=t,e&&e.method?n.method=e.method:t&&t instanceof Request?n.method=t.method:n.method="GET",e&&e.headers&&this._config.enableRequestHeaderTracking?n.requestHeaders=e.headers:n.requestHeaders={},n},Rd.prototype.includeCorrelationHeaders=function(t,e,r,i){if(e){if(Bc.canIncludeCorrelationHeader(this._config,t.getAbsoluteUrl(),this.currentWindowHost)){if((r=r||{}).headers=new Headers(r.headers||e instanceof Request&&e.headers||{}),this._isUsingAIHeaders){var n="|"+t.traceID+"."+t.spanID;r.headers.set(Pc.requestIdHeader,n),this._config.enableRequestHeaderTracking&&(t.requestHeaders[Pc.requestIdHeader]=n)}var o=this._config.appId||this._context.appId();if(o&&(r.headers.set(Pc.requestContextHeader,Pc.requestContextAppIdFormat+o),this._config.enableRequestHeaderTracking&&(t.requestHeaders[Pc.requestContextHeader]=Pc.requestContextAppIdFormat+o)),this._isUsingW3CHeaders){var a=new Ld(t.traceID,t.spanID);r.headers.set(Pc.traceParentHeader,a.toString()),this._config.enableRequestHeaderTracking&&(t.requestHeaders[Pc.traceParentHeader]=a.toString())}return r}return r}if(i){if(this.currentWindowHost&&Bc.canIncludeCorrelationHeader(this._config,i.ajaxData.getAbsoluteUrl(),this.currentWindowHost)){this._isUsingAIHeaders&&(n="|"+i.ajaxData.traceID+"."+i.ajaxData.spanID,i.setRequestHeader(Pc.requestIdHeader,n),this._config.enableRequestHeaderTracking&&(i.ajaxData.requestHeaders[Pc.requestIdHeader]=n));var s=this._config.appId||this._context.appId();s&&(i.setRequestHeader(Pc.requestContextHeader,Pc.requestContextAppIdFormat+s),this._config.enableRequestHeaderTracking&&(i.ajaxData.requestHeaders[Pc.requestContextHeader]=Pc.requestContextAppIdFormat+s)),this._isUsingW3CHeaders&&(a=new Ld(i.ajaxData.traceID,i.ajaxData.spanID),i.setRequestHeader(Pc.traceParentHeader,a.toString()),this._config.enableRequestHeaderTracking&&(i.ajaxData.requestHeaders[Pc.traceParentHeader]=a.toString()))}return i}},Rd.prototype.getFailedFetchDiagnosticsMessage=function(t){var e="";try{nu.isNullOrUndefined(t)||(e+="string"==typeof t?"(url: '"+t+"')":"(url: '"+t.url+"')")}catch(t){this._core.logger.throwInternal(au.CRITICAL,Iu,"Failed to grab failed fetch diagnostics message",{exception:Dc.dump(t)})}return e},Rd.prototype.onFetchComplete=function(e,t){if(t)try{if(t.responseFinishedTime=qc.Now(),t.CalculateMetrics(),t.ajaxTotalDuration<0)this._core.logger.throwInternal(au.WARNING,Eu,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(e),requestSentTime:t.requestSentTime,responseFinishedTime:t.responseFinishedTime});else{var r={id:"|"+t.traceID+"."+t.spanID,target:t.getAbsoluteUrl(),name:t.getPathName(),type:"Fetch",duration:t.ajaxTotalDuration,success:200<=e.status&&e.status<400,responseCode:e.status,properties:{HttpMethod:t.method}},i=this.getFetchCorrelationContext(e);if(i&&(r.correlationContext=i),this._config.enableRequestHeaderTracking&&0<Object.keys(t.requestHeaders).length&&(r.properties=r.properties||{},r.properties.requestHeaders=t.requestHeaders),this._config.enableResponseHeaderTracking){var n={};e.headers.forEach(function(t,e){n[e]=t}),0<Object.keys(n).length&&(r.properties=r.properties||{},r.properties.responseHeaders=n)}this.trackDependencyDataInternal(r)}}catch(t){this._core.logger.throwInternal(au.WARNING,Au,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(e),exception:Dc.dump(t)})}},Rd.prototype.onFetchFailed=function(e,t,r){if(t)try{if(t.responseFinishedTime=qc.Now(),t.CalculateMetrics(),t.ajaxTotalDuration<0)this._core.logger.throwInternal(au.WARNING,Eu,"Failed to calculate the duration of the failed fetch call, monitoring data for this fetch call won't be sent.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(e),requestSentTime:t.requestSentTime,responseFinishedTime:t.responseFinishedTime});else{var i={id:"|"+t.traceID+"."+t.spanID,target:t.getAbsoluteUrl(),name:t.getPathName(),type:"Fetch",duration:t.ajaxTotalDuration,success:!1,responseCode:0,properties:{HttpMethod:t.method}};this.trackDependencyDataInternal(i,{error:r.message})}}catch(t){this._core.logger.throwInternal(au.WARNING,Au,"Failed to calculate the duration of the failed fetch call, monitoring data for this fetch call won't be sent.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(e),exception:Dc.dump(t)})}},Rd.prototype.getFetchCorrelationContext=function(e){try{var t=e.headers.get(Pc.requestContextHeader);return Bc.getCorrelationContext(t)}catch(t){this._core.logger.throwInternal(au.WARNING,Au,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(e),exception:Dc.dump(t)})}},Rd.prototype.instrumentXhr=function(){this.supportsAjaxMonitoring()&&!this.initialized&&(this.instrumentOpen(),this.instrumentSend(),this.instrumentAbort(),this.instrumentSetRequestHeader(),this.initialized=!0)},Rd.getDefaultConfig=function(){return{maxAjaxCallsPerView:500,disableAjaxTracking:!1,disableFetchTracking:!0,disableCorrelationHeaders:!1,distributedTracingMode:tu.AI,correlationHeaderExcludedDomains:["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],correlationHeaderDomains:void 0,appId:void 0,enableCorsCorrelation:!1,enableRequestHeaderTracking:!1,enableResponseHeaderTracking:!1}},Rd.getEmptyConfig=function(){return{maxAjaxCallsPerView:void 0,disableAjaxTracking:void 0,disableFetchTracking:void 0,disableCorrelationHeaders:void 0,distributedTracingMode:void 0,correlationHeaderExcludedDomains:void 0,appId:void 0,enableCorsCorrelation:void 0,correlationHeaderDomains:void 0,enableRequestHeaderTracking:void 0,enableResponseHeaderTracking:void 0}},Rd.prototype.initialize=function(t,e,r){if(!this.initialized&&!this._fetchInitialized){this._core=e;var i=Rd.getDefaultConfig();for(var n in this._config=Rd.getEmptyConfig(),i)this._config[n]=ah.getConfig(t,n,Rd.identifier,i[n]);if(this._isUsingAIHeaders=this._config.distributedTracingMode===tu.AI||this._config.distributedTracingMode===tu.AI_AND_W3C,this._isUsingW3CHeaders=this._config.distributedTracingMode===tu.AI_AND_W3C||this._config.distributedTracingMode===tu.W3C,!1===this._config.disableAjaxTracking&&this.instrumentXhr(),!1===this._config.disableFetchTracking&&this.instrumentFetch(),0<r.length&&r){for(var o=void 0,a=0;!o&&a<r.length;)r[a]&&r[a].identifier===fh&&(o=r[a]),a++;o&&(this._context=o.context)}}},Rd.identifier="AjaxDependencyPlugin",Rd);function Rd(){this._trackAjaxAttempts=0,this.identifier=Rd.identifier,this.priority=120,this.currentWindowHost=window&&window.location&&window.location.host&&window.location.host.toLowerCase(),this.initialized=!1,this._fetchInitialized=!1}var zd=(Nd.prototype.trackEvent=function(t,e){this.appInsights.trackEvent(t,e)},Nd.prototype.trackPageView=function(t){var e=t||{};this.appInsights.trackPageView(e)},Nd.prototype.trackPageViewPerformance=function(t){var e=t||{};this.appInsights.trackPageViewPerformance(e)},Nd.prototype.trackException=function(t){!t.exception&&t.error&&(t.exception=t.error),this.appInsights.trackException(t)},Nd.prototype._onerror=function(t){this.appInsights._onerror(t)},Nd.prototype.trackTrace=function(t,e){this.appInsights.trackTrace(t,e)},Nd.prototype.trackMetric=function(t,e){this.appInsights.trackMetric(t,e)},Nd.prototype.startTrackPage=function(t){this.appInsights.startTrackPage(t)},Nd.prototype.stopTrackPage=function(t,e,r,i){this.appInsights.stopTrackPage(t,e,r,i)},Nd.prototype.startTrackEvent=function(t){this.appInsights.startTrackEvent(t)},Nd.prototype.stopTrackEvent=function(t,e,r){this.appInsights.stopTrackEvent(t,e,r)},Nd.prototype.addTelemetryInitializer=function(t){return this.appInsights.addTelemetryInitializer(t)},Nd.prototype.setAuthenticatedUserContext=function(t,e,r){void 0===r&&(r=!1),this.properties.context.user.setAuthenticatedUserContext(t,e,r)},Nd.prototype.clearAuthenticatedUserContext=function(){this.properties.context.user.clearAuthenticatedUserContext()},Nd.prototype.trackDependencyData=function(t){this.dependencies.trackDependencyData(t)},Nd.prototype.flush=function(e){void 0===e&&(e=!0),this.core.getTransmissionControls().forEach(function(t){t.forEach(function(t){t.flush(e)})})},Nd.prototype.onunloadFlush=function(e){void 0===e&&(e=!0),this.core.getTransmissionControls().forEach(function(t){t.forEach(function(t){t.onunloadFlush?t.onunloadFlush():t.flush(e)})})},Nd.prototype.loadAppInsights=function(t){if(void 0===t&&(t=!1),t&&this.config.extensions&&0<this.config.extensions.length)throw new Error("Extensions not allowed in legacy mode");var e=[],r=new pd;return e.push(r),e.push(this.properties),e.push(this.dependencies),e.push(this.appInsights),this.core.initialize(this.config,e),this.emptyQueue(),this.pollInternalLogs(),this.addHousekeepingBeforeUnload(this),this.context=this.properties.context,this},Nd.prototype.updateSnippetDefinitions=function(t){for(var e in this)"string"==typeof e&&(t[e]=this[e])},Nd.prototype.emptyQueue=function(){try{if(Dc.isArray(this.snippet.queue)){for(var t=this.snippet.queue.length,e=0;e<t;e++)(0,this.snippet.queue[e])();this.snippet.queue=void 0,delete this.snippet.queue}}catch(t){var r={};t&&"function"==typeof t.toString&&(r.exception=t.toString())}},Nd.prototype.pollInternalLogs=function(){this.core.pollInternalLogs()},Nd.prototype.addHousekeepingBeforeUnload=function(e){!e.appInsights.config.disableFlushOnBeforeUnload&&"onbeforeunload"in window&&(Dc.addEventHandler("beforeunload",function(){e.onunloadFlush(!1);var t=e.appInsights.core._extensions[fh];t&&t.context&&t.context._sessionManager&&t.context._sessionManager.backup()})||e.appInsights.core.logger.throwInternal(au.CRITICAL,Pu,"Could not add handler for beforeunload"))},Nd.prototype.getSKUDefaults=function(){this.config.diagnosticLogInterval=this.config.diagnosticLogInterval&&0<this.config.diagnosticLogInterval?this.config.diagnosticLogInterval:1e4},Nd);function Nd(t){t.queue=t.queue||[],t.version=t.version||2;var e=t.config||{};e&&!e.instrumentationKey&&(e=t,Th.Version="2.2.2"),this.appInsights=new Th,this.properties=new Ed,this.dependencies=new Dd,this.core=new kc,this.snippet=t,this.config=e,this.getSKUDefaults()}var Bd=(Fd.prototype.trackEvent=function(t,e){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.trackEvent(t,e)},Fd.prototype.setAuthenticatedUserContext=function(t,e){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.setAuthenticatedUserContext(t,e)},Fd.prototype.trackException=function(t){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.trackException(t)},Fd.prototype.flush=function(t){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.flush(t)},Fd);function Fd(t){this.options=t,!this.options.disableTelemetry&&s&&(this.appInsights=new zd({config:{instrumentationKey:s,disableExceptionTracking:!0,disableAjaxTracking:!0,isCookieUseDisabled:!0,maxBatchInterval:5e3}}),this.appInsights.loadAppInsights(),this.appInsights.addTelemetryInitializer(function(t){t.tags[dh.applicationVersion]=D.getFullVersion()}))}var Ud=(jd.prototype.onAdd=function(t){return this.container=document.createElement("div"),this.container.className="azure-map-logo",this.container},jd.prototype.onRemove=function(){this.container.remove()},jd);function jd(){}var qd,Vd=(b(Gd,qd=E),Gd);function Gd(){var t=null!==qd&&qd.apply(this,arguments)||this;return t.copyrightMessage=void 0,t.showFeedbackLink=!0,t}var Zd,Hd=(b(Wd,Zd=nt),Wd.prototype.onAdd=function(t){return this.container=this.buildContainer(t,p.ControlStyle.auto),this.container.className="map-copyright",this.copyrightDiv=this.buildCopyrightDiv(),this.container.appendChild(this.copyrightDiv),this.options.showFeedbackLink&&(this.feedbackLink=this.buildFeedbackLink(),this.container.appendChild(this.feedbackLink)),this.container},Wd.prototype.onRemove=function(){Zd.prototype.onRemove.call(this),delete this.container},Wd.prototype.setOptions=function(t){var e=(new Vd).merge(this.options,t);e.copyrightMessage!==this.options.copyrightMessage&&(this.copyrightDiv.innerText=e.copyrightMessage),!e.showFeedbackLink&&this.feedbackLink?(this.feedbackLink.remove(),delete this.feedbackLink):e.showFeedbackLink&&!this.feedbackLink&&(this.feedbackLink=this.buildFeedbackLink(),this.container.appendChild(this.feedbackLink)),this.options=e},Wd.prototype.buildCopyrightDiv=function(){var t=document.createElement("div");return t.innerText=this.options.copyrightMessage||"",t},Wd.prototype.buildFeedbackLink=function(){var t=document.createElement("a");return t.textContent="Improve this map",t.href="https://feedback.azuremaps.com",t.target="_blank",t.rel="noopener",t},Wd);function Wd(t){var e=Zd.call(this)||this;return e.options=(new Vd).merge(t),e}var Kd=(Xd.throwOnError=function(t,e){var r=t instanceof Qm?t._getMap():t,i=function(t){throw r.off("error",i),t.error};r.on("error",i);var n=e();return r.off("error",i),n},Xd.tryCatch=function(t,e,r,i){try{return this.throwOnError(t,e)}catch(t){return r(t)}finally{"function"==typeof i&&i()}},Xd.tryFinally=function(t,e,r){try{return this.throwOnError(t,e)}finally{r()}},Xd);function Xd(){}var Yd=(Jd.prototype.request=function(t){var e={domain:this.map.getServiceOptions().domain,path:"search/address/reverse/json",queryParams:w({"api-version":"1.0",language:t.style.language,limit:1,query:to(t.position[1])+","+eo(t.position[0])},t.style.view&&{view:t.style.view})};return new P(this.map.authentication.signRequest(e)).get()},Jd);function Jd(t){this.map=t}var Qd=($d.prototype.cache=function(t,e,r,i){var n=t+"_"+r[0]+"_"+r[1]+"_"+i;this._labelIdx[e.labelType]||(this._labelIdx[e.labelType]=[],this._labelCache[e.labelType]=[]),-1===this._labelIdx[e.labelType].indexOf(n)&&(this._labelCache[e.labelType].push({name:t,radius:e.radius,minZoom:e.minZoom,maxZoom:e.maxZoom||24,position:r}),this._labelIdx[e.labelType].push(n))},$d.prototype.getNearestLabel=function(t,e,r){var i=null,n=this._labelCache[t];if(n)for(var o=1/0,a=0,s=n.length;a<s;a++)if(r>=n[a].minZoom&&r<=n[a].maxZoom){var l=Kn(n[a].position,e);l<=n[a].radius&&l<=o&&(o=l,i=n[a])}return i},$d.prototype._preloadCache=function(t){if(!this._preloadedCache.has(t)){this._preloadedCache.add(t);var e={source:["Ocean label","Ocean name"],labelType:"water",minZoom:0,radius:395e4,polygonSources:["Ocean","Ocean or sea"]},r=t,i=r.indexOf("-");switch(-1!==i&&(r=r.substr(0,i)),r){case"fr":this.cache("Océan Pacifique",e,[-170,32],t),this.cache("Océan Pacifique",e,[-138,-27],t),this.cache("Océan Atlantique",e,[-40,32],t),this.cache("Océan Atlantique",e,[-17,-29],t);break;case"es":this.cache("Océan Pacifique",e,[-170,32],t),this.cache("Océan Pacifique",e,[-138,-27],t),this.cache("Océano Atlántico",e,[-40,32],t),this.cache("Océano Atlántico",e,[-17,-29],t);break;case"pt":this.cache("Oceano Pacífico",e,[-170,32],t),this.cache("Oceano Pacífico",e,[-138,-27],t),this.cache("Oceano Atlântico",e,[-40,32],t),this.cache("Oceano Atlântico",e,[-17,-29],t);break;case"ja":this.cache("太平洋",e,[-170,32],t),this.cache("太平洋",e,[-138,-27],t);break;case"en":this.cache("Pacific Ocean",e,[-170,32],t),this.cache("Pacific Ocean",e,[-138,-27],t),this.cache("Atlantic Ocean",e,[-40,32],t),this.cache("Atlantic Ocean",e,[-17,-29],t),this.cache("Indian Ocean",e,[77,-26],t)}}},$d);function $d(){this._labelCache={},this._labelIdx={},this._preloadedCache=new Set}var tf=(ef.prototype.dispose=function(){this._disposed=!0,this._map._getMap().off("move",this._onMove),this._map._getMap().off("moveend",this._onMoveEnd),this._map._getMap().off("styledata",this._onStyleData),this._map._getMap().off("rotate",this._onRotate),this._map.getMapContainer().removeEventListener("keydown",this._shortcutListener)},ef.prototype._checkThresholds=function(t,e){return this._checkZoomThreshold(t.zoom,e.zoom)||this._checkPitchThreshold(t.pitch,e.pitch)||this._checkLocThreshold(t.center,e.center)||this._checkHeadingThreshold(t.bearing,e.bearing)},ef.prototype._checkZoomThreshold=function(t,e){return this._round(t)!==this._round(e)},ef.prototype._checkPitchThreshold=function(t,e){return Math.abs(t-e)>=this._pitchThreshold},ef.prototype._checkLocThreshold=function(t,e){var r=this._map.positionsToPixels([e,t]),i=r[0],n=r[1];return dn.getDistance(i,n)>=this._moveThreshold},ef.prototype._checkHeadingThreshold=function(t,e){t<0&&(t+=360),e<0&&(e+=360);var r=Math.abs(t-e);return 180<r&&(r=360-r),r>=this._headingThreshold},ef.prototype._getLocDesc=function(p,h,d){return S(this,void 0,void 0,function(){var e,r,i,n,o,a,s,l,u,c=this;return T(this,function(t){switch(t.label){case 0:return"blank"===d?[3,3]:this._map._getMap().loaded()?[3,2]:[4,new Promise(function(t){return c._map._getMap().once("idle",t)})];case 1:t.sent(),t.label=2;case 2:for(e={},r=this._map.positionsToPixels([p.center])[0],Kd.tryCatch(this._map,function(){i=c._map._getMap().queryRenderedFeatures(r,{layers:c._polygonStyleLayer,filter:["==",["geometry-type"],"Polygon"]})},function(){}),n=null,i&&0<i.length&&(n=i[0]),o=null,a=0,s=this._lableConfig.length;a<s;a++)l=this._lableConfig[a],p.zoom>=l.minZoom?l.polygonSources?n&&-1!==l.polygonSources.indexOf(n.layer["source-layer"])?(o=l.labelType,this._getClosestLabel(l,p,h,e,!1)):this._getClosestLabel(l,p,h,e,!0):this._getClosestLabel(l,p,h,e,!1):this._getClosestLabel(l,p,h,e,!0);return 8<=p.zoom&&this._processRoads(e,p,h),this._labelCache.forEach(function(t){e[t]||(u=null,"water"===t||"majorPoi"===t?t===o&&(u=ef._labelCache.getNearestLabel(t,p.center,p.zoom)):u=ef._labelCache.getNearestLabel(t,p.center,p.zoom),u&&(e[t]=u.name))}),[2,this._processLocInfo(p,o,e,!0,this._restFallback)];case 3:return[2,this._processLocInfo(p,null,null,!1,!1)]}})})},ef.prototype._getHeadingDesc=function(t){var e=t.bearing;switch(e<0&&(e+=360),e=this._round(e,this._headingThreshold)){case 0:case 360:return"north";case 45:return"north east";case 90:return"east";case 135:return"south east";case 180:return"south";case 225:return"south west";case 270:return"west";case 315:return"north west";default:return e+" degrees"}},ef.prototype._getClosestLabel=function(t,e,r,i,n){for(var o=t.radius,a=0,s=t.source.length;a<s;a++){var l={sourceLayer:t.source[a]},u=this._map._getMap().querySourceFeatures(this._baseVectorTileSourceId,l),c=null,p=1/0,h=this._labelCache.has(t.labelType);if(!n||n&&h)for(var d=0,f=u.length;d<f;d++){var m="Point"===u[d].geometry.type?u[d]:yo(e.center,u[d].geometry);if(!n){var g="Point"===u[d].geometry.type?Kn(e.center,m.geometry.coordinates):m.properties.distance;g<p&&(p=g,c=u[d])}h&&ef._labelCache.cache(u[d].properties.name,t,m.geometry.coordinates,r)}if(!n){var y=t.labelType+"Dis";c&&p<=o&&("number"!=typeof i[y]||p<=i[y])&&(i[t.labelType]=c.properties.name,i[y]=p)}}},ef.prototype._processRoads=function(t,e,r,i){var n=this._map._getMap().queryRenderedFeatures(i,{filter:["==",["geometry-type"],"LineString"]});if(n){for(var o=void 0,a=void 0,s=void 0,l=void 0,u=0,c=n.length;u<c;u++)if(this._roadLayers.has(n[u].layer["source-layer"])&&n[u].properties.name&&""!==n[u].properties.name){var p=yo(e.center,n[u]);(!s||p.properties.distance<s.properties.distance)&&(o&&n[u].properties.name===o.properties.name?s=p:o&&n[u].properties.name===o.properties.name?(!l||p.properties.distance<l.properties.distance)&&(l=p,a=n[u]):(l=s,a=o,s=p,o=n[u]))}if(o&&(t.country||(t.country=o.properties.country_code,t.countryDis=0,ef._labelCache.cache(t.country,{source:["Country name"],labelType:"country",radius:5e3,minZoom:0},s.geometry.coordinates,r)),t.state||(t.state=o.properties.country_subdivision,t.stateDis=0,ef._labelCache.cache(t.state,{source:["State name"],labelType:"state",radius:5e3,minZoom:4},s.geometry.coordinates,r)),15<=e.zoom)){var h=this._map.positionsToPixels([e.center,s.geometry.coordinates]),d=dn.getDistance(h[0],h[1]);if((d<this._roadPixelRadius||s.properties.distance<this._minRoadDistance)&&(t.road=o.properties.name),a){var f=this._map.positionsToPixels([l.geometry.coordinates]);((d=dn.getDistance(h[0],f[0]))<this._minIntersectionPixelDistance||l.properties.distance<this._minRoadDistance)&&(t.secondRoad=a.properties.name,t.secondRoadDis=l.properties.distance)}}}},ef.prototype._getActionDesc=function(t){if(this._lastCam){var e=[];if(this._checkLocThreshold(t.center,this._lastCam.center)){var r=["panned"],i=Math.round(Yn(this._lastCam.center,t.center));0===i||360===i?r.push("north"):i<90?r.push("north east"):90===i?r.push("east"):i<180?r.push("south east"):180===i?r.push("south"):i<270?r.push("south west"):270===i?r.push("west"):i<360&&r.push("north west");var n=Kn(this._lastCam.center,t.center,_n.meters);r.push(1e3<n?Zn(n/1e3,2)+" kilometers":Zn(n,2)+" meters"),e.push(r.join(" "))}if(this._checkZoomThreshold(t.zoom,this._lastCam.zoom)){(r=["zoomed"]).push(this._lastCam.zoom<t.zoom?"in":"out");var o=Math.abs(this._lastCam.zoom-t.zoom);1<=o&&(o=Math.ceil(o),r.push(1<o?o+" levels":o+" level")),this._getCanonicalZoom(this._lastCam.zoom)!==this._getCanonicalZoom(t.zoom)&&r.push("to "+this._getCanonicalZoom(t.zoom)+" level"),e.push(r.join(" "))}if(this._checkPitchThreshold(t.pitch,this._lastCam.pitch)){var a=this._round(t.pitch,this._pitchThreshold);e.push("pitched to "+a+" degrees")}return this._checkHeadingThreshold(this._lastCam.bearing,t.bearing)&&e.push("rotated to "+this._getHeadingDesc(t)),e.join(" and ")||null}return null},ef.prototype._getCanonicalZoom=function(t){return(t=this._round(t))<2?"world":t<5?"country":t<11?"state province":t<15?"city":"street"},ef.prototype._processLocInfo=function(n,o,a,s,l){var u=this;return new Promise(function(e,t){var r=[];if(s){var i=[];if(a&&(o&&("water"===o&&a.water?i.push(a.water):"majorPoi"===o&&a.majorPoi&&i.push(a.majorPoi)),0===i.length&&(a.majorPoi&&8<=n.zoom?i.push(a.majorPoi):(a.poi&&14<=n.zoom?i.push(a.poi):a.road&&15<=n.zoom&&(a.secondRoad?i.push(a.road+" & "+a.secondRoad):i.push(a.road)),a.neighbourhood&&12<=n.zoom&&i.push(a.neighbourhood),a.city&&6<=n.zoom&&i.push(a.city)),a.state&&4<=n.zoom&&i.push(a.state),0===i.length?a.water?i.push(a.water):a.country&&i.push(a.country):1===i.length&&a.state&&4<=n.zoom&&a.country&&i.push(a.country))),0<i.length)r.push("<p>Location: ",i.join(", "),"</p>");else if(l&&"water"!==o)return void u._reverseGeocodeDescription(n).then(function(t){e(t)},function(){t("<p>Location: unknown</p>")})}u._returnDetailedDescriptions&&(r.push("<p>Zoom: ",Zn(n.zoom,2),"</p>"),r.push("<p>Latitude: ",Zn(n.center[1],5),"</p>"),r.push("<p>Longitude: ",Zn(n.center[0],5),"</p>")),e(r.join(""))})},ef.prototype._reverseGeocodeDescription=function(o){var a=this;return new Promise(function(i){var n=a._map.getStyle();a._reverseSearch.request({position:o.center,style:n}).then(function(t){var e={};if(t&&t.addresses&&0<t.addresses.length&&t.addresses[0].address){var r=t.addresses[0].address;r.country&&(e.country=r.country,ef._labelCache.cache(e.country,{source:["Country name"],labelType:"country",radius:5e3,minZoom:0},o.center,n.language)),r.countrySubdivision&&(e.state=r.countrySubdivision,ef._labelCache.cache(e.state,{source:["State name"],labelType:"state",radius:5e3,minZoom:4},o.center,n.language)),r.municipality&&(e.city=r.municipality,ef._labelCache.cache(e.state,{source:["Small city"],labelType:"city",radius:1e3,minZoom:10},o.center,n.language)),r.streetNameAndNumber?e.road=r.streetNameAndNumber:r.street&&(e.road=r.street)}a._processLocInfo(o,null,e,!0,!1).then(function(t){i(t)})},function(t){a._processLocInfo(o,null,null,!0,!1).then(function(t){i(t)})}).catch(function(t){a._processLocInfo(o,null,null,!0,!1).then(function(t){i(t)})})})},ef.prototype._round=function(t,e){return void 0===e&&(e=1),Math.round(t/e)*e},ef);function ef(t,e){var s=this;this._restFallback=!0,this._disposed=!1,this._lastHeadingTime=0,this._actionQueue=[],this._camUpdateDelay=1e3,this._headUpdateLimit=1e3,this._controlEventDelay=500,this._moveThreshold=25,this._headingThreshold=5,this._pitchThreshold=5,this._roadPixelRadius=120,this._minRoadDistance=25,this._minIntersectionPixelDistance=50,this._baseVectorTileSourceId="vectorTiles",this._lableConfig=[{source:["Ocean label","Ocean name"],labelType:"water",minZoom:0,radius:395e4,polygonSources:["Ocean","Ocean or sea"]},{source:["Sea label"],labelType:"water",minZoom:3,radius:1e6,polygonSources:["Sea","Ocean or sea"]},{source:["Country name"],labelType:"country",minZoom:0,maxZoom:5,radius:3e5},{source:["State name","State name short"],labelType:"state",minZoom:4,maxZoom:7,radius:3e5},{source:["Capital city","Large city"],labelType:"city",minZoom:8,radius:4e4},{source:["Medium city"],labelType:"city",minZoom:8,radius:3e4},{source:["Small city"],labelType:"city",minZoom:8,radius:2e4},{source:["Island label"],labelType:"city",minZoom:8,radius:1e4},{source:["Town"],labelType:"city",minZoom:10,radius:1e4},{source:["Village"],labelType:"neighbourhood",minZoom:12,radius:6e3},{source:["Amusement area label"],labelType:"poi",minZoom:14,radius:2e3,polygonSources:["Amusement park"]},{source:["Hospital label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Hospital"]},{source:["Shopping centre label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Shopping"]},{source:["Stadium label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Stadium"]},{source:["University/School label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["University"]},{source:["Zoo label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Zoo"]},{source:["Airport Label","Airport name","Airport POI"],labelType:"majorPoi",minZoom:11,radius:3e3,polygonSources:["Airport","Runway"]},{source:["National park label"],labelType:"majorPoi",minZoom:7,radius:15e3,polygonSources:["National or state park","National park","Forest"]},{source:["Reservation label"],labelType:"majorPoi",minZoom:7,radius:15e3,polygonSources:["Reservation"]}],this._polygonStyleLayer=["National or state park","National park","Reservation","Airport","Runway","Stadium","University","Zoo","Shopping","Hospital","Amusement park","Ocean","Sea","Ocean or sea"],this._labelCache=new Set(["city","state","country","water","majorPoi"]),this._roadLayers=new Set(["Connecting road","Connecting road tunnel","International road","International road tunnel","Local road","Local road tunnel","Major local road","Major local road tunnel","Major road","Major road tunnel","Minor local road","Minor local road tunnel","Motorway","Motorway tunnel","Secondary road","Secondary road tunnel","Toll connecting road","Toll connecting road tunnel","Toll international road","Toll international road tunnel","Toll local road","Toll local road tunnel","Toll major local road","Toll major local road tunnel","Toll major road","Toll major road tunnel","Toll minor local road","Toll minor local road tunnel","Toll motorway","Toll motorway tunnel","Toll secondary road","Toll secondary road tunnel"]),this._returnDetailedDescriptions=!1,this._shortcutListener=function(a){return S(s,void 0,void 0,function(){var e,r,i,n,o;return T(this,function(t){switch(t.label){case 0:return a.altKey&&a.ctrlKey&&68===a.keyCode?(this._returnDetailedDescriptions=!this._returnDetailedDescriptions,e=this._map.getCamera(),r=this._map.getStyle(),i=r.language.toLowerCase(),n=r.style.toLowerCase(),[4,this._getLocDesc(e,i,n)]):[3,2];case 1:o=t.sent(),this._descCallback(o),t.label=2;case 2:return[2]}})})},this._onRotate=function(){s._rotateTimeout||(Date.now()-s._lastHeadingTime>=s._headUpdateLimit?s._rotateTimeout=setTimeout(s._updateHeading,ct.RotationDuration+25):s._rotateTimeout=setTimeout(s._updateHeading,s._headUpdateLimit-(Date.now()-s._lastHeadingTime)))},this._onMove=function(){s._moveTimeout&&(clearTimeout(s._moveTimeout),delete s._moveTimeout),s._controlTimeout&&(clearTimeout(s._controlTimeout),delete s._controlTimeout)},this._onMoveEnd=function(t){t.fromControl?s._controlTimeout=setTimeout(s._updateCam,s._controlEventDelay):s._updateCam()},this._onStyleData=function(){setTimeout(s._updateStyle)},this._updateHeading=function(){var t=s._map.getCamera();if(!s._lastHead||s._checkHeadingThreshold(t.bearing,s._lastHead)){var e=s._getHeadingDesc(t);s._lastHead=t.bearing,s._descCallback("<p>Map heading "+e+"</p>"),s._lastHeadingTime=Date.now()}delete s._rotateTimeout},this._updateStyle=function(){return S(s,void 0,void 0,function(){var e,r,i,n,o;return T(this,function(t){switch(t.label){case 0:return e=this._map.getCamera(),r=this._map.getStyle(),i=r.language.toLowerCase(),n=r.style.toLowerCase(),this._lastLang===i?[3,2]:(ef._labelCache._preloadCache(i),[4,this._getLocDesc(e,i,n)]);case 1:return o=t.sent(),[3,4];case 2:return this._lastStyle===n||"blank"!==this._lastStyle?[3,4]:[4,this._getLocDesc(e,i,n)];case 3:o=t.sent(),t.label=4;case 4:return this._lastLang=i,this._lastStyle=n,o&&this._descCallback(o),[2]}})})},this._updateCam=function(t){void 0===t&&(t=!1);var r=s._map.getCamera();if(!s._lastCam||0<s._actionQueue.length||s._checkThresholds(r,s._lastCam)){var e=s._map.getStyle(),i=e.language.toLowerCase(),n=e.style.toLowerCase(),o=s._getActionDesc(r);o&&s._actionQueue.push(o),s._lastCam=r,s._moveTimeout&&(clearTimeout(s._moveTimeout),delete s._moveTimeout),s._moveTimeout=setTimeout(function(){return S(s,void 0,void 0,function(){var e;return T(this,function(t){switch(t.label){case 0:return clearTimeout(this._rotateTimeout),delete this._rotateTimeout,[4,this._getLocDesc(r,i,n)];case 1:return e=t.sent(),0<this._actionQueue.length?(this._descCallback("<p>Map "+this._actionQueue.join(", then ")+"</p>"+e),this._actionQueue=[]):this._descCallback(e),[2]}})})},t?0:s._camUpdateDelay)}},this._map=t,this._descCallback=e,this._reverseSearch=new Yd(t),ef._labelCache||(ef._labelCache=new Qd),this._lastLang=this._map.getStyle().language.toLowerCase(),ef._labelCache._preloadCache(this._lastLang),this._map.events.addOnce("load",function(){s._disposed||(s._updateCam(!0),s._map._getMap().on("move",s._onMove),s._map._getMap().on("moveend",s._onMoveEnd),s._map._getMap().on("styledata",s._onStyleData),s._map._getMap().on("rotate",s._onRotate))}),this._map.getMapContainer().addEventListener("keydown",this._shortcutListener)}var rf,nf=function(t){var e=this;this.addToMap=function(){e.createMapKeyBindingInfo(),e.initializeMapLiveStateInfo(),e.initializeMapStyleInfo(),e.map.getMapContainer().setAttribute("role","application"),e.map.getMapContainer().setAttribute("aria-label","Map Application"),e.map.getCanvas().setAttribute("aria-label","Interactive Map"),e.map.getCanvas().setAttribute("aria-describedby","atlas-map-state atlas-map-shortcuts"),e.map.getCanvas().setAttribute("alt","Interactive Map")},this.removeFromMap=function(){null!=e.mapViewDesc&&e.mapViewDesc.dispose(),delete e.mapViewDesc,null!=e.atlasMapKeyBindings&&e.map.getCanvasContainer().removeChild(e.atlasMapKeyBindings),delete e.atlasMapKeyBindings,null!=e.atlasMapLiveStateInfo&&e.map.getCanvasContainer().removeChild(e.atlasMapLiveStateInfo),delete e.atlasMapLiveStateInfo,null!=e.atlasMapStyleInfo&&e.map.getCanvasContainer().removeChild(e.atlasMapStyleInfo),delete e.atlasMapStyleInfo,e.map.getMapContainer().removeAttribute("role"),e.map.getMapContainer().removeAttribute("aria-label"),e.map.getCanvas().removeAttribute("aria-label"),e.map.getCanvas().removeAttribute("aria-describedby"),e.map.getCanvas().removeAttribute("alt"),e.map.events.remove("styledata",e.updateMapStyle)},this.createMapKeyBindingInfo=function(){e.atlasMapKeyBindings=document.createElement("div"),e.atlasMapKeyBindings.setAttribute("tabindex","-1"),e.atlasMapKeyBindings.setAttribute("aria-label","Interactive Map Key Bindings"),e.atlasMapKeyBindings.id="atlas-map-shortcuts",e.atlasMapKeyBindings.classList.add("hidden-accessible-element"),e.map.getCanvasContainer().appendChild(e.atlasMapKeyBindings),e.atlasMapKeyBindings.innerHTML="<p>Zoom out: hyphen</p><p>Zoom in: plus</p><p>Pan right 100 pixels: right arrow</p><p>Pan left 100 pixels: left arrow</p><p>Pan up 100 pixels: up arrow</p><p>Pan down 100 pixels: down arrow</p><p>Rotate 15 degrees clockwise: shift + right arrow</p><p>Rotate 15 degrees counter clockwise: shift + left arrow</p><p>Increase pitch 10 degrees: shift + up arrow</p><p>Decrease pitch 10 degrees: shift + down arrow</p><p>Toggle verbose map state: control + alt + D</p><p>Jump focus to the map</p>"},this.initializeMapLiveStateInfo=function(){e.mapViewDesc=new tf(e.map,e.updateMapState),e.atlasMapLiveStateInfo=document.createElement("div"),e.atlasMapLiveStateInfo.setAttribute("tabindex","-1"),e.atlasMapLiveStateInfo.setAttribute("aria-label","Interactive Map State"),e.atlasMapLiveStateInfo.setAttribute("aria-live","polite"),e.atlasMapLiveStateInfo.setAttribute("aria-atomic","true"),e.atlasMapLiveStateInfo.id="atlas-map-state",e.atlasMapLiveStateInfo.classList.add("hidden-accessible-element"),e.map.getCanvasContainer().appendChild(e.atlasMapLiveStateInfo)},this.initializeMapStyleInfo=function(){e.atlasMapStyleInfo=document.createElement("div"),e.atlasMapStyleInfo.setAttribute("aria-label","Interactive Map Style"),e.atlasMapStyleInfo.setAttribute("aria-live","polite"),e.atlasMapStyleInfo.setAttribute("aria-atomic","true"),e.atlasMapStyleInfo.classList.add("hidden-accessible-element"),e.map.getCanvasContainer().appendChild(e.atlasMapStyleInfo),e.updateMapStyle(),e.map.events.add("styledata",e.updateMapStyle)},this.updateMapStyle=function(){e.atlasMapStyleInfo.innerHTML="<p>Style: "+e.map.getStyle().style+"</p>"},this.updateMapState=function(t){e.atlasMapLiveStateInfo.innerHTML=t},this.map=t},of=function(t){var a=this;this.callCounter=0,this.listenerEnabled=!1,this.flowComponent=void 0,this.flowPath=void 0,this.addToMap=function(){if(!a.map._isReady())throw new Error("Traffic flow could not be added to the map because the map is not ready. Please use a ready event listener to guarantee the map is ready before enabling traffic flow.");a.listenerEnabled||(a.map.events.add("styledata",a.addToMap),a.listenerEnabled=!0);var t=a.map.getStyle(),e=a.map.getTraffic(),n=a.map.styles.getFlowPath(t,e);if(n&&a.flowPath!==n){a.callCounter++;var o=a.callCounter;a.map.styles.getFlowComponent(t,e).then(function(t){if(a.callCounter===o){a.flowComponent&&(a.map.layers.remove(a.flowComponent.layer),a.map.sources.remove(a.flowComponent.sources),delete a.flowComponent);var e=a.map.layers.getLayers(),r=e.findIndex(function(t){return"transit"===t.getId()}),i=-1!==r?e[r+1]:void 0;a.map.sources.add(t.sources),a.map.layers.add(t.layer,i),a.flowComponent=t,a.flowPath=n}})}},this.removeFromMap=function(){a.callCounter++,a.listenerEnabled&&(a.map.events.remove("styledata",a.addToMap),a.listenerEnabled=!1),a.flowPath&&delete a.flowPath,a.flowComponent&&(a.map.layers.remove(a.flowComponent.layer),a.map.sources.remove(a.flowComponent.sources),delete a.flowComponent)},this.map=t},af=(b(sf,rf=E),sf);function sf(){var t=null!==rf&&rf.apply(this,arguments)||this;return t.version="1.0",t.bbox=void 0,t.zoom=void 0,t.params={},t}var lf=(uf.prototype.request=function(t){var e,r=(new af).merge(t),i=this.map.getServiceOptions().domain;e=Oo.getWest(r.bbox)<-180&&180<Oo.getEast(r.bbox)?Oo.getSouth(r.bbox)+",-180,"+Oo.getNorth(r.bbox)+",180":Oo.getSouth(r.bbox)+","+eo(Oo.getWest(r.bbox))+","+Oo.getNorth(r.bbox)+","+eo(Oo.getEast(r.bbox));var n={domain:i,path:"traffic/incident/detail/json",queryParams:w({"api-version":r.version,projection:"EPSG4326",style:"s3",boundingbox:e,boundingzoom:r.zoom,trafficmodelid:-1},r.params)};return new P(this.map.authentication.signRequest(n)).get()},uf);function uf(t){this.map=t}var cf,pf,hf,df=(b(ff,cf=cn),ff.getIncidentTypeName=function(t,e){switch(t){case 0:return e.Unknown;case 1:return e.Accident;case 2:return e.Fog;case 3:return e.Danger;case 4:return e.Rain;case 5:return e.Ice;case 6:return e.Jam;case 7:return e.LaneClosed;case 8:return e.RoadClosed;case 9:return e.RoadWorks;case 10:return e.Wind;case 11:return e.Flood;case 12:return e.Detour;default:return e.Unknown}},ff.getIncidentTypeIconName=function(t){switch(t){case 0:return"unknown";case 1:return"accident";case 2:return"fog";case 3:return"danger";case 4:return"rain";case 5:return"ice";case 6:return"jam";case 7:return"lane-closed";case 8:return"road-closed";case 9:return"road-work";case 10:return"wind";case 11:return"flood";case 12:return"detour";default:return"unknown"}},ff.getSeverityColorName=function(t){switch(t){case 0:return"grey";case 1:return"yellow";case 2:return"orange";case 3:return"red";case 4:default:return"grey"}},ff.getSeverityColorHexCode=function(t){switch(t){case 0:return"#B5B6B7";case 1:return"#F4C951";case 2:return"#F4873F";case 3:return"#F04F4E";case 4:default:return"#B5B6B7"}},ff);function ff(t,e){var r=new mn(new _o(t.op.x,t.op.y)),i={icon:ff.getSeverityColorName(t.ty)+"-"+ff.getIncidentTypeIconName(t.ic),incidentType:ff.getIncidentTypeName(t.ic,e),description:t.d,length:t.l,delay:t.dl,from:t.f,color:ff.getSeverityColorHexCode(t.ty),to:t.t,id:t.id};return cf.call(this,r,i)||this}(hf=pf=pf||{}).DELAY="delay",hf.LENGTH="length",hf.FROM="from",hf.TO="to";var mf=(gf.build=function(t,e){void 0===e&&(e="en-US");var r=document.createElement("div");r.classList.add("incident-popup-title"),r.classList.add("font-segoeui-b"),r.setAttribute("tabindex","0"),r.innerText=t.properties.incidentType,r.setAttribute("aria-label","Incident Type "+t.properties.incidentType);var i=document.createElement("div");i.classList.add("incident-popup-subtitle"),i.classList.add("font-segoeui-b"),i.setAttribute("aria-label","Incident Description "+t.properties.description),i.setAttribute("tabindex","0"),i.innerText=t.properties.description;var n=document.createElement("div");n.classList.add("incident-popup-header"),n.style.backgroundColor=t.properties.color,n.appendChild(r),n.appendChild(i);var o=document.createElement("div");if(o.classList.add("incident-popup-body"),t.properties.delay){var a=Math.floor(t.properties.delay/60)+" min",s=this.createInfoSection(a,pf.DELAY);o.appendChild(s)}if(t.properties.length){var l=new Intl.NumberFormat([e,"en-US"],{maximumFractionDigits:2}),u=void 0;if("en-US"===e){var c=Hn(t.properties.length,"meters","miles");u=l.format(c)+" miles"}else{var p=Hn(t.properties.length,"meters","kilometers");u=l.format(p)+" km"}var h=this.createInfoSection(u,pf.LENGTH);o.appendChild(h)}if(t.properties.from){var d=this.createInfoSection(t.properties.from,pf.FROM);o.appendChild(d)}if(t.properties.to){var f=this.createInfoSection(t.properties.to,pf.TO);o.appendChild(f)}var m=document.createElement("div");return m.classList.add("incident-popup-content"),m.appendChild(n),m.appendChild(o),new Ns({content:m,position:t.geometry.coordinates})},gf.createInfoSection=function(t,e){var r=document.createElement("div");r.classList.add("incident-popup-info");var i=document.createElement("div");i.classList.add("icon"),i.classList.add(e);var n=document.createElement("span");return n.classList.add("message"),n.classList.add("font-segoeui"),n.setAttribute("aria-label","Incident "+e+" "+t),n.setAttribute("tabindex","0"),n.innerText=t,r.appendChild(i),r.appendChild(n),r},gf);function gf(){}var yf,vf=function(t){var p=this;this.incidentLayerName="incidents",this.popups=new Ci,this.addToMap=function(){p.map.addPins([],{name:p.incidentLayerName,cluster:!1}),p.map.addEventListener("mouseenter",p.incidentLayerName,p.cursorToPointer),p.map.addEventListener("mouseleave",p.incidentLayerName,p.cursorToDefault),p.map.addEventListener("click",p.incidentLayerName,p.openIncidentPopup),p.map.events.add("moveend",p.updateIncidents),p.map.events.add("styledata",p.updateLanguage),p.updateIncidents()},this.removeFromMap=function(){p.map.removeLayers([p.incidentLayerName]),p.map.removeEventListener("click",p.incidentLayerName,p.openIncidentPopup),p.map.removeEventListener("mouseenter",p.incidentLayerName,p.cursorToPointer),p.map.removeEventListener("mouseleave",p.incidentLayerName,p.cursorToDefault),p.map.events.remove("moveend",p.updateIncidents),p.map.events.remove("styledata",p.updateLanguage),p.cleanUpPopups()},this.updateIncidents=function(){var t=Math.ceil(p.map.getCamera().zoom),c=p.map.getCamera().bounds;p.incidentLanguage=p.map.getStyle().language;var e=p.map._getLocalizedStrings(),r=p.incidentService.request({bbox:c,zoom:t,params:{expandCluster:!0,originalPosition:!0,language:p.incidentLanguage}});Promise.all([r,e]).then(function(t){var e=t[0],i=t[1];if(p.map.getTraffic().incidents){var n=[];p.cleanUpPopups();for(var r=0,o=e.tm.poi||[];r<o.length;r++)for(var a=o[r],s=function(t){if(Oo.containsPosition(c,[t.op.x,t.op.y])){var e=new df(t,i);n.push(e);var r=mf.build(e,p.incidentLanguage);p.popups.set(e.properties.id,r),p.map.events.add("open",r,function(){p.openPopupId=e.properties.id,p.popups.forEach(function(t,e){p.openPopupId!==e&&t.close()})}),p.map.events.add("close",r,function(){p.openPopupId===e.properties.id&&delete p.openPopupId}),p.openPopupId===e.properties.id?p.popups.get(e.properties.id).open(p.map):p.popups.get(e.properties.id).attach(p.map)}},l=0,u=a.cpoi||[a];l<u.length;l++)s(u[l]);p.map.addPins(n,{overwrite:!0,name:p.incidentLayerName})}})},this.cursorToPointer=function(t){p.map.getCanvas().style.cursor="pointer"},this.cursorToDefault=function(t){p.map.getCanvas().style.cursor=""},this.openIncidentPopup=function(t){var e=t.features[0].properties.id;p.popups.has(e)&&p.popups.get(e).open(p.map)},this.cleanUpPopups=function(){p.popups.forEach(function(t){t.remove()}),p.popups.clear()},this.updateLanguage=function(){p.map.getStyle().language!==p.incidentLanguage&&p.updateIncidents()},this.map=t,this.incidentService=new lf(this.map)},_f=(b(xf,yf=E),xf);function xf(){var t=null!==yf&&yf.apply(this,arguments)||this;return t.interactive=!0,t.scrollZoomInteraction=!0,t.boxZoomInteraction=!0,t.dragRotateInteraction=!0,t.dragPanInteraction=!0,t.keyboardInteraction=!0,t.dblClickZoomInteraction=!0,t.touchInteraction=!0,t.wheelZoomRate=1/450,t}var bf=(wf.prototype.enable=function(){this.map.getMapContainer().addEventListener("keydown",this._onKeyDown)},wf.prototype.disable=function(){this.map.getMapContainer().removeEventListener("keydown",this._onKeyDown)},wf);function wf(t){var e=this;this._onKeyDown=function(t){27===t.keyCode&&e.map.getCanvas().focus()},this.map=t}var Sf=(Tf.prototype.enable=function(){this.map._getMap().on("touchstart",this._onTouchStart),this.map._getMap().on("touchmove",this._onTouchMove),this.map._getMap().on("touchend",this._onTouchEnd),this.map._getMap().on("touchcancel",this._onTouchCancel)},Tf.prototype.disable=function(){this.map._getMap().off("touchstart",this._onTouchStart),this.map._getMap().off("touchmove",this._onTouchMove),this.map._getMap().off("touchend",this._onTouchEnd),this.map._getMap().off("touchcancel",this._onTouchCancel)},Tf);function Tf(t){var o=this;this.minDiffX=70,this.maxDiffY=100,this.minDiff=30,this.delay=160,this._onTouchStart=function(t){if(2===t.points.length){var e=t.points[0].y-t.points[1].y,r=t.points[0].x-t.points[1].x;Math.abs(r)>=o.minDiffX&&Math.abs(e)<=o.maxDiffY&&(t.originalEvent.preventDefault(),o.map._getMap().touchZoomRotate.disable(),o.map._getMap().dragPan.disable(),o.dpPoint=t.point,o.dpPitch=o.map._getMap().getPitch(),o.startTiming=Date.now(),o.startDistance=Math.hypot(r,e),o.startEventData=t)}},this._onTouchMove=function(t){if(void 0!==o.dpPoint&&void 0!==o.dpPitch){t.preventDefault(),t.originalEvent.preventDefault();var e=t.points[0].y-t.points[1].y,r=t.points[0].x-t.points[1].x,i=Math.hypot(r,e);if(Math.abs(i-o.startDistance)>=o.minDiff)return o.dpPoint&&(o.map._getMap().touchZoomRotate.enable(),o.map._getMap().dragPan.enable(),o.map._getMap().touchZoomRotate.onStart(Date.now()-o.startTiming>=o.delay?t.originalEvent:o.startEventData.originalEvent)),void(o.dpPoint=void 0);if(Date.now()-o.startTiming>=o.delay){var n=.5*(o.dpPoint.y-t.point.y);o.map._getMap().setPitch(o.dpPitch+n)}}},this._onTouchEnd=function(){o.dpPoint&&(o.map._getMap().touchZoomRotate.enable(),o.map._getMap().dragPan.enable()),o.dpPoint=void 0},this._onTouchCancel=function(){o.dpPoint&&(o.map._getMap().touchZoomRotate.enable(),o.map._getMap().dragPan.enable()),o.dpPoint=void 0},this.map=t}var Ef=(If.prototype.enable=function(){this.map.getCanvasContainer().addEventListener("gesturestart",this._onGestureStart),this.map.getCanvasContainer().addEventListener("gesturechange",this._onGestureChange),this.map.getCanvasContainer().addEventListener("touchstart",this._onTouchStart),this.map.getCanvasContainer().addEventListener("touchend",this._onTouchEnd)},If.prototype.disable=function(){this.map.getCanvasContainer().removeEventListener("gesturestart",this._onGestureStart),this.map.getCanvasContainer().removeEventListener("gesturechange",this._onGestureChange),this.map.getCanvasContainer().removeEventListener("touchstart",this._onTouchStart),this.map.getCanvasContainer().removeEventListener("touchend",this._onTouchEnd)},If);function If(t){var e=this;this._onGestureStart=function(t){e.hasTouch||(t.preventDefault(),e.initZoom=e.map.getCamera().zoom)},this._onGestureChange=function(t){e.hasTouch||(t.preventDefault(),e.map.setCamera({zoom:e.initZoom+t.scale-1}))},this._onTouchStart=function(t){e.hasTouch=!0},this._onTouchEnd=function(t){0===t.touches.length&&(e.hasTouch=!1)},this.map=t}var Cf=(kf.prototype.addToMap=function(){this.added||(this.added=!0,this._setInteractions(this.options))},kf.prototype.removeFromMap=function(){this.added&&(this.added=!1,this._setInteractions({interactive:!1}))},kf.prototype.setOptions=function(t){this.options=(new _f).merge(this.options,t),this.added&&this._setInteractions(this.options)},kf.prototype.getOptions=function(){return Object.assign({},this.options)},kf.prototype._setInteractions=function(t){t.interactive?(t.boxZoomInteraction?this.map._getMap().boxZoom.enable():this.map._getMap().boxZoom.disable(),t.dblClickZoomInteraction?this.map._getMap().doubleClickZoom.enable():this.map._getMap().doubleClickZoom.disable(),t.dragPanInteraction?this.map._getMap().dragPan.enable():this.map._getMap().dragPan.disable(),t.dragRotateInteraction?this.map._getMap().dragRotate.enable():this.map._getMap().dragRotate.disable(),t.keyboardInteraction?(this.map._getMap().keyboard.enable(),this.focusShortcut.enable()):(this.map._getMap().keyboard.disable(),this.focusShortcut.disable()),t.scrollZoomInteraction?(this.map._getMap().scrollZoom.enable(),this.map._getMap().scrollZoom.setWheelZoomRate(t.wheelZoomRate)):this.map._getMap().scrollZoom.disable(),t.touchInteraction?(this.map._getMap().touchZoomRotate.enable(),this.mobilePitch.enable()):(this.map._getMap().touchZoomRotate.disable(),this.mobilePitch.disable()),this.pinchZoom.enable()):(this.map._getMap().boxZoom.disable(),this.map._getMap().doubleClickZoom.disable(),this.map._getMap().dragPan.disable(),this.map._getMap().dragRotate.disable(),this.map._getMap().keyboard.disable(),this.focusShortcut.disable(),this.map._getMap().scrollZoom.disable(),this.map._getMap().touchZoomRotate.disable(),this.mobilePitch.disable(),this.pinchZoom.disable())},kf);function kf(t,e){this.added=!1,this.map=t,this.mobilePitch=new Sf(t),this.focusShortcut=new bf(t),this.pinchZoom=new Ef(t),this.options=(new _f).merge(e)}var Af=e(function(t){var e=(e=function(t){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},e.prototype._singletonInstance)return e.prototype._singletonInstance;if((e.prototype._singletonInstance=this).instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,t.displayCall&&"function"!=typeof t.displayCall)throw new Error("displayCall is not a function");if(!t.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(t),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(t){}}),e.prototype.login=function(){if(this._loginInProgress)this.info("Login in progress");else{this._loginInProgress=!0;var t=this._guid();this.config.state=t,this._idTokenNonce=this._guid();var e=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);e&&""!==e?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):e=window.location.href,this.verbose("Expected state: "+t+" startPage:"+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,t,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var r=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(r):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(t),this.registerCallback(t,this.config.clientId,this.callback),this._loginPopup(r)):this.promptUser(r)}},e.prototype._openPopup=function(t,e,r,i){try{var n=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,l=a/2-r/2+n,u=s/2-i/2+o,c=window.open(t,e,"width="+r+", height="+i+", top="+u+", left="+l);return c.focus&&c.focus(),c}catch(t){return this.warn("Error opening popup, "+t.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},e.prototype._handlePopupError=function(t,e,r,i,n){this.warn(i),this._saveItem(this.CONSTANTS.STORAGE.ERROR,r),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,i),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,n),e&&this._activeRenewals[e]&&(this._activeRenewals[e]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,t&&t(i,null,r)},e.prototype._loginPopup=function(t,i,e){var n=this._openPopup(t,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),o=e||this.callback;if(null!=n){if(this._openedWindows.push(n),-1!=this.config.redirectUri.indexOf("#"))var a=this.config.redirectUri.split("#")[0];else a=this.config.redirectUri;var s=this,l=window.setInterval(function(){if(!n||n.closed||void 0===n.closed){var t="Popup Window closed",e="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return s.isAngular&&s._broadcast("adal:popUpClosed",e+s.CONSTANTS.RESOURCE_DELIMETER+t),s._handlePopupError(o,i,t,e,e),void window.clearInterval(l)}try{var r=n.location;if(-1!=encodeURI(r.href).indexOf(encodeURI(a)))return s.isAngular?s._broadcast("adal:popUpHashChanged",r.hash):s.handleWindowCallback(r.hash),window.clearInterval(l),s._loginInProgress=!1,s._acquireTokenInProgress=!1,s.info("Closing popup window"),s._openedWindows=[],void n.close()}catch(t){}},1)}else{var r="Popup Window is null. This can happen if you are using IE";this._handlePopupError(o,i,"Error opening popup",r,r)}},e.prototype._broadcast=function(t,e){!function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var r=document.createEvent("CustomEvent");return r.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),r}"function"!=typeof window.CustomEvent&&(t.prototype=window.Event.prototype,window.CustomEvent=t)}();var r=new CustomEvent(t,{detail:e});window.dispatchEvent(r)},e.prototype.loginInProgress=function(){return this._loginInProgress},e.prototype._hasResource=function(t){var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return e&&!this._isEmpty(e)&&-1<e.indexOf(t+this.CONSTANTS.RESOURCE_DELIMETER)},e.prototype.getCachedToken=function(t){if(!this._hasResource(t))return null;var e=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t),r=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t),i=this.config.expireOffsetSeconds||300;return r&&r>this._now()+i?e:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,0),null)},e.prototype.getCachedUser=function(){if(this._user)return this._user;var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(t),this._user},e.prototype.registerCallback=function(o,a,t){this._activeRenewals[a]=o,this._callBacksMappedToRenewStates[o]||(this._callBacksMappedToRenewStates[o]=[]);var s=this;this._callBacksMappedToRenewStates[o].push(t),this._callBackMappedToRenewStates[o]||(this._callBackMappedToRenewStates[o]=function(t,e,r,i){s._activeRenewals[a]=null;for(var n=0;n<s._callBacksMappedToRenewStates[o].length;++n)try{s._callBacksMappedToRenewStates[o][n](t,e,r,i)}catch(r){s.warn(r)}s._callBacksMappedToRenewStates[o]=null,s._callBackMappedToRenewStates[o]=null})},e.prototype._renewToken=function(t,e,r){this.info("renewToken is called for resource:"+t);var i=this._addAdalFrame("adalRenewFrame"+t),n=this._guid()+"|"+t;this.config.state=n,this._renewStates.push(n),this.verbose("Renew token Expected state: "+n),r=r||"token";var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl(r,t),"prompt");r===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),o+="&nonce="+encodeURIComponent(this._idTokenNonce)),o+="&prompt=none",o=this._addHintParameters(o),this.registerCallback(n,t,e),this.verbosePii("Navigate to:"+o),i.src="about:blank",this._loadFrameTimeout(o,"adalRenewFrame"+t,t)},e.prototype._renewIdToken=function(t,e){this.info("renewIdToken is called");var r=this._addAdalFrame("adalIdTokenFrame"),i=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=i,this._renewStates.push(i),this.verbose("Renew Idtoken Expected state: "+i);var n=null==e?null:this.config.clientId,o=(e=e||"id_token",this._urlRemoveQueryStringParameter(this._getNavigateUrl(e,n),"prompt"));o+="&prompt=none",o=this._addHintParameters(o),o+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(i,this.config.clientId,t),this.verbosePii("Navigate to:"+o),r.src="about:blank",this._loadFrameTimeout(o,"adalIdTokenFrame",this.config.clientId)},e.prototype._urlContainsQueryStringParameter=function(t,e){return new RegExp("[\\?&]"+t+"=").test(e)},e.prototype._urlRemoveQueryStringParameter=function(t,e){var r=new RegExp("(\\&"+e+"=)[^&]+");return t=t.replace(r,""),r=new RegExp("("+e+"=)[^&]+&"),t=t.replace(r,""),r=new RegExp("("+e+"=)[^&]+"),t=t.replace(r,"")},e.prototype._loadFrameTimeout=function(t,e,r){this.verbose("Set loading state to pending for: "+r),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+r,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(t,e);var i=this;setTimeout(function(){if(i._getItem(i.CONSTANTS.STORAGE.RENEW_STATUS+r)===i.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){i.verbose("Loading frame has timed out after: "+i.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+r);var t=i._activeRenewals[r];t&&i._callBackMappedToRenewStates[t]&&i._callBackMappedToRenewStates[t]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),i._saveItem(i.CONSTANTS.STORAGE.RENEW_STATUS+r,i.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}},i.CONSTANTS.LOADFRAME_TIMEOUT)},e.prototype._loadFrame=function(e,t){var r=this;r.info("LoadFrame: "+t);var i=t;setTimeout(function(){var t=r._addAdalFrame(i);""!==t.src&&"about:blank"!==t.src||(t.src=e,r._loadFrame(e,i))},500)},e.prototype.acquireToken=function(t,e){if(this._isEmpty(t))return this.warn("resource is required"),void e("resource is required",null,"resource is required");var r=this.getCachedToken(t);return r?(this.info("Token is already in cache for resource:"+t),void e(null,r,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[t]?this.registerCallback(this._activeRenewals[t],t,e):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,t===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(e)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(e,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(t,e)):(this.verbose("renewing idtoken and access_token"),this._renewToken(t,e,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void e("User login is required",null,"login required"))},e.prototype.acquireTokenPopup=function(t,e,r,i){if(this._isEmpty(t))return this.warn("resource is required"),void i("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void i("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void i("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var n=this._guid()+"|"+t;this.config.state=n,this._renewStates.push(n),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+n);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",t),"prompt");if(o+="&prompt=select_account",e&&(o+=e),r&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(r);else if(r&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+t),this.registerCallback(n,t,i),this._loginPopup(o,t,i)},e.prototype.acquireTokenRedirect=function(t,e,r){if(this._isEmpty(t))return this.warn("resource is required"),void i("resource is required",null,"resource is required");var i=this.callback;if(!this._user)return this.warn("User login is required"),void i("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void i("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var n=this._guid()+"|"+t;this.config.state=n,this.verbose("Renew token Expected state: "+n);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",t),"prompt");if(o+="&prompt=select_account",e&&(o+=e),r&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(r);else if(r&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,n,!0),this.promptUser(o)},e.prototype.promptUser=function(t){t?(this.infoPii("Navigate to:"+t),window.location.replace(t)):this.info("Navigate url is empty")},e.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(t)){t=t.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var e=0;e<t.length&&""!==t[e];e++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t[e],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t[e],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},e.prototype.clearCacheForResource=function(t){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(t)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,0))},e.prototype.logOut=function(){var t;if(this.clearCache(),this._user=null,this.config.logOutUri)t=this.config.logOutUri;else{var e="common",r="";this.config.tenant&&(e=this.config.tenant),this.config.postLogoutRedirectUri&&(r="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),t=this.instance+e+"/oauth2/logout?"+r}this.infoPii("Logout navigate to: "+t),this.promptUser(t)},e.prototype._isEmpty=function(t){return void 0===t||!t||0===t.length},e.prototype.getUser=function(t){if("function"!=typeof t)throw new Error("callback is not a function");if(this._user)t(null,this._user);else{var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(e)?(this.warn("User information is not available"),t("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(e),t(null,this._user))}},e.prototype._addHintParameters=function(t){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==t.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",t)||(t+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",t)||(t+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",t)&&-1<this._user.profile.upn.indexOf("@"))){var e=this._user.profile.upn.split("@");t+="&domain_hint="+encodeURIComponent(e[e.length-1])}return t},e.prototype._createUser=function(t){var e=null,r=this._extractIdToken(t);return r&&r.hasOwnProperty("aud")&&(r.aud.toLowerCase()===this.config.clientId.toLowerCase()?(e={userName:"",profile:r},r.hasOwnProperty("upn")?e.userName=r.upn:r.hasOwnProperty("email")&&(e.userName=r.email)):this.warn("IdToken has invalid aud field")),e},e.prototype._getHash=function(t){return-1<t.indexOf("#/")?t=t.substring(t.indexOf("#/")+2):-1<t.indexOf("#")&&(t=t.substring(1)),t},e.prototype.isCallback=function(t){t=this._getHash(t);var e=this._deserialize(t);return e.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||e.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||e.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},e.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},e.prototype.getRequestInfo=function(t){t=this._getHash(t);var e=this._deserialize(t),r={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(e&&((r.parameters=e).hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||e.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||e.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){r.valid=!0;var i="";if(!e.hasOwnProperty("state"))return this.warn("No state returned"),r;if(this.verbose("State: "+e.state),i=e.state,r.stateResponse=i,this._matchState(r))return r;if(!r.stateMatch&&window.parent){r.requestType=this._requestType;for(var n=this._renewStates,o=0;o<n.length;o++)if(n[o]===r.stateResponse){r.stateMatch=!0;break}}}return r},e.prototype._matchNonce=function(t){var e=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(e){e=e.split(this.CONSTANTS.CACHE_DELIMETER);for(var r=0;r<e.length;r++)if(e[r]===t.profile.nonce)return!0}return!1},e.prototype._matchState=function(t){var e=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(e){e=e.split(this.CONSTANTS.CACHE_DELIMETER);for(var r=0;r<e.length;r++)if(e[r]===t.stateResponse)return t.requestType=this.REQUEST_TYPE.LOGIN,t.stateMatch=!0}var i=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(i)for(i=i.split(this.CONSTANTS.CACHE_DELIMETER),r=0;r<i.length;r++)if(i[r]===t.stateResponse)return t.requestType=this.REQUEST_TYPE.RENEW_TOKEN,t.stateMatch=!0;return!1},e.prototype._getResourceFromState=function(t){if(t){var e=t.indexOf("|");if(-1<e&&e+1<t.length)return t.substring(e+1)}return""},e.prototype.saveTokenFromHash=function(t){this.info("State status:"+t.stateMatch+"; Request type:"+t.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var e,r=this._getResourceFromState(t.stateResponse);t.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)?(this.infoPii("Error :"+t.parameters.error+"; Error description:"+t.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,t.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,t.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),t.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,t.parameters.error_description))):t.stateMatch?(this.info("State is right"),t.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,t.parameters[this.CONSTANTS.SESSION_STATE]),t.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(r)||(e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,e+r+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+r,t.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+r,this._expiresIn(t.parameters[this.CONSTANTS.EXPIRES_IN]))),t.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(t.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,t.parameters[this.CONSTANTS.ID_TOKEN]),r=this.config.loginResource?this.config.loginResource:this.config.clientId,this._hasResource(r)||(e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,e+r+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+r,t.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+r,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(t.parameters.error="invalid id_token",t.parameters.error_description="Invalid id_token. id_token: "+t.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+t.parameters[this.CONSTANTS.ID_TOKEN])))):(t.parameters.error="Invalid_state",t.parameters.error_description="Invalid_state. state: "+t.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+t.stateResponse)),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+r,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},e.prototype.getResourceForEndpoint=function(t){if(this.config&&this.config.anonymousEndpoints)for(var e=0;e<this.config.anonymousEndpoints.length;e++)if(-1<t.indexOf(this.config.anonymousEndpoints[e]))return null;if(this.config&&this.config.endpoints)for(var r in this.config.endpoints)if(-1<t.indexOf(r))return this.config.endpoints[r];return-1<t.indexOf("http://")||-1<t.indexOf("https://")?this._getHostFromUri(t)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null:this.config.loginResource},e.prototype._getHostFromUri=function(t){var e=String(t).replace(/^(https?:)\/\//,"");return e=e.split("/")[0]},e.prototype.handleWindowCallback=function(t){if(null==t&&(t=window.location.hash),this.isCallback(t)){var e=null,r=!1;0<this._openedWindows.length&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(e=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,r=!0):window.parent&&window.parent._adalInstance&&(e=window.parent._adalInstance);var i,n,o=e.getRequestInfo(t),a=null;n=r||window.parent!==window?e._callBackMappedToRenewStates[o.stateResponse]:e.callback,e.info("Returned from redirect url"),e.saveTokenFromHash(o),o.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?e.verbose("Window is in iframe, acquiring token silently"):e.verbose("acquiring token interactive in progress"),i=o.parameters[e.CONSTANTS.ACCESS_TOKEN]||o.parameters[e.CONSTANTS.ID_TOKEN],a=e.CONSTANTS.ACCESS_TOKEN):o.requestType===this.REQUEST_TYPE.LOGIN&&(i=o.parameters[e.CONSTANTS.ID_TOKEN],a=e.CONSTANTS.ID_TOKEN);var s=o.parameters[e.CONSTANTS.ERROR_DESCRIPTION],l=o.parameters[e.CONSTANTS.ERROR];try{n&&n(s,i,l,a)}catch(t){e.error("Error occurred in user defined callback function: "+t)}window.parent!==window||r||(e.config.navigateToLoginRequestUrl?window.location.href=e._getItem(e.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},e.prototype._getNavigateUrl=function(t,e){var r="common";this.config.tenant&&(r=this.config.tenant);var i=this.instance+r+"/oauth2/authorize"+this._serialize(t,this.config,e)+this._addLibMetadata();return this.info("Navigate url:"+i),i},e.prototype._extractIdToken=function(t){var e=this._decodeJwt(t);if(!e)return null;try{var r=e.JWSPayload,i=this._base64DecodeStringUrlSafe(r);return i?JSON.parse(i):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(t){this.error("The returned id_token could not be decoded",t)}return null},e.prototype._base64DecodeStringUrlSafe=function(t){return t=t.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(t))):decodeURIComponent(escape(this._decode(t)))},e.prototype._decode=function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=(t=String(t).replace(/=+$/,"")).length;if(r%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var i,n,o,a,s,l,u,c,p="",h=0;h<r;h+=4){if(i=e.indexOf(t.charAt(h)),n=e.indexOf(t.charAt(h+1)),o=e.indexOf(t.charAt(h+2)),a=e.indexOf(t.charAt(h+3)),h+2===r-1){l=(s=i<<18|n<<12|o<<6)>>16&255,u=s>>8&255,p+=String.fromCharCode(l,u);break}if(h+1===r-1){l=(s=i<<18|n<<12)>>16&255,p+=String.fromCharCode(l);break}l=(s=i<<18|n<<12|o<<6|a)>>16&255,u=s>>8&255,c=255&s,p+=String.fromCharCode(l,u,c)}return p},e.prototype._decodeJwt=function(t){if(this._isEmpty(t))return null;var e=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);return!e||e.length<4?(this.warn("The returned id_token is not parseable."),null):{header:e[1],JWSPayload:e[2],JWSSig:e[3]}},e.prototype._convertUrlSafeToRegularBase64EncodedString=function(t){return t.replace("-","+").replace("_","/")},e.prototype._serialize=function(t,e,r){var i=[];if(null!==e){i.push("?response_type="+t),i.push("client_id="+encodeURIComponent(e.clientId)),r&&i.push("resource="+encodeURIComponent(r)),i.push("redirect_uri="+encodeURIComponent(e.redirectUri)),i.push("state="+encodeURIComponent(e.state)),e.hasOwnProperty("slice")&&i.push("slice="+encodeURIComponent(e.slice)),e.hasOwnProperty("extraQueryParameter")&&i.push(e.extraQueryParameter);var n=e.correlationId?e.correlationId:this._guid();i.push("client-request-id="+encodeURIComponent(n))}return i.join("&")},e.prototype._deserialize=function(t){function e(t){return decodeURIComponent(t.replace(i," "))}var r,i=/\+/g,n=/([^&=]+)=([^&]*)/g,o={};for(r=n.exec(t);r;)o[e(r[1])]=e(r[2]),r=n.exec(t);return o},e.prototype._decimalToHex=function(t){for(var e=t.toString(16);e.length<2;)e="0"+e;return e},e.prototype._guid=function(){var t=window.crypto||window.msCrypto;if(t&&t.getRandomValues){var e=new Uint8Array(16);return t.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,this._decimalToHex(e[0])+this._decimalToHex(e[1])+this._decimalToHex(e[2])+this._decimalToHex(e[3])+"-"+this._decimalToHex(e[4])+this._decimalToHex(e[5])+"-"+this._decimalToHex(e[6])+this._decimalToHex(e[7])+"-"+this._decimalToHex(e[8])+this._decimalToHex(e[9])+"-"+this._decimalToHex(e[10])+this._decimalToHex(e[11])+this._decimalToHex(e[12])+this._decimalToHex(e[13])+this._decimalToHex(e[14])+this._decimalToHex(e[15])}for(var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",i="0123456789abcdef",n=0,o="",a=0;a<36;a++)"-"!==r[a]&&"4"!==r[a]&&(n=16*Math.random()|0),"x"===r[a]?o+=i[n]:"y"===r[a]?(n&=3,o+=i[n|=8]):o+=r[a];return o},e.prototype._expiresIn=function(t){return t=t||3599,this._now()+parseInt(t,10)},e.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},e.prototype._addAdalFrame=function(t){if(void 0!==t){this.info("Add adal frame to document:"+t);var e=document.getElementById(t);if(!e){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var r=document.createElement("iframe");r.setAttribute("id",t),r.setAttribute("aria-hidden","true"),r.style.visibility="hidden",r.style.position="absolute",r.style.width=r.style.height=r.borderWidth="0px",e=document.getElementsByTagName("body")[0].appendChild(r)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+t+'" id="'+t+'" style="display:none"></iframe>');window.frames&&window.frames[t]&&(e=window.frames[t])}return e}},e.prototype._saveItem=function(t,e,r){if(this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info("Local storage is not supported"),!1;if(r){var i=this._getItem(t)||"";localStorage.setItem(t,i+e+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(t,e);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(t,e),!0):(this.info("Session storage is not supported"),!1)},e.prototype._getItem=function(t){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(t):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(t):(this.info("Session storage is not supported"),null)},e.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem("storageTest","A"),"A"==window.localStorage.getItem("storageTest")&&(window.localStorage.removeItem("storageTest"),!window.localStorage.getItem("storageTest")))}catch(t){return!1}},e.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem("storageTest","A"),"A"==window.sessionStorage.getItem("storageTest")&&(window.sessionStorage.removeItem("storageTest"),!window.sessionStorage.getItem("storageTest")))}catch(t){return!1}},e.prototype._cloneConfig=function(t){if(null===t||"object"!=typeof t)return t;var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},e.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},e.prototype.log=function(t,e,r,i){if(t<=Logging.level){if(!Logging.piiLoggingEnabled&&i)return;var n=(new Date).toUTCString(),o="";o=this.config.correlationId?n+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[t]+" "+e:n+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[t]+" "+e,r&&(o+="\nstack:\n"+r.stack),Logging.log(o)}},e.prototype.error=function(t,e){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,t,e)},e.prototype.warn=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,t,null)},e.prototype.info=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,t,null)},e.prototype.verbose=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,t,null)},e.prototype.errorPii=function(t,e){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,t,e,!0)},e.prototype.warnPii=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,t,null,!0)},e.prototype.infoPii=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,t,null,!0)},e.prototype.verbosePii=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,t,null,!0)},e.prototype._libVersion=function(){return"1.0.17"},t.exports&&(t.exports=e,t.exports.inject=function(t){return new e(t)}),e)});Af.inject;function Pf(t){this.message=t}(Pf.prototype=new Error).name="InvalidCharacterError";var Mf="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new Pf("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,i,n=0,o=0,a="";i=e.charAt(o++);~i&&(r=n%4?64*r+i:i,n++%4)&&(a+=String.fromCharCode(255&r>>(-2*n&6))))i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(i);return a};function Lf(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return function(t){return decodeURIComponent(Mf(t).replace(/(.)/g,function(t,e){var r=e.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}(e)}catch(t){return Mf(e)}}function Of(t){this.message=t}(Of.prototype=new Error).name="InvalidTokenError";function Df(t,e){if("string"!=typeof t)throw new Of("Invalid token specified");var r=!0===(e=e||{}).header?0:1;try{return JSON.parse(Lf(t.split(".")[r]))}catch(t){throw new Of("Invalid token specified: "+t.message)}}Df.InvalidTokenError=Of;var Rf=(zf.prototype.initialize=function(){var r=this;return this.initPromise||(this.initPromise=new Promise(function(t,e){if(r.options.authType===p.AuthenticationType.subscriptionKey)t();else if(r.options.authType===p.AuthenticationType.aad){if(r.options.authContext=r.options.authContext||zf.getDefaultAuthContext(r.options),r.options.authContext.handleWindowCallback(),r.options.authContext.getLoginError())return void e(new Error("Error logging in the AAD users: "+r.options.authContext.getLoginError()));if(r.options.authContext.isCallback(window.location.hash))return void r.map.dispose();setTimeout(function(){return r._loginAndAcquire(t,e)})}else r.options.authType===p.AuthenticationType.anonymous?t(r._triggerTokenFetch()):e(new Error("An invalid authentication type was specified."))})),this.initPromise},zf.getDefaultAuthContext=function(t){if(!t.aadAppId)throw new Error("No AAD app ID was specified.");if(!t.aadTenant)throw new Error("No AAD tenant was specified.");return this.defaultAuthContext||(this.defaultAuthContext=new Af({instance:t.aadInstance||l,tenant:t.aadTenant,clientId:t.aadAppId,cacheLocation:this.constants.preferredCacheLocation})),this.defaultAuthContext},zf.prototype._loginAndAcquire=function(r,i){function t(){n.options.authContext.acquireToken(v,function(t){if(t)i(new Error(t));else{var e={map:n.map,type:zf.constants.events.tokenAcquired};n.map.events.invoke(zf.constants.events.tokenAcquired,e),r()}})}var n=this,e=this.options.authContext.getCachedToken(this.options.aadAppId),o=this.options.authContext.getCachedUser();if(e&&o)t();else{this.options.authContext.loginInProgress()||this.options.authContext.login();var a=setInterval(function(){n.options.authContext.loginInProgress()||(clearInterval(a),n.options.authContext.getCachedToken(n.options.aadAppId)?t():i(new Error(n.options.authContext.getLoginError()||"The AAD authentication context is not logged-in for the specified app ID: "+n.options.aadAppId)))},25)}},zf.prototype.getAuthType=function(){return this.options.authType},zf.prototype.getClientId=function(){return this.options.clientId},zf.prototype.getToken=function(){var i=this;if(this.options.authType===p.AuthenticationType.aad){var n=this.options.authContext.getCachedToken(v);return n||(this.options.authContext.getCachedUser()||this.options.authContext.login(),this.options.authContext.acquireToken(v,function(t,e){if(!t){n=e;var r={map:i.map,type:zf.constants.events.tokenAcquired};i.map.events.invoke(zf.constants.events.tokenAcquired,r)}})),n}if(this.options.authType===p.AuthenticationType.anonymous){var t=this._getItem(zf.constants.storage.accessTokenKey);if(t){var e=this._getTokenExpiry(t);if(e<300&&0<e)this._triggerTokenFetch();else if(e<=0)throw this._saveItem(zf.constants.storage.accessTokenKey,""),new Error(zf.constants.errors.tokenExpired)}else this._triggerTokenFetch();return t}if(this.options.authType===p.AuthenticationType.subscriptionKey)return this.options.subscriptionKey},zf.prototype._getTokenExpiry=function(t){var e=Df(t).exp,r=this._getCurrentTime();return 0<e-r?e-r:-1},zf.prototype._storeAccessToken=function(t){this._saveItem(zf.constants.storage.accessTokenKey,t);var e={map:this.map,type:zf.constants.events.tokenAcquired};this.map.events.invoke(zf.constants.events.tokenAcquired,e)},zf.prototype._saveItem=function(t,e){return this._supportsLocalStorage()?(localStorage.setItem(t,e),!0):!!this._supportsSessionStorage()&&(sessionStorage.setItem(t,e),!0)},zf.prototype._getItem=function(t){return this._supportsLocalStorage()?localStorage.getItem(t):this._supportsSessionStorage()?sessionStorage.getItem(t):null},zf.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem(zf.constants.storage.testStorageKey,"A"),"A"===window.localStorage.getItem(zf.constants.storage.testStorageKey)&&(window.localStorage.removeItem(zf.constants.storage.testStorageKey),!window.localStorage.getItem(zf.constants.storage.testStorageKey)))}catch(t){return!1}},zf.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem(zf.constants.storage.testStorageKey,"A"),"A"===window.sessionStorage.getItem(zf.constants.storage.testStorageKey)&&(window.sessionStorage.removeItem(zf.constants.storage.testStorageKey),!window.sessionStorage.getItem(zf.constants.storage.testStorageKey)))}catch(t){return!1}},zf.prototype._getCurrentTime=function(){return Math.round((new Date).getTime()/1e3)},zf.prototype.signRequest=function(t){t.headers=t.headers||{},t.headers[_]=this.sessionId,t.headers[g]=y,t.headers[f]="MapControl/"+O+" (Web)";var e=this.getToken();switch(this.options.authType){case p.AuthenticationType.aad:case p.AuthenticationType.anonymous:t.headers[m]=this.options.clientId,t.headers[u]=c+e;break;case p.AuthenticationType.subscriptionKey:if("url"in t)-1!==t.url.indexOf("?")?t.url+="&subscription-key="+e:t.url+="?&subscription-key="+e;else{if(!("domain"in t))throw new Error("Could not determine if the provided object was UrlOptions or RequestParameters");t.queryParams=t.queryParams||{},t.queryParams["subscription-key"]=e}break;default:throw new Error("An invalid authentication type was specified")}return t},zf.constants={preferredCacheLocation:"localStorage",storage:{accessTokenKey:"access.token.key",testStorageKey:"testStorage"},events:{tokenAcquired:"tokenacquired"},tokenExpiresIn:3599,tokenRefreshClockSkew:300,errors:{tokenExpired:"Token Expired, Try again"}},zf);function zf(t){var n=this;this._triggerTokenFetch=function(){return new Promise(function(r,i){n.options.getToken(function(t){try{var e=n._getTokenExpiry(t)-zf.constants.tokenRefreshClockSkew;n._storeAccessToken(t),clearTimeout(n.tokenTimeOutHandle),n.tokenTimeOutHandle=setTimeout(n._triggerTokenFetch,1e3*e),r()}catch(t){i(new Error("Invalid token returned by getToken function"))}},function(t){i(t)},n.map)})};var e=t.getServiceOptions();this.options=e.authOptions,this.sessionId=e.sessionId,this.map=t}var Nf=(Bf.prototype.add=function(t,e){if(Array.isArray(t))for(var r=0,i=t;r<i.length;r++){var n=i[r];this._add(n,e)}else this._add(t,e)},Bf.prototype.getControls=function(){return Array.from(this.controls)},Bf.prototype.remove=function(t){if(Array.isArray(t))for(var e=0,r=t;e<r.length;e++){var i=r[e];this._remove(i)}else this._remove(t)},Bf.prototype._add=function(t,e){this.controls.add(t);var r=(new N).merge(e),i=t.onAdd(this.map,e),n=this.controlContainer.getElementsByClassName(r.position);if(!(0<n.length))throw new Error("Control position "+r.position+" does not exist.");n.item(0).appendChild(i)},Bf.prototype._remove=function(t){t.onRemove(),this.controls.delete(t)},Bf);function Bf(t){for(var e in this.map=t,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("atlas-control-container"),p.ControlPosition)if(p.ControlPosition.hasOwnProperty(e)){var r=document.createElement("div");r.classList.add(p.ControlPosition[e]),r.classList.add("subcontrol-container"),this.controlContainer.appendChild(r)}this.map.getMapContainer().appendChild(this.controlContainer),this.controls=new Set}var Ff=(Uf.prototype.addCallback=function(s,l,u,t,c){var e,p,h=this;if(t)e=function(t){var e=t.lngLat?new _o(t.lngLat.lng,t.lngLat.lat):void 0,r=t.point?[t.point.x,t.point.y]:void 0,i=t.features?t.features.map(function(t){return new cn(t.geometry,t.properties,t.id)}):[],n={type:t.type,originalEvent:t.originalEvent,position:e,coordinate:r,features:i};u(n)};else switch(s){case"data":case"sourcedata":case"styledata":e=function(t){var e=w(w({dataType:t.dataType},"source"===t.dataType&&w(w(w({isSourceLoaded:t.isSourceLoaded},t.sourceDataType&&{sourceDataType:t.sourceDataType}),{source:h.map.sources.getById(t.sourceId)}),t.tile&&{tile:{id:{x:t.tile.tileID.canonical.x,y:t.tile.tileID.canonical.y,z:t.tile.tileID.canonical.z},size:t.tile.tileSize,state:t.tile.state}})),{map:h.map,type:t.type});c&&h.map.events._removeListener(s,l,u),u(e)};break;case"error":e=function(t){var e={error:t.error,map:h.map,type:t.type};c&&h.map.events._removeListener(s,l,u),u(e)};break;case"touchstart":case"touchend":case"touchmove":case"touchcancel":e=function(t){if(t.originalEvent){if(t.originalEvent===p)return;p=t.originalEvent}var e=t.point?new dn(t.point.x,t.point.y):void 0,r=t.points?t.points.map(function(t){return new dn(t.x,t.y)}):[],i=t.lngLat?new _o(t.lngLat.lng,t.lngLat.lat):void 0,n=t.lngLats?t.lngLats.map(function(t){return new _o(t.lng,t.lat)}):[],o=i?h.map.layers.getRenderedShapes(new mn(i),l?[l]:void 0):[],a={map:h.map,originalEvent:t.originalEvent,pixel:e,pixels:r,position:i,positions:n,shapes:o,layerId:l||void 0,preventDefault:t.preventDefault,type:t.type};c&&h.map.events._removeListener(s,l,u),u(a)};break;case"mousedown":case"mouseup":case"mouseover":case"mousemove":case"click":case"dblclick":case"mouseout":case"mouseenter":case"mouseleave":case"contextmenu":e=function(t){if(t.originalEvent){if(t.originalEvent===p)return;p=t.originalEvent}var e=t.lngLat?new _o(t.lngLat.lng,t.lngLat.lat):void 0,r=t.point?new dn(t.point.x,t.point.y):void 0,i=e?h.map.layers.getRenderedShapes(new mn(e),l?[l]:void 0):[],n={map:h.map,originalEvent:t.originalEvent,position:e,pixel:r,preventDefault:t.preventDefault,shapes:i,layerId:l||void 0,type:t.type};c&&h.map.events._removeListener(s,l,u),u(n)};break;case"styleimagemissing":e=function(t){c&&h.map.events._removeListener(s,l,u),u(t.id)};break;case"wheel":e=function(t){if(t.originalEvent){if(t.originalEvent===p)return;p=t.originalEvent}var e={map:h.map,originalEvent:t.originalEvent,preventDefault:t.preventDefault,type:t.type};c&&h.map.events._removeListener(s,l,u),u(e)};break;case"resize":e=function(t){var e={map:h.map,type:t.type};for(var r in t)"type"!==r&&"target"!==r&&(e[r]=t[r]);c&&h.map.events._removeListener(s,l,u),u(e)};break;default:e=function(t){var e={map:h.map,type:t.type};t.originalEvent&&(e.originalEvent=t.originalEvent),c&&h.map.events._removeListener(s,l,u),u(e)}}this.callbacks.has(l)||this.callbacks.set(l,new Ci),this.callbacks.get(l).has(s)||this.callbacks.get(l).set(s,new Ci),this.callbacks.get(l).get(s).set(u,[e,c])},Uf.prototype.removeCallback=function(t,e,r){this.callbacks.has(e)&&this.callbacks.get(e).has(t)&&this.callbacks.get(e).get(t).has(r)&&this.callbacks.get(e).get(t).delete(r)},Uf.prototype.getModifiedCallback=function(t,e,r){if(this.callbacks.has(e)&&this.callbacks.get(e).has(t)&&this.callbacks.get(e).get(t).has(r))return this.callbacks.get(e).get(t).get(r)[0]},Uf.prototype.getLayerCallbacks=function(t){if(this.callbacks.has(t))return this.callbacks.get(t)},Uf.prototype.getEventCallbacks=function(t,e){if(this.callbacks.has(e)){var r=this.callbacks.get(e);if(r.has(t))return r.get(t)}},Uf);function Uf(t){this.callbacks=new Ci,this.map=t}var jf=(qf.prototype.add=function(t,e,r){if("function"==typeof e)this._addGlobalListener(t,e,!1,!1);else for(var i=0,n=e=Array.isArray(e)?e:[e];i<n.length;i++){var o=n[i];o instanceof ha&&ha._isMBoxEvent(t)?this._addLayerListener(t,o,r,!1,!1):o._addEventListener(t,r,!1)}},qf.prototype.addOnce=function(t,e,r){"function"==typeof e?this._addGlobalListener(t,e,!1,!0):e instanceof ha&&ha._isMBoxEvent(t)?this._addLayerListener(t,e,r,!1,!0):e._addEventListener(t,r,!0)},qf.prototype._addLegacy=function(t,e,r){"function"==typeof e?this._addGlobalListener(t,e,!0,!1):this._addLayerListener(t,e,r,!0,!1)},qf.prototype._addLayerListener=function(t,e,r,i,n){var o=e instanceof ha?e.getId():e,a=this.map.layers.getLayerById(o),s=this.mapCallbackHandler.getModifiedCallback(t,o,r);if(s&&a)for(var l=0,u=a._getLayerIds();l<u.length;l++){var c=u[l];this.map._getMap().off(t,c,s)}if(this.mapCallbackHandler.addCallback(t,o,r,i,n),a){s=this.mapCallbackHandler.getModifiedCallback(t,o,r);for(var p=0,h=a._getLayerIds();p<h.length;p++)c=h[p],this.map._getMap().on(t,c,s)}},qf.prototype._addGlobalListener=function(t,e,r,i){var n=this.mapCallbackHandler.getModifiedCallback(t,"",e);if(n&&this.map._getMap().off(t,n),this.mapCallbackHandler.addCallback(t,"",e,r,i),n=this.mapCallbackHandler.getModifiedCallback(t,"",e),"load"===t&&this.map._isLoaded()){var o={type:"load",map:this.map};setTimeout(function(){return n(o)})}else if("ready"===t){if(this.map._isReady()){var a={type:"ready",map:this.map};setTimeout(function(){return n(a)})}}else this.map._getMap().on(t,n)},qf.prototype.invoke=function(t,e,r){if(void 0===r)this._invokeListeners(t,"",e);else if(e instanceof ha&&ha._isMBoxEvent(t))this._invokeListeners(t,e.getId(),r);else{if(!(e instanceof So))throw new Error("The invoke target is invalid.");e._invokeEvent(t,r)}},qf.prototype._invokeListeners=function(r,i,n){var o=this,t=this.mapCallbackHandler.getEventCallbacks(r,i);t?t.forEach(function(t,e){t[0],t[1]&&o._removeListener(r,i,e),e(n)}):"error"===r&&console.error("error"in n?n.error:n)},qf.prototype.remove=function(t,e,r){if("function"==typeof e)this._removeListener(t,"",e);else for(var i=0,n=e=Array.isArray(e)?e:[e];i<n.length;i++){var o=n[i];o instanceof ha&&ha._isMBoxEvent(t)?this._removeListener(t,o,r):o._removeEventListener(t,r)}},qf.prototype._removeLegacy=function(t,e,r){"function"==typeof e?this._removeListener(t,"",e):this._removeListener(t,e,r)},qf.prototype._removeListener=function(t,e,r){var i=e instanceof ha?e.getId():e,n=this.mapCallbackHandler.getModifiedCallback(t,i,r);if(n)if(i){var o=this.map.layers.getLayerById(i);if(o)for(var a=0,s=o._getLayerIds();a<s.length;a++){var l=s[a];this.map._getMap().off(t,l,n)}}else this.map._getMap().off(t,n);this.mapCallbackHandler.removeCallback(t,i,r)},qf.prototype._enableLayerEvents=function(a){var s=this,t=this.mapCallbackHandler.getLayerCallbacks(a.getId());t&&t.forEach(function(t,o){t.forEach(function(t){for(var e=t[0],r=0,i=a._getLayerIds();r<i.length;r++){var n=i[r];s.map._getMap().on(o,n,e)}})})},qf.prototype._disableLayerEvents=function(a){var s=this,t=this.mapCallbackHandler.getLayerCallbacks(a.getId());t&&t.forEach(function(t,o){t.forEach(function(t){for(var e=t[0],r=0,i=a._getLayerIds();r<i.length;r++){var n=i[r];s.map._getMap().off(o,n,e)}})})},qf);function qf(t){this.map=t,this.mapCallbackHandler=new Ff(this.map)}var Vf=(Gf.prototype.add=function(t,e){if(Array.isArray(t))for(var r=0,i=t;r<i.length;r++){var n=i[r];this._addMarker(n,e)}else this._addMarker(t,e)},Gf.prototype._addMarker=function(t,e){t._addToMap(this.map,e),this.markers.add(t)},Gf.prototype.getMarkers=function(){return Array.from(this.markers)},Gf.prototype.remove=function(t){if(Array.isArray(t))for(var e=0,r=t;e<r.length;e++){var i=r[e];this._removeMarker(i)}else this._removeMarker(t)},Gf.prototype._removeMarker=function(e){var r=this;e instanceof Vs?(e._removeFromMap(),this.markers.delete(e)):this.markers.forEach(function(t){t._getId()===e&&(t._removeFromMap(),r.markers.delete(t))})},Gf.prototype.clear=function(){var e=this;this.markers.forEach(function(t){t._removeFromMap(),e.markers.delete(t)})},Gf);function Gf(t){this.markers=new Set,this.map=t}var Zf=(Hf.prototype.add=function(a,e){var s=this;return new Promise(function(r,i){if(s.userImages.has(a))r();else if(e instanceof HTMLImageElement||e instanceof ImageData)s.map._getMap().addImage(a,e),s.userImages.set(a,e),r();else if("string"==typeof e){var n,t=void 0;t=/<svg/i.test(e)&&!/^data:/i.test(e)?"data:image/svg+xml;base64,"+window.btoa(e):e;var o=!1;s.map._sendRequest(t,"Image").then(function(t){if(!o)return t.blob()}).then(function(t){if(!o){clearTimeout(n);var e=new Image;e.onload=function(){s.map._getMap().addImage(a,e),s.userImages.set(a,e),r()},e.onerror=e.onabort=function(){i("Failed to load image into HTML element.")},e.src=URL.createObjectURL(t)}}).catch(function(){o||(clearTimeout(n),i("Failed to load image into HTML element."))}),n=setTimeout(function(){o=!0,i("Failed to load image within specified timeout: "+s.imageLoadTimeout+" ms.")},s.imageLoadTimeout)}})},Hf.prototype.clear=function(){var r=this;this.userImages.forEach(function(t,e){r.map._getMap().removeImage(e)}),this.userImages.clear()},Hf.prototype.getImageIds=function(){var r=[];return this.userImages.forEach(function(t,e){r.push(e)}),r},Hf.prototype.createFromTemplate=function(t,e,r,i,n){r=r||"#1A73AA",i=i||"#fff";var o=Gl(e,n);return o=o.replace(/{color}/g,r).replace(/{secondaryColor}/g,i).replace(/{text}/g,""),this.add(t,o)},Hf.prototype.hasImage=function(t){return this.userImages.has(t)},Hf.prototype.remove=function(t){this.map._getMap().removeImage(t),this.userImages.delete(t)},Hf.prototype._restoreImages=function(){var r=this;this.userImages.forEach(function(t,e){r.map._getMap().hasImage(e)||r.map._getMap().addImage(e,t)})},Hf);function Hf(t){this.userImages=new Ci,this.imageLoadTimeout=5e3,this.map=t}var Wf=(Kf.prototype.add=function(t,e,r){void 0===r&&(r=!0);var i=e instanceof ha?e.getId():e;if(Array.isArray(t))for(var n=0,o=t;n<o.length;n++){var a=o[n];this._addLayer(a,i,r)}else this._addLayer(t,i,r)},Kf.prototype._addLayer=function(e,r,t){if(r!==e.getId()&&this.layersById.has(r))if(this.layersById.has(e.getId())){var i=this.layers.findIndex(function(t){return t.getId()===e.getId()});t&&(this._removeMapboxLayers(this.layers[i]),this._addMapboxLayers(e,r)),this.layers[i].onRemove(),e.onAdd(this.map),this.map.events._disableLayerEvents(this.layers[i]),this.map.events._enableLayerEvents(e),this.layersById.set(e.getId(),e),this.layers.splice(i,1);var n=this.layers.findIndex(function(t){return t.getId()===r});this.layers.splice(n,0,e)}else t&&this._addMapboxLayers(e,r),n=this.layers.findIndex(function(t){return t.getId()===r}),this.layers.splice(n,0,e),this.layersById.set(e.getId(),e),e.onAdd(this.map),this.map.events._enableLayerEvents(e);else this.layersById.has(e.getId())?(i=this.layers.findIndex(function(t){return t.getId()===e.getId()}),t&&(this._removeMapboxLayers(this.layers[i]),this._addMapboxLayers(e,i+1)),this.layers[i].onRemove(),e.onAdd(this.map),this.map.events._disableLayerEvents(this.layers[i]),this.map.events._enableLayerEvents(e),this.layersById.set(e.getId(),e),this.layers[i]=e):(t&&this._addMapboxLayers(e),this.layersById.set(e.getId(),e),this.layers.push(e),e.onAdd(this.map),this.map.events._enableLayerEvents(e))},Kf.prototype._addMapboxLayers=function(t,e){if(!this.map._isReady())throw new Error("The layer '"+t.getId()+"' could not be added to the map because the map is not ready. Please use a ready event listener to guarantee the map is ready before adding a layer to it.");if(!(t instanceof bs)||t.getOptions().tileUrl){t instanceof za&&this.map._getMap().addSource(t._getSourceId(),t._buildSource());for(var r=this._getMapboxBefore(e),i=0,n=t._buildLayers();i<n.length;i++){var o=n[i];this.map._getMap().addLayer(o,r)}}},Kf.prototype._removeMapboxLayers=function(t){for(var e=0,r=t._getLayerIds();e<r.length;e++){var i=r[e];this.map._getMap().getLayer(i)&&this.map._getMap().removeLayer(i)}t instanceof za&&this.map._getMap().getSource(t._getSourceId())&&this.map._getMap().removeSource(t._getSourceId())},Kf.prototype._getMapboxBefore=function(e){if("string"==typeof e){var t=this.layersById.get(e);if(!t)return;for(var r=0,i=t._getLayerIds();r<i.length;r++){var n=i[r];if(this.map._getMap().getLayer(n))return n}e=this.layers.findIndex(function(t){return t.getId()===e})+1}for(var o=e;o<this.layers.length;o++)for(var a=0,s=this.layers[o]._getLayerIds();a<s.length;a++)if(n=s[a],this.map._getMap().getLayer(n))return n},Kf.prototype.clear=function(){for(var t=this.layers.length-1;0<=t;t--)this._removeMapboxLayers(this.layers[t]),this.layers[t].onRemove(),this.map.events._disableLayerEvents(this.layers[t]),this.layersById.delete(this.layers[t].getId()),this.layers.splice(t,1)},Kf.prototype.getLayerById=function(t){return this.layersById.get(t)},Kf.prototype.getLayers=function(){return this.layers.slice(0)},Kf.prototype._getSourceIds=function(){for(var e=new Set,t=0,r=this.layers;t<r.length;t++)r[t]._getSourceIds().forEach(function(t){return e.add(t)});return e},Kf.prototype.move=function(t,e){var r=t instanceof ha?t.getId():t,i=e instanceof ha?e.getId():e;if(!this.layersById.has(r))throw new Error("The layer '"+r+"' has not been added to the map and cannot be moved.");var n=this.layers.findIndex(function(t){return t.getId()===r});if(this._moveMapboxLayers(this.layers[n],i),t=this.layers[n],this.layers.splice(n,1),this.layersById.has(i)){var o=this.layers.findIndex(function(t){return t.getId()===i});this.layers.splice(o,0,t)}else this.layers.push(t)},Kf.prototype._moveMapboxLayers=function(t,e){for(var r=this._getMapboxBefore(e),i=0,n=t._getLayerIds();i<n.length;i++){var o=n[i];this.map._getMap().moveLayer(o,r)}},Kf.prototype.getRenderedShapes=function(t,e,r){var i,n,o=this;if(t=t||[-180,-85.0511,180,85.0511],Array.isArray(t)?4===t.length||6===t.length?i=this.map.positionsToPixels([Oo.getSouthWest(t),Oo.getNorthEast(t)]):2!==t.length&&3!==t.length||(i=this.map.positionsToPixels([t])[0]):i=this.map.positionsToPixels([t.coordinates])[0],e){n=[];for(var a=0,s=e=Array.isArray(e)?e:[e];a<s.length;a++){var l=s[a],u=l instanceof ha?l.getId():l;if(!this.layersById.has(u))throw new Error("The layer '"+u+"' has not been added to the map and its rendered features cannot be retrieved.");n.push.apply(n,this.layersById.get(u)._getLayerIds().filter(function(t){return!!o.map._getMap().getLayer(t)}))}}var c=this.map._getMap().queryRenderedFeatures(i,{layers:n,filter:r});return this.map.sources._mapFeaturesToShapes(c)},Kf.prototype.remove=function(t,e){if(void 0===e&&(e=!0),Array.isArray(t))for(var r=0,i=t;r<i.length;r++){var n=i[r];this._removeLayer(n,e)}else this._removeLayer(t,e)},Kf.prototype._removeLayer=function(t,e){var r=t instanceof ha?t.getId():t;if(!this.layersById.has(r))throw new Error("The layer '"+r+"' has not been added to the map and cannot be removed.");var i=this.layers.findIndex(function(t){return t.getId()===r});e&&this._removeMapboxLayers(this.layers[i]),this.layers[i].onRemove(),this.map.events._disableLayerEvents(this.layers[i]),this.layersById.delete(r),this.layers.splice(i,1)},Kf);function Kf(t){this.layersById=new Ci,this.layers=[],this.map=t}var Xf=(Yf.prototype.add=function(t){for(var e=0,r=t=Array.isArray(t)?t:[t];e<r.length;e++){var i=r[e];this.popups.has(i)||(this.popups.add(i),i.attach(this.map))}},Yf.prototype.clear=function(){var e=this;this.popups.forEach(function(t){e.popups.delete(t),t.remove()})},Yf.prototype.remove=function(t){for(var e=0,r=t=Array.isArray(t)?t:[t];e<r.length;e++){var i=r[e];this.popups.has(i)&&(this.popups.delete(i),i.remove())}},Yf.prototype.getPopups=function(){return Array.from(this.popups)},Yf.prototype._getCollectionDiv=function(){var t=this.map.getMapContainer().querySelector("."+Yf.Css.collection);return t||((t=document.createElement("div")).classList.add(Yf.Css.collection),t.setAttribute("role","region"),t.setAttribute("aria-label","Map Information"),this.map.getMapContainer().appendChild(t)),t},Yf.prototype._addDraggedPopup=function(t){0===this.draggedPopups.size&&(this.map.getMapContainer().addEventListener("mousemove",this._onDrag),this.map.getMapContainer().addEventListener("touchmove",this._onDrag),this.map.getMapContainer().addEventListener("mouseup",this._onUp),this.map.getMapContainer().addEventListener("touchend",this._onUp)),this.draggedPopups.add(t)},Yf.Css={collection:"popup-collection-container"},Yf);function Yf(t){var i=this;this._onDrag=function(t){var e,r;"mousemove"===t.type?(e=(t=t).clientX,r=t.clientY):"touchmove"===t.type&&(e=(t=t).touches[0].clientX,r=t.touches[0].clientY),i.draggedPopups.forEach(function(t){t._dragToPixel([e,r])})},this._onUp=function(){i.map.getMapContainer().removeEventListener("mousemove",i._onDrag),i.map.getMapContainer().removeEventListener("touchmove",i._onDrag),i.map.getMapContainer().removeEventListener("mouseup",i._onUp),i.map.getMapContainer().removeEventListener("touchend",i._onUp),i.draggedPopups.forEach(function(t){i.draggedPopups.delete(t),t._onUp()})},this.map=t,this.popups=new Set,this.draggedPopups=new Set}var Jf=(Qf.prototype.add=function(t,e){if(void 0===e&&(e=!0),Array.isArray(t))for(var r=0,i=t;r<i.length;r++){var n=i[r];this._addSource(n,e)}else this._addSource(t,e)},Qf.prototype.getRenderedShapes=function(t,e,r){var i="string"==typeof t?t:t.getId(),n=this.map._getMap().querySourceFeatures(i,{sourceLayer:r,filter:e});return this.map.sources._mapFeaturesToShapes(n,!0,this.sources.get(i))},Qf.prototype._buildSources=function(){var e={};return this.sources.forEach(function(t){e[t.getId()]=t._buildSource()}),e},Qf.prototype.clear=function(){var e=this;this.sources.forEach(function(t){e.remove(t)})},Qf.prototype.getById=function(t){return this.sources.get(t)},Qf.prototype.getSources=function(){return Array.from(this.sources.values())},Qf.prototype.isSourceLoaded=function(t){var e=t instanceof $o?t.getId():t;return this.map._getMap().isSourceLoaded(e)},Qf.prototype.remove=function(t,e){if(void 0===e&&(e=!0),Array.isArray(t))for(var r=0,i=t;r<i.length;r++){var n=i[r];this._removeSource(n,e)}else this._removeSource(t,e)},Qf.prototype._removeSource=function(t,e){var r=t instanceof $o?t.getId():t;if(this.sources.has(r)){if(this.map._getMap().getSource(r)&&e&&this.map._getMap().removeSource(r),this.map._getMap().getSource(r)&&e)throw new Error("One or more layers have a dependency on the source '"+r+"'");return this.sources.get(r)._setMap(null),void this.sources.delete(r)}throw new Error("'"+r+"' is not added to the map")},Qf.prototype._addSource=function(t,e){if(this.sources.has(t.getId())){if(e)throw new Error("'"+t.getId()+"' is already added to the map");this.sources.get(t.getId())._setMap(null),this.sources.delete(t.getId())}if(e){if(!this.map._isReady())throw new Error("The source '"+t.getId()+"' could not be added to the map because the map is not ready. Please use a ready event listener to guarantee the map is ready before adding a source to it.");this.map._getMap().addSource(t.getId(),t._buildSource())}this.sources.set(t.getId(),t),t._setMap(this.map)},Qf.prototype._mapFeaturesToShapes=function(t,e,r){for(var i=[],n=0,o=t;n<o.length;n++){var a=o[n];if((r||"string"==typeof a.source)&&"string"==typeof a.properties[Po._shapeIdPropName]){var s=r||this.sources.get(a.source);if(s instanceof ra){var l=s.getShapeById(a.properties[Po._shapeIdPropName]);if(l instanceof Po){i.push(l);continue}}}e||i.push(a)}return i},Qf);function Qf(t){this.map=t,this.sources=new Ci}var $f,tm=(b(em,$f=E),em);function em(){var t=null!==$f&&$f.apply(this,arguments)||this;return t.duration=1e3,t.type="jump",t}var rm,im=(b(nm,rm=E),nm);function nm(){var t=null!==rm&&rm.apply(this,arguments)||this;return t.bottom=0,t.left=0,t.right=0,t.top=0,t}var om,am=(b(sm,om=E),sm.prototype.merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,i=t;r<i.length;r++){var n=i[r];n&&"number"==typeof n.padding&&(n.padding={top:n.padding,bottom:n.padding,left:n.padding,right:n.padding})}return om.prototype.merge.apply(this,t)},sm);function sm(){var t=null!==om&&om.apply(this,arguments)||this;return t.bounds=[-180,-89,180,90],t.maxBounds=void 0,t.maxZoom=20,t.offset=new dn(0,0),t.padding=new im,t}var lm,um=(b(cm,lm=E),cm);function cm(){var t=null!==lm&&lm.apply(this,arguments)||this;return t.zoom=1,t.center=new _o(0,0),t.centerOffset=new dn(0,0),t.bearing=0,t.pitch=0,t.minZoom=1,t.maxZoom=20,t.maxBounds=void 0,t}var pm,hm=(b(dm,pm=E),dm);function dm(){var t=null!==pm&&pm.apply(this,arguments)||this;return t.name=void 0,t.before=void 0,t.minZoom=1,t.maxZoom=20,t.overwrite=!1,t.defer=!1,t.opacity=1,t}var fm,mm=(b(gm,fm=hm),gm);function gm(){var t=null!==fm&&fm.apply(this,arguments)||this;return t.color="rgba(0,0,0,.5)",t.outlineColor="#000",t.radius=1,t.outlineWidth=5,t.name="default-circles",t}var ym,vm=(b(_m,ym=hm),_m);function _m(){var t=null!==ym&&ym.apply(this,arguments)||this;return t.cap="butt",t.join="miter",t.name="default-linestrings",t.color="#000",t.width=1,t}var xm,bm=(b(wm,xm=hm),wm);function wm(){var t=null!==xm&&xm.apply(this,arguments)||this;return t.iconSize=1,t.fontSize=14,t.fontColor="#000",t.textFont="SegoeUi-Regular",t.cluster=!0,t.clusterIcon=void 0,t.textOffset=[0,0],t.name="default-pins",t.icon="pin-darkblue",t.title="",t}var Sm,Tm=(b(Em,Sm=hm),Em);function Em(){var t=null!==Sm&&Sm.apply(this,arguments)||this;return t.color="rgba(0,0,0,.5)",t.outlineColor="#000",t.name="default-polygons",t}var Im,Cm=(b(km,Im=hm),km);function km(){var t=null!==Im&&Im.apply(this,arguments)||this;return t.name="default-raster",t}var Am,Pm=(b(Mm,Am=E),Mm);function Mm(){var t=null!==Am&&Am.apply(this,arguments)||this;return t.anchor="map",t.color="#FFFFFF",t.intensity=.5,t.position=[1.15,210,30],t}var Lm,Om=(b(Dm,Lm=E),Dm.prototype.merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,i=t;r<i.length;r++){var n=i[r];n&&(n.hasOwnProperty("view")?n.userRegion=n.view:n.hasOwnProperty("userRegion")&&(n.view=n.userRegion),"string"==typeof n.language&&(n.language=dl.getCode(n.language)))}return Lm.prototype.merge.apply(this,t)},Dm);function Dm(){var t=null!==Lm&&Lm.apply(this,arguments)||this;return t.autoResize=!0,t.language=Ol(),t.light=new Pm,t.preserveDrawingBuffer=!1,t.renderWorldCopies=!0,t.showBuildingModels=!1,t.showFeedbackLink=!0,t.showLogo=!0,t.showTileBoundaries=!1,t.style="road",t.view=zl(),t.userRegion=t.view,t}var Rm,zm=(b(Nm,Rm=E),Nm);function Nm(){var t=null!==Rm&&Rm.apply(this,arguments)||this;return t.flow="none",t.incidents=!1,t}var Bm,Fm=(b(Um,Bm=E),Um.prototype.merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,i=t;r<i.length;r++){var n=i[r];n&&(n.authOptions?"string"==typeof n.authOptions.subscriptionKey&&(n.subscriptionKey=n["subscription-key"]=n.authOptions.subscriptionKey):"string"==typeof n.subscriptionKey?(n["subscription-key"]=n.subscriptionKey,n.authOptions={authType:p.AuthenticationType.subscriptionKey,subscriptionKey:n.subscriptionKey}):"string"==typeof n["subscription-key"]&&(n.subscriptionKey=n["subscription-key"],n.authOptions={authType:p.AuthenticationType.subscriptionKey,subscriptionKey:n["subscription-key"]}),"string"==typeof n.sessionId?n["session-id"]=n.sessionId:"string"==typeof n["session-id"]&&(n.sessionId=n["session-id"]),"boolean"==typeof n.disableTelemetry?n["disable-telemetry"]=n.disableTelemetry:"boolean"==typeof n["disable-telemetry"]&&(n.disableTelemetry=n["disable-telemetry"]),"boolean"==typeof n.enableAccessibility?n["enable-accessibility"]=n.enableAccessibility:"boolean"==typeof n["enable-accessibility"]&&(n.enableAccessibility=n["enable-accessibility"]))}var o=Bm.prototype.merge.apply(this,t);return o.authOptions.authType!==p.AuthenticationType.subscriptionKey&&(o["subscription-key"]=o.subscriptionKey=void 0),o},Um._cloneCustomizer=function(t){if("object"==typeof t)return Object.assign({},t)},Um);function Um(){var t=null!==Bm&&Bm.apply(this,arguments)||this;return t.authOptions=Ml(),t.disableTelemetry=!1,t["disable-telemetry"]=t.disableTelemetry,t.domain=Ll(),t.enableAccessibility=!0,t["enable-accessibility"]=t.enableAccessibility,t.refreshExpiredTiles=!0,t.subscriptionKey=Rl(),t["subscription-key"]=t.subscriptionKey,t.sessionId=Dl(),t["session-id"]=t.sessionId,t.transformRequest=void 0,t}var jm=function(){this.version=8,this.sprite="",this.glyphs="",this.light={},this.sources={},this.layers=[]},qm=(Vm.prototype.build=function(t){var e=new jm;if(null!=this.glyphs&&(e.glyphs=this.glyphs),null!=this.sprite&&(e.sprite=this.sprite),null!=t.light&&Object.assign(e.light,t.light),null!=this.map.sources&&(e.sources=this.map.sources._buildSources()),null!=this.map.layers)for(var r=0,i=this.map.layers.getLayers();r<i.length;r++){var n=i[r];e.layers=e.layers.concat(n._buildLayers()),n instanceof za&&(e.sources[n._getSourceId()]=n._buildSource())}return e},Vm.prototype.setGlyphs=function(t){this.glyphs=t},Vm.prototype.setSprite=function(t){this.sprite=t},Vm);function Vm(t){this.sprite="",this.glyphs="{fontstack}/{range}",this.map=t}var Gm,Zm=(b(Hm,Gm=ha),Hm.prototype._buildLayers=function(){return this.layers},Hm.prototype._getLayerIds=function(){return this.layers.map(function(t){return t.id})},Hm.prototype._getSourceIds=function(){for(var t=new Set,e=0,r=this.layers;e<r.length;e++){var i=r[e];"string"==typeof i.source?t.add(i.source):i.source&&t.add(i.id)}return t},Hm);function Hm(t,e){var r=Gm.call(this,e)||this;return r.layers=t,r}var Wm,Km=(b(Xm,Wm=$o),Xm.prototype._buildSource=function(){return this.source},Xm.prototype._modifySource=function(t,e){var r=t.tiles.map(function(t){return"string"==typeof t?t:new P({domain:d,path:t.path,queryParams:w(w({},e),t.queryParams)}).toString()});return t.tiles=r,t},Xm);function Xm(t,e,r){var i=Wm.call(this,t)||this;return i.source=i._modifySource(e,r),i}var Ym=(Jm.prototype.initialize=function(){var e=this;return this.initPromise||(this.initPromise=this.request(o,a).then(function(t){e.definitions=t}).catch(function(t){throw new Error("Failed to retrieve the style definitions: "+t)})),this.initPromise},Jm.prototype.getStyleComponents=function(p){return S(this,void 0,void 0,function(){var c,e,r,i=this;return T(this,function(t){return c=new Set,e=this.lookUp(p),r=e.layerGroups.map(function(u){return S(i,void 0,void 0,function(){var e,r,i,n,o,a,s,l;return T(this,function(t){switch(t.label){case 0:return e=u.layerPath,r=u.name,i={language:p.language},p.view&&(i.view=p.view),[4,this.buildComponent(r,e,i,c)];case 1:if(n=t.sent(),!p.showBuildingModels)for(o=0,a=n.layer.layers;o<a.length;o++)"fill-extrusion"===(s=a[o]).type&&((l=s.paint)["fill-extrusion-base"]=0,l["fill-extrusion-height"]=0);return[2,n]}})})}),[2,Promise.all(r)]})})},Jm.prototype.getFlowComponent=function(r,i){return S(this,void 0,void 0,function(){var e;return T(this,function(t){return e=this.getFlowPath(r,i),[2,this.buildComponent("flow",e)]})})},Jm.prototype.getCopyrightCaption=function(t){var e=this.lookUp(t).copyright.join(" ");return t.showLogo||(e+=" ©2019 Microsoft"),e},Jm.prototype.getSprite=function(t){var e=this.lookUp(t);return new P({domain:this.definitions.domain,path:e.spritePath}).toString()},Jm.prototype.getGlyphs=function(t){var e=this.lookUp(t);return new P({domain:this.definitions.domain,path:e.glyphsPath}).toString()},Jm.prototype.getFlowPath=function(t,e){return this.lookUp(t).flowPaths[e.flow]},Jm.prototype.getTheme=function(t){return this.lookUp(t).theme.toLowerCase()||"light"},Jm.prototype.getDef=function(){return this.definitions},Jm.prototype.lookUp=function(t){for(var e,r=t.style||this.definitions.defaultStyle,i=0,n=this.definitions.styles;i<n.length;i++){var o=n[i];if(o.name===r)return o;o.name===this.definitions.defaultStyle&&(e=o)}return e},Jm.prototype.request=function(e,r){return S(this,void 0,void 0,function(){return T(this,function(t){return[2,new P({domain:e,path:r}).get()]})})},Jm.prototype.buildComponent=function(s,e,l,u){return S(this,void 0,void 0,function(){return T(this,function(t){return[2,this.request(this.definitions.domain,e).then(function(t){for(var e=new Zm(t.layers,s),r=[],i=0,n=t.sources;i<n.length;i++){var o=n[i],a=o.name;if(u){if(u.has(a))continue;u.add(a)}r.push(new Km(a,o,l))}return{layer:e,sources:r}})]})})},Jm);function Jm(){}var Qm=($m.prototype.getCanvas=function(){return this.map.getCanvas()},$m.prototype.getCanvasContainer=function(){return this.map.getCanvasContainer()},$m.prototype.getMapContainer=function(){return this.map.getContainer()},$m.prototype.getServiceOptions=function(){return Xo(this.serviceOptions,Fm._cloneCustomizer)},$m.prototype.setServiceOptions=function(t){this.serviceOptions=(new Fm).merge(this.serviceOptions,t),this.serviceOptions["enable-accessibility"]?this.accessibleMapDelegate.addToMap():this.accessibleMapDelegate.removeFromMap()},$m.prototype.setCamera=function(t,e){var r,i;if(void 0===e&&(e=!1),"padding"in t||"offset"in t||"bounds"in t){var n=(new am).merge({maxZoom:this.getCamera().maxZoom},t),o=this._generateSafeBounds(n.bounds);if(!(r=this.map.cameraForBounds(o,{padding:n.padding,offset:n.offset,maxZoom:n.maxZoom})))throw new Error("The map cannot be fit to the current canvas with the given CameraBoundsOptions.");this.map.setMaxZoom(n.maxZoom),i=this._generateSafeBounds(n.maxBounds)}else{var a=(new um).merge(this.getCamera(),t);if(a.centerOffset&&2<=a.centerOffset.length){var s=a.centerOffset,l=no([a.center],a.zoom);l[0][0]+=s[0],l[0][1]+=s[1],a.center=io(l,a.zoom)[0]}r={center:a.center,zoom:a.zoom,bearing:a.bearing,pitch:a.pitch,around:void 0},this.map.setMinZoom(a.minZoom),this.map.setMaxZoom(a.maxZoom),i=this._generateSafeBounds(a.maxBounds)}i?this.map.setMaxBounds(i):this.map.setMaxBounds(null);var u=(new tm).merge(t),c={duration:u.duration,easing:function(t){return t},offset:[0,0],animate:!0},p={fromControl:e};"jump"===u.type?this.map.jumpTo(r,p):"ease"===u.type?this.map.easeTo(w(w({},r),c),p):"fly"===u.type&&this.map.flyTo(w(w({},r),c),p)},$m.prototype.setCameraBounds=function(t){this.setCamera(t)},$m.prototype.getCamera=function(){var t=this.map.getBounds().getSouthWest().toArray(),e=this.map.getBounds().getNorthEast().toArray();return{zoom:this.map.getZoom(),center:this.map.getCenter().toArray(),bearing:this.map.getBearing(),pitch:this.map.getPitch(),bounds:new Oo(t,e),minZoom:this.map.getMinZoom(),maxZoom:this.map.getMaxZoom()}},$m.prototype.setStyle=function(t){delete t.preserveDrawingBuffer;var e=(new Om).merge(this.styleOptions,t);e.autoResize!==this.styleOptions.autoResize&&this._setAutoResize(e.autoResize),e.language!==this.styleOptions.language&&(this.localizedStringsPromise=dl.getStrings(e.language)),e.renderWorldCopies!==this.styleOptions.renderWorldCopies&&this.map.setRenderWorldCopies(e.renderWorldCopies),e.showFeedbackLink!==this.styleOptions.showFeedbackLink&&this.copyrightControl.setOptions({showFeedbackLink:e.showFeedbackLink}),e.showLogo&&!this.logoControl?(this.logoControl=new Ud,this.controls.add(this.logoControl,{position:p.ControlPosition.NonFixed})):!e.showLogo&&this.logoControl&&(this.controls.remove(this.logoControl),delete this.logoControl),e.showTileBoundaries!==this.styleOptions.showTileBoundaries&&(this.map.showTileBoundaries=e.showTileBoundaries),this._setStyleComponents(e),this.styleOptions=e},$m.prototype.getStyle=function(){return Ii(this.styleOptions)},$m.prototype.addIcon=function(t,e){this.imageSprite.add(t,e)},$m.prototype.addPins=function(t,e){var r,i=(new bm).merge(e),n=this.layers.getLayerById(i.name),o=!1;if(n||(o=!0,n=new ms(i.name+"-source",i.name,{source:i.name+"-source",minZoom:i.minZoom,maxZoom:i.maxZoom,iconOptions:{anchor:"center",size:i.iconSize,image:["case",["has","icon"],["get","icon"],i.icon],ignorePlacement:!i.cluster,opacity:i.opacity},textOptions:{anchor:"center",textField:["case",["has","point_count"],["to-string",["get","point_count"]],["has","title"],["to-string",["get","title"]],i.title],font:["case",["has","point_count"],["literal",["StandardFontCondensed-Bold"]],["literal",[i.textFont]]],size:["case",["has","point_count"],20,i.fontSize],ignorePlacement:!i.cluster,opacity:i.opacity,offset:["case",["has","point_count"],["literal",[.5,-.45]],["literal",[i.textOffset[0]/16,i.textOffset[1]/16]]],color:i.fontColor}})),!(n instanceof ms))throw new Error("A layer with name '"+i.name+"' already exists but it is not a SymbolLayer.A SymbolLayer should be used for rendering pins.");var a=n.getSource();"string"==typeof a?(r=a,a=this.sources.getById(r)):r=a.getId();var s=!1;if(a||(s=!0,a=new ra(r,{cluster:i.cluster})),!(a instanceof ra))throw new Error("The source with name '"+r+"' already exists but it is not a DataSource.New data can only be added to a DataSource.");s&&this.sources.add(a),o&&this.layers.add(n,i.before);var l=new Ro(t);i.defer?(i.overwrite&&a._clearNoUpdate(),a._addNoUpdate(l)):i.overwrite?a.setShapes(l):a.add(l)},$m.prototype.addCircles=function(t,e){var r,i=(new mm).merge(e),n=this.layers.getLayerById(i.name),o=!1;if(n||(o=!0,n=new ba(i.name+"-source",i.name,{source:i.name+"-source",minZoom:i.minZoom,maxZoom:i.maxZoom,opacity:i.opacity,radius:["case",["has","radius"],["get","radius"],i.radius],color:["case",["has","color"],["get","color"],i.color],strokeColor:["case",["has","outlineColor"],["get","outlineColor"],i.outlineColor],strokeWidth:["case",["has","outlineWidth"],["get","outlineWidth"],i.outlineWidth]})),!(n instanceof ba))throw new Error("A layer with name '"+i.name+"' already exists but it is not a BubbleLayer.A BubbleLayer should be used for rendering circles.");var a=n.getSource();"string"==typeof a?(r=a,a=this.sources.getById(r)):r=a.getId();var s=!1;if(a||(s=!0,a=new ra(r)),!(a instanceof ra))throw new Error("The source with name '"+r+"' already exists but it is not a DataSource.New data can only be added to a DataSource.");s&&this.sources.add(a),o&&this.layers.add(n,i.before);var l=new Ro(t);i.defer?(i.overwrite&&a._clearNoUpdate(),a._addNoUpdate(l)):i.overwrite?a.setShapes(l):a.add(l)},$m.prototype.addLinestrings=function(t,e){var r,i=(new vm).merge(e),n=this.layers.getLayerById(i.name),o=!1;if(n||(o=!0,n=new Za(i.name+"-source",i.name,{source:i.name+"-source",minZoom:i.minZoom,maxZoom:i.maxZoom,lineCap:i.cap,lineJoin:i.join,strokeOpacity:i.opacity,strokeColor:["case",["has","color"],["get","color"],i.color],strokeWidth:["case",["has","width"],["get","width"],i.width]})),!(n instanceof Za))throw new Error("A layer with name '"+i.name+"' already exists but it is not a LineLayer.A LineLayer should be used for rendering linestrings.");var a=n.getSource();"string"==typeof a?(r=a,a=this.sources.getById(r)):r=a.getId();var s=!1;if(a||(s=!0,a=new ra(r)),!(a instanceof ra))throw new Error("The source with name '"+r+"' already exists but it is not a DataSource.New data can only be added to a DataSource.");s&&this.sources.add(a),o&&this.layers.add(n,i.before);var l=new Ro(t);i.defer?(i.overwrite&&a._clearNoUpdate(),a._addNoUpdate(l)):i.overwrite?a.setShapes(l):a.add(l)},$m.prototype.addPolygons=function(t,e){var r,i=(new Tm).merge(e),n=this.layers.getLayerById(i.name),o=!1;if(n||(o=!0,n=new is(i.name+"-source",i.name,{source:i.name+"-source",minZoom:i.minZoom,maxZoom:i.maxZoom,fillOpacity:i.opacity,fillColor:["case",["has","color"],["get","color"],i.color]})),!(n instanceof is))throw new Error("A layer with name '"+i.name+"' already exists but it is not a PolygonLayer.A PolygonLayer should be used for rendering linestrings.");var a=n.getSource();"string"==typeof a?(r=a,a=this.sources.getById(r)):r=a.getId();var s=!1;if(a||(s=!0,a=new ra(r)),!(a instanceof ra))throw new Error("The source with name '"+r+"' already exists but it is not a DataSource.New data can only be added to a DataSource.");s&&this.sources.add(a),o&&this.layers.add(n,i.before);var l=new Ro(t);i.defer?(i.overwrite&&a._clearNoUpdate(),a._addNoUpdate(l)):i.overwrite?a.setShapes(l):a.add(l)},$m.prototype.addRaster=function(t,e){var r,i=(new Cm).merge(e),n=this.layers.getLayerById(i.name),o=!1;if(n||(o=!0,n=new bs({maxZoom:i.maxZoom,minZoom:i.minZoom,opacity:i.opacity,tileSize:256,tileUrl:"{subdomain}"},i.name)),!(n instanceof bs))throw new Error("A layer with name '"+i.name+"' already exists but it is not a TileLayer.A TileLayer should be used for rendering raster images.");if("{subdomain}"!==n.getOptions().tileUrl)throw new Error("A TileLayer with name '"+i.name+"' already exists but was configured for a single tile url [default for new TileLayer(...)].");(r=i.overwrite?[]:n.getOptions().subdomains||[]).push.apply(r,t),n._setOptionsNoUpdate({subdomains:r}),i.defer?o&&this.layers.add(n,i.before,!1):this.layers.add(n,i.before)},$m.prototype.getLayers=function(){return this.layers.getLayers().map(function(t){return t.getId()})},$m.prototype.removeLayers=function(t){for(var e=0,r=t;e<r.length;e++){var i=r[e];if(this.layers.getLayerById(i)){this.layers.remove(i);var n=i+"-source";this.sources.getById(n)&&this.sources.remove(n)}}},$m.prototype.addHtml=function(t,e){t.id||(t.id="marker_"+un());var r=new Vs({htmlContent:t});return this.markers.add(r,e),t.id},$m.prototype.removeHtml=function(t){this.markers.remove(t)},$m.prototype.addEventListener=function(t,e,r){this.events._addLegacy(t,e,r)},$m.prototype.removeEventListener=function(t,e,r){this.events._removeLegacy(t,e,r)},$m.prototype.setUserInteraction=function(t){this.userInteractionDelegate.setOptions(t)},$m.prototype.getUserInteraction=function(){return this.userInteractionDelegate.getOptions()},$m.prototype.addControl=function(t,e){this.controls.add(t,e)},$m.prototype.removeControl=function(t){this.controls.remove(t)},$m.prototype.setTraffic=function(t){var e=this.trafficOptions.incidents,r=this.trafficOptions.flow;if(this.trafficOptions=(new zm).merge(this.trafficOptions,t),this.trafficOptions.incidents?e||this.incidentDelegate.addToMap():this.incidentDelegate.removeFromMap(),this.trafficOptions.flow&&"none"!==this.trafficOptions.flow)try{this.flowDelegate.addToMap()}catch(t){throw this.trafficOptions.flow=r,t}else this.flowDelegate.removeFromMap()},$m.prototype.getTraffic=function(){return Ii(this.trafficOptions)},$m.prototype.remove=function(){this.dispose()},$m.prototype.clear=function(){this.popups.clear(),this.layers.clear(),this.sources.clear(),this.markers.clear()},$m.prototype.dispose=function(){for(this.clear(),this.map.remove(),this.removed=!0;this.getMapContainer().firstChild;){var t=this.getMapContainer().firstChild;this.getMapContainer().removeChild(t)}},$m.prototype.resize=function(t,e,r){if("number"!=typeof t&&"string"!=typeof t||"number"!=typeof e&&"string"!=typeof e)r=t;else{var i=t;this.getMapContainer().style.height="number"==typeof i?i+"px":i,this.getMapContainer().style.width="number"==typeof e?e+"px":e}var n=this.getMapContainer().style.overflow;this.getMapContainer().style.overflow="hidden",this.map.resize(r),this.getMapContainer().style.overflow=n},$m.prototype.pixelsToPositions=function(t){for(var e=[],r=0,i=t;r<i.length;r++){var n=i[r],o=this.map.unproject(n);e.push(new _o(o.lng,o.lat))}return e},$m.prototype.positionsToPixels=function(t){for(var e=[],r=0,i=t;r<i.length;r++){var n=i[r],o=this.map.project(n);e.push(new dn(o.x,o.y))}return e},$m.prototype.areTilesLoaded=function(){return this.map.areTilesLoaded()},$m.prototype.stop=function(){this.map.stop()},$m.prototype._getMap=function(){return this.map},$m.prototype._rebuildStyle=function(){this.map.setStyle(this.styleBuilder.build(this.styleOptions)),this.imageSprite._restoreImages()},$m.prototype._isLoaded=function(){return this.loaded},$m.prototype._isReady=function(){return this.ready},$m.prototype._getLocalizedStrings=function(){return this.localizedStringsPromise},$m.prototype._sendRequest=function(t,e,r){var i;return"function"==typeof this.serviceOptions.transformRequest&&(i=this.serviceOptions.transformRequest(t,e)),i?fetch(i.url||t,{credentials:i.credentials,headers:w(w({},r),i.headers),method:"GET",mode:"cors"}):fetch(t,{headers:r,method:"GET",mode:"cors"})},$m.prototype._setAutoResize=function(t){t?window.addEventListener("resize",this._windowResizeCallback):window.removeEventListener("resize",this._windowResizeCallback)},$m.prototype._setStyleComponents=function(g){var y=this;this.styles.getStyleComponents(g).then(function(o){if(!y.removed){y.copyrightControl.setOptions({copyrightMessage:y.styles.getCopyrightCaption(g)}),y.styleBuilder.setGlyphs(y.styles.getGlyphs(g)),y.styleBuilder.setSprite(y.styles.getSprite(g));for(var e=new Set,r=new Set,t=0,i=o;t<i.length;t++){var n=i[t];e.add(n.layer.getId());for(var a=0,s=n.sources;a<s.length;a++){var l=s[a];r.add(l.getId())}}y.styleLayerIds.forEach(function(t){e.has(t)||(y.layers.getLayerById(t)&&y.layers.remove(t,!1),y.styleLayerIds.delete(t))});for(var u=function(t){var e=o[t].layer;if(y.styleLayerIds.add(e.getId()),y.layers.getLayerById(e.getId()))y.layers.add(e,void 0,!1);else if(0===t)y.layers.add(e,y.layers.getLayers()[0],!1);else{var r=o[t-1].layer,i=y.layers.getLayers(),n=i.findIndex(function(t){return t.getId()===r.getId()});y.layers.add(e,i[n+1],!1)}},c=0;c<o.length;c++)u(c);var p=y.layers._getSourceIds();y.styleSourceIds.forEach(function(t){p.has(t)||r.has(t)||(y.sources.getById(t)&&y.sources.remove(t,!1),y.styleSourceIds.delete(t))});for(var h=0,d=o;h<d.length;h++){n=d[h],y.sources.add(n.sources,!1);for(var f=0,m=n.sources;f<m.length;f++)l=m[f],y.styleSourceIds.add(l.getId())}y._rebuildStyle()}})},$m.prototype._updateGlobalDefaults=function(t){t&&(t.authOptions&&!Zl()&&Bl(t.authOptions),t.domain&&!Hl()&&Fl(t.domain),!t.subscriptionKey&&!t["subscription-key"]||Zl()||ql(t.subscriptionKey||t["subscription-key"]),!t.sessionId&&!t["session-id"]||Kl()||jl(t.sessionId||t["session-id"]),t.language&&!Wl()&&Ul(t.language),!t.userRegion&&!t.view||Xl()||Vl(t.userRegion||t.view))},$m.prototype._generateSafeBounds=function(t){if(t){var e=Oo.getSouth(t),r=Oo.getWest(t),i=Oo.getNorth(t),n=Oo.getEast(t);if(isNaN(e)||isNaN(r)||isNaN(i)||isNaN(n))throw new Error("The bounds specified are invalid: ["+t+"]");for(;n<r;)n+=360;return new Oo([r,e,n,i])}return t},$m);function $m(t,e){var n=this;this.styleLayerIds=new Set,this.styleSourceIds=new Set,this.removed=!1,this.loaded=!1,this.ready=!1,this._windowResizeCallback=function(){return n.resize()};var r=!0;this._updateGlobalDefaults(e),this.serviceOptions=(new Fm).merge(e),this.styleOptions=(new Om).merge(e),this.trafficOptions=new zm,this.styles=new Ym,this.insights=new Bd(this.serviceOptions);var i,o={attributionControl:!1,container:t,preserveDrawingBuffer:this.styleOptions.preserveDrawingBuffer,refreshExpiredTiles:this.serviceOptions.refreshExpiredTiles,renderWorldCopies:this.styleOptions.renderWorldCopies,trackResize:!1,transformRequest:function(t,e){var r={url:t};if("Tile"===e&&t.includes(d)){if(n.insights.trackEvent({name:"TileLoad"}),P.protoRegEx.test(n.serviceOptions.domain)){var i=t.indexOf(d);r.url=n.serviceOptions.domain+t.substring(i+d.length)}else r.url=t.replace(d,n.serviceOptions.domain);n.authentication.signRequest(r)}return n.serviceOptions.transformRequest&&ll(r,n.serviceOptions.transformRequest(r.url,e)),r}};i=this.serviceOptions.authOptions.clientId?this.serviceOptions.authOptions.clientId:this.serviceOptions.authOptions.subscriptionKey?this.serviceOptions.authOptions.subscriptionKey.replace(/.(?=.{3,}$)/g,"*"):"invalid-setting",this.insights.setAuthenticatedUserContext(this.serviceOptions.sessionId,i);try{var a=new h.Map(o);this.map=a,this.authentication=new Rf(this),this.controls=new Nf(this),this.events=new jf(this),this.imageSprite=new Zf(this),this.layers=new Wf(this),this.markers=new Vf(this),this.sources=new Jf(this),this.popups=new Xf(this),this.styleBuilder=new qm(this),this.map.getContainer().classList.add("atlas-map"),this.map.getCanvasContainer().classList.add("atlas-map-canvas-container"),this.map.getCanvasContainer().id="atlas-map_"+un(),this.map.getCanvas().classList.add("atlas-map-canvas"),this.copyrightControl=new Hd({showFeedbackLink:this.styleOptions.showFeedbackLink}),this.controls.add(this.copyrightControl,{position:p.ControlPosition.NonFixed}),this.styleOptions.showLogo&&(this.logoControl=new Ud,this.controls.add(this.logoControl,{position:p.ControlPosition.NonFixed}));var s=this.authentication.initialize();if(this.removed)return;var l=function(){n.loaded=!0,n.map.off("load",l)};this.map.on("load",l);var u=function(){n.ready=!0,n.map.off("styledata",u);var t={map:n,type:"ready"};n.events.invoke("ready",t)};this.map.on("styledata",u),this._setAutoResize(this.styleOptions.autoResize),this.map.showTileBoundaries=this.styleOptions.showTileBoundaries,this.localizedStringsPromise=dl.getStrings(this.styleOptions.language);var c=this.styles.initialize();Promise.all([s,c]).then(function(){if(!n.removed){if(!n.authentication.getToken())throw new Error("AuthenticationManager finished initializing, but no token is available");n.serviceOptions["enable-accessibility"]&&n.accessibleMapDelegate.addToMap(),n._setStyleComponents(n.styleOptions)}}).catch(function(t){var e=t instanceof Error?t:new Error(t);n.insights.trackException({error:e});var r={map:n,type:"error",error:e};n.events.invoke("error",r)}),this.setCamera(w(w({},e),{type:"jump",duration:0})),this.incidentDelegate=new vf(this),this.flowDelegate=new of(this),this.accessibleMapDelegate=new nf(this),this.userInteractionDelegate=new Cf(this,e),this.userInteractionDelegate.addToMap()}catch(t){throw r=!1,this.insights.trackException({error:t instanceof Error?t:new Error(t)}),t}finally{this.insights.trackEvent({name:"MapLoad"},{success:r,supported:Nl(!1),supportedWithPerformance:Nl(!0)}),this.insights.flush()}}var tg=(eg.applyTemplate=function(e,r){var i=this,t=document.createElement("div");if(t.classList.add(eg.Css.template),e){"boolean"!=typeof(r=r||{}).singleDescription&&(r.singleDescription=!0),r.sandboxContent="boolean"!=typeof r.sandboxContent||r.sandboxContent,r.title&&"string"==typeof r.content&&(r.content.includes("{title}")||r.content.includes("{name}"))||(e.title?r.title="{title}":e.name&&(r.title="{name}")),"boolean"!=typeof r.detectHyperlinks&&(r.detectHyperlinks=!0),r.textColor&&(t.style.color=r.textColor),r.fillColor&&(t.style.backgroundColor=r.fillColor),r.title&&((a=this._applyStringTemplate(e,r.title,r)).innerText=a.textContent||a.innerText||"",this._appendChild(t,a,eg.Css.title));var n=document.createElement("div");if(n.classList.add(eg.Css.content),Array.isArray(r.content))0<r.content.length&&r.content[0].propertyPath?this._appendChild(n,this._generateContent(e,r.content,r),eg.Css.item):r.content.forEach(function(t){i._appendChild(n,i._generateContent(e,t,r),eg.Css.item)});else{var o=0;e.description&&Object.keys(e).forEach(function(t){i._ignoreProperty(t,e[t])||o++});var a=void 0;1===o||r.singleDescription&&e.description||2===o&&e.Snippet?(a=document.createElement("div")).innerHTML=e.description:a=this._generateContent(e,r.content,r),this._appendChild(n,a,eg.Css.item)}""!==n.innerHTML&&(r.sandboxContent?t.appendChild(eg._createSandboxedIframe(n,r)):t.appendChild(n))}return t},eg._createSandboxedIframe=function(t,e){var r=document.createElement("iframe");r.sandbox.add("allow-popups");var i,n=t.innerHTML,o=!1,a=100,s=550,l=10;document.body.scrollWidth<=340&&(s=300,a=50);var u=n.split(/<(tr|div|br|li|h[0-9]|p>)/);i=Math.max.apply(Math,u.map(function(t){return t.replace(/<[a-zA-Z0-9\s=\/]+>/g,"").length}))-1;var c=Math.ceil(3.5*i);if(c<s&&(s=c,a=i),n.includes("<img")||n.includes("<video"))o=!0,r.width="550px";else{var p=-1<n.indexOf(eg.Css.table)?25:20;l+=Math.max(.5*u.length*p,Math.ceil(n.replace(/<[a-zA-Z0-9\s=\/]+>/g,"").length/a)*p)}r.width=s+"px",r.height=o||280<l?"280px":l+"px";var h=e.textColor?"color:"+e.textColor+";":"",d=e.fillColor?"background-color:"+e.fillColor+";":"",f='<html><head><title></title><meta charset="utf-8" /><meta http-equiv="x-ua-compatible" content="IE=Edge" /><link rel="stylesheet" href="'+eg._cssUrl+'" type="text/css"/><style>html, body{margin:0;padding:0;'+h+d+'}</style></head><body><div class="'+eg.Css.template+'" style="padding:0;width:'+(s-20)+'px">'+n+"</div></body></html>";return void 0===r.srcdoc?r.src="data:text/html;charset=utf-8,"+encodeURI(f):r.srcdoc=f,r},eg._appendChild=function(t,e,r){e&&(r&&(e.className=(e.className?e.className+" ":"")+r),t.appendChild(e))},eg._generateContent=function(t,e,r){if(e)return Array.isArray(e)?this._generatePropertyInfoTable(t,e,r):this._applyStringTemplate(t,e,r);var i=this._generateDynamicTableHtml(t,null,r);if(i){var n=document.createElement("div");return n.innerHTML=i,n}return null},eg._applyStringTemplate=function(t,e,r){if(e){for(var i=e,n=this._placeholderRx.exec(e);n;){if(2<=n.length){var o=this._getPropertyValue(t,n[1],r);i=i.replace(n[0],o)}n=this._placeholderRx.exec(e)}if(i){(i=i.trim()).includes("<")&&(i=i.replace(/[\r\n]+/g,"<br/>"));var a=document.createElement("div");return a.innerHTML=i,a}}return null},eg._getPropertyValue=function(t,e,r,i){var n=e.split("/"),o=n.length;if(0<o&&t){var a=n[0],s=t[a];if(r.detectHyperlinks&&"link"===e&&(!i||i.hyperlinkFormat)){var l=[];if(Array.isArray(s)?s.forEach(function(t){t.href?l.push(t):"string"==typeof t&&l.push({href:t})}):s.href&&l.push(s),0<l.length){var u,c;i&&i.hyperlinkFormat?u=i.hyperlinkFormat:r&&r.hyperlinkFormat&&(u=r.hyperlinkFormat),c=u&&u.target?u.target:"_blank";var p=[];return l.forEach(function(t){t.title||u&&u.label||!t.rel||p.push(t.rel," - "),p.push('<a href="',t.href,'" target="',c,'">'),t.title?p.push(t.title):u&&u.label?p.push(u.label):p.push(t.href),p.push("</a>","<br/>")}),p.pop(),p.join("")}}if(null!=s){var h=void 0;for(h=1;h<o&&(s=s[n[h]],a=n[h],null!=s);h++);if(h===o&&null!=s){var d=void 0;if((d=void 0!==s.value?s.value:s)instanceof Date)return i&&i.dateFormat?d.toLocaleString(void 0,i.dateFormat):r.dateFormat?d.toLocaleString(void 0,r.dateFormat):d.toISOString();if("object"==typeof d)return(v=this._generateDynamicTableHtml(d,n.slice(1),r))||"";if("number"==typeof d){if(i){if(i.dateFormat)return new Date(d).toLocaleString(void 0,i.dateFormat);if(i.numberFormat)return d.toLocaleString(void 0,i.numberFormat)}else if(/(timestamp|date)/gi.test(a))return new Date(d).toISOString();return d.toLocaleString(void 0,r.numberFormat)}if("string"==typeof d&&""!==d&&!/[\n\r<>\s]/g.test(d)&&(r.detectHyperlinks||i&&i.hyperlinkFormat)){d=d.trim();var f=this._isUrlRx.test(d)||i&&i.hyperlinkFormat,m=this._isImageUrlRx.test(d)&&(f||d.startsWith("data:image")),g=this._emailRx.test(d);if(f||m||g){var y=void 0;i&&i.hyperlinkFormat?y=i.hyperlinkFormat:r&&r.hyperlinkFormat&&(y=r.hyperlinkFormat);var v=void 0;v=y&&y.target?' target="'+y.target+'"':' target="_blank"';var _=""+(y&&y.label?y.label:d);y&&y.scheme?d=y.scheme+d:g&&(d="mailto:"+d);var x=y&&y.label?' alt="'+y.label+'"':"";return(y&&y.isImage||m)&&(_='<img src="'+d+'" style="max-width:100%"'+x+'"/>'),'<a href="'+d+'"'+v+">"+_+"</a>"}}return d.toString()}}}return""},eg._generatePropertyInfoTable=function(i,t,n){if(i&&t&&0<t.length){var o=[],a=this;o.push('<table class="'+a.Css.table+'">'),t.forEach(function(t){var e=a._getPropertyValue(i,t.propertyPath,n,t);if(t.hideLabel)o.push('<tr><td colspan="2">',e,"</td></tr>");else{var r=t.label||t.propertyPath.split("/")[0];o.push("<tr><th>",r,"</th><td>",e,"</td></tr>")}}),o.push("</table>");var e=document.createElement("div");return e.innerHTML=o.join(""),e}return null},eg._generateDynamicTableHtml=function(e,t,r){var i=this;if(e){var n=[],o=this;n.push('<table class="'+o.Css.table+'">');var a=t&&0<t.length?t.join("/")+"/":"",s=0;return Object.keys(e).forEach(function(t){i._ignoreProperty(t,e[t])||(n.push("<tr><th>",t,"</th><td>",o._getPropertyValue(e,a+t,r),"</td></tr>"),s++)}),0===s?null:(n.push("</table>"),n.join(""))}return null},eg._ignoreProperty=function(t,e){switch(t){case"title":case"name":case"base":case"popupTemplate":case"anchor":case"image":case"imageUrl":case"rotation":case"color":case"size":case"offset":case"strokeColor":case"strokeWidth":case"strokeOpacity":case"fillColor":case"fillOpacity":case"visibility":case"visible":return!0;default:if(0===t.indexOf("_")||null==e||""===e)return!0}return!1},eg._placeholderRx=/\{([a-zA-Z0-9_\/]+)\}/gi,eg._isUrlRx=/^(http|https|ftp|tel|mailto):\/\//i,eg._isImageUrlRx=/(^data:image|.png$|.jpg$|.jpeg$|.gif$|.bmp$|.svg|.tif|.tiff$)/i,eg._emailRx=/^[^\.\s@:](?:[^\s@:]*[^\s@:\.])?@[^\.\s@]+(?:\.[^\.\s@]+)*$/,eg._cssUrl=new P({domain:o,path:"sdk/javascript/mapcontrol/"+D.getEndpointVersion()+"/atlas.min.css"}).toString(),eg.Css={template:"azure-maps-control-popup-template",title:"azure-maps-control-popup-template-title",content:"azure-maps-control-popup-template-content",item:"azure-maps-control-popup-template-content-item",table:"azure-maps-control-popup-template-table"},eg);function eg(){this.detectHyperlinks=!0}r(new P({domain:o,path:"sdk/javascript/mapcontrol/"+D.getEndpointVersion()+"/mapbox-gl-rtl-text.js"}).toString(),function(t){}),p.HtmlMarker=Vs,p.Map=Qm,p.Pixel=dn,p.Popup=Ns,p.PopupTemplate=tg,p.Shape=Po,p._getAssetDomain=function(){return n},p._getDomain=function(){return Ll()},p._hasSetAuthenticationOptions=Zl,p._hasSetDomain=Hl,p._hasSetLanguage=Wl,p._hasSetSessionId=Kl,p._hasSetView=Xl,p.addImageTemplate=function(t,e,r){!r&&ru[t.toLowerCase()]||(ru[t.toLowerCase()]=e)},p.control=Fi,p.data=Wo,p.getAllImageTemplateNames=function(){return Object.keys(ru)},p.getAuthenticationOptions=Ml,p.getDomain=Ll,p.getImageTemplate=Gl,p.getLanguage=Ol,p.getSessionId=Dl,p.getSubscriptionKey=Rl,p.getUserRegion=function(){return _l},p.getVersion=function(){return D.getFullVersion()},p.getView=zl,p.internal=Eo,p.isSupported=Nl,p.layer=Ss,p.math=Ao,p.setAuthenticationOptions=Bl,p.setDomain=Fl,p.setLanguage=Ul,p.setSessionId=jl,p.setSubscriptionKey=ql,p.setUserRegion=Vl,p.setView=function(t){_l=t,Il=!0},p.source=pa,Object.defineProperty(p,"__esModule",{value:!0})});
